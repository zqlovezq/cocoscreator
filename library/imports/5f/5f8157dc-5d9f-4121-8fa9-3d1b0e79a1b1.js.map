{"version":3,"sources":["assets/Script/Tools.js"],"names":["cc","Tools","dot","event","pro","sys","isNative","log","jsb","reflection","callStaticMethod","adCallBack","ecpm","getUserEcpm","then","zm","userInfo","power","sendData","ad","sendRequest","res","data","value","videoAd","enterGame","director","loadScene","redPack","LevelInfo","stage","clickSign","clickTable","showJiliAd","showBanner","hideBanner","showTableScreen","hideTableScreen","wxLogin","wxLoginResult","errCode","wxLoginResultcode","Promise","resolve","reject","Date","getTime","createSignData","sortList","key","hasOwnProperty","item","push","sort","strToJiaMi","forEach","sc1","hex_md5","require","sign","screenAdapter","canvas","find","getComponent","Canvas","winSize","view","getVisibleSize","height","width","fitHeight","fitWidth","showTips","n","str","tips","getChildByName","Label","string","stopAllActions","y","tween","to","opacity","delay","start","url","type","xhr","XMLHttpRequest","requestURL","open","setRequestHeader","wxToken","JSON","stringify","onreadystatechange","readyState","status","response","_response","parse","code","console","message","onerror","Error","statusText","send"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Tools = {\n    /**\n     * @param {*} event 数数打点的事件名称\n     * @param {*} pro 数数打点的关联属性\n    */\n    dot(event, pro) {\n        if (cc.sys.isNative) {\n            cc.log(\"注册打点\" + event);\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"dot\", \"(Ljava/lang/String;)V\", event, pro);\n        }\n    },\n\n    /**\n     * 看视频回调\n     */\n    adCallBack(ecpm) {\n        cc.log(\"观看视频回调\");\n        // 获取广告ad之前先用epcr\n        // 看视频得体力\n        this.getUserEcpm(ecpm).then(()=>{\n            cc.log(\"获取ecpm之后才调用\");\n            if (cc.zm.userInfo.power<=0) {\n                let sendData = {\n                    ad: cc.zm.ad\n                }\n                cc.Tools.sendRequest(\"pit.v1.PitSvc/GrowPower\", \"POST\", sendData).then((res) => {\n                    cc.log(\"获取体力奖励\")\n                    cc.zm.userInfo.power = res.data.value;\n                    if(cc.zm.videoAd.enterGame){\n                        cc.director.loadScene('Game');\n                    }\n                });\n            }\n            // 看视频得红包\n            if (cc.zm.videoAd.redPack) {\n                cc.Tools.sendRequest(\"pit.v1.PitSvc/PassAd\", \"POST\", cc.zm.ad.redPack).then((res) => {\n                    cc.log(\"获取红包奖励\", res);\n                    let sendData = {};\n                    cc.Tools.sendRequest(\"pit.v1.PitSvc/UserInfo\", \"GET\", sendData).then((res) => {\n                        cc.zm.userInfo = res.data;\n                        // 如果体力大于0 进入下一关\n                        if (cc.zm.userInfo.power > 0) {\n                            cc.Tools.sendRequest(\"pit.v1.PitSvc/Stage\", \"GET\", {}).then((res) => {\n                                cc.zm.LevelInfo = res.data;\n                                cc.zm.videoAd.redPack = null;\n                                // console.log(\"关卡信息=\", cc.zm.LevelInfo);\n                                if (cc.zm.LevelInfo.stage < 30) {\n                                    cc.director.loadScene('Game');\n                                } else {\n                                    // 直接返回主界面\n                                    cc.director.loadScene('Index');\n                                }\n                            });\n                        } else {\n                            // 小于0 弹出看视频获得体力的接口\n                            cc.director.loadScene('Index');\n                        }\n                    })\n                });\n            }\n            if(cc.zm.videoAd.clickSign){\n                cc.zm.videoAd.clickSign = false;\n            }\n            if(cc.zm.videoAd.clickTable){\n                cc.zm.videoAd.clickTable = false;\n            }\n        })\n    },\n    // 显示激励视频\n    showJiliAd() {\n        cc.log(\"点击显示激励视频\")\n        if (cc.sys.isNative) {\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"showAd\", \"()V\");\n        }\n    },\n    // 显示banner\n    showBanner() {\n        if (cc.sys.isNative) {\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"showBanner\", \"()V\");\n        }\n    },\n    // 隐藏banner\n    hideBanner() {\n        if (cc.sys.isNative) {\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"hideBanner\", \"()V\");\n        }\n    },\n    // 显示插屏广告\n    showTableScreen() {\n        if (cc.sys.isNative) {\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"showTableScreen\", \"()V\");\n        }\n    },\n    // 隐藏插屏广告\n    hideTableScreen() {\n        if (cc.sys.isNative) {\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"hideTableScreen\", \"()V\");\n        }\n    },\n    // 微信登陆\n    wxLogin() {\n        cc.log(\"wxLogin\");\n        if (cc.sys.isNative) {\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"weixin_login\", \"(Ljava/lang/String;)V\", \"weixin_login\");\n        }\n    },\n    /**\n    * 接收native微信授权的code\n    * @param errCode \n    */\n    wxLoginResult(errCode) {\n        cc.log(\"wxLoginResultcode=\" + errCode)\n        cc.wxLoginResultcode = errCode;\n    },\n    /**\n     * 看广告之后刷新一下ecpm\n     */\n     getUserEcpm(ecpm) {\n         if(!cc.zm){\n             return;\n         }\n         cc.log(\"调用ecpm=\",ecpm);\n         return new Promise(function (resolve, reject){\n            let sendData = {\n                \"ecpm\": ecpm,\n                \"ts\": new Date().getTime()//时间戳\n            };\n            let data = cc.Tools.createSignData(sendData);\n            cc.Tools.sendRequest(\"pit.v1.PitSvc/Rc\", \"POST\", data).then((res) => {\n                cc.log(\"Ecpm成功\", res.data);\n                cc.zm.ad = res.data.ad;\n                resolve();\n            }).catch((res)=>{\n                cc.log(\"Ecpm失败\", res);\n                reject(res);\n            })\n         })\n    },\n    /**\n     * \n     * @param {*} data 需要签名数据\n     * @returns \n     */\n    createSignData: function (data) {\n        var sortList = [];\n        for (var key in data) {\n            if (data.hasOwnProperty(key) && key != \"sign\") {\n                var value = data[key];\n                var item = {};\n                item.key = key;\n                item.value = value;\n                sortList.push(key);\n            }\n        }\n        sortList.sort();\n        var strToJiaMi = \"\";\n        sortList.forEach(function (key) {\n            strToJiaMi += \"&\" + key + \"=\" + data[key];\n        }, this);\n        strToJiaMi = \"token=\" + cc.zm.userInfo.sc1 + strToJiaMi;\n        // var noJiaMi = strToJiaMi;\n        // console.log(\"未加密前=\", strToJiaMi)\n        var hex_md5 = require(\"MD5\")\n        strToJiaMi = hex_md5(strToJiaMi);\n        data.sign = strToJiaMi;\n        // console.log(\"加密后=\", strToJiaMi)\n        return data;\n\n    },\n    // 适配屏幕\n    screenAdapter() {\n        let canvas = cc.find(\"Canvas\").getComponent(cc.Canvas);\n        let winSize = cc.view.getVisibleSize();\n\n        if (winSize.height / winSize.width <= 720 / 1280) {\n            canvas.fitHeight = true;\n            canvas.fitWidth = false;\n        }\n        else {\n            canvas.fitHeight = false;\n            canvas.fitWidth = true;\n        }\n    },\n    /**\n     * \n     * @param {*} n node节点\n     * @param {*} str  显示的tips内容\n     */\n    showTips(n,str) {\n        let tips = n.getChildByName(\"Tips\");\n        tips.getComponent(cc.Label).string =str;\n        tips.stopAllActions();\n        tips.y = 145;\n        cc.tween(tips).to(0.1, { opacity: 255 }).to(1, { y: 300 }).delay(0.5).to(0.1, { opacity: 0 }).start()\n    },\n    /**\n     * \n     * @param {*} url 请求接口的url----pit.v1.PitSvc/UserInfo\n     * @param {*} type 请求接口的类型 只能是GET--POST\n     * @param {*} data 请求接口所需要的数据\n     * @returns \n     */\n    sendRequest: function (url, type,data) {\n        return new Promise(function (resolve, reject) {\n            let xhr = new XMLHttpRequest();\n            let requestURL = \"https://pit.api.jiankangzhuan.com/\" + url;\n            xhr.open(type, requestURL, true);\n            if (cc.sys.isNative) {\n                cc.log(\"isNative\");\n                xhr.setRequestHeader(\"Accept-Encodeing\", \"gzip,deflate\");\n            }\n            if(cc.wxToken){\n                xhr.setRequestHeader(\"Authorization\", cc.wxToken);\n            }\n            xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n            cc.log(\"requestURL=\", requestURL);\n            cc.log(\"data=\", JSON.stringify(data));\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4 && xhr.status == 200) {\n                    cc.log(\"http res:\" + xhr.response);\n                    // 统一处理\n                    let _response = JSON.parse(xhr.response);\n                    if(_response.code===0){\n                        resolve(_response)\n                    }else{\n                        console.log(_response.message);\n                        reject(_response.message);\n                    }\n                }\n            }\n            xhr.onerror = function () {\n                reject(new Error(xhr.statusText))\n            }\n            xhr.send(JSON.stringify(data));\n        })\n    }\n}"]}