{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/award/CongratulationItem.ts"],"names":["_decorator","Component","Animation","ItemInfo","ItemPoolMgr","HeroInfo","tab","HeroItem","WeaponItem","EquipInfo","EquipmentItem","CommonItem","RareBookInfo","ccclass","property","CongratulationItem","data","count","equipComItems","heroComItems","comItems","bookComItems","setData","i","parentNode","node","children","active","unschedule","playAnim","schedule","length","anim","getComponent","play","createItemByType","itemTab","getData","ItemTableById","getValue","itemId","Type","ItemType","ItemType_Hero","createHeroItem","ItemType_Book","createBookItem","ItemType_Currency","ItemType_Material","ItemType_HeroCommonCost","ItemType_LimitTimeItem","ItemType_Elixir","ItemType_Box","ItemType_Piece","ItemType_IdleReward","ItemType_ChoiceBox","Id","createCommonItem","ItemType_HeadFrame","ItemType_ChatBubble","ItemType_Head","ItemType_MainScene","ItemType_Equip","createEquipItem","info","num","itemItem","ins","createItem","push","itemTs","setTouchCallBack","isPiece","HeroTableById","id","star","extra","heroStar","DefaultStar","heroItem","setPiece","Number","initItemId","Weapon_Item","initBookItemId","equipItem","onDisable","key","putEquipItem","putHeroItem","putCommonItem","putBookItme"],"mappings":"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","sourcesContent":["import { _decorator, Component, Layout, Node, Animation } from 'cc';\r\nimport { proto } from 'client_protocol';\r\nimport { ItemInfo } from '../item/ItemInfo';\r\nimport { ItemPoolMgr } from '../item/ItemPoolMgr';\r\nimport { HeroInfo } from '../hero/HeroInfo';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { HeroItem } from '../item/HeroItem';\r\nimport { WeaponItem } from '../common/WeaponItem';\r\nimport { EquipInfo } from '../equip/EquipInfo';\r\nimport { EquipmentItem } from '../item/EquipmentItem';\r\nimport { CommonItem } from '../item/CommonItem';\r\nimport { RareBookInfo } from '../rareBook/RareBookInfo';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('CongratulationItem')\r\nexport class CongratulationItem extends Component {\r\n    private data:proto.Item[] = [];\r\n    private count:number = 0;\r\n    \r\n    private equipComItems: Array<Node> = [];\r\n    private heroComItems: Array<Node> = [];\r\n    private comItems: Array<Node> = [];\r\n    private bookComItems: Array<Node> = [];\r\n    setData(data: proto.Item[]) {\r\n        this.data = data;\r\n        this.count = 0;\r\n        for (let i = 0; i < 6; i++) {\r\n            const parentNode = this.node.children[i];\r\n            if (data[i]) {\r\n                parentNode.active = true;\r\n            } else {\r\n                parentNode.active = false;\r\n            }\r\n        }\r\n        this.unschedule(this.playAnim);\r\n        this.schedule(this.playAnim, 0.25, data.length - 1)\r\n    }\r\n    playAnim() {\r\n        const parentNode = this.node.children[ this.count];\r\n        const anim = parentNode.getComponent(Animation);\r\n        anim.play();\r\n        this.createItemByType(this.data[ this.count], parentNode);\r\n        this.count++;\r\n    }\r\n    // 根据类型创建不同的item\r\n    createItemByType(data: proto.Item, parentNode: Node) {\r\n        const itemTab = tab.getData().ItemTableById.getValue(data.itemId);\r\n        const Type = itemTab.Type;\r\n        switch (Type) {\r\n            case tab.ItemType.ItemType_Hero:\r\n                this.createHeroItem(data, parentNode)\r\n                break;\r\n            case tab.ItemType.ItemType_Book:\r\n                this.createBookItem(data, parentNode)\r\n                break;\r\n            case tab.ItemType.ItemType_Currency:\r\n            case tab.ItemType.ItemType_Material:\r\n            case tab.ItemType.ItemType_HeroCommonCost:\r\n            case tab.ItemType.ItemType_LimitTimeItem:\r\n            case tab.ItemType.ItemType_Elixir:\r\n            case tab.ItemType.ItemType_Box:\r\n            case tab.ItemType.ItemType_Piece:\r\n            case tab.ItemType.ItemType_IdleReward:\r\n            case tab.ItemType.ItemType_ChoiceBox:\r\n                if (itemTab.Id > 6100 && itemTab.Id < 9000) {\r\n                    data.itemId = itemTab.Id - 4000\r\n                    this.createHeroItem(data, parentNode, true);\r\n                } else {\r\n                    this.createCommonItem(data, parentNode);\r\n                }\r\n                break;\r\n            case tab.ItemType.ItemType_HeadFrame:\r\n            case tab.ItemType.ItemType_ChatBubble:\r\n            case tab.ItemType.ItemType_Head:\r\n            case tab.ItemType.ItemType_MainScene:\r\n            case tab.ItemType.ItemType_LimitTimeItem:\r\n                this.createCommonItem(data, parentNode);\r\n                break;\r\n            case tab.ItemType.ItemType_Equip:\r\n                this.createEquipItem(data, parentNode)\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    // 创建普通item\r\n    createCommonItem(data: proto.Item, parentNode: Node) {\r\n        const info = new ItemInfo();\r\n        info.itemId = data.itemId;\r\n        info.num = data.num;\r\n        const itemItem = ItemPoolMgr.ins.createItem(info, parentNode);\r\n        this.comItems.push(itemItem);\r\n        const itemTs = itemItem.getComponent(CommonItem);\r\n        itemTs.setTouchCallBack(() => {\r\n\r\n        })\r\n    }\r\n    // 创建英雄item\r\n    createHeroItem(data: proto.Item, parentNode: Node, isPiece: boolean = false) {\r\n        const info = new HeroInfo();\r\n        info.itemId = data.itemId;\r\n        const itemTab = tab.getData().HeroTableById.getValue(data.itemId)\r\n        info.id = 0;\r\n        info.star = data.extra && data.extra.heroStar ? data.extra.heroStar : itemTab.DefaultStar;\r\n        const heroItem = ItemPoolMgr.ins.createHeroItem(info, parentNode);\r\n        this.heroComItems.push(heroItem);\r\n        const itemTs = heroItem.getComponent(HeroItem);\r\n        itemTs.setTouchCallBack(() => {\r\n\r\n        })\r\n        if (isPiece) {\r\n            itemTs.setPiece(Number(data.num));\r\n        }\r\n    }\r\n    // 创建秘籍\r\n    createBookItem(data: proto.Item, parentNode: Node) {\r\n        let info = new RareBookInfo();\r\n        info.initItemId(data.itemId);\r\n        const Weapon_Item = ItemPoolMgr.ins.createBookItem(info, parentNode);\r\n        this.bookComItems.push(Weapon_Item);\r\n        const itemTs = Weapon_Item.getComponent(WeaponItem);\r\n        itemTs.initBookItemId(data.itemId)\r\n    }\r\n    // 创建装备\r\n    createEquipItem(data: proto.Item, parentNode: Node) {\r\n        const info = new EquipInfo();\r\n        info.itemId = data.itemId;\r\n        const equipItem = ItemPoolMgr.ins.createEquipItem(info, parentNode, false);\r\n        this.equipComItems.push(equipItem);\r\n        const itemTs = equipItem.getComponent(EquipmentItem);\r\n        itemTs.setTouchCallBack(() => {\r\n\r\n        })\r\n    }\r\n    protected onDisable(): void {\r\n        if (this.equipComItems) {\r\n            for (let key in this.equipComItems) {\r\n                ItemPoolMgr.ins.putEquipItem(this.equipComItems[key]);\r\n            }\r\n        }\r\n        if (this.heroComItems) {\r\n            for (let key in this.heroComItems) {\r\n                ItemPoolMgr.ins.putHeroItem(this.heroComItems[key]);\r\n            }\r\n        }\r\n        if (this.comItems) {\r\n            for (let key in this.comItems) {\r\n                ItemPoolMgr.ins.putCommonItem(this.comItems[key]);\r\n            }\r\n        }\r\n        if (this.bookComItems) {\r\n            for (let key in this.bookComItems) {\r\n                ItemPoolMgr.ins.putBookItme(this.bookComItems[key]);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}