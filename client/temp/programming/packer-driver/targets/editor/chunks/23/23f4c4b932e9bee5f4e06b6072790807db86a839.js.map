{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/equip/EquipMasterPop.ts"],"names":["_decorator","instantiate","Label","Node","Prefab","ProgressBar","Toggle","ViewPop","tab","EquipmentAttrItem","EquipData","LangMgr","ccclass","property","EquipMasterPop","currTag","heroClass","attrItemComs","currMasterInfo","register","start","openData","MasterType","MasterType_Enhance","toggle_enhance","isChecked","MasterType_Quality","toggle_quality","MasterType_Refine","toggle_refine","initView","initEnhanceView","initQualityView","initRefineView","qualityNode","active","forgeNode","strengthenNode","ins","getMasterInfoByHeroClass","level","qualityMasterLevel","levelLab","string","nextHeroMasterTab","getHeroMasterTableByTypeAndLevel","minLevel","getMinLevel","qualityLvLab","node","qualityMasterLab","Level","getLab","progreBar","progress","Require","currValueLab","totalValueLab","qualityTable","updateAtts","refineMasterLevel","forgeLvLab","forgeMasterLab","refineTable","enhanceMasterLevel","strengthenLvLab","strengthenMasterLab","enhanceTable","type","allEquips","getWearEquipInfosByHeroClass","i","equipTable","MasterLevel","enhanceLv","refineLv","nextMasterInfo","attrMaps","Map","atts","AttrList","key","item","getData","EquipAttrTableById","getValue","info","get","AttrType","value","Base","set","next","index","forEach","vlaue","attrItemPrefab","parent","attrContent","push","getComponent","onClickTogle","event","Number"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Label, Node, Prefab, ProgressBar, Toggle } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { EquipmentAttrItem } from './EquipmentAttrItem';\r\nimport { EquipMasterInfo } from './EquipMasterInfo';\r\nimport { EquipData } from './EquipData';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('EquipMasterPop')\r\nexport class EquipMasterPop extends  ViewPop{\r\n    @property(ProgressBar)\r\n    progreBar:ProgressBar=null;\r\n    @property(Label)\r\n    currValueLab:Label=null;\r\n    @property(Label)\r\n    totalValueLab:Label=null;\r\n    @property(Label)\r\n    levelLab:Label=null;\r\n    @property(Node)\r\n    qualityNode:Node=null;\r\n    @property(Node)\r\n    strengthenNode:Node=null;\r\n    @property(Node)\r\n    forgeNode:Node=null;\r\n    @property(Label)\r\n    qualityLvLab:Label=null;\r\n    @property(Label)\r\n    qualityMasterLab:Label=null;\r\n\r\n    @property(Label)\r\n    strengthenLvLab:Label=null;\r\n    @property(Label)\r\n    strengthenMasterLab:Label=null;\r\n\r\n    @property(Label)\r\n    forgeLvLab:Label=null;\r\n    @property(Label)\r\n    forgeMasterLab:Label=null;\r\n    @property(Node)\r\n    attrContent:Node=null;\r\n    @property(Prefab)\r\n    attrItemPrefab:Prefab=null;\r\n    @property(Toggle)\r\n    toggle_quality:Toggle=null;\r\n    @property(Toggle)\r\n    toggle_enhance:Toggle=null;\r\n    \r\n    @property(Toggle)\r\n    toggle_refine:Toggle=null;\r\n    \r\n    private currTag:number;\r\n\r\n    private heroClass:number;\r\n    private attrItemComs:Array<EquipmentAttrItem>;\r\n    private currMasterInfo:EquipMasterInfo;\r\n \r\n    register(): void {\r\n       \r\n    }\r\n     start(): void {\r\n        this.heroClass=this.openData[\"heroClass\"];\r\n        if(this.openData[\"type\"]){\r\n            this.currTag=this.openData[\"type\"];\r\n        }else{\r\n            this.currTag=tab.MasterType.MasterType_Enhance;\r\n        }\r\n        if(this.currTag==tab.MasterType.MasterType_Enhance){\r\n            this.toggle_enhance.isChecked=true;\r\n\r\n        }else if(this.currTag==tab.MasterType.MasterType_Quality){\r\n            this.toggle_quality.isChecked=true;\r\n\r\n        }else if(this.currTag==tab.MasterType.MasterType_Refine){\r\n            this.toggle_refine.isChecked=true;\r\n        }\r\n        this.attrItemComs=[];\r\n        this.initView();\r\n    }\r\n    initView(){\r\n        if(this.currTag==tab.MasterType.MasterType_Enhance){\r\n            this.initEnhanceView();\r\n\r\n        }else if(this.currTag==tab.MasterType.MasterType_Quality){\r\n            this.initQualityView();\r\n\r\n        }else if(this.currTag==tab.MasterType.MasterType_Refine){\r\n            this.initRefineView();\r\n        }\r\n    }\r\n    initQualityView(){\r\n        this.qualityNode.active=true;\r\n        this.forgeNode.active=false;\r\n        this.strengthenNode.active=false;\r\n        this.currMasterInfo=EquipData.ins.getMasterInfoByHeroClass(this.heroClass);\r\n        let level=this.currMasterInfo.qualityMasterLevel;\r\n        this.levelLab.string=this.currMasterInfo.qualityMasterLevel+\"\";\r\n        let nextHeroMasterTab:tab.HeroMasterTable=EquipData.ins.getHeroMasterTableByTypeAndLevel(tab.MasterType.MasterType_Quality,level+1);\r\n        let minLevel=this.getMinLevel(1);\r\n      \r\n        if(nextHeroMasterTab){\r\n            this.qualityLvLab.node.active=true;\r\n            this.qualityMasterLab.node.active=false;\r\n            // let require=nextHeroMasterTab.Require;\r\n            let level=nextHeroMasterTab.Level;\r\n            this.qualityLvLab.string=LangMgr.getLab(\"heromaster_desc_1000\"+level);\r\n            // this.qualityMasterLab.string=nextHeroMasterTab.Level+\"\";\r\n            this.progreBar.progress=minLevel/nextHeroMasterTab.Require;\r\n            \r\n            this.currValueLab.string=minLevel+\"\";\r\n            this.totalValueLab.string=nextHeroMasterTab.Require+\"\"\r\n        }else{\r\n            this.progreBar.progress=1;//minLevel/this.currMasterInfo.qualityTable.Require;\r\n            \r\n            this.currValueLab.string=this.currMasterInfo.qualityTable.Require+\"\";//minLevel+\"\";\r\n            this.totalValueLab.string=this.currMasterInfo.qualityTable.Require+\"\"\r\n            //满级\r\n            this.qualityLvLab.node.active=false;\r\n            this.qualityMasterLab.node.active=true;\r\n        }\r\n        this.updateAtts(this.currMasterInfo.qualityTable,nextHeroMasterTab);\r\n    }\r\n\r\n    initRefineView(){\r\n        this.qualityNode.active=false;\r\n        this.forgeNode.active=true;\r\n        this.strengthenNode.active=false;\r\n        this.currMasterInfo=EquipData.ins.getMasterInfoByHeroClass(this.heroClass);\r\n        let level=this.currMasterInfo.refineMasterLevel;\r\n        this.levelLab.string=level+\"\";\r\n        let nextHeroMasterTab:tab.HeroMasterTable=EquipData.ins.getHeroMasterTableByTypeAndLevel(tab.MasterType.MasterType_Refine,level+1);\r\n        let minLevel=this.getMinLevel(3);\r\n        if(nextHeroMasterTab){\r\n            this.forgeLvLab.string=LangMgr.getLab(\"heromaster_desc_3000\"+nextHeroMasterTab.Level);\r\n            this.forgeMasterLab.node.active=false;\r\n            this.forgeLvLab.node.active=true;\r\n            // this.forgeMasterLab.string=nextHeroMasterTab.Level+\"\";\r\n            this.progreBar.progress=minLevel/nextHeroMasterTab.Require;\r\n            this.currValueLab.string=minLevel+\"\";\r\n            this.totalValueLab.string=nextHeroMasterTab.Require+\"\"\r\n        }else{\r\n            //满级\r\n            this.forgeMasterLab.node.active=true;\r\n            this.forgeLvLab.node.active=false;\r\n            this.progreBar.progress=1;//minLevel/this.currMasterInfo.refineTable.Require;\r\n            this.currValueLab.string=this.currMasterInfo.refineTable.Require+\"\";//minLevel+\"\";\r\n            this.totalValueLab.string=this.currMasterInfo.refineTable.Require+\"\"\r\n        }\r\n        this.updateAtts(this.currMasterInfo.refineTable,nextHeroMasterTab);\r\n    }\r\n    initEnhanceView(){\r\n        this.qualityNode.active=false;\r\n        this.forgeNode.active=false;\r\n        this.strengthenNode.active=true;\r\n        this.currMasterInfo=EquipData.ins.getMasterInfoByHeroClass(this.heroClass);\r\n        let level=this.currMasterInfo.enhanceMasterLevel;\r\n        this.levelLab.string=level+\"\";\r\n        let nextHeroMasterTab:tab.HeroMasterTable=EquipData.ins.getHeroMasterTableByTypeAndLevel(tab.MasterType.MasterType_Enhance,level+1);\r\n        let minLevel=this.getMinLevel(2);\r\n        if(nextHeroMasterTab){\r\n            this.strengthenLvLab.node.active=true;\r\n            this.strengthenMasterLab.node.active=false;\r\n            this.strengthenLvLab.string=LangMgr.getLab(\"heromaster_desc_2000\"+nextHeroMasterTab.Level);\r\n            // this.strengthenMasterLab.string=nextHeroMasterTab.Level+\"\";\r\n            this.progreBar.progress=minLevel/nextHeroMasterTab.Require;\r\n            this.currValueLab.string=minLevel+\"\";\r\n            this.totalValueLab.string=nextHeroMasterTab.Require+\"\"\r\n            \r\n        }else{\r\n            this.strengthenLvLab.node.active=false;\r\n            this.strengthenMasterLab.node.active=true;\r\n            this.progreBar.progress=1;//minLevel/this.currMasterInfo.enhanceTable.Require;\r\n            this.currValueLab.string=this.currMasterInfo.enhanceTable.Require+\"\";//minLevel+\"\";\r\n            this.totalValueLab.string=this.currMasterInfo.enhanceTable.Require+\"\"\r\n            \r\n        }\r\n        this.updateAtts(this.currMasterInfo.enhanceTable,nextHeroMasterTab);\r\n    }\r\n\r\n    getMinLevel(type:number){\r\n        let allEquips=EquipData.ins.getWearEquipInfosByHeroClass(this.heroClass);\r\n        let minLevel=-1;\r\n        for(let i:number=1;i<5;i++){\r\n            if(allEquips[i]){\r\n                let level=0;\r\n                if(type==1){\r\n                    level=allEquips[i].equipTable.MasterLevel;\r\n                }else if(type==2){\r\n                    level=allEquips[i].enhanceLv;\r\n                }else if(type==3){\r\n                    level=allEquips[i].refineLv\r\n                }\r\n                if(minLevel==-1){\r\n                    minLevel=level;\r\n                }\r\n                if(level<minLevel){\r\n                    minLevel=level;\r\n                }\r\n            }else{\r\n                minLevel=0;\r\n            }\r\n        }\r\n        if(minLevel==-1){\r\n            minLevel=0;\r\n        }\r\n        return minLevel;\r\n    }\r\n\r\n    updateAtts(currMasterInfo:tab.HeroMasterTable,nextMasterInfo:tab.HeroMasterTable){\r\n        let attrMaps:Map<number,any>=new Map();\r\n        if(currMasterInfo){\r\n            let atts=currMasterInfo.AttrList;\r\n            for(let key in atts){\r\n                let item=tab.getData().EquipAttrTableById.getValue(atts[key]);\r\n                let info=attrMaps.get(item.AttrType);\r\n                if(info){\r\n                    info.value+=item.Base;\r\n                }else{\r\n                    info={\"value\":item.Base,\"next\":0}\r\n                    attrMaps.set(item.AttrType,info);\r\n                }\r\n            }\r\n        }\r\n        if(nextMasterInfo){\r\n            let atts=nextMasterInfo.AttrList;\r\n            for(let key in atts){\r\n                let item=tab.getData().EquipAttrTableById.getValue(atts[key]);\r\n                let info=attrMaps.get(item.AttrType);\r\n                if(info){\r\n                    info.next+=item.Base;\r\n                }else{\r\n                    info={\"value\":0,\"next\":item.Base}\r\n                    attrMaps.set(item.AttrType,info);\r\n                }\r\n            }\r\n        }\r\n\r\n        for(let key in this.attrItemComs){\r\n            this.attrItemComs[key].node.active=false;\r\n        }\r\n\r\n        let index=0;\r\n        attrMaps.forEach((vlaue,key)=> {\r\n            if(!this.attrItemComs[index]){\r\n                let node:Node=instantiate(this.attrItemPrefab);\r\n                node.parent=this.attrContent;\r\n                this.attrItemComs.push(node.getComponent(EquipmentAttrItem));\r\n            }\r\n            this.attrItemComs[index].node.active=true;\r\n            this.attrItemComs[index].initView(key,vlaue.value,vlaue.next,\"\")\r\n            index++;\r\n        });\r\n    }\r\n    onClickTogle(event,type){\r\n        if(Number(type)!=this.currTag){\r\n            this.currTag=Number(type);\r\n            this.initView();\r\n        }\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}