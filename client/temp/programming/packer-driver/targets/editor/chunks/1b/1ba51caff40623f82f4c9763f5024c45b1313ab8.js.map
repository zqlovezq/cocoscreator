{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/role/roleInfo/RoleInfoPop.ts"],"names":["_decorator","game","Label","Node","Toggle","ViewPop","RoleData","Sound","PlaySound","Func","UIMgr","ViewName","SoundUrl","ResMgr","SettingsManager","EventMgr","proto","Global","ChannelMgr","ccclass","property","RoleInfoPop","onLoad","redeemcodeNode","active","isReview","service_btn","mgrBtn","isJp37","onShow","setStaticView","lbl_nickname","string","ins","name","lbl_id","id","toggle_bgm","isChecked","getSetting","toggle_effect","toggle_shock","toggle_damage","lbl_lv","String","level","onDestroy","on_s2c_ChangeRoleName","msg","error","code","CommonErrorCode","Succeed","hideView","register","onMsg","Ptl","ChangeRoleNameRsp","unRegister","onClickToggle","event","key","toggle","target","getComponent","setSetting","onCheckBgm","onChecEffect","onCheckAutoCollect","onCheckDamage","enabled","EnableBGM","console","log","MainBGM","EnableSE","onClickCopy","copyText","onClickChangeName","printCache","show","viewName","RoleInfoChangeNamePop","onClickRedeemcode","RoleInfoRedemptionCodePop","onClickChangeAccount","logout","restart","onClickUpgradeAccount","accountUpgrade","onClickHeadChange","RoleInfoDecorationsPop","onClickMgr","accountCenter","onClickService","openCustomService"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, game, Label, Node, Toggle } from 'cc';\r\nimport { ViewPop } from '../../../../framework/base/ViewPop';\r\nimport { RoleData } from '../RoleData';\r\nimport Sound, { PlaySound } from '../../../utils/Sound';\r\nimport { Func } from '../../../utils/Func';\r\nimport { UIMgr } from '../../../mgr/UIMgr';\r\nimport { ViewName } from '../../../define/ViewDefine';\r\nimport { SoundUrl } from '../../../../Common/script/EnumTypeMgr';\r\nimport { ResMgr } from '../../../mgr/ResMgr';\r\nimport { SettingsManager } from '../SettingsManager';\r\nimport { EventMgr } from '../../../mgr/EventMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { Global } from '../../../../Global';\r\nimport { ChannelMgr } from '../../../../channel/ChannelMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('RoleInfoPop')\r\nexport class RoleInfoPop extends ViewPop {\r\n    @property(Label)\r\n    lbl_nickname: Label = null;\r\n    @property(Label)\r\n    lbl_id: Label = null;\r\n    @property(Toggle)\r\n    toggle_bgm: Toggle = null;\r\n    @property(Toggle)\r\n    toggle_effect: Toggle = null;\r\n    @property(Toggle)\r\n    toggle_shock: Toggle = null;\r\n    @property(Toggle)\r\n    toggle_damage: Toggle = null;\r\n    @property(Label)\r\n    lbl_lv: Label = null;\r\n\r\n    @property(Node)\r\n    mgrBtn: Node = null;\r\n    @property(Node)\r\n    service_btn: Node = null\r\n    \r\n    \r\n\r\n    @property(Node)\r\n    redeemcodeNode: Node = null\r\n    protected onLoad(): void {\r\n        super.onLoad()\r\n        this.redeemcodeNode.active = !Global.isReview\r\n        this.service_btn.active =  this.mgrBtn.active = ChannelMgr.isJp37\r\n    }\r\n    onShow(): void {\r\n        this.setStaticView();\r\n    }\r\n    setStaticView() {\r\n        // 名字\r\n        this.lbl_nickname.string = RoleData.ins.name;\r\n        // id\r\n        this.lbl_id.string = RoleData.ins.id;\r\n\r\n        // this.toggle_bgm.isChecked = Sound.ins.isEnableBGM();\r\n\r\n        // this.toggle_effect.isChecked = Sound.ins.isEnableSE();\r\n        this.toggle_bgm.isChecked = SettingsManager.ins.getSetting(\"bgm_flag\");\r\n        this.toggle_effect.isChecked = SettingsManager.ins.getSetting(\"se_flag\");\r\n        this.toggle_shock.isChecked = SettingsManager.ins.getSetting(\"isAutoCollect\");\r\n        this.toggle_damage.isChecked = SettingsManager.ins.getSetting(\"damage_flag\");\r\n        this.lbl_lv.string = String(RoleData.ins.level);\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy();\r\n    }\r\n    on_s2c_ChangeRoleName(msg: proto.Msg_ChangeRoleNameRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            UIMgr.ins.hideView(\"RoleInfoChangeNamePop\");\r\n            this.lbl_nickname.string = msg.name;\r\n        }\r\n    }\r\n    register(): void {\r\n        /* 监听名字修改 */\r\n        EventMgr.onMsg(proto.Ptl.ChangeRoleNameRsp, this.on_s2c_ChangeRoleName, this);\r\n    }\r\n    unRegister(): void {\r\n        super.unRegister();\r\n    }\r\n    onClickToggle(event: EventTouch, key: string) {\r\n        const toggle = event.target.getComponent(Toggle);\r\n        SettingsManager.ins.setSetting(key, toggle.isChecked);\r\n        switch (key) {\r\n            case \"bgm_flag\":\r\n                this.onCheckBgm(toggle.isChecked);\r\n                break;\r\n            case \"se_flag\":\r\n                this.onChecEffect(toggle.isChecked);\r\n                break\r\n            case \"isAutoCollect\":\r\n                this.onCheckAutoCollect(toggle.isChecked);\r\n                break\r\n            case \"damage_flag\":\r\n                this.onCheckDamage(toggle.isChecked);\r\n                break\r\n            default:\r\n                break\r\n        }\r\n    }\r\n    /* 点击复制id */\r\n    /* 关闭开启背景音乐 */\r\n    onCheckBgm(enabled: boolean) {\r\n        Sound.ins.EnableBGM(enabled);\r\n        if (enabled) {\r\n            console.log('Music enabled');\r\n            PlaySound(SoundUrl.MainBGM);\r\n        } else {\r\n            console.log('Music disabled');\r\n        }\r\n    }\r\n    onChecEffect(enabled: boolean) {\r\n        Sound.ins.EnableSE(enabled);\r\n        if (enabled) {\r\n            console.log('Sound effects enabled');\r\n            // 启用音效\r\n        } else {\r\n            console.log('Sound effects disabled');\r\n            // 禁用音效\r\n        }\r\n    }\r\n    onCheckAutoCollect(enabled: boolean) {\r\n        if (enabled) {\r\n            console.log('shock effects enabled');\r\n            // 启用震动\r\n        } else {\r\n            console.log('Sound effects disabled');\r\n            // 禁用震动\r\n        }\r\n    }\r\n    onCheckDamage(enabled: boolean) {\r\n        if (enabled) {\r\n            console.log('Damage enabled');\r\n            // 启用伤害字体\r\n        } else {\r\n            console.log('Damage disabled');\r\n            // 禁用伤害字体\r\n        }\r\n    }\r\n    onClickCopy() {\r\n        Func.copyText(RoleData.ins.id)\r\n    }\r\n    /* 点击更改姓名 */\r\n    onClickChangeName() {\r\n        ResMgr.printCache()\r\n        UIMgr.ins.show({ viewName: ViewName.RoleInfoChangeNamePop })\r\n    }\r\n    onClickRedeemcode() {\r\n        console.log(\"wwwww\")\r\n        UIMgr.ins.show({ viewName: ViewName.RoleInfoRedemptionCodePop })\r\n    }\r\n    onClickChangeAccount() {\r\n        ChannelMgr.logout(\"\", () => {\r\n            console.log(\"重启游戏代码\")\r\n            game.restart()\r\n        });\r\n    }\r\n    onClickUpgradeAccount() {\r\n        ChannelMgr.accountUpgrade();\r\n    }\r\n    /* 点击更换头像 */\r\n    onClickHeadChange() {\r\n        UIMgr.ins.show({ viewName: ViewName.RoleInfoDecorationsPop })\r\n    }\r\n\r\n    onClickMgr() {\r\n        ChannelMgr.accountCenter({})\r\n    }\r\n    onClickService() {\r\n        ChannelMgr.openCustomService()\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}