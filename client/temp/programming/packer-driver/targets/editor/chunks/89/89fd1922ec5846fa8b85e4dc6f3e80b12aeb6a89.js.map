{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/fincaFight/FincaFightTeamToggle.ts"],"names":["_decorator","Component","Label","FincaFightTeamState","HeroData","ItemPoolMgr","HeroItem","FincaFightData","ShowTips","LangMgr","ccclass","property","FincaFightTeamToggle","emptyNode","lockNode","heroNode","selectNode","heroItem","lvNode","curIndex","setData","index","heroId","ins","heroIds","node","getChildByName","getComponent","string","String","getHeroPvpLevel","state","getState","active","EMPTY","LOCK","HERO","parent","heroInfo","getById","heroItemNode","createHeroItem","setTouchCallBack","UpdateContent","setSelectState","isSelect","refreshItem","onClickLockBtn","level","getUnLockLevel","getCombineString","defaultLevel","star"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node } from 'cc';\r\nimport { FincaFightTeamState } from '../../../Common/script/EnumTypeMgr';\r\nimport { HeroData } from '../hero/HeroData';\r\nimport { ItemPoolMgr } from '../item/ItemPoolMgr';\r\nimport { HeroItem } from '../item/HeroItem';\r\nimport { FincaFightData } from './FincaFightData';\r\nimport { ShowTips } from '../../mgr/UIMgr';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('FincaFightTeamToggle')\r\nexport class FincaFightTeamToggle extends Component {\r\n    private emptyNode:Node = null;\r\n    private lockNode:Node = null;\r\n    private heroNode:Node = null;\r\n    private selectNode:Node = null;\r\n    private heroItem:HeroItem = null;\r\n    private lvNode:Label = null;\r\n    public curIndex:number = 0;\r\n    setData(index:number){\r\n        let heroId = FincaFightData.ins.heroIds[index];\r\n        this.curIndex = index;\r\n        this.emptyNode = this.node.getChildByName(\"empty_node\");\r\n        this.lockNode = this.node.getChildByName(\"lock_node\");\r\n        this.heroNode = this.node.getChildByName(\"item\");\r\n        this.selectNode = this.node.getChildByName(\"select_node\");\r\n        this.lvNode = this.node.getChildByName(\"lv_node\").getChildByName(\"lv_txt\").getComponent(Label);\r\n        this.lvNode.string = String(this.getHeroPvpLevel());\r\n        \r\n        const state = FincaFightData.ins.getState(index+1);\r\n\r\n        this.emptyNode.active = state===FincaFightTeamState.EMPTY;\r\n        this.lockNode.active = state===FincaFightTeamState.LOCK;\r\n        this.heroNode.active = state===FincaFightTeamState.HERO;\r\n        this.lvNode.node.parent.active =  state===FincaFightTeamState.HERO;\r\n        let heroInfo = HeroData.ins.getById(heroId);\r\n        if(heroId){\r\n            if(!this.heroItem){\r\n                let heroItemNode = ItemPoolMgr.ins.createHeroItem(heroInfo,this.heroNode);\r\n                this.heroItem = heroItemNode.getComponent(HeroItem);\r\n                this.heroItem.setTouchCallBack(()=>{\r\n                    // console.log(`cocos 当前点击的index=${index}`)\r\n                });\r\n            }else{\r\n                this.heroItem.UpdateContent(heroInfo);\r\n            }\r\n        }\r\n    }\r\n    setSelectState(isSelect:boolean){\r\n        this.selectNode.active = isSelect;\r\n    }\r\n    refreshItem(heroId:number){\r\n        let heroInfo = HeroData.ins.getById(heroId);\r\n        this.heroItem.UpdateContent(heroInfo)\r\n    }\r\n    onClickLockBtn(){\r\n        const level = FincaFightData.ins.getUnLockLevel(this.curIndex+1,true);\r\n        ShowTips(LangMgr.getCombineString(\"Tips_finca_3\",[level]))\r\n    }\r\n    // 获取pvp英雄的觉醒星级\r\n    getHeroPvpLevel(){\r\n        let defaultLevel = 5;\r\n        let heroId = FincaFightData.ins.heroIds[this.curIndex];\r\n        let heroInfo = HeroData.ins.getById(heroId);\r\n        // 英雄星级>=16时，星级+1\r\n        if(heroInfo&&heroInfo.star>=16){\r\n            defaultLevel+=1;\r\n        }\r\n        return defaultLevel\r\n    }\r\n}\r\n\r\n\r\n"]}