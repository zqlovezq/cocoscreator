{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/recruit/RecruitView.ts"],"names":["_decorator","Button","Label","Node","RichText","sp","Sprite","Toggle","ViewPop","tab","Func","ViewName","ShowTips","UIMgr","proto","Net","EventMgr","HeroDataControl","LangMgr","HeroData","ItemData","RedMgr","RedDotType","gachaReplace","setTextTime","AdMgr","RoleData","RecruitType","SettingRedManager","GuideController","LocalEvent","ActivityData","ccclass","property","RecruitView","Skeleton","_recruitHerosMap","Map","_curRecruitType","None","_recruitItemSource","_isGacha","_newHero","countDown","setRecruitMap","clear","heros","ins","getHeros","i","length","heroInfo","heroTab","heroTable","Aptitude","HeroAptitude","HeroAptitude_SR","has","Id","set","get","register","onMsg","Ptl","GachaRsp","on_s2c_GachaRsp","onLocal","showNewOver","autoShowHeroAnim","hidePop","unRegister","msg","error","code","CommonErrorCode","Succeed","id","rewards","itemId","showNewHeroPop","showGachaView","isGuiding","unClickToggle","asyncView","refreshEvent","HeroGacha","GachaAds","onShow","emitLocal","ShowPop","Senior","openData","node_toggle","node_toggle_type","getChildByName","getComponent","isChecked","showTypeNode","node_limit","active","GachaUpIsOpen","hideView","actInfo","getAllUpData","Number","endTime","getServerUtcTime","timeUpdate","unschedule","schedule","lbl_time","string","onDestroy","switchRecruitType","event","type","node_senior","node_vocation","Vocation","node_friend","Friend","getItem","changeItemSource","String","seniorVoucher","getCount","heroVoucher","lbl_senior_voucher","lbl_hero_voucher","type_friend","AdType","AdType_Gacha301","friend_adv_cur_count","getAdCountByType","friend_adv_max_count","getAdCountMaxByType","lbl_adv_friend_time","node_adv_friend_btn","grayscale","interactable","type_senior","AdType_Gacha101","senior_adv_cur_count","senior_adv_max_count","lbl_adv_senior_time","node_adv_senior_btn","totalCount","drop","data","sum","lbl_tips","getCombineString","setItem","vocation_toggle","node_toggle_vacation","gachaTen","sendGacha","gachaOnce","sendSeniorAdvWatch","playVideoAd","sendFriendAdvWatch","isAdv","self","gachaTab","getData","GachaTableById","getValue","count","ItemCount","ItemId","itemCount","getHeroBagFull","getLab","sendMsg","setAnimation","setCompleteListener","listener","animation","name","Msg_GachaReq","fromAdv","Send","GachaReq","canSendMsg","_rewards","_id","show","viewName","RecruitGetPop","map","showGachaProbabilityView","RecruitProbabilityPop","RecruitFriendProbabilityPop","RecruitProProbabilityPop","showGuaranteeView","RecruitGuaranteePop","NewHeroPop","HeroTableById","num","extra","heroStar","DefaultStar","transaction","CongratulationPop","onClickGoVocationShop","MallMainView","MallTab","MallTab_Tab3","onClose","getSetting","setSetting","checkMainView","clickLimitBtn","RecruitLimitView"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, EventTouch, Label, Node, RichText, sp, Sprite, Toggle } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { Func } from '../../utils/Func';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { ShowTips, UIMgr } from '../../mgr/UIMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../net/Net';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nimport { HeroDataControl } from '../hero/herobag/HeroDataControl';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { HeroData } from '../hero/HeroData';\r\nimport { ItemData } from '../item/ItemData';\r\nimport { RedMgr } from '../../mgr/RedMgr';\r\nimport { RedDotType } from '../../red/RedDotType';\r\nimport { gachaReplace, setTextTime } from '../../utils/GameUtil';\r\nimport { AdMgr } from '../AdMgr';\r\nimport { RoleData } from '../role/RoleData';\r\nimport { RecruitType } from '../../../Common/script/EnumTypeMgr';\r\nimport { SettingRedManager } from '../role/SettingRedManager';\r\nimport { GuideController } from '../../guide/GuideController';\r\nimport { LocalEvent } from '../../define/LocalEvent';\r\nimport { ActivityData } from '../activity/ActivityData';\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('RecruitView')\r\nexport class RecruitView extends ViewPop {\r\n    @property(Node)\r\n    node_senior: Node = null;\r\n    @property(Node)\r\n    node_vocation: Node = null;\r\n    @property(Node)\r\n    node_friend: Node = null;\r\n\r\n    @property(RichText)\r\n    lbl_tips: RichText = null;\r\n\r\n    @property(Node)\r\n    node_toggle_type: Node = null;\r\n    @property(Node)\r\n    node_toggle_vacation: Node = null;\r\n    @property(Label)\r\n    lbl_senior_voucher: Label = null;\r\n    @property(Label)\r\n    lbl_hero_voucher: Label = null;\r\n    @property(sp.Skeleton)\r\n    spine_draw_1: sp.Skeleton = null;\r\n    @property(sp.Skeleton)\r\n    spine_draw_2: sp.Skeleton = null;\r\n    @property(sp.Skeleton)\r\n    spine_draw_3: sp.Skeleton = null;\r\n\r\n    @property(Label)\r\n    lbl_adv_friend_time: Label = null;\r\n    @property(Node)\r\n    node_adv_friend_btn: Node = null;\r\n\r\n    @property(Label)\r\n    lbl_adv_senior_time: Label = null;\r\n    @property(Node)\r\n    node_adv_senior_btn: Node = null;\r\n    @property(Node)\r\n    node_limit: Node = null;\r\n    @property(Label)\r\n    lbl_time:Label = null;\r\n\r\n    public _recruitHerosMap: Map<number, number> = new Map();\r\n    private _curRecruitType: RecruitType = RecruitType.None;//当前抽卡类型\r\n    private _recruitItemSource: number = 0;\r\n    private _isGacha: boolean = false\r\n    private _newHero: number = 0;\r\n    private countDown:number = 0;\r\n    /* 初始化map */\r\n    setRecruitMap() {\r\n        this._recruitHerosMap.clear();\r\n        const heros = HeroData.ins.getHeros();\r\n        for (let i = 0; i < heros.length; i++) {\r\n            const heroInfo = heros[i];\r\n            const heroTab = heroInfo.heroTable;\r\n            if (heroTab.Aptitude == tab.HeroAptitude.HeroAptitude_SR) {\r\n                if (this._recruitHerosMap.has(heroTab.Id)) {\r\n                    this._recruitHerosMap.set(heroTab.Id, this._recruitHerosMap.get(heroTab.Id) + 1)\r\n                } else {\r\n                    this._recruitHerosMap.set(heroTab.Id, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    register(): void {\r\n        /* 获取背包数据 */\r\n        EventMgr.onMsg(proto.Ptl.GachaRsp, this.on_s2c_GachaRsp, this);\r\n        EventMgr.onLocal(LocalEvent.showNewOver, this.autoShowHeroAnim, this)\r\n        EventMgr.onLocal(LocalEvent.hidePop, this.hidePop, this)\r\n    }\r\n    unRegister(): void {\r\n        super.unRegister()\r\n    }\r\n    on_s2c_GachaRsp(msg: proto.Msg_GachaRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        if (msg.id === 100) {\r\n            this._newHero = msg.rewards[0].itemId;\r\n            this.showNewHeroPop();\r\n        } else {\r\n            this.showGachaView(msg.rewards, msg.id)\r\n        }\r\n        if (!GuideController.ins.isGuiding()) {\r\n            this._isGacha = false;\r\n        }\r\n        this.unClickToggle();\r\n        this.asyncView();\r\n        // 刷新红点\r\n\r\n        RedMgr.refreshEvent(RedDotType.HeroGacha); //保底抽\r\n        RedMgr.refreshEvent(RedDotType.GachaAds); //广告\r\n    }\r\n    hidePop() {\r\n        if (GuideController.ins.isGuiding()) {\r\n            this._isGacha = false;\r\n        }\r\n    }\r\n    onShow(): void {\r\n        // 默认进来高级扭蛋\r\n        if (GuideController.ins.isGuiding()) {\r\n            EventMgr.emitLocal(LocalEvent.ShowPop);\r\n        }\r\n        this.setRecruitMap();\r\n        this._curRecruitType = RecruitType.Senior;\r\n        if (this.openData) {\r\n            this._curRecruitType = this.openData;\r\n        }\r\n        const node_toggle: Toggle = this.node_toggle_type.getChildByName(\"Toggle\" + this._curRecruitType).getComponent(Toggle);\r\n        node_toggle.isChecked = true;\r\n        this.showTypeNode();\r\n        this.node_limit.active = ActivityData.ins.GachaUpIsOpen();\r\n        if(this.node_limit.active){\r\n            UIMgr.ins.hideView(\"RecruitLimitView\");\r\n            const actInfo = ActivityData.ins.getAllUpData()[0];\r\n            this.countDown = Number(actInfo.endTime) - RoleData.ins.getServerUtcTime();\r\n            this.timeUpdate();\r\n            this.unschedule(this.timeUpdate);\r\n            this.schedule(this.timeUpdate, 1);\r\n        }\r\n    }\r\n    timeUpdate(){\r\n        this.countDown--;\r\n        if(this.countDown<=0){\r\n            this.unschedule(this.timeUpdate);\r\n            this.node_limit.active = false;\r\n        }else{\r\n            this.lbl_time.string = setTextTime(this.countDown);\r\n        }\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy();\r\n        this.unRegister();\r\n    }\r\n    switchRecruitType(event: EventTouch, type: string) {\r\n        this._curRecruitType = Number(type);\r\n        this.showTypeNode();\r\n    }\r\n    showTypeNode() {\r\n        this.node_senior.active = this._curRecruitType === RecruitType.Senior;\r\n        this.node_vocation.active = this._curRecruitType === RecruitType.Vocation;\r\n        this.node_friend.active = this._curRecruitType === RecruitType.Friend;\r\n        if (this._curRecruitType === RecruitType.Vocation) {\r\n            // 默认为射手 是否本地存储职业 没有则设置为默认\r\n            if (Func.getItem(\"recruit_vacation\")) {\r\n                this.changeItemSource(null, Func.getItem(\"recruit_vacation\"))\r\n            } else {\r\n                this.changeItemSource(null, String(210))\r\n            }\r\n        } else {\r\n            this.asyncView();\r\n            this.changeItemSource(null, \"\");\r\n        }\r\n    }\r\n    /* 界面动态信息更新*/\r\n    asyncView() {\r\n        const seniorVoucher = ItemData.ins.getCount(51);\r\n        // 英雄凭证\r\n        const heroVoucher = ItemData.ins.getCount(81);\r\n        this.lbl_senior_voucher.string = seniorVoucher + \"/\" + 1000\r\n        this.lbl_hero_voucher.string = heroVoucher + \"/\" + 1000;\r\n        const type_friend = tab.AdType.AdType_Gacha301;\r\n        const friend_adv_cur_count = AdMgr.ins.getAdCountByType(type_friend);\r\n        const friend_adv_max_count = AdMgr.ins.getAdCountMaxByType(type_friend);\r\n        this.lbl_adv_friend_time.string = (friend_adv_max_count - friend_adv_cur_count) + \"/\" + friend_adv_max_count;\r\n        if (AdMgr.ins.getAdCountByType(type_friend) >= AdMgr.ins.getAdCountMaxByType(type_friend)) {\r\n            this.node_adv_friend_btn.getComponent(Sprite).grayscale = true;\r\n            this.node_adv_friend_btn.getComponent(Button).interactable = false;\r\n        }\r\n\r\n        const type_senior = tab.AdType.AdType_Gacha101;\r\n        const senior_adv_cur_count = AdMgr.ins.getAdCountByType(type_senior);\r\n        const senior_adv_max_count = AdMgr.ins.getAdCountMaxByType(type_senior);\r\n        this.lbl_adv_senior_time.string = (senior_adv_max_count - senior_adv_cur_count) + \"/\" + senior_adv_max_count\r\n        if (AdMgr.ins.getAdCountByType(type_senior) >= AdMgr.ins.getAdCountMaxByType(type_senior)) {\r\n            this.node_adv_senior_btn.getComponent(Sprite).grayscale = true;\r\n            this.node_adv_senior_btn.getComponent(Button).interactable = false;\r\n        }\r\n        // 同步一下\r\n\r\n        let totalCount = 10;\r\n        for (let i = 0; i < RoleData.ins.drop.data.length; i++) {\r\n            const data = RoleData.ins.drop.data[i];\r\n            if (data.id == \"r_17\") {\r\n                totalCount = totalCount - data.sum;\r\n                break;\r\n            }\r\n        }\r\n        this.lbl_tips.string = LangMgr.getCombineString(\"ui_recruit_2\", [totalCount]);\r\n    }\r\n    changeItemSource(event: EventTouch, type: string) {\r\n        if (this._curRecruitType === RecruitType.Senior) {\r\n            this._recruitItemSource = 100\r\n        } else if (this._curRecruitType === RecruitType.Friend) {\r\n            this._recruitItemSource = 300;\r\n        } else if (this._curRecruitType === RecruitType.Vocation) {\r\n            // 职业\r\n            if (type) {\r\n                this._recruitItemSource = Number(type);\r\n                Func.setItem(\"recruit_vacation\", type);\r\n                const vocation_toggle = this.node_toggle_vacation.getChildByName(\"Toggle\" + (this._recruitItemSource - 190) / 10).getComponent(Toggle);\r\n                vocation_toggle.isChecked = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /* 十连抽 */\r\n    private gachaTen() {\r\n        // 点击抽卡播放xuanzhuan结束后弹出抽卡展示界面\r\n        if (this._isGacha) {\r\n            return\r\n        }\r\n        this.sendGacha(this._recruitItemSource + 2);\r\n    }\r\n\r\n    /* 单抽 */\r\n    private gachaOnce() {\r\n        if (this._isGacha) {\r\n            return\r\n        }\r\n        this.sendGacha(this._recruitItemSource + 1);\r\n    }\r\n    /* 高级广告抽 */\r\n    sendSeniorAdvWatch() {\r\n        const type = tab.AdType.AdType_Gacha101;\r\n        if (AdMgr.ins.getAdCountByType(type) >= AdMgr.ins.getAdCountMaxByType(type)) {\r\n            return\r\n        }\r\n        AdMgr.ins.playVideoAd(tab.AdType.AdType_Gacha101, () => {\r\n            this.sendGacha(101, true);\r\n        }, false)\r\n    }\r\n    /* 好友广告抽 */\r\n    sendFriendAdvWatch() {\r\n        const type = tab.AdType.AdType_Gacha301;\r\n        if (AdMgr.ins.getAdCountByType(type) >= AdMgr.ins.getAdCountMaxByType(type)) {\r\n            return\r\n        }\r\n\r\n        AdMgr.ins.playVideoAd(tab.AdType.AdType_Gacha301, () => {\r\n            this.sendGacha(301, true);\r\n        }, false)\r\n    }\r\n    sendGacha(id: number, isAdv: boolean = false) {\r\n        const self = this;\r\n        const gachaTab = tab.getData().GachaTableById.getValue(id);\r\n        const count = gachaTab.ItemCount;\r\n        const itemId = gachaTab.ItemId;\r\n        const itemCount = ItemData.ins.getCount(itemId);\r\n        if (HeroDataControl.ins.getHeroBagFull(gachaTab.ItemCount)) {\r\n            ShowTips(LangMgr.getLab(\"Tips_herobag_1\"))\r\n            return\r\n        }\r\n        const sendMsg = (() => {\r\n            self._isGacha = true;\r\n            self.unClickToggle();\r\n            self[\"spine_draw_\" + self._curRecruitType].setAnimation(0, \"xuanzhuan\", false);\r\n            self[\"spine_draw_\" + self._curRecruitType].setCompleteListener((listener) => {\r\n                if (listener.animation.name === \"xuanzhuan\") {\r\n                    let msg = new proto.Msg_GachaReq();\r\n                    msg.id = id;\r\n                    msg.fromAdv = isAdv;\r\n                    Net.Send(proto.Ptl.GachaReq, msg);\r\n                }\r\n            })\r\n        })\r\n        if (!isAdv && itemCount < count) {\r\n            let canSendMsg = gachaReplace(id, this._curRecruitType, sendMsg);\r\n            if (!canSendMsg) {\r\n                return;\r\n            }\r\n        }\r\n        sendMsg();\r\n    }\r\n    /* 显示抽卡界面 */\r\n    showGachaView(_rewards: proto.IItem[], _id: number) {\r\n        UIMgr.ins.show({\r\n            viewName: ViewName.RecruitGetPop, data: {\r\n                rewards: _rewards,\r\n                id: _id,\r\n                type: this._curRecruitType,\r\n                map: this._recruitHerosMap\r\n            }\r\n        });\r\n    }\r\n    /* 显示概率公示界面 */\r\n    showGachaProbabilityView(event: EventTouch, type: string) {\r\n        if (this._curRecruitType == RecruitType.Senior) {\r\n            UIMgr.ins.show({ viewName: ViewName.RecruitProbabilityPop })\r\n        } else if (this._curRecruitType == RecruitType.Friend) {\r\n            UIMgr.ins.show({ viewName: ViewName.RecruitFriendProbabilityPop })\r\n        } else if (this._curRecruitType == RecruitType.Vocation) {\r\n            UIMgr.ins.show({ viewName: ViewName.RecruitProProbabilityPop, data: { \"heroClass\": this._recruitItemSource } })\r\n        }\r\n        // UIMgr.ins.show({\r\n        //     viewName: ViewName.RecruitProbabilityPop, data: {\r\n        //         type: this._curRecruitType,\r\n        //         recruit: this._recruitItemSource\r\n        //     }\r\n        // });\r\n    }\r\n    /* 显示保底抽界面 */\r\n    showGuaranteeView(event: EventTouch, type: string) {\r\n        UIMgr.ins.show({\r\n            viewName: ViewName.RecruitGuaranteePop\r\n        });\r\n    }\r\n    // 如果当前是新英雄\r\n    showNewHeroPop() {\r\n        UIMgr.ins.show({\r\n            viewName: ViewName.NewHeroPop, data: {\r\n                itemId: this._newHero\r\n            }\r\n        })\r\n    }\r\n    autoShowHeroAnim() {\r\n        if (this._newHero > 0) {\r\n            const heroTab = tab.getData().HeroTableById.getValue(this._newHero);\r\n            let rewards: proto.Item[] = [{\r\n                itemId: this._newHero,\r\n                num: 1,\r\n                extra: {\r\n                    heroStar: heroTab.DefaultStar\r\n                },\r\n                transaction: []\r\n            }]\r\n            UIMgr.ins.show({\r\n                viewName: ViewName.CongratulationPop, data: rewards\r\n            });\r\n            this._newHero = -1;\r\n        }\r\n    }\r\n    /* 将toggle失效 */\r\n    unClickToggle() {\r\n        for (let i = 1; i <= 3; i++) {\r\n            const node_toggle: Toggle = this.node_toggle_type.getChildByName(\"Toggle\" + i).getComponent(Toggle);\r\n            node_toggle.interactable = !this._isGacha\r\n        }\r\n    }\r\n    /* 点击前往职业兑换界面 */\r\n    onClickGoVocationShop() {\r\n        UIMgr.ins.show({\r\n            viewName: ViewName.MallMainView, data: tab.MallTab.MallTab_Tab3\r\n        });\r\n    }\r\n\r\n    onClose(): void {\r\n        super.onClose();\r\n        if (!SettingRedManager.ins.getSetting(\"GachaAds\")) {\r\n            SettingRedManager.ins.setSetting(\"GachaAds\", true);\r\n        }\r\n        if (!SettingRedManager.ins.getSetting(\"TenGacha\")) {\r\n            SettingRedManager.ins.setSetting(\"TenGacha\", true);\r\n        }\r\n        if (GuideController.ins.isGuiding()) {\r\n            EventMgr.emitLocal(LocalEvent.checkMainView);\r\n        }\r\n    }\r\n    clickLimitBtn(){\r\n        this.onClose();\r\n        UIMgr.ins.show({ viewName: ViewName.RecruitLimitView})\r\n    }\r\n}\r\n\r\n\r\n"]}