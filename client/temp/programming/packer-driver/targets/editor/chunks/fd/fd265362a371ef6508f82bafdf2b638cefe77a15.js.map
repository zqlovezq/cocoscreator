{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationOperatePop.ts"],"names":["_decorator","Component","Label","Node","AssociationControl","tab","AssociationData","RoleData","ccclass","property","AssociationOperatePop","_data","setData","data","btn_captain","active","btn_sub","btn_elite","btn_revert","btn_kick","lbl_contribution","string","String","contribution","roleMemberData","ins","getMemberData","id","subCount","getJobInMemberCount","GuildPosition","GuildPosition_VicePresident","subMaxCount","getData","GuildPositionTableByPosition","getValue","MaxCount","eliteCount","GuildPosition_Elite","eliteMaxCount","kickCount","job","KickOut","GuildPosition_President","GuildPosition_Member","kickOutMemberCount","setGuildJob","e","node","reqSetGuildMemberJob","roleId","Number","deleteGuildJob","reqKickGuildMember"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, Label, Node, NodeEventType } from 'cc';\r\nimport { proto } from 'client_protocol';\r\nimport { AssociationControl } from './AssociationControl';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { AssociationData } from './AssociationData';\r\nimport { RoleData } from '../role/RoleData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationOperatePop')\r\nexport class AssociationOperatePop extends Component {\r\n    @property(Node)\r\n    btn_captain: Node = null;\r\n    @property(Node)\r\n    btn_sub: Node = null;\r\n    @property(Node)\r\n    btn_elite: Node = null;\r\n    @property(Node)\r\n    btn_revert: Node = null;//撤销职务\r\n    @property(Node)\r\n    btn_kick: Node = null;\r\n    @property(Label)\r\n    lbl_contribution: Label = null;\r\n    private _data: proto.IGuildMember = null;\r\n    setData(data: proto.IGuildMember) {\r\n        this._data = data;\r\n        this.btn_captain.active = true;\r\n        this.btn_sub.active = false;\r\n        this.btn_elite.active = false;\r\n        this.btn_revert.active = true;\r\n        this.btn_kick.active = true;\r\n\r\n        this.lbl_contribution.string = String(data.contribution);\r\n        const roleMemberData = AssociationData.ins.getMemberData(RoleData.ins.id);\r\n\r\n\r\n        const subCount = AssociationData.ins.getJobInMemberCount(tab.GuildPosition.GuildPosition_VicePresident);\r\n        const subMaxCount = tab.getData().GuildPositionTableByPosition.getValue(tab.GuildPosition.GuildPosition_VicePresident).MaxCount;\r\n\r\n        const eliteCount = AssociationData.ins.getJobInMemberCount(tab.GuildPosition.GuildPosition_Elite);\r\n        const eliteMaxCount = tab.getData().GuildPositionTableByPosition.getValue(tab.GuildPosition.GuildPosition_Elite).MaxCount;\r\n\r\n        const kickCount = tab.getData().GuildPositionTableByPosition.getValue(roleMemberData.job).KickOut;\r\n\r\n        this.btn_captain.active = data.job > tab.GuildPosition.GuildPosition_President && roleMemberData.job === tab.GuildPosition.GuildPosition_President\r\n        this.btn_revert.active = data.job > roleMemberData.job && data.job !== tab.GuildPosition.GuildPosition_Member;\r\n        this.btn_kick.active = data.job > roleMemberData.job && kickCount > 0 && roleMemberData.kickOutMemberCount < kickCount;\r\n        this.btn_elite.active = data.job > roleMemberData.job && roleMemberData.job < tab.GuildPosition.GuildPosition_Elite && data.job !== tab.GuildPosition.GuildPosition_Elite && eliteCount < eliteMaxCount;\r\n        this.btn_sub.active = data.job > roleMemberData.job && roleMemberData.job < tab.GuildPosition.GuildPosition_VicePresident && data.job !== tab.GuildPosition.GuildPosition_VicePresident && subCount < subMaxCount;\r\n    }\r\n    /* 设置职务 */\r\n    setGuildJob(e: EventTouch, job: string) {\r\n        this.node.active = false;\r\n        AssociationControl.ins.reqSetGuildMemberJob(this._data.roleId, Number(job));\r\n    }\r\n    /* 踢出公会 */\r\n    deleteGuildJob() {\r\n        this.node.active = false;\r\n        AssociationControl.ins.reqKickGuildMember(this._data.roleId);\r\n    }\r\n}\r\n\r\n\r\n"]}