{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/recruit/RecruitLimitItem.ts"],"names":["_decorator","Component","Label","Node","ProgressBar","TaskData","CommonItem","ItemInfo","ActivityControl","ccclass","property","RecruitLimitItem","taskInfo","_taskTab","_activityId","initData","activityId","taskId","ins","getGachaUpTaskInfo","taskTable","rewards","RewardItemIds","nums","RewardItemNum","finishParam","FinishParam1","award","itemId","num","common_item","isReceived","bar_progress","progress","setSelectState","lastTaskInfo","lastMax","node_receive","active","isCanReceived","lbl_progress","string","String","clickGetAward","requestReceiveActivityGachaUpTasksRewards","gotAward"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, ProgressBar } from 'cc';\r\nimport { TaskInfo } from '../task/TaskInfo';\r\nimport { TaskData } from '../task/TaskData';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { CommonItem } from '../item/CommonItem';\r\nimport { ItemInfo } from '../item/ItemInfo';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../net/Net';\r\nimport { ActivityControl } from '../activity/ActivityControl';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('RecruitLimitItem')\r\nexport class RecruitLimitItem extends Component {\r\n    @property(ProgressBar)\r\n    bar_progress: ProgressBar = null;\r\n    @property(CommonItem)\r\n    common_item: CommonItem = null;\r\n    @property(Node)\r\n    node_receive:Node = null;\r\n    @property(Label)\r\n    lbl_progress:Label = null;\r\n\r\n    private taskInfo:TaskInfo = null;\r\n    private _taskTab: tab.TaskTable = null;\r\n    private _activityId:number = 0;\r\n    initData(activityId:number,taskId:number){\r\n        this._activityId = activityId;\r\n        this.taskInfo = TaskData.ins.getGachaUpTaskInfo(taskId);\r\n        this._taskTab = this.taskInfo.taskTable;\r\n        const rewards = this._taskTab.RewardItemIds;\r\n        const nums = this._taskTab.RewardItemNum;\r\n\r\n        let finishParam = this._taskTab.FinishParam1;\r\n        const award = new ItemInfo();\r\n        award.itemId = rewards[0];\r\n        award.num = nums[0];\r\n        this.common_item.initData(award);\r\n\r\n        if (this.taskInfo.isReceived) {\r\n            this.bar_progress.progress = 1\r\n            this.common_item.setSelectState(true);\r\n        }else{\r\n            const lastTaskInfo = TaskData.ins.getGachaUpTaskInfo(taskId-1);\r\n            if(lastTaskInfo){\r\n                const lastMax = lastTaskInfo.taskTable.FinishParam1\r\n                this.bar_progress.progress = (this.taskInfo.progress-lastMax)/(finishParam-lastMax);\r\n            }else{\r\n                this.bar_progress.progress = this.taskInfo.progress/finishParam;\r\n            }\r\n        }\r\n        this.node_receive.active = this.taskInfo.isCanReceived;\r\n        this.lbl_progress.string = String(finishParam);\r\n    }\r\n      // 点击领取任务奖励\r\n      clickGetAward() {\r\n        ActivityControl.ins.requestReceiveActivityGachaUpTasksRewards(this._activityId);\r\n    }\r\n    gotAward(){\r\n        this.node_receive.active = false;\r\n        this.common_item.setSelectState(true);\r\n    }\r\n}\r\n\r\n\r\n"]}