{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationSkillResetPop.ts"],"names":["_decorator","Label","Node","ViewPop","ItemInfo","tab","AssociationData","ItemPoolMgr","AssociationControl","proto","EventMgr","RoleData","ShowItemNotEnoughTips","ccclass","property","AssociationSkillResetPop","curClass","HeroClass","HeroClass_Assassin","onShow","openData","node_content","destroyAllChildren","lbl_diamond_cost","string","String","getData","GetKeyValue_ConfigTable","GuildAttrResetCost","materialMap","ins","getResetSkillMaterial","forEach","value","key","award","itemId","num","createItem","onDestroy","register","onMsg","Ptl","ResetGuildSkillRsp","on_s2c_ResetGuildSkillRsp","unRegister","resetGuildSkill","diamond","reqResetGuildSkill","msg","error","code","CommonErrorCode","Succeed","onClose"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAuBC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;;AAC9BC,MAAAA,O,iBAAAA,O;;AAEAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,kB,iBAAAA,kB;;AACAC,MAAAA,K,oBAAAA,K;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,qB,kBAAAA,qB;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBd,U;;0CAGjBe,wB,WADZF,OAAO,CAAC,0BAAD,C,UAEHC,QAAQ,CAACZ,IAAD,C,UAERY,QAAQ,CAACb,KAAD,C,2BAJb,MACac,wBADb;AAAA;AAAA,8BACsD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAK1CC,QAL0C,GAKhB;AAAA;AAAA,0BAAIC,SAAJ,CAAcC,kBALE;AAAA;;AAMlDC,QAAAA,MAAM,GAAS;AACX,eAAKH,QAAL,GAAgB,KAAKI,QAArB;AACA,eAAKC,YAAL,CAAkBC,kBAAlB;AACA,eAAKC,gBAAL,CAAsBC,MAAtB,GAA+BC,MAAM,CAAC;AAAA;AAAA,0BAAIC,OAAJ,GAAcC,uBAAd,GAAwCC,kBAAzC,CAArC;AACA,gBAAMC,WAAW,GAAG;AAAA;AAAA,kDAAgBC,GAAhB,CAAoBC,qBAApB,CAA0C,KAAKf,QAA/C,CAApB;AACAa,UAAAA,WAAW,CAACG,OAAZ,CAAoB,CAACC,KAAD,EAAQC,GAAR,KAAgB;AAChC,kBAAMC,KAAK,GAAG;AAAA;AAAA,uCAAd;AACAA,YAAAA,KAAK,CAACC,MAAN,GAAeF,GAAf;AACAC,YAAAA,KAAK,CAACE,GAAN,GAAYJ,KAAZ;AACA;AAAA;AAAA,4CAAYH,GAAZ,CAAgBQ,UAAhB,CAA2BH,KAA3B,EAAkC,KAAKd,YAAvC;AACH,WALD;AAMH;;AACSkB,QAAAA,SAAS,GAAS;AACxB,gBAAMA,SAAN;AACH;;AACDC,QAAAA,QAAQ,GAAS;AACb;AAAA;AAAA,oCAASC,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUC,kBAAzB,EAA6C,KAAKC,yBAAlD,EAA6E,IAA7E;AACH;;AACDC,QAAAA,UAAU,GAAS;AACf,gBAAMA,UAAN;AACH;AACD;;;AACAC,QAAAA,eAAe,GAAG;AACd,cAAI;AAAA;AAAA,oCAAShB,GAAT,CAAaiB,OAAb,GAAuB;AAAA;AAAA,0BAAIrB,OAAJ,GAAcC,uBAAd,GAAwCC,kBAAnE,EAAuF;AACnF;AAAA;AAAA,gEAAsB,CAAtB;AACA;AACH;;AACD;AAAA;AAAA,wDAAmBE,GAAnB,CAAuBkB,kBAAvB,CAA0C,KAAKhC,QAA/C;AACH;;AACD4B,QAAAA,yBAAyB,CAACK,GAAD,EAAoC;AACzD,cAAIA,GAAG,CAACC,KAAJ,IAAaD,GAAG,CAACC,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAAzD,EAAkE;AAClE,eAAKC,OAAL;AACH;;AAtCiD,O;;;;;iBAE7B,I;;;;;;;iBAEI,I","sourcesContent":["import { _decorator, Component, Label, Node } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { CommonItem } from '../item/CommonItem';\r\nimport { ItemInfo } from '../item/ItemInfo';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { AssociationData } from './AssociationData';\r\nimport { ItemPoolMgr } from '../item/ItemPoolMgr';\r\nimport { AssociationControl } from './AssociationControl';\r\nimport { proto } from 'client_protocol';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nimport { RoleData } from '../role/RoleData';\r\nimport { ShowItemNotEnoughTips } from '../../mgr/UIMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationSkillResetPop')\r\nexport class AssociationSkillResetPop extends ViewPop {\r\n    @property(Node)\r\n    node_content: Node = null;\r\n    @property(Label)\r\n    lbl_diamond_cost:Label = null;\r\n    private curClass: tab.HeroClass = tab.HeroClass.HeroClass_Assassin;\r\n    onShow(): void {\r\n        this.curClass = this.openData;\r\n        this.node_content.destroyAllChildren();\r\n        this.lbl_diamond_cost.string = String(tab.getData().GetKeyValue_ConfigTable().GuildAttrResetCost)\r\n        const materialMap = AssociationData.ins.getResetSkillMaterial(this.curClass);\r\n        materialMap.forEach((value, key) => {\r\n            const award = new ItemInfo();\r\n            award.itemId = key;\r\n            award.num = value;\r\n            ItemPoolMgr.ins.createItem(award, this.node_content)\r\n        })\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy();\r\n    }\r\n    register(): void {\r\n        EventMgr.onMsg(proto.Ptl.ResetGuildSkillRsp, this.on_s2c_ResetGuildSkillRsp, this);\r\n    }\r\n    unRegister(): void {\r\n        super.unRegister();\r\n    }\r\n    /* 重置技能 */\r\n    resetGuildSkill() {\r\n        if (RoleData.ins.diamond < tab.getData().GetKeyValue_ConfigTable().GuildAttrResetCost) {\r\n            ShowItemNotEnoughTips(1);\r\n            return;\r\n        }\r\n        AssociationControl.ins.reqResetGuildSkill(this.curClass);\r\n    }\r\n    on_s2c_ResetGuildSkillRsp(msg: proto.Msg_ResetGuildSkillRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.onClose()\r\n    }\r\n}\r\n\r\n\r\n"]}