{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/base/move/bullet/BuletMoveTrackLaser.ts"],"names":["BuletMoveTrackLaser","Vec3","FixedUtil","BuletMoveLaser","tempPos","extendTime","watingTime","shrink","state","TrackLaserState","extend","shrinkVelocity","init","abs","info","configTab","LiveTime","fly","dt","passTime","wating","set","velocity","x","y","onShrink","deltaTimeMovePostion","widthPos","updateSize","getPosition","setAbsPos"],"mappings":";;;gHAcaA,mB;;;;;;;;;;;;;;;;;;;AAdJC,MAAAA,I,OAAAA,I;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,c,iBAAAA,c;;;;;;;;;;;;;;AAQHC,MAAAA,O,GAAU,IAAIH,IAAJ,E;AAChB;AACA;AACA;;qCACaD,mB,GAAN,MAAMA,mBAAN;AAAA;AAAA,4CAAiD;AAAA;AAAA;AAAA,eAEpDK,UAFoD,GAE/B,GAF+B;AAAA,eAGpDC,UAHoD,GAG/B,CAH+B;AAAA,eAIpDC,MAJoD,GAInC,CAJmC;AAAA,eAKpDC,KALoD,GAK3BC,eAAe,CAACC,MALW;AAAA,eAQpDC,cARoD,GAQ7B,IAAIV,IAAJ,EAR6B;AAAA;;AASpDW,QAAAA,IAAI,GAAS;AACT,eAAKN,UAAL,GAAkB,KAAKO,GAAL,CAASC,IAAT,CAAcC,SAAd,CAAwBC,QAAxB,CAAiC,CAAjC,CAAlB;AACA,eAAKX,UAAL,GAAkB,KAAKQ,GAAL,CAASC,IAAT,CAAcC,SAAd,CAAwBC,QAAxB,CAAiC,CAAjC,CAAlB;AACA,eAAKT,MAAL,GAAc,KAAKM,GAAL,CAASC,IAAT,CAAcC,SAAd,CAAwBC,QAAxB,CAAiC,CAAjC,CAAd;AAEA,gBAAMJ,IAAN;AACH;;AACDK,QAAAA,GAAG,CAACC,EAAD,EAAmB;AAClB,cAAI,KAAKV,KAAL,IAAcC,eAAe,CAACC,MAAlC,EAA0C;AACtC,kBAAMO,GAAN,CAAUC,EAAV;;AACA,gBAAI,KAAKC,QAAL,IAAiB,KAAKd,UAA1B,EAAsC;AAClC,mBAAKG,KAAL,GAAaC,eAAe,CAACW,MAA7B;AACH;AACJ,WALD,MAKO,IAAI,KAAKZ,KAAL,IAAcC,eAAe,CAACW,MAAlC,EAA0C;AAC7C,gBAAI,KAAKD,QAAL,IAAkB,KAAKb,UAAL,GAAkB,KAAKD,UAA7C,EAA0D;AACtD,mBAAKG,KAAL,GAAaC,eAAe,CAACF,MAA7B;AACA,mBAAKI,cAAL,CAAoBU,GAApB,CAAwB,KAAKR,GAAL,CAASS,QAAjC;AACA,mBAAKX,cAAL,CAAoBY,CAApB,GAAwB,KAAKZ,cAAL,CAAoBY,CAApB,GAAwB,CAAC,CAAjD;AACA,mBAAKZ,cAAL,CAAoBa,CAApB,GAAwB,KAAKb,cAAL,CAAoBa,CAApB,GAAwB,CAAC,CAAjD;AACH;AACJ,WAPM,MAOA,IAAI,KAAKhB,KAAL,IAAcC,eAAe,CAACF,MAAlC,EAA0C;AAC7C,iBAAKkB,QAAL,CAAcP,EAAd;AACH;AACJ;;AAEDO,QAAAA,QAAQ,CAACP,EAAD,EAAa;AACjB;AACA;AAAA;AAAA,sCAAUQ,oBAAV,CAA+B,KAAKC,QAApC,EAA8C,KAAKA,QAAnD,EAA6D,KAAKhB,cAAlE,EAAkFO,EAAlF;AACA,eAAKU,UAAL,GAHiB,CAKjB;;AACA;AAAA;AAAA,sCAAUF,oBAAV,CAA+BtB,OAA/B,EAAwC,KAAKS,GAAL,CAASgB,WAAT,EAAxC,EAAgE,KAAKhB,GAAL,CAASS,QAAzE,EAAmFJ,EAAnF;AACA,eAAKY,SAAL,CAAe1B,OAAf;AACH;;AA1CmD,O","sourcesContent":["import { Vec3 } from \"cc\";\nimport { FixedUtil } from \"../../../util/FixedUtil\";\nimport { BuletMoveLaser } from \"./BuletMoveLaser\";\nimport { BulletMoveLine } from \"./BulletMoveLine\";\n\nconst enum TrackLaserState {\n    extend = 0,//延伸\n    wating = 1,//停留\n    shrink = 2//收缩\n}\nconst tempPos = new Vec3();\n/** 激光 延伸-停留-收缩\n * 宽度延伸，位置不变\n */\nexport class BuletMoveTrackLaser extends BuletMoveLaser {\n\n    extendTime: number = 0.1\n    watingTime: number = 0\n    shrink: number = 0\n    state: TrackLaserState = TrackLaserState.extend\n\n\n    shrinkVelocity: Vec3 = new Vec3()\n    init(): void {\n        this.watingTime = this.abs.info.configTab.LiveTime[0]\n        this.extendTime = this.abs.info.configTab.LiveTime[1]\n        this.shrink = this.abs.info.configTab.LiveTime[2]\n\n        super.init()\n    }\n    fly(dt: number): void {\n        if (this.state == TrackLaserState.extend) {\n            super.fly(dt)\n            if (this.passTime >= this.extendTime) {\n                this.state = TrackLaserState.wating\n            }\n        } else if (this.state == TrackLaserState.wating) {\n            if (this.passTime >= (this.watingTime + this.extendTime)) {\n                this.state = TrackLaserState.shrink\n                this.shrinkVelocity.set(this.abs.velocity)\n                this.shrinkVelocity.x = this.shrinkVelocity.x * -1\n                this.shrinkVelocity.y = this.shrinkVelocity.y * -1\n            }\n        } else if (this.state == TrackLaserState.shrink) {\n            this.onShrink(dt)\n        }\n    }\n\n    onShrink(dt: number) {\n        //计算新位置\n        FixedUtil.deltaTimeMovePostion(this.widthPos, this.widthPos, this.shrinkVelocity, dt)\n        this.updateSize()\n\n        //计算新位置\n        FixedUtil.deltaTimeMovePostion(tempPos, this.abs.getPosition(), this.abs.velocity, dt)\n        this.setAbsPos(tempPos);\n    }\n}"]}