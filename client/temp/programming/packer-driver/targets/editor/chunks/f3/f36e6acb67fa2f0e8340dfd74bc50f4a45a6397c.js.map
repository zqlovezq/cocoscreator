{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/power/powerTab/BulletTab.ts"],"names":["_decorator","tab","PowerBase","BoundsTab","ccclass","property","BulletTab","powerType","PowerType","PowerType_BulletTable","configTab","Id","BulletType","BulletOffset","Speed","Rating","BornAnimationId","WalkAnimationId","DeadAnimationId","Bounds","BulletBorn","EnemyUnit","SearchEnemy","EnemyFiltrate","EffectUnit","Trajectory","ForwardArrow","Fission","Penetration","Catapult","Round","Rotate","Centrifugation","ScreenBounce","CommonShow","IntervalEffect","LiveTime","DamageTick","DamageScale","AddEffect","DamageAmount","SameLow","HitChance","HitTrigger","HitEffect","HitShake","AddBuffChance","AddBuff","CollisionInterval","DeathType","DeathTrigger","OlnyOne","NoHarm","OlnyOneSon","IsReviveClean","SoundId","HitBack","boundTabs","DeathTriggerTabs","addBuffTabs","hitTriggerTab","addEffectTab","intervalEffectBulletTab","followOwner","setConfigId","id","index","length","v","push","skillPowers","createTypeAnyId","PowerType_BuffTable","isHitTriggerBullet","PowerType_EffectTable","isIntervalEffect","addPowerValue","powerKey","powerValue","idx","Math","floor","boundTab","Parameters","isSearchNone","SearchEnemy_None","getValidAnimId","isExtends","BulletBorn_Inherit","isHitTrigger","isHitTriggerSpeed","isLaunchMask","CommonShow_LaunchMask","isHitBack"],"mappings":"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","sourcesContent":["import { _decorator, Component } from \"cc\";\nimport { tab } from \"../../../../Table/table_gen\";\nimport { PowerBase } from \"./PowerBase\";\nimport { BoundsTab } from \"./BoundsTab\";\nimport { BuffTab } from \"./BuffTab\";\nimport { EffectTab } from \"./EffectTab\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('BulletTab')\nexport class BulletTab extends PowerBase {\n    powerType: tab.PowerType = tab.PowerType.PowerType_BulletTable\n    configTab: tab.BulletTable\n    //---------------------配置字段-------------------\n    Id: number // ID \n    BulletType: tab.BulletType // 子弹类型 \n    BulletOffset: number[] // 跟随子弹偏移 \n    Speed: number // 速度 \n    Rating: number // 子弹层级 \n    BornAnimationId: number // 出生动画 \n    WalkAnimationId: number // 移动动画 \n    DeadAnimationId: number // 死亡动画 \n    Bounds: number[] // 包围盒组 \n    BulletBorn: tab.BulletBorn // 子弹出生点 \n    EnemyUnit: tab.EffectUnit // 索敌单位 \n    SearchEnemy: tab.SearchEnemy // 索敌规则 \n    EnemyFiltrate: tab.EnemyFiltrate // 索敌筛选 \n    EffectUnit: tab.EffectUnit // 作用单位 \n    Trajectory: tab.Trajectory // 子弹轨迹 \n    ForwardArrow: number[] // 正向箭 \n    Fission: number[] // 分裂 \n    Penetration: number // 穿透 \n    Catapult: number // 弹射 \n    Round: number[] // 回旋 \n    Rotate: number // 自旋 \n    Centrifugation: number[] // 离心 \n    ScreenBounce: number // 屏幕反弹 \n    CommonShow: tab.CommonShow // 通用表现 \n    IntervalEffect: number[] // 间隔时间效果 \n    LiveTime: number[] // 生存时间 \n    DamageTick: number // 伤害间隔 \n    DamageScale: number[] // 子弹伤害系数 \n    AddEffect: number[] // 子弹额外效果 \n    DamageAmount: number // 子弹多段伤害 \n    SameLow: number // 相同子弹衰减 \n    HitChance: number // 命中触发概率 \n    HitTrigger: number[] // 命中触发效果 \n    HitEffect: number[] // 命中特效 \n    HitShake: number // 命中抖动 \n    AddBuffChance: number[] // buff触发概率 \n    AddBuff: number[] // 加buff \n    CollisionInterval: number // 触碰间隔 \n    DeathType: tab.DeathType // 死亡方式 \n    DeathTrigger: number[] // 死亡触发子弹 \n    OlnyOne: boolean // 相同子弹唯一 \n    NoHarm: boolean // 子系忽视父系 \n    OlnyOneSon: boolean // 子系伤害唯一 \n    IsReviveClean: boolean // 复活清除 \n    SoundId: number[] // 子弹音效 \n    HitBack : number[] // 命中击退 \n\n    //---------------------自有字段-------------------\n    boundTabs: BoundsTab[] = []\n    DeathTriggerTabs: BulletTab[] = []\n    addBuffTabs: BuffTab[] = []\n    hitTriggerTab: BulletTab = null\n    addEffectTab: EffectTab[] = []\n    intervalEffectBulletTab: BulletTab = null\n    //跟随预留\n    followOwner: number[] = []\n\n    setConfigId(id: number) {\n        super.setConfigId(id)\n        // this.Bounds[0] = 4\n        //包围盒配置\n        for (let index = 0; index < this.Bounds.length; index++) {\n            const v = this.Bounds[index];\n            this.boundTabs.push(new BoundsTab(v))\n        }\n\n        //死亡触发子弹配置\n        for (let index = 0; index < this.DeathTrigger.length; index++) {\n            this.DeathTriggerTabs.push(this.skillPowers.createTypeAnyId(tab.PowerType.PowerType_BulletTable, this.DeathTrigger[index]) as BulletTab)\n        }\n\n        //buff配置\n        for (let index = 0; index < this.AddBuff.length; index++) {\n            this.addBuffTabs.push(this.skillPowers.createTypeAnyId(tab.PowerType.PowerType_BuffTable, this.AddBuff[index]) as BuffTab)\n        }\n        //命中触发子弹配置\n        if (this.isHitTriggerBullet()) {\n            this.hitTriggerTab = this.skillPowers.createTypeAnyId(tab.PowerType.PowerType_BulletTable, this.HitTrigger[1]) as BulletTab\n        }\n        //效果配置\n        for (let index = 0; index < this.AddEffect.length; index++) {\n            this.addEffectTab.push(this.skillPowers.createTypeAnyId(tab.PowerType.PowerType_EffectTable, this.AddEffect[index]) as EffectTab)\n        }\n        /*时间间隔产生子弹 */\n        if (this.isIntervalEffect()) {\n            this.intervalEffectBulletTab = this.skillPowers.createTypeAnyId(tab.PowerType.PowerType_BulletTable, this.IntervalEffect[1]) as BulletTab\n        }\n    }\n\n    addPowerValue(powerKey: string, powerValue: number, index: number) {\n        if (powerKey == \"Bounds\") {\n            let idx = Math.floor((index) / 4)\n            let boundTab = this.boundTabs[idx]\n            if (boundTab == null) {\n                return\n            }\n            if (boundTab.Parameters[index] == null) {\n                boundTab.Parameters[index] = 0\n            }\n            boundTab.Parameters[index] += powerValue\n        } else {\n            super.addPowerValue(powerKey, powerValue, index)\n        }\n    }\n\n    isSearchNone() {\n        return this.SearchEnemy == tab.SearchEnemy.SearchEnemy_None\n    }\n\n    /** 获取有效的动画，确定显示层级 */\n    getValidAnimId() {\n        return this.BornAnimationId || this.WalkAnimationId || this.DeadAnimationId\n    }\n\n    isExtends() {\n        return this.BulletBorn == tab.BulletBorn.BulletBorn_Inherit\n    }\n\n    isHitTrigger() {\n        return this.HitTrigger.length > 0\n    }\n\n    /** 命中触发子弹 */\n    isHitTriggerBullet() {\n        return this.HitTrigger[0] == 1\n    }\n\n    /** 命中触发更改速度 */\n    isHitTriggerSpeed() {\n        return this.HitTrigger[0] == 2\n    }\n\n    /** 是否间隔效果 */\n    isIntervalEffect() {\n        return this.IntervalEffect.length > 0\n    }\n\n    /** 是否发射遮罩 */\n    isLaunchMask() {\n        return this.CommonShow == tab.CommonShow.CommonShow_LaunchMask\n    }\n\n    isHitBack(){\n        return this.HitBack.length > 0\n    }\n}"]}