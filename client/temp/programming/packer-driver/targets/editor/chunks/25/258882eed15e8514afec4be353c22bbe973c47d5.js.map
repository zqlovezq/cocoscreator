{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/view/common/FightBarItem.ts"],"names":["_decorator","Component","Node","ProgressBar","FightMacro","ccclass","property","FightBarItem","_isActive","attrData","isActive","bo","node","active","changeSkillCd","changeHp","setAttrData","data","hpBar1","progress","hpBar","hpPercent","PERCENT","shieldBar","shield","maxShield","checkHpShow","hpBg","hpRedOrGreen","pro","Math","min","skillCdBar"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAA2BC,MAAAA,S,OAAAA,S;AAAkBC,MAAAA,I,OAAAA,I;AAAcC,MAAAA,W,OAAAA,W;;AAS3DC,MAAAA,U,iBAAAA,U;;;;;;;;;OAGH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;AAC9B;;8BAEaO,Y,WADZF,OAAO,CAAC,cAAD,C,UAEHC,QAAQ,CAACJ,IAAD,C,UAERI,QAAQ,CAACH,WAAD,C,UAERG,QAAQ,CAACH,WAAD,C,UAERG,QAAQ,CAACH,WAAD,C,UAERG,QAAQ,CAACH,WAAD,C,2BAVb,MACaI,YADb,SACkCN,SADlC,CAC4C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAYxCO,SAZwC,GAYnB,KAZmB;AAAA,eAcxCC,QAdwC;AAAA;;AAe5B,YAARC,QAAQ,GAAG;AACX,iBAAO,KAAKF,SAAZ;AACH;;AACW,YAARE,QAAQ,CAACC,EAAD,EAAK;AACb,eAAKH,SAAL,GAAiBG,EAAjB;AACA,eAAKC,IAAL,CAAUC,MAAV,GAAmBF,EAAnB;AACA,eAAKG,aAAL,CAAmB,CAAnB;AACA,eAAKC,QAAL;AACH;;AAEDC,QAAAA,WAAW,CAACC,IAAD,EAAsB;AAC7B,eAAKR,QAAL,GAAgBQ,IAAhB;AACH;;AAEDF,QAAAA,QAAQ,GAAG;AACP,eAAKG,MAAL,CAAYC,QAAZ,GAAuB,KAAKC,KAAL,CAAWD,QAAX,GAAuB,KAAKV,QAAL,CAAcY,SAAd,GAA0B;AAAA;AAAA,wCAAWC,OAAnF;AACA,eAAKC,SAAL,CAAeJ,QAAf,GAA0B,KAAKV,QAAL,CAAce,MAAd,GAAuB,KAAKf,QAAL,CAAcgB,SAA/D;AACA,eAAKC,WAAL;AACH;;AAEDA,QAAAA,WAAW,GAAG;AACV,eAAKC,IAAL,CAAUd,MAAV,GAAmB,KAAKU,SAAL,CAAeX,IAAf,CAAoBC,MAApB,GAA6B,KAAKO,KAAL,CAAWR,IAAX,CAAgBC,MAAhB,GAAyB,KAAKK,MAAL,CAAYN,IAAZ,CAAiBC,MAAjB,GAA0B,KAAnG;;AACA,cAAI,KAAKJ,QAAL,CAAce,MAAd,GAAuB,CAA3B,EAA8B;AAC1B,iBAAKG,IAAL,CAAUd,MAAV,GAAmB,KAAKU,SAAL,CAAeX,IAAf,CAAoBC,MAApB,GAA6B,IAAhD;AACA,iBAAKe,YAAL;AACH,WAHD,MAGO;AACH,gBAAI,KAAKnB,QAAL,CAAcY,SAAd,GAA0B;AAAA;AAAA,0CAAWC,OAAzC,EAAkD;AAC9C,mBAAKK,IAAL,CAAUd,MAAV,GAAmB,IAAnB;AACA,mBAAKe,YAAL;AACH;AACJ;AACJ;;AACDA,QAAAA,YAAY,GAAG;AACX,eAAKR,KAAL,CAAWR,IAAX,CAAgBC,MAAhB,GAAyB,KAAKJ,QAAL,CAAcY,SAAd,IAA2B,IAApD;AACA,eAAKH,MAAL,CAAYN,IAAZ,CAAiBC,MAAjB,GAA0B,CAAC,KAAKO,KAAL,CAAWR,IAAX,CAAgBC,MAA3C;AACH;;AAEDC,QAAAA,aAAa,CAACe,GAAD,EAAc;AACvBA,UAAAA,GAAG,GAAGC,IAAI,CAACC,GAAL,CAASF,GAAT,EAAc,CAAd,CAAN;AACA,eAAKG,UAAL,CAAgBb,QAAhB,GAA2BU,GAA3B;AACA,eAAKG,UAAL,CAAgBpB,IAAhB,CAAqBC,MAArB,GAA8BgB,GAAG,IAAI,CAArC;AACH;;AAxDuC,O;;;;;iBAE3B,I;;;;;;;iBAEQ,I;;;;;;;iBAEC,I;;;;;;;iBAEG,I;;;;;;;iBAEC,I","sourcesContent":["import { _decorator, Button, Color, Component, Label, Node, Prefab, ProgressBar, Sprite } from \"cc\";\nimport { tab } from \"../../../../Table/table_gen\";\nimport { HeroFightInfo } from \"../../data/HeroFightInfo\";\nimport { EventMgr } from \"../../../mgr/EventMgr\";\nimport { FightEvent } from \"../../define/FightEvent\";\nimport { UIMgr } from \"../../../mgr/UIMgr\";\nimport { ViewName } from \"../../../define/ViewDefine\";\nimport { HeroInfo } from \"../../../model/hero/HeroInfo\";\nimport { FightAttrData } from \"../../data/FightAttrData\";\nimport { FightMacro } from \"../../define/FightDefine\";\nimport { roots } from \"protobufjs\";\n\nconst { ccclass, property } = _decorator;\n/** 战斗角色进度条， 血条、护盾、技能cd */\n@ccclass('FightBarItem')\nexport class FightBarItem extends Component {\n    @property(Node)\n    hpBg: Node = null\n    @property(ProgressBar)\n    hpBar: ProgressBar = null\n    @property(ProgressBar)\n    hpBar1: ProgressBar = null\n    @property(ProgressBar)\n    shieldBar: ProgressBar = null\n    @property(ProgressBar)\n    skillCdBar: ProgressBar = null\n\n    _isActive: boolean = false\n\n    attrData: FightAttrData\n    get isActive() {\n        return this._isActive\n    }\n    set isActive(bo) {\n        this._isActive = bo\n        this.node.active = bo\n        this.changeSkillCd(1)\n        this.changeHp()\n    }\n    \n    setAttrData(data: FightAttrData) {\n        this.attrData = data\n    }\n\n    changeHp() {\n        this.hpBar1.progress = this.hpBar.progress = (this.attrData.hpPercent / FightMacro.PERCENT)\n        this.shieldBar.progress = this.attrData.shield / this.attrData.maxShield\n        this.checkHpShow()\n    }\n\n    checkHpShow() {\n        this.hpBg.active = this.shieldBar.node.active = this.hpBar.node.active = this.hpBar1.node.active = false\n        if (this.attrData.shield > 0) {\n            this.hpBg.active = this.shieldBar.node.active = true\n            this.hpRedOrGreen()\n        } else {\n            if (this.attrData.hpPercent < FightMacro.PERCENT) {\n                this.hpBg.active = true\n                this.hpRedOrGreen()\n            }\n        }\n    }\n    hpRedOrGreen() {\n        this.hpBar.node.active = this.attrData.hpPercent >= 5000\n        this.hpBar1.node.active = !this.hpBar.node.active\n    }\n\n    changeSkillCd(pro: number) {\n        pro = Math.min(pro, 1)\n        this.skillCdBar.progress = pro\n        this.skillCdBar.node.active = pro != 1\n    }\n}"]}