{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/jade/JadeSelectItem.ts"],"names":["_decorator","Component","instantiate","Label","Node","Prefab","LangMgr","ItemPoolMgr","tab","JadeSelectattrItem","EquipData","EquipControl","UIMgr","ViewName","HeroTeamControl","RoleData","ccclass","property","JadeSelectItem","equipInfo","heroClass","start","initData","jadeNode","active","notNode","initView","nameLab","string","getLab","itemTable","Name","item","ins","createItem","itemParent","scoreLab","score","belongNode","isWear","initAttrItem","initSkilItem","unequipNode","exchangeNode","equipNode","info","getHeroByClass","heroNameLab","heroItem","createHeroItem","heroNode","attrs","baseAttr","key","table","getData","EquipAttrTableById","getValue","selectAttrItemPrefab","parent","attrNode","getComponent","initAttr","skills","skillList","skillNode","initSkill","onClickEquip","isJadeGuide","Boolean","clientData","jadeGuildOver","setClientData","con","getEquipContainerDataByHeroClass","slotData","equipTable","Type","equipId","id","reqUndressEquip","reqChangEquips","hideView","JadeSelectPop","onClickExchange","reqSwitchEquip","onClickUnEquip"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Label, Node, Prefab, Sprite } from 'cc';\r\nimport { EquipInfo } from '../equip/EquipInfo';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { ItemPoolMgr } from '../item/ItemPoolMgr';\r\nimport { CommonItem } from '../item/CommonItem';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { JadeSelectattrItem } from './JadeSelectattrItem';\r\nimport { EquipData } from '../equip/EquipData';\r\nimport { EquipControl } from '../equip/EquipControl';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { HeroData } from '../hero/HeroData';\r\nimport { HeroTeamControl } from '../hero/HeroTeamControl';\r\nimport { RoleData } from '../role/RoleData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('JadeSelectItem')\r\nexport class JadeSelectItem extends Component {\r\n    @property(Node)\r\n    itemParent: Node = null;\r\n    @property(Label)\r\n    nameLab: Label = null;\r\n    @property(Label)\r\n    scoreLab: Label = null;\r\n    @property(Node)\r\n    attrNode: Node = null;\r\n    @property(Node)\r\n    skillNode: Node = null;\r\n    @property(Node)\r\n    equipNode: Node = null;\r\n    @property(Node)\r\n    exchangeNode: Node = null;\r\n    @property(Node)\r\n    unequipNode: Node = null;\r\n    @property(Prefab)\r\n    selectAttrItemPrefab: Prefab = null;\r\n\r\n    @property(Node)\r\n    belongNode: Node = null;\r\n    @property(Node)\r\n    heroNode: Node = null;\r\n    @property(Label)\r\n    heroNameLab: Label = null;\r\n    @property(Node)\r\n    notNode: Node = null;\r\n    @property(Node)\r\n    jadeNode: Node = null;\r\n\r\n\r\n    private equipInfo: EquipInfo;\r\n    private heroClass: number;\r\n    start() {\r\n\r\n\r\n    }\r\n    initData(equipInfo: EquipInfo, heroClass: number) {\r\n        this.equipInfo = equipInfo;\r\n        if (this.equipInfo) {\r\n            this.jadeNode.active = true;\r\n            this.notNode.active = false;\r\n            this.heroClass = heroClass;\r\n            this.initView();\r\n        } else {\r\n            this.jadeNode.active = false;\r\n            this.notNode.active = true;\r\n        }\r\n\r\n\r\n    }\r\n    initView() {\r\n        this.nameLab.string = LangMgr.getLab(this.equipInfo.itemTable.Name);\r\n        let item = ItemPoolMgr.ins.createItem(this.equipInfo, this.itemParent,false);\r\n        // item.getComponent(CommonItem).setIsTouchItem(false);\r\n        this.scoreLab.string = this.equipInfo.score + \"\";\r\n        this.belongNode.active = this.equipInfo.isWear;\r\n        this.initAttrItem();\r\n        this.initSkilItem();\r\n        if (this.equipInfo.heroClass == this.heroClass) {\r\n            this.unequipNode.active = true;\r\n            this.exchangeNode.active = false;\r\n            this.equipNode.active = false;\r\n        } else {\r\n            this.exchangeNode.active = this.equipInfo.isWear;\r\n            this.equipNode.active = !this.equipInfo.isWear;\r\n        }\r\n        if (this.equipInfo.isWear) {\r\n            let info = HeroTeamControl.ins.getHeroByClass(this.equipInfo.heroClass);\r\n            //this.heroNameLab.string =LangMgr.getLab(info.itemTable.Name)+\"穿戴中\";\r\n            this.heroNameLab.string = LangMgr.getLab(info.itemTable.Name) + LangMgr.getLab(\"ui_jade_10\");\r\n            let heroItem=ItemPoolMgr.ins.createHeroItem(info,this.heroNode);\r\n            // heroItem.parent=this.heroNode;\r\n            \r\n            // this.heroIcon.setTexture(info.itemTable.Icon);\r\n        }\r\n\r\n\r\n    }\r\n    initAttrItem() {\r\n        let attrs = this.equipInfo.baseAttr;\r\n        for (let key in attrs) {\r\n            let table = tab.getData().EquipAttrTableById.getValue(attrs[key]);\r\n            let item = instantiate(this.selectAttrItemPrefab);\r\n            item.parent = this.attrNode;\r\n            item.getComponent(JadeSelectattrItem).initAttr(table);\r\n\r\n            // item.getChildByName(\"name_txt\").getComponent(Label).string=LangMgr.getLab(tab.AttrType[table.AttrType]);\r\n            // item.getChildByName(\"now_txt\").getComponent(Label).string=table.Base+\"\";\r\n        }\r\n    }\r\n\r\n    initSkilItem() {\r\n        let skills = this.equipInfo.skillList;\r\n        for (let key in skills) {\r\n            let item = instantiate(this.selectAttrItemPrefab);\r\n            item.parent = this.skillNode;\r\n            item.getComponent(JadeSelectattrItem).initSkill(skills[key]);\r\n\r\n            // item.getChildByName(\"name_txt\").getComponent(Label).string=LangMgr.getLab(tab.AttrType[table.AttrType]);\r\n            // item.getChildByName(\"now_txt\").getComponent(Label).string=table.Base+\"\";\r\n        }\r\n    }\r\n\r\n    onClickEquip() {\r\n\r\n        const isJadeGuide = Boolean(RoleData.ins.clientData.jadeGuildOver);\r\n        if(!isJadeGuide){\r\n            RoleData.ins.setClientData(\"jadeGuildOver\",\"true\");\r\n        }\r\n\r\n        let con = EquipData.ins.getEquipContainerDataByHeroClass(this.heroClass);\r\n        if (con.slotData&&con.slotData[this.equipInfo.equipTable.Type]&&con.slotData[this.equipInfo.equipTable.Type].equipId>0) {\r\n             let id = con.slotData[this.equipInfo.equipTable.Type].equipId;\r\n            // // EquipControl.ins.reqUndressEquip(id, this.equipInfo.heroClass)\r\n            // EquipControl.ins.reqSwitchEquip(id, this.equipInfo.id, this.heroClass, this.equipInfo.heroClass)\r\n            EquipControl.ins.reqUndressEquip(id,this.heroClass)\r\n        }\r\n        EquipControl.ins.reqChangEquips(this.heroClass, [this.equipInfo.id]);\r\n        \r\n      \r\n        UIMgr.ins.hideView(ViewName.JadeSelectPop)\r\n    }\r\n    onClickExchange() {\r\n        let con = EquipData.ins.getEquipContainerDataByHeroClass(this.heroClass);\r\n        if (con.slotData&&con.slotData[this.equipInfo.equipTable.Type]) {\r\n            let id = con.slotData[this.equipInfo.equipTable.Type].equipId;\r\n            EquipControl.ins.reqSwitchEquip(id, this.equipInfo.id, this.heroClass, this.equipInfo.heroClass)\r\n            \r\n        }else{\r\n            EquipControl.ins.reqSwitchEquip(0, this.equipInfo.id, this.heroClass, this.equipInfo.heroClass)\r\n        }\r\n        // EquipControl.ins.reqSwitchEquip(this)\r\n        // EquipControl.ins.reqChangEquips(this.heroClass,[this.equipInfo.id]);\r\n        UIMgr.ins.hideView(ViewName.JadeSelectPop)\r\n    }\r\n    onClickUnEquip() {\r\n        EquipControl.ins.reqUndressEquip(this.equipInfo.id, this.equipInfo.heroClass)\r\n        UIMgr.ins.hideView(ViewName.JadeSelectPop)\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}