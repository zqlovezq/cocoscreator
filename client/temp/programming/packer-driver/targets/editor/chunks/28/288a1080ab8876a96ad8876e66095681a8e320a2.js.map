{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/friends/FriendPop.ts"],"names":["_decorator","EditBox","instantiate","Label","Node","Prefab","ViewPop","EventMgr","proto","FriendControl","FriendData","FriendListItem","InfiniteList","SimpleRoleInfo","ShowTips","tab","ItemData","LangMgr","ccclass","property","FriendPop","currType","FriendListType","FriendList","friendItemInfos","lastRefreshTimer","searchRoleInfo","register","onMsg","Ptl","GetFriendSimpleRoleRsp","on_s2c_GetFriendSimpleRoleRsp","AddFriendPush","on_s2c_AddFriendPush","RemoveFriendPush","on_s2c_RemoveFriendPush","RecommendFriendRsp","on_s2c_RecommendFriendRsp","FindFriendRsp","on_s2c_FindFriendRsp","AddBlacklistRsp","on_s2c_Msg_AddBlacklistRsp","RemoveBlacklistRsp","on_s2c_RemoveBlacklistRsp","AddFriendRsp","on_s2c_AddFriendRsp","ConfirmFriendRsp","on_s2c_ConfirmFriendRsp","RemoveFriendRsp","on_s2c_RemoveFriendRsp","RemoveFriendApplyRsp","on_s2c_RemoveFriendApplyRsp","RecvGiftRsp","on_s2c_RecvGiftRsp","GivingGiftRsp","on_s2c_GivingGiftRsp","GiftPush","on_s2c_GiftPush","onShow","initListScroll","initView","ins","isInitMyFirend","initMyFriendView","requestGetFriendSimpleRole","ApplyList","isInitApply","initApplyView","BlackList","isInitBlack","initBlackView","isInitRecommend","initRecommendView","requestRecommendFriend","updateNodeShowState","getMyFreindInfos","sort","a","b","offlineTime","length","listScroll","node","active","Reload","updateFriendNum","updateFriendValue","updateFriendGiftBtn","setContentPos","getApplyInfos","getRecommendInfos","getBlackInfos","blackScroll","blackNumLab","string","blackTotalNumLab","getData","GetKeyValue_ConfigTable","BlackListMaxCount","Init","getCellNumber","getCellCount","bind","getCellSize","getCellHigth","getCellIdentifer","getCellView","getCellData","GetCellData","blackNode","friendNumNode","myfriendNode","applicationNode","addfriendNode","currNum","getMyFriendNum","max","FriendMaxCount","friendNumLab","friendTotalNumLab","onClickToggle","event","type","Number","num","getCount","CurrencyType","CurrencyType_Friendship","friendValueLab","getValueLab","getReceiveGiftNum","getValueTotalLab","GiftRecvMaxCount","onClickGetValue","infos","ids","key","receiveGiftState","push","id","requestRecvGift","getLab","onClickSendValue","isGiveGift","requestGivingGift","onClickAllRefuse","requestRemoveFriendApply","onClickAllAgree","requestConfirmFriend","onClickRefresh","tiemr","Date","getTime","t","Math","floor","getCombineString","onClickSearch","searchEdit","requestFindFriend","msg","error","code","CommonErrorCode","Succeed","role","info","merge","friendItemPrefab","getComponent","idx","message"],"mappings":"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","sourcesContent":["import { _decorator, Component, EditBox, instantiate, Label, Node, PointToPointConstraint, Prefab, ScrollView } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { FriendControl } from './FriendControl';\r\nimport { FriendData } from './FriendData';\r\nimport { FriendListItem } from './FriendListItem';\r\nimport InfiniteList from '../../../Common/InfiniteList/InfiniteList';\r\nimport { SimpleRoleInfo } from './SimpleRoleInfo';\r\nimport { TimeUtil } from '../../utils/TimeUtil';\r\nimport { ShowTips } from '../../mgr/UIMgr';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { ItemControl } from '../item/ItemControl';\r\nimport { ItemData } from '../item/ItemData';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * FriendPop\r\n * zhudingchao\r\n * Fri Jun 07 2024 11:09:31 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/friends/FriendPop.ts\r\n *\r\n */\r\n\r\n@ccclass('FriendPop')\r\nexport class FriendPop extends ViewPop {\r\n    @property(InfiniteList)\r\n    listScroll: InfiniteList = null;\r\n    @property(Node)\r\n    friendNode: Node = null;\r\n    @property(Node)\r\n    blackNode: Node = null;\r\n    @property(InfiniteList)\r\n    blackScroll: InfiniteList = null;\r\n    @property(Node)\r\n    friendNumNode: Node = null;\r\n    @property(Label)\r\n    friendNumLab: Label = null;\r\n    @property(Label)\r\n    friendTotalNumLab: Label = null;\r\n    @property(Label)\r\n    friendValueLab: Label = null;\r\n    @property(Label)\r\n    getValueLab: Label = null;\r\n    @property(Label)\r\n    getValueTotalLab: Label = null;\r\n    @property(Label)\r\n    sendValueLab: Label = null;\r\n    @property(Label)\r\n    sendValueTotalLab: Label = null;\r\n    @property(Label)\r\n    blackNumLab: Label = null;\r\n    @property(Label)\r\n    blackTotalNumLab: Label = null;\r\n    @property(Prefab)\r\n    friendItemPrefab: Prefab = null;\r\n\r\n    @property(Node)\r\n    myfriendNode: Node = null;\r\n    @property(Node)\r\n    applicationNode: Node = null;\r\n    @property(Node)\r\n    addfriendNode: Node = null;\r\n\r\n    @property(EditBox)\r\n    searchEdit: EditBox = null;\r\n\r\n\r\n\r\n\r\n    private currType: number = proto.FriendListType.FriendList;\r\n    private friendItemInfos: Array<SimpleRoleInfo>;\r\n    private lastRefreshTimer: number = 0;\r\n    private searchRoleInfo: SimpleRoleInfo = null;\r\n    register(): void {\r\n        EventMgr.onMsg(proto.Ptl.GetFriendSimpleRoleRsp, this.on_s2c_GetFriendSimpleRoleRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.AddFriendPush, this.on_s2c_AddFriendPush, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveFriendPush, this.on_s2c_RemoveFriendPush, this);\r\n        EventMgr.onMsg(proto.Ptl.RecommendFriendRsp, this.on_s2c_RecommendFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.FindFriendRsp, this.on_s2c_FindFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.AddBlacklistRsp, this.on_s2c_Msg_AddBlacklistRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveBlacklistRsp, this.on_s2c_RemoveBlacklistRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.AddFriendRsp, this.on_s2c_AddFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.ConfirmFriendRsp, this.on_s2c_ConfirmFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveFriendRsp, this.on_s2c_RemoveFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveFriendApplyRsp, this.on_s2c_RemoveFriendApplyRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RecvGiftRsp, this.on_s2c_RecvGiftRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.GivingGiftRsp, this.on_s2c_GivingGiftRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.GiftPush, this.on_s2c_GiftPush, this);\r\n\r\n    }\r\n    onShow(): void {\r\n        this.friendItemInfos = [];\r\n        this.initListScroll();\r\n        this.initView();\r\n\r\n    }\r\n\r\n    initView() {\r\n        if (this.currType == proto.FriendListType.FriendList) {\r\n            if (FriendData.ins.isInitMyFirend) {\r\n                this.initMyFriendView();\r\n            } else {\r\n                FriendControl.ins.requestGetFriendSimpleRole(proto.FriendListType.FriendList);\r\n            }\r\n        } else if (this.currType == proto.FriendListType.ApplyList) {\r\n            if (FriendData.ins.isInitApply) {\r\n                this.initApplyView();\r\n            } else {\r\n                FriendControl.ins.requestGetFriendSimpleRole(proto.FriendListType.ApplyList);\r\n            }\r\n        } else if (this.currType == proto.FriendListType.BlackList) {\r\n            if (FriendData.ins.isInitBlack) {\r\n                this.initBlackView();\r\n            } else {\r\n                FriendControl.ins.requestGetFriendSimpleRole(proto.FriendListType.BlackList);\r\n            }\r\n        } else if (this.currType == 3) {\r\n            if (FriendData.ins.isInitRecommend) {\r\n                this.initRecommendView();\r\n            } else {\r\n                FriendControl.ins.requestRecommendFriend();\r\n            }\r\n        }\r\n    }\r\n    initMyFriendView() {\r\n        this.updateNodeShowState();\r\n        this.friendItemInfos = FriendData.ins.getMyFreindInfos();\r\n        // if(this.listScroll.isAutoScrolling()){\r\n        //     this.listScroll.stopAutoScroll()\r\n        // }、\r\n        this.friendItemInfos.sort((a,b)=>{\r\n            if(a.offlineTime<=0&&b.offlineTime<=0){\r\n                return 0;\r\n            }else{\r\n                if(a.offlineTime<=0){\r\n                    return -1;\r\n                }\r\n                if(b.offlineTime<=0){\r\n                    return 1;\r\n                }\r\n                return b.offlineTime-a.offlineTime;\r\n            }\r\n           \r\n        })\r\n        if (this.friendItemInfos.length > 0) {\r\n            this.listScroll.node.active = true;\r\n            this.listScroll.Reload(true, true);\r\n        } else {\r\n            this.listScroll.node.active = false;\r\n        }\r\n\r\n        this.updateFriendNum();\r\n        this.updateFriendValue();\r\n        this.updateFriendGiftBtn();\r\n        this.listScroll.setContentPos(0,0,0);\r\n    }\r\n    initApplyView() {\r\n        this.updateNodeShowState();\r\n        this.friendItemInfos = FriendData.ins.getApplyInfos();\r\n        if (this.friendItemInfos.length > 0) {\r\n            this.listScroll.node.active = true;\r\n            this.listScroll.Reload(true, true);\r\n        } else {\r\n            this.listScroll.node.active = false;\r\n        }\r\n\r\n        this.updateFriendNum();\r\n        this.listScroll.setContentPos(0,0,0);\r\n    }\r\n    initRecommendView() {\r\n        // if(this.listScroll.isAutoScrolling()){\r\n        //     this.listScroll.stopAutoScroll()\r\n        // }\r\n        this.updateNodeShowState();\r\n        if (this.searchRoleInfo) {\r\n            this.friendItemInfos = [this.searchRoleInfo];\r\n        } else {\r\n            this.friendItemInfos = FriendData.ins.getRecommendInfos();\r\n        }\r\n        if (this.friendItemInfos.length > 0) {\r\n            this.listScroll.node.active = true;\r\n            this.listScroll.Reload(true, true);\r\n        } else {\r\n            this.listScroll.node.active = false;\r\n        }\r\n\r\n        // this.listScroll.scrollToTop();\r\n        this.listScroll.setContentPos(0,0,0);\r\n    }\r\n    initBlackView() {\r\n        this.updateNodeShowState();\r\n        this.friendItemInfos = FriendData.ins.getBlackInfos();\r\n        if (this.friendItemInfos.length > 0) {\r\n            this.blackScroll.node.active = true;\r\n            this.blackScroll.Reload(true, true);\r\n        } else {\r\n            this.blackScroll.node.active = false;\r\n        }\r\n        this.blackNumLab.string = this.friendItemInfos.length + \"\";\r\n        this.blackTotalNumLab.string = tab.getData().GetKeyValue_ConfigTable().BlackListMaxCount + \"\"\r\n        this.blackScroll.setContentPos(0,0,0);\r\n\r\n    }\r\n    initListScroll() {\r\n        this.listScroll.Init({\r\n            getCellNumber: this.getCellCount.bind(this),\r\n            getCellSize: this.getCellHigth.bind(this),\r\n            getCellIdentifer: this.getCellIdentifer.bind(this),\r\n            getCellView: this.getCellView.bind(this),\r\n            getCellData: this.GetCellData.bind(this),\r\n        });\r\n        this.blackScroll.Init({\r\n            getCellNumber: this.getCellCount.bind(this),\r\n            getCellSize: this.getCellHigth.bind(this),\r\n            getCellIdentifer: this.getCellIdentifer.bind(this),\r\n            getCellView: this.getCellView.bind(this),\r\n            getCellData: this.GetCellData.bind(this),\r\n        });\r\n\r\n\r\n    }\r\n    updateNodeShowState() {\r\n        this.blackNode.active = this.currType == proto.FriendListType.BlackList;\r\n        this.listScroll.node.active = this.currType != proto.FriendListType.BlackList;\r\n        this.friendNumNode.active = this.currType == proto.FriendListType.FriendList || this.currType == proto.FriendListType.ApplyList;\r\n        this.myfriendNode.active = this.currType == proto.FriendListType.FriendList;\r\n        this.applicationNode.active = this.currType == proto.FriendListType.ApplyList;\r\n        this.addfriendNode.active = this.currType == 3;\r\n    }\r\n    updateFriendNum() {\r\n        let currNum = FriendData.ins.getMyFriendNum();\r\n        let max = tab.getData().GetKeyValue_ConfigTable().FriendMaxCount;\r\n        this.friendNumLab.string = currNum + \"\";\r\n        this.friendTotalNumLab.string = max + \"\";\r\n    }\r\n\r\n\r\n    onClickToggle(event, type) {\r\n        type = Number(type);\r\n        if (this.currType != type) {\r\n            this.currType = type;\r\n            this.initView();\r\n        }\r\n    }\r\n    updateFriendValue() {\r\n        let num = ItemData.ins.getCount(tab.CurrencyType.CurrencyType_Friendship);\r\n        this.friendValueLab.string = num + \"\";\r\n    }\r\n    updateFriendGiftBtn() {\r\n        this.getValueLab.string = FriendData.ins.getReceiveGiftNum() + \"\";\r\n        this.getValueTotalLab.string = tab.getData().GetKeyValue_ConfigTable().GiftRecvMaxCount + \"\"\r\n\r\n    }\r\n    onClickGetValue() {\r\n        let max = tab.getData().GetKeyValue_ConfigTable().GiftRecvMaxCount;\r\n        let currNum=FriendData.ins.getReceiveGiftNum();\r\n        if (currNum<= max) {\r\n            let infos = FriendData.ins.getMyFreindInfos();\r\n            let ids = [];\r\n            for (let key in infos) {\r\n                if (infos[key].receiveGiftState == 1) {\r\n                    ids.push(infos[key].id);\r\n                    currNum++;\r\n                }\r\n            }\r\n            if (ids.length > 0) {\r\n                FriendControl.ins.requestRecvGift(ids);\r\n            } else {\r\n                //ShowTips(\"没有可领取的礼物\")\r\n                ShowTips(LangMgr.getLab(\"Tips_friend_1\"))\r\n            }\r\n        } else {\r\n            //ShowTips(\"今日领取已达到上线\")\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_2\"))\r\n        }\r\n\r\n    }\r\n    onClickSendValue() {\r\n        let infos = FriendData.ins.getMyFreindInfos();\r\n        let ids = [];\r\n        \r\n        for (let key in infos) {\r\n            if (!infos[key].isGiveGift) {\r\n                ids.push(infos[key].id);\r\n            }\r\n        }\r\n        if (ids.length > 0) {\r\n            FriendControl.ins.requestGivingGift(ids);\r\n        } else {\r\n            //ShowTips(\"没有可赠送的好友\")\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_3\"))\r\n        }\r\n    }\r\n    onClickAllRefuse() {\r\n        if (this.currType == proto.FriendListType.ApplyList) {\r\n            let ids = [];\r\n            for (let key in this.friendItemInfos) {\r\n                ids.push(this.friendItemInfos[key].id);\r\n            }\r\n            if (ids.length > 0) {\r\n                FriendControl.ins.requestRemoveFriendApply(ids);\r\n            } else {\r\n                //ShowTips(\"没有申请列表\")\r\n                ShowTips(LangMgr.getLab(\"Tips_friend_4\"))\r\n            }\r\n        }\r\n    }\r\n    onClickAllAgree() {\r\n        if (this.currType == proto.FriendListType.ApplyList) {\r\n            let ids = [];\r\n            for (let key in this.friendItemInfos) {\r\n                ids.push(this.friendItemInfos[key].id);\r\n            }\r\n            if (ids.length > 0) {\r\n                FriendControl.ins.requestConfirmFriend(ids);\r\n            } else {\r\n                //ShowTips(\"没有申请列表\")\r\n                ShowTips(LangMgr.getLab(\"Tips_friend_4\"))\r\n            }\r\n        }\r\n    }\r\n    onClickRefresh() {\r\n        let tiemr = new Date().getTime();\r\n        let t = Math.floor((tiemr - this.lastRefreshTimer) / 1000);\r\n        if (t > 5) {\r\n            FriendControl.ins.requestRecommendFriend();\r\n        } else {\r\n            //ShowTips((5 - t) + \"秒后在刷新\");\r\n            //ShowTips((5 - t) + LangMgr.getLab(\"Tips_friend_5\"));\r\n            ShowTips(LangMgr.getCombineString(\"Tips_friend_5\", [(5 - t)]));\r\n        }\r\n\r\n\r\n    }\r\n    onClickSearch() {\r\n        if (this.searchEdit.string != \"\" && this.searchEdit.string != LangMgr.getLab(\"ui_friend_6\")) {\r\n            FriendControl.ins.requestFindFriend(this.searchEdit.string);\r\n        } else {\r\n            //ShowTips(\"请输入角色名\")\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_6\"))\r\n        }\r\n\r\n    }\r\n    on_s2c_GetFriendSimpleRoleRsp(msg: proto.Msg_GetFriendSimpleRoleRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            if (msg.type == proto.FriendListType.FriendList) {\r\n                this.initMyFriendView();\r\n            } else if (msg.type == proto.FriendListType.ApplyList) {\r\n                this.initApplyView();\r\n            } else if (msg.type == proto.FriendListType.BlackList) {\r\n                this.initBlackView();\r\n            }\r\n        }\r\n    }\r\n    on_s2c_AddFriendPush(msg: proto.Msg_AddFriendPush) {\r\n        if (msg.type == this.currType) {\r\n            this.initView();\r\n        } else if (msg.type == proto.FriendListType.ApplyList || msg.type == proto.FriendListType.FriendList) {\r\n            this.updateFriendNum();\r\n        }\r\n    }\r\n    on_s2c_RemoveFriendPush(msg: proto.Msg_RemoveFriendPush) {\r\n        if (msg.type == this.currType) {\r\n            this.initView();\r\n        } else if (msg.type == proto.FriendListType.ApplyList || msg.type == proto.FriendListType.FriendList) {\r\n            this.updateFriendNum();\r\n        }\r\n\r\n    }\r\n    on_s2c_RecommendFriendRsp(msg: proto.Msg_RecommendFriendRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        if (this.currType == 3) {\r\n            this.searchRoleInfo = null;\r\n            this.initRecommendView();\r\n\r\n        }\r\n        this.lastRefreshTimer = new Date().getTime();\r\n\r\n    }\r\n    on_s2c_Msg_AddBlacklistRsp(msg: proto.Msg_AddBlacklistRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            //ShowTips(\"添加黑名单成功\");\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_7\"));\r\n        }\r\n    }\r\n    on_s2c_RemoveBlacklistRsp(msg: proto.Msg_RemoveBlacklistRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            //ShowTips(\"已移除黑名单\");\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_8\"));\r\n        }\r\n    }\r\n    on_s2c_AddFriendRsp(msg: proto.Msg_AddFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            //ShowTips(\"已发送好友请求\");\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_9\"));\r\n        } else {\r\n            // ShowTips(msg.error.message);\r\n        }\r\n    }\r\n    on_s2c_FindFriendRsp(msg: proto.Msg_FindFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            if (msg.role) {\r\n                let info = new SimpleRoleInfo();\r\n                info.merge(msg.role);\r\n                this.searchRoleInfo = info;\r\n                if (this.currType == 3) {\r\n                    this.initRecommendView();\r\n                }\r\n            } else {\r\n                //ShowTips(\"找不到用户\")\r\n                ShowTips(LangMgr.getLab(\"Tips_friend_10\"))\r\n            }\r\n        } else {\r\n            // if (msg.error) {\r\n            //     ShowTips(msg.error.message)\r\n            // }\r\n\r\n        }\r\n\r\n    }\r\n    on_s2c_ConfirmFriendRsp(msg: proto.Msg_ConfirmFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            //ShowTips(\"添加好友成功\");\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_11\"));\r\n        }\r\n    }\r\n    on_s2c_RemoveFriendApplyRsp(msg: proto.Msg_RemoveFriendApplyRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            //ShowTips(\"已拒绝好友申请\");\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_12\"));\r\n        }\r\n    }\r\n    on_s2c_RemoveFriendRsp(msg: proto.Msg_RemoveFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            //ShowTips(\"移除好友成功\");\r\n            ShowTips(LangMgr.getLab(\"Tips_friend_13\"));\r\n        }\r\n    }\r\n\r\n    getCellCount() {\r\n        return this.friendItemInfos.length;\r\n    }\r\n    getCellHigth() {\r\n        return 100;\r\n    }\r\n    getCellIdentifer() {\r\n        return \"FriendListItem\";\r\n    }\r\n    getCellView() {\r\n        return instantiate(this.friendItemPrefab).getComponent(FriendListItem);\r\n    }\r\n    GetCellData(idx: number) {\r\n        if (this.friendItemInfos[idx]) {\r\n            return { type: this.currType, info: this.friendItemInfos[idx] }\r\n        }\r\n\r\n    }\r\n    /**\r\n   * 同步送礼数据\r\n   * @param msg \r\n   */\r\n    on_s2c_GiftPush(msg: proto.Msg_GiftPush) {\r\n        if (this.currType == proto.FriendListType.FriendList) {\r\n            this.initMyFriendView();\r\n        }\r\n    }\r\n    /**\r\n    * 收取礼物返回\r\n    * @param msg \r\n    */\r\n    on_s2c_RecvGiftRsp(msg: proto.Msg_RecvGiftRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            if (this.currType == proto.FriendListType.FriendList) {\r\n                this.initMyFriendView();\r\n            }\r\n        } else {\r\n            ShowTips(msg.error.message);\r\n        }\r\n    }\r\n    /**\r\n   * 赠与礼物返回\r\n   * @param msg \r\n   */\r\n    on_s2c_GivingGiftRsp(msg: proto.Msg_GivingGiftRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            if (this.currType == proto.FriendListType.FriendList) {\r\n                this.initMyFriendView();\r\n            }\r\n        } else {\r\n            ShowTips(msg.error.message);\r\n        }\r\n    }\r\n}"]}