{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/utils/GameUtil.ts"],"names":["GameUtil","getTimeGuildTXT","timeleft","dayStr","getLab","hourStr","day","Math","floor","dayleft","hour","minuteStr","hourleft","min","sec","secondStr","getTimeTXT","setTextTime_2","iLeftSecond","iHour","iMin","iSecond","String","setTextTime","setTextTime_3","setTextTime_4","setGraySpine","sp","isGray","nowMaterial","customMaterial","name","mat","builtinResMgr","get","sortByVocation","arr","sort","a","b","heroTabA","getData","HeroTableById","getValue","heroTabB","Class","gachaReplace","gachaId","key","cb","gachaTab","GachaTableById","itemId","ItemId","count","ItemCount","itemTab","ItemTableById","itemCount","ins","getCount","addCount","addItemId","SubItemId","addItemTab","addItemNeedCount","SubItemBaseCount","havaAddItemCount","checkSameDay","tipsStr","getCombineString","Name","create","val","gacha","show","viewName","DiamondBuyPop","dailyBuyShop","CostCount","getItemId","recuitType","itemTabName","itemGetTab","itemGetTabName","type","BuyDailyShop","ConsumptionToPurchase","currentDate","Date","today","toDateString","dismissTime","getItem","getPlayInfoById","id","msg","Msg_GetSimpleRoleReq","roleId","Send","Ptl","GetSimpleRoleReq","handleNumerText","_score","score","Number","value","index","indexOf","slice","getTimeUntilNextWeek","now","dayOfWeek","getDay","daysUntilNextMonday","nextMonday","setDate","getDate","millisecondsUntilNextMonday","getTime","getTimeUntilNextMonth","year","getFullYear","month","getMonth","nextMonth","nextMonthYear","firstDayOfNextMonth","millisecondsUntilNextMonth","getTimeUntilNextDay","tomorrow","millisecondsUntilTomorrow","createAnimation","animNode","animId","addAnimId","animaData","AnimationTableById","path","Path","Scale","length","scale","Vec3","Type","AnimationType","AnimationType_SkeletonData","spine","getComponent","Skeleton","addComponent","SkeletonData","then","spData","isValid","skeletonData","premultipliedAlpha","enableBatch","setAnimation","AnimationName","Loop","addAnimaData","addAnimation","timeScale","AnimationType_Plist","spr","Sprite","animCom","Animation","SpriteAtlas","atlas","sizeMode","SizeMode","RAW","SIMPLE","trim","anim_clip","AnimationClip","createWithSpriteFrames","setPlistArray","FPS","wrapMode","WrapMode","Normal","defaultClip","play","on","EventType","FINISHED","e","AnimationType_SpriteFrame","_spr","destroy","spriteFrame","SpriteFrame","sf","log","getRandomInt","max","ceil","random","getPassDaysByZero","startSeconds","days","nowSeconds","getServerUtcTime","m_dateHelp","setTime","setHours","setMinutes","setSeconds","t_startZeroSeconds","isChEngNumber","str","test","sendChatToGuild","channelId","getChanneIdByType","ChatChannelType","Guild","ChatBreviaryType","ChatBreviaryType_GuildGiftLow","ChatBreviaryType_GuildGiftBargain","clientCustomNotice","ChatMessage","ClientCustomNotice","noticeType","content","requestSendChatMessage","refreshFlagImg","flagId","flagtab","GuildFlagTableById","setTexture","IconUrl","formatTimestamp","timestamp","date","hours","getHours","minutes","getMinutes","s_month","s_day","s_hours","s_minutes","ButtonLock","lockTime","callBackFun","target","propertyKey","descriptor","oldFun","isLock","args","setTimeout","apply","AmendmentEventLocation","pos","newpos","y","view","getVisibleSize","height","getDesignResolutionSize","getLocationInResolution","dSize","desVec","Vec2","width","winVec","subtract","moveZeroes","nums","i","deepClone","obj","Array","isArray","arrCopy","objCopy","hasOwnProperty","error","LangMgr","ItemInfo","LoadResAsync","tab","Func","ItemData","CommonTipsPop","ShowItemNotEnoughTips","UIMgr","proto","Net","RecruitType","Avatar","ViewName","RoleData","ChatData","ChatControl","convertRewardsByList","list","rewads","len","push","convertItemInfosByList","item","initItemData","itemsAddItems","items1","items2","find","num","getRewardsByDropId","dropId","callBack","table","DropTableById","DropType","DropType_Odds","DropType_Weight","ItemList","Count","DropType_GroupWeight","convertNumber","isConsume","round","toFixed"],"mappings":";;;2WAmBaA,Q;;AAgIN,WAASC,eAAT,CAAyBC,QAAzB,EAAmD;AACtD,QAAIA,QAAQ,GAAG,CAAf,EAAkB;AACd;AACH;;AACD,QAAIC,MAAM,GAAG;AAAA;AAAA,4BAAQC,MAAR,CAAe,iBAAf,CAAb;AACA,QAAIC,OAAO,GAAG;AAAA;AAAA,4BAAQD,MAAR,CAAe,kBAAf,CAAd;AAEA,QAAIE,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWN,QAAQ,GAAG,KAAtB,CAAV;AACA,QAAIO,OAAO,GAAGP,QAAQ,GAAG,KAAzB;AACA,QAAIQ,IAAI,GAAGH,IAAI,CAACC,KAAL,CAAWC,OAAO,GAAG,IAArB,CAAX;;AACA,QAAIH,GAAG,GAAG,CAAV,EAAa;AAAE;AACX,aAAQ,GAAEA,GAAI,GAAEH,MAAO,EAAvB;AACH;;AACD,QAAIQ,SAAS,GAAG;AAAA;AAAA,4BAAQP,MAAR,CAAe,oBAAf,CAAhB;AACA,QAAIQ,QAAQ,GAAGH,OAAO,GAAG,IAAzB;AACA,QAAII,GAAG,GAAGN,IAAI,CAACC,KAAL,CAAWI,QAAQ,GAAG,EAAtB,CAAV;;AACA,QAAIF,IAAI,GAAG,CAAX,EAAc;AAAE;AACZ,aAAQ,GAAEA,IAAK,IAAGL,OAAQ,EAA1B;AACH;;AACD,QAAIS,GAAG,GAAGF,QAAQ,GAAG,EAArB;AAEA,QAAIG,SAAS,GAAG;AAAA;AAAA,4BAAQX,MAAR,CAAe,oBAAf,CAAhB,CArBsD,CAsBtD;;AACA,QAAIS,GAAG,GAAG,CAAV,EAAa;AACT,aAAQ,GAAEA,GAAI,GAAEF,SAAU,EAA1B;AACH;;AAED,WAAQ,GAAEG,GAAI,GAAEC,SAAU,EAA1B;AACH;;AAEM,WAASC,UAAT,CAAoBd,QAApB,EAA8C;AACjD,QAAIA,QAAQ,GAAG,CAAf,EAAkB;AACd;AACH;;AACD,QAAIC,MAAM,GAAG;AAAA;AAAA,4BAAQC,MAAR,CAAe,iBAAf,CAAb;AACA,QAAIC,OAAO,GAAG;AAAA;AAAA,4BAAQD,MAAR,CAAe,kBAAf,CAAd;AAEA,QAAIE,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWN,QAAQ,GAAG,KAAtB,CAAV;AACA,QAAIO,OAAO,GAAGP,QAAQ,GAAG,KAAzB;AACA,QAAIQ,IAAI,GAAGH,IAAI,CAACC,KAAL,CAAWC,OAAO,GAAG,IAArB,CAAX;;AACA,QAAIH,GAAG,GAAG,CAAV,EAAa;AAAE;AACX,UAAII,IAAI,GAAG,CAAX,EAAc;AACV,eAAQ,GAAEJ,GAAI,GAAEH,MAAO,GAAEO,IAAK,GAAEL,OAAQ,EAAxC;AACH,OAFD,MAEO;AACH,eAAQ,GAAEC,GAAI,GAAEH,MAAO,EAAvB;AACH;AACJ;;AACD,QAAIQ,SAAS,GAAG;AAAA;AAAA,4BAAQP,MAAR,CAAe,oBAAf,CAAhB;AACA,QAAIQ,QAAQ,GAAGH,OAAO,GAAG,IAAzB;AACA,QAAII,GAAG,GAAGN,IAAI,CAACC,KAAL,CAAWI,QAAQ,GAAG,EAAtB,CAAV;;AACA,QAAIF,IAAI,GAAG,CAAX,EAAc;AAAE;AACZ,UAAIG,GAAG,GAAG,CAAV,EAAa;AACT,eAAQ,GAAEH,IAAK,GAAEL,OAAQ,GAAEQ,GAAI,GAAEF,SAAU,EAA3C;AACH,OAFD,MAEO;AACH,eAAQ,GAAED,IAAK,GAAEL,OAAQ,EAAzB;AACH;;AACD;AACH;;AACD,QAAIS,GAAG,GAAGF,QAAQ,GAAG,EAArB;AAEA,QAAIG,SAAS,GAAG;AAAA;AAAA,4BAAQX,MAAR,CAAe,oBAAf,CAAhB,CA9BiD,CA+BjD;;AACA,QAAIS,GAAG,GAAG,CAAV,EAAa;AACT,aAAQ,GAAEA,GAAI,GAAEF,SAAU,GAAEG,GAAI,GAAEC,SAAU,EAA5C;AACH;;AAED,WAAQ,GAAED,GAAI,GAAEC,SAAU,EAA1B;AACH;;AAEM,WAASE,aAAT,CAAuBC,WAAvB,EAA4C;AAC/C,QAAIC,KAAK,GAAGZ,IAAI,CAACC,KAAL,CAAWU,WAAW,IAAI,KAAK,EAAT,CAAtB,CAAZ;AACA,QAAIE,IAAI,GAAGb,IAAI,CAACC,KAAL,CAAWU,WAAW,IAAI,KAAK,EAAT,CAAX,GAA0B,EAArC,CAAX;AACA,QAAIG,OAAO,GAAGd,IAAI,CAACC,KAAL,CAAWU,WAAW,GAAG,EAAzB,CAAd;AACA,WAAOI,MAAM,CAACH,KAAK,IAAI,EAAT,GAAcA,KAAd,GAAsB,MAAMA,KAA7B,CAAN,GAA4C,GAA5C,GAAkDG,MAAM,CAACF,IAAI,IAAI,EAAR,GAAaA,IAAb,GAAoB,MAAMA,IAA3B,CAAxD,GACD,GADC,GACKE,MAAM,CAACD,OAAO,IAAI,EAAX,GAAgBA,OAAhB,GAA0B,MAAMA,OAAjC,CADlB;AAEH;;AACM,WAASE,WAAT,CAAqBL,WAArB,EAAkD;AACrD,QAAIA,WAAW,GAAG,KAAlB,EAAyB;AACrB;AACA,aAAOD,aAAa,CAACC,WAAD,CAApB;AACH,KAHD,MAGO;AACH,aAAOF,UAAU,CAACE,WAAD,CAAjB;AACH;AACJ;;AACM,WAASM,aAAT,CAAuBN,WAAvB,EAA4C;AAC/C,QAAIE,IAAI,GAAGb,IAAI,CAACC,KAAL,CAAWU,WAAW,IAAI,KAAK,EAAT,CAAX,GAA0B,EAArC,CAAX;AACA,QAAIG,OAAO,GAAGd,IAAI,CAACC,KAAL,CAAWU,WAAW,GAAG,EAAzB,CAAd;AACA,WAAOI,MAAM,CAACF,IAAI,IAAI,EAAR,GAAaA,IAAb,GAAoB,MAAMA,IAA3B,CAAN,GAAyC,GAAzC,GAA+CE,MAAM,CAACD,OAAO,IAAI,EAAX,GAAgBA,OAAhB,GAA0B,MAAMA,OAAjC,CAA5D;AACH;;AACM,WAASI,aAAT,CAAuBP,WAAvB,EAA4C;AAC/C,QAAIZ,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWU,WAAW,GAAG,KAAzB,CAAV;AACA,QAAIT,OAAO,GAAGS,WAAW,GAAG,KAA5B;AACA,QAAIC,KAAK,GAAGZ,IAAI,CAACC,KAAL,CAAWC,OAAO,IAAI,KAAK,EAAT,CAAlB,CAAZ;AACA,QAAIW,IAAI,GAAGb,IAAI,CAACC,KAAL,CAAWC,OAAO,IAAI,KAAK,EAAT,CAAP,GAAsB,EAAjC,CAAX;AACA,QAAIY,OAAO,GAAGd,IAAI,CAACC,KAAL,CAAWC,OAAO,GAAG,EAArB,CAAd;AACA,WAAOa,MAAM,CAAChB,GAAG,IAAI,EAAP,GAAYA,GAAZ,GAAkB,MAAMA,GAAzB,CAAN,GAAsC,GAAtC,GAA4CgB,MAAM,CAACH,KAAK,IAAI,EAAT,GAAcA,KAAd,GAAsB,MAAMA,KAA7B,CAAlD,GAAwF,GAAxF,GAA8FG,MAAM,CAACF,IAAI,IAAI,EAAR,GAAaA,IAAb,GAAoB,MAAMA,IAA3B,CAApG,GACD,GADC,GACKE,MAAM,CAACD,OAAO,IAAI,EAAX,GAAgBA,OAAhB,GAA0B,MAAMA,OAAjC,CADlB;AAEH;AACD;;;AACO,WAASK,YAAT,CAAsBC,EAAtB,EAAuCC,MAAvC,EAAwD;AAC3D,QAAIC,WAAW,GAAGF,EAAE,CAACG,cAArB;;AACA,QAAIF,MAAJ,EAAY;AACR,UAAIC,WAAW,IAAIA,WAAW,CAAC,aAAD,CAA1B,IAA6CA,WAAW,CAAC,aAAD,CAAX,CAA2BE,IAA3B,IAAmC,WAApF,EAAiG;AAC7F;AACH;;AACD,UAAIC,GAAa,GAAGC,aAAa,CAACC,GAAd,CAAmB,yBAAnB,CAApB;AACAP,MAAAA,EAAE,CAACG,cAAH,GAAoBE,GAApB;AACH,KAND,MAMO;AACH,UAAIH,WAAW,IAAIA,WAAW,CAAC,aAAD,CAA1B,IAA6CA,WAAW,CAAC,aAAD,CAAX,CAA2BE,IAA3B,IAAmC,eAApF,EAAqG;AACjG;AACH;;AACD,UAAIC,GAAa,GAAGC,aAAa,CAACC,GAAd,CAAmB,wBAAnB,CAApB;AACAP,MAAAA,EAAE,CAACG,cAAH,GAAoBE,GAApB;AACH;AACJ,G,CACD;;;AACO,WAASG,cAAT,CAAwBC,GAAxB,EAAuC;AAC1C,WAAOA,GAAG,CAACC,IAAJ,CAAS,CAACC,CAAD,EAAIC,CAAJ,KAAU;AACtB,YAAMC,QAAQ,GAAG;AAAA;AAAA,sBAAIC,OAAJ,GAAcC,aAAd,CAA4BC,QAA5B,CAAqCL,CAArC,CAAjB;AACA,YAAMM,QAAQ,GAAG;AAAA;AAAA,sBAAIH,OAAJ,GAAcC,aAAd,CAA4BC,QAA5B,CAAqCJ,CAArC,CAAjB;AACA,aAAOC,QAAQ,CAACK,KAAT,GAAiBD,QAAQ,CAACC,KAAjC;AACH,KAJM,CAAP;AAKH;AACD;;;AACO,WAASC,YAAT,CAAsBC,OAAtB,EAAuCC,GAAvC,EAAyDC,EAAzD,EAAgF;AACnF,UAAMC,QAAQ,GAAG;AAAA;AAAA,oBAAIT,OAAJ,GAAcU,cAAd,CAA6BR,QAA7B,CAAsCI,OAAtC,CAAjB;AACA,UAAMK,MAAM,GAAGF,QAAQ,CAACG,MAAxB;AACA,UAAMC,KAAK,GAAGJ,QAAQ,CAACK,SAAvB;AACA,UAAMC,OAAO,GAAG;AAAA;AAAA,oBAAIf,OAAJ,GAAcgB,aAAd,CAA4Bd,QAA5B,CAAqCS,MAArC,CAAhB;AACA,UAAMM,SAAS,GAAG;AAAA;AAAA,8BAASC,GAAT,CAAaC,QAAb,CAAsBR,MAAtB,CAAlB;AACA;;AACA,UAAMS,QAAQ,GAAGP,KAAK,GAAGI,SAAzB,CAPmF,CAQnF;;AACA,UAAMI,SAAS,GAAGZ,QAAQ,CAACa,SAA3B;;AACA,QAAI,CAACD,SAAL,EAAgB;AACZ;AAAA;AAAA,0DAAsBV,MAAtB;AACA,aAAO,KAAP;AACH;;AACD,UAAMY,UAAU,GAAG;AAAA;AAAA,oBAAIvB,OAAJ,GAAcgB,aAAd,CAA4Bd,QAA5B,CAAqCmB,SAArC,CAAnB;AACA,UAAMG,gBAAgB,GAAGJ,QAAQ,GAAGX,QAAQ,CAACgB,gBAA7C;AACA;;AACA,UAAMC,gBAAgB,GAAG;AAAA;AAAA,8BAASR,GAAT,CAAaC,QAAb,CAAsBE,SAAtB,CAAzB,CAjBmF,CAkBnF;;AACA,QAAI,CAACM,YAAY,CAACpB,GAAD,CAAjB,EAAwB;AACpB,YAAMqB,OAAO,GAAG;AAAA;AAAA,8BAAQC,gBAAR,CAAyB,yBAAzB,EAAoD,CAAC;AAAA;AAAA,8BAAQlE,MAAR,CAAeoD,OAAO,CAACe,IAAvB,CAAD,EAA+BN,gBAA/B,EAAiD;AAAA;AAAA,8BAAQ7D,MAAR,CAAe4D,UAAU,CAACO,IAA1B,CAAjD,CAApD,CAAhB;AACA;AAAA;AAAA,0CAAcC,MAAd,CAAqBH,OAArB,EAAgCI,GAAD,IAAS;AACpC,YAAIA,GAAJ,EAAS;AACL,cAAIN,gBAAgB,GAAGF,gBAAvB,EAAyC;AACrC;AAAA;AAAA,gEAAsBH,SAAtB;AACA,mBAAO,KAAP;AACH,WAHD,MAGO;AACHb,YAAAA,EAAE;AACL;AACJ;AACJ,OATD,EASI;AACAyB,QAAAA,KAAK,EAAE1B;AADP,OATJ;AAYH,KAdD,MAcO;AACH,UAAImB,gBAAgB,IAAIF,gBAAxB,EAA0C;AACtC,eAAO,IAAP;AACH,OAFD,MAEO;AACH;AACA;AACA,YAAIH,SAAS,KAAK,CAAlB,EAAqB;AACjB;AAAA;AAAA,8BAAMH,GAAN,CAAUgB,IAAV,CAAe;AAAEC,YAAAA,QAAQ,EAAE;AAAA;AAAA,sCAASC;AAArB,WAAf;AACH,SAFD,MAEO;AACH;AAAA;AAAA,8DAAsBzB,MAAtB;AACH;;AACD,eAAO,KAAP;AACH;AACJ;AACJ,G,CACD;;;AACO,WAAS0B,YAAT,CAAsB1B,MAAtB,EAAsC2B,SAAtC,EAAyDC,SAAzD,EAA4EhC,GAA5E,EAAyFC,EAAzF,EAAuGgC,UAAvG,EAAiI;AACpI,UAAMzB,OAAO,GAAG;AAAA;AAAA,oBAAIf,OAAJ,GAAcgB,aAAd,CAA4Bd,QAA5B,CAAqCS,MAArC,CAAhB;AACA,UAAM8B,WAAW,GAAG;AAAA;AAAA,4BAAQ9E,MAAR,CAAeoD,OAAO,CAACe,IAAvB,CAApB;AAEA,UAAMY,UAAU,GAAG;AAAA;AAAA,oBAAI1C,OAAJ,GAAcgB,aAAd,CAA4Bd,QAA5B,CAAqCqC,SAArC,CAAnB,CAJoI,CAKpI;;AACA,QAAII,cAAc,GAAG,EAArB;;AACA,QAAID,UAAJ,EAAgB;AACZC,MAAAA,cAAc,GAAG;AAAA;AAAA,8BAAQhF,MAAR,CAAe+E,UAAU,CAACZ,IAA1B,CAAjB;AACH;;AAED,UAAMb,SAAS,GAAG;AAAA;AAAA,8BAASC,GAAT,CAAaC,QAAb,CAAsBR,MAAtB,CAAlB;AACA,UAAMiC,IAAI,GAAGJ,UAAU,GAAGA,UAAH,GAAgB;AAAA;AAAA,oCAAYK,YAAnD;;AACA,QAAI,CAAClB,YAAY,CAACiB,IAAD,CAAjB,EAAyB;AACrB,YAAMhB,OAAO,GAAG;AAAA;AAAA,8BAAQC,gBAAR,CAAyBtB,GAAzB,EAA8B,CAACkC,WAAD,EAAcH,SAAd,EAAyBK,cAAzB,CAA9B,CAAhB;AACA;AAAA;AAAA,0CAAcZ,MAAd,CAAqBH,OAArB,EAAgCI,GAAD,IAAS;AACpC,YAAIA,GAAJ,EAAS;AACL,cAAIf,SAAS,GAAGqB,SAAhB,EAA2B;AACvB;AAAA;AAAA,gEAAsB3B,MAAtB;AACH,WAFD,MAEO;AACHH,YAAAA,EAAE;AACL;AACJ;AACJ,OARD,EAQI;AACAyB,QAAAA,KAAK,EAAEW;AADP,OARJ;AAWH,KAbD,MAaO;AACH,UAAI3B,SAAS,GAAGqB,SAAhB,EAA2B;AACvB;AAAA;AAAA,4DAAsB3B,MAAtB;AACH,OAFD,MAEO;AACHH,QAAAA,EAAE;AACL;AACJ;AACJ;AACD;;;AACO,WAASsC,qBAAT,CAA+BnC,MAA/B,EAA+C2B,SAA/C,EAAkE/B,GAAlE,EAA+EC,EAA/E,EAA6F;AAChG;AACA,UAAMS,SAAS,GAAG;AAAA;AAAA,8BAASC,GAAT,CAAaC,QAAb,CAAsBR,MAAtB,CAAlB;AACA,UAAMiB,OAAO,GAAG;AAAA;AAAA,4BAAQC,gBAAR,CAAyBtB,GAAzB,EAA8B,CAAC+B,SAAD,CAA9B,CAAhB;AACA;AAAA;AAAA,wCAAcP,MAAd,CAAqBH,OAArB,EAAgCI,GAAD,IAAS;AACpC,UAAIA,GAAJ,EAAS;AACL,YAAIf,SAAS,GAAGqB,SAAhB,EAA2B;AACvB;AAAA;AAAA,8DAAsB3B,MAAtB;AACH,SAFD,MAEO;AACHH,UAAAA,EAAE;AACL;AACJ;AACJ,KARD;AASH;AACD;;;AACO,WAASmB,YAAT,CAAsBpB,GAAtB,EAAiD;AACpD,QAAIwC,WAAW,GAAG,IAAIC,IAAJ,EAAlB;AACA,QAAIC,KAAK,GAAGF,WAAW,CAACG,YAAZ,EAAZ;AACA,QAAIC,WAAW,GAAG;AAAA;AAAA,sBAAKC,OAAL,CAAa,gBAAgB7C,GAA7B,CAAlB;;AACA,QAAI,CAAC4C,WAAD,IAAgBA,WAAW,KAAKF,KAApC,EAA2C;AACvC,aAAO,KAAP;AACH;;AACD,WAAO,IAAP;AACH;;AACM,WAASI,eAAT,CAAyBC,EAAzB,EAAqC;AACxC,QAAIC,GAAG,GAAG,IAAI;AAAA;AAAA,wBAAMC,oBAAV,EAAV;AACAD,IAAAA,GAAG,CAACE,MAAJ,GAAaH,EAAb;AACA;AAAA;AAAA,oBAAII,IAAJ,CAAS;AAAA;AAAA,wBAAMC,GAAN,CAAUC,gBAAnB,EAAqCL,GAArC;AACH,G,CACD;;;AACO,WAASM,eAAT,CAAyBC,MAAzB,EAAwD;AAC3D,UAAMC,KAAK,GAAGC,MAAM,CAACF,MAAD,CAApB;;AACA,QAAIC,KAAK,IAAI,SAAb,EAAwB;AACpB,UAAIE,KAAK,GAAGpF,MAAM,CAACkF,KAAK,GAAG,SAAT,CAAlB,CADoB,CAEpB;;AACA,UAAIG,KAAK,GAAGD,KAAK,CAACE,OAAN,CAAc,GAAd,CAAZ;;AACA,UAAID,KAAK,IAAI,CAAC,CAAd,EAAiB;AACb,eAAOD,KAAK,GAAG,GAAf;AACH,OAFD,MAEO;AACHC,QAAAA,KAAK,IAAI,CAAT;AACH,OARmB,CASpB;;;AACA,aAAOD,KAAK,CAACG,KAAN,CAAY,CAAZ,EAAeF,KAAf,IAAwB,GAA/B;AACH,KAXD,MAWO,IAAIH,KAAK,GAAG,KAAZ,EAAmB;AACtB,UAAIE,KAAK,GAAGpF,MAAM,CAACkF,KAAK,GAAG,KAAT,CAAlB;AACA,UAAIG,KAAK,GAAGD,KAAK,CAACE,OAAN,CAAc,GAAd,CAAZ;;AACA,UAAID,KAAK,IAAI,CAAC,CAAd,EAAiB;AACb,eAAOD,KAAK,GAAG,GAAf;AACH,OAFD,MAEO;AACHC,QAAAA,KAAK,IAAI,CAAT;AACH,OAPqB,CAQtB;;;AACA,aAAOD,KAAK,CAACG,KAAN,CAAY,CAAZ,EAAeF,KAAf,IAAwB,GAA/B;AACH,KAVM,MAWF;AACD,aAAOrF,MAAM,CAACkF,KAAD,CAAb;AACH;AACJ,G,CACD;;;AACO,WAASM,oBAAT,GAAgC;AACnC,UAAMC,GAAG,GAAG,IAAItB,IAAJ,EAAZ;AACA,UAAMuB,SAAS,GAAGD,GAAG,CAACE,MAAJ,EAAlB;AACA,UAAMC,mBAAmB,GAAIF,SAAS,KAAK,CAAf,GAAoB,CAApB,GAAwB,IAAIA,SAAxD;AACA,UAAMG,UAAU,GAAG,IAAI1B,IAAJ,CAASsB,GAAT,CAAnB;AACAI,IAAAA,UAAU,CAACC,OAAX,CAAmBL,GAAG,CAACM,OAAJ,KAAgBH,mBAAnC;AACA,UAAMI,2BAA2B,GAAGH,UAAU,CAACI,OAAX,KAAuBR,GAAG,CAACQ,OAAJ,EAA3D;AACA,WAAOhH,IAAI,CAACC,KAAL,CAAW8G,2BAA2B,GAAG,IAAzC,CAAP;AACH,G,CACD;;;AACO,WAASE,qBAAT,GAAiC;AACpC,UAAMT,GAAG,GAAG,IAAItB,IAAJ,EAAZ;AACA,UAAMgC,IAAI,GAAGV,GAAG,CAACW,WAAJ,EAAb;AACA,UAAMC,KAAK,GAAGZ,GAAG,CAACa,QAAJ,EAAd;AACA,UAAMC,SAAS,GAAIF,KAAK,KAAK,EAAX,GAAiB,CAAjB,GAAqBA,KAAK,GAAG,CAA/C;AACA,UAAMG,aAAa,GAAIH,KAAK,KAAK,EAAX,GAAiBF,IAAI,GAAG,CAAxB,GAA4BA,IAAlD;AACA,UAAMM,mBAAmB,GAAG,IAAItC,IAAJ,CAASqC,aAAT,EAAwBD,SAAxB,EAAmC,CAAnC,CAA5B;AACA,UAAMG,0BAA0B,GAAGD,mBAAmB,CAACR,OAApB,KAAgCR,GAAG,CAACQ,OAAJ,EAAnE;AACA,WAAOhH,IAAI,CAACC,KAAL,CAAWwH,0BAA0B,GAAG,IAAxC,CAAP;AACH,G,CACD;;;AACO,WAASC,mBAAT,GAA+B;AAClC,UAAMlB,GAAG,GAAG,IAAItB,IAAJ,EAAZ;AACA,UAAMyC,QAAQ,GAAG,IAAIzC,IAAJ,CAASsB,GAAG,CAACW,WAAJ,EAAT,EAA4BX,GAAG,CAACa,QAAJ,EAA5B,EAA4Cb,GAAG,CAACM,OAAJ,KAAgB,CAA5D,CAAjB;AACA,UAAMc,yBAAyB,GAAGD,QAAQ,CAACX,OAAT,KAAqBR,GAAG,CAACQ,OAAJ,EAAvD;AACA,WAAOhH,IAAI,CAACC,KAAL,CAAW2H,yBAAyB,GAAG,IAAvC,CAAP;AACH;AACD;;;AACO,iBAAeC,eAAf,CAA+BC,QAA/B,EAA+CC,MAA/C,EAA+DC,SAA/D,EAAmFtF,EAAnF,EAAkG;AACrG,UAAMuF,SAA6B,GAAG;AAAA;AAAA,oBAAI/F,OAAJ,GAAcgG,kBAAd,CAAiC9F,QAAjC,CAA0C2F,MAA1C,CAAtC;AACA,UAAMI,IAAI,GAAGF,SAAS,CAACG,IAAvB;;AACA,QAAIH,SAAS,CAACI,KAAV,CAAgBC,MAAhB,GAAyB,CAA7B,EAAgC;AAC5BR,MAAAA,QAAQ,CAACS,KAAT,GAAiB,IAAIC,IAAJ,CAASP,SAAS,CAACI,KAAV,CAAgB,CAAhB,CAAT,EAA6BJ,SAAS,CAACI,KAAV,CAAgB,CAAhB,CAA7B,EAAiD,CAAjD,CAAjB;AACH;;AACD,QAAIF,IAAJ,EAAU;AACN,cAAQF,SAAS,CAACQ,IAAlB;AACI;AACA,aAAK;AAAA;AAAA,wBAAIC,aAAJ,CAAkBC,0BAAvB;AACI,cAAIC,KAAK,GAAGd,QAAQ,CAACe,YAAT,CAAsBzH,EAAE,CAAC0H,QAAzB,CAAZ;;AACA,cAAI,CAACF,KAAL,EAAY;AACRA,YAAAA,KAAK,GAAGd,QAAQ,CAACiB,YAAT,CAAsB3H,EAAE,CAAC0H,QAAzB,CAAR;AACH;;AACD,gBAAM;AAAA;AAAA,4CAAaX,IAAb,EAAmB/G,EAAE,CAAC4H,YAAtB,EAAoCC,IAApC,CAA0CC,MAAD,IAA6B;AACxE,gBAAIN,KAAK,CAACO,OAAV,EAAmB;AACfP,cAAAA,KAAK,CAACQ,YAAN,GAAqBF,MAArB;AACAN,cAAAA,KAAK,CAACS,kBAAN,GAA2B,KAA3B;AACAT,cAAAA,KAAK,CAACU,WAAN,GAAoB,IAApB;AACAV,cAAAA,KAAK,CAACW,YAAN,CAAmB,CAAnB,EAAsBtB,SAAS,CAACuB,aAAhC,EAA+CvB,SAAS,CAACwB,IAAzD;;AACA,kBAAIzB,SAAJ,EAAe;AACX,sBAAM0B,YAAY,GAAG;AAAA;AAAA,gCAAIxH,OAAJ,GAAcgG,kBAAd,CAAiC9F,QAAjC,CAA0C4F,SAA1C,CAArB;AACAY,gBAAAA,KAAK,CAACe,YAAN,CAAmB,CAAnB,EAAsBD,YAAY,CAACF,aAAnC,EAAkDE,YAAY,CAACD,IAA/D;AACH;;AACDzB,cAAAA,SAAS,KAAK,CAAd,GAAkBY,KAAK,CAACgB,SAAN,GAAkB,CAApC,GAAwChB,KAAK,CAACgB,SAAN,GAAkB,CAA1D;AACH;AACJ,WAZK,CAAN;AAaA;;AACJ,aAAK;AAAA;AAAA,wBAAIlB,aAAJ,CAAkBmB,mBAAvB;AACI;AACA,cAAIC,GAAG,GAAGhC,QAAQ,CAACe,YAAT,CAAsBkB,MAAtB,CAAV;;AACA,cAAI,CAACD,GAAL,EAAU;AACNA,YAAAA,GAAG,GAAGhC,QAAQ,CAACiB,YAAT,CAAsBgB,MAAtB,CAAN;AACH;;AACD,cAAIC,OAAO,GAAGlC,QAAQ,CAACe,YAAT,CAAsBoB,SAAtB,CAAd;;AACA,cAAI,CAACD,OAAL,EAAc;AACVA,YAAAA,OAAO,GAAGlC,QAAQ,CAACiB,YAAT,CAAsBkB,SAAtB,CAAV;AACH;;AACD,gBAAM;AAAA;AAAA,4CAAa9B,IAAb,EAAmB+B,WAAnB,EAAgCjB,IAAhC,CAAsCkB,KAAD,IAAwB;AAC/D,gBAAIL,GAAG,CAACX,OAAJ,IAAea,OAAO,CAACb,OAA3B,EAAoC;AAChCW,cAAAA,GAAG,CAACM,QAAJ,GAAeL,MAAM,CAACM,QAAP,CAAgBC,GAA/B;AACAR,cAAAA,GAAG,CAAChF,IAAJ,GAAWiF,MAAM,CAACtB,IAAP,CAAY8B,MAAvB;AACAT,cAAAA,GAAG,CAACU,IAAJ,GAAW,KAAX;AACA,oBAAMC,SAAS,GAAGC,aAAa,CAACC,sBAAd,CAAqC;AAAA;AAAA,oCAAOC,aAAP,CAAqBT,KAArB,EAA4BlC,SAA5B,CAArC,EAA6EA,SAAS,CAAC4C,GAAvF,CAAlB;AACAJ,cAAAA,SAAS,CAACjJ,IAAV,GAAiByG,SAAS,CAACuB,aAAV,GAA0BvB,SAAS,CAACuB,aAApC,GAAoD,aAArE;AACAiB,cAAAA,SAAS,CAACK,QAAV,GAAqB7C,SAAS,CAACwB,IAAV,GAAiBiB,aAAa,CAACK,QAAd,CAAuBtB,IAAxC,GAA+CiB,aAAa,CAACK,QAAd,CAAuBC,MAA3F;AACAhB,cAAAA,OAAO,CAACiB,WAAR,GAAsBR,SAAtB;AACAT,cAAAA,OAAO,CAACkB,IAAR,CAAaT,SAAS,CAACjJ,IAAvB;;AACA,kBAAI,CAACyG,SAAS,CAACwB,IAAf,EAAqB;AACjBO,gBAAAA,OAAO,CAACmB,EAAR,CAAWlB,SAAS,CAACmB,SAAV,CAAoBC,QAA/B,EAAyCC,CAAC,IAAI;AAC1C5I,kBAAAA,EAAE;AACL,iBAFD;AAGH;AACJ;AACJ,WAhBK,CAAN;AAiBA;;AACJ,aAAK;AAAA;AAAA,wBAAIgG,aAAJ,CAAkB6C,yBAAvB;AACI,cAAIC,IAAI,GAAG1D,QAAQ,CAACe,YAAT,CAAsBkB,MAAtB,CAAX;;AACA,cAAI,CAACyB,IAAL,EAAW;AACPA,YAAAA,IAAI,GAAG1D,QAAQ,CAACiB,YAAT,CAAsBgB,MAAtB,CAAP;AACH;;AACD,cAAIjC,QAAQ,CAACe,YAAT,CAAsBoB,SAAtB,CAAJ,EAAsC;AAClCnC,YAAAA,QAAQ,CAACe,YAAT,CAAsBoB,SAAtB,EAAiCwB,OAAjC;AACH;;AACDD,UAAAA,IAAI,CAACE,WAAL,GAAmB,IAAnB;AACA,gBAAM;AAAA;AAAA,4CAAavD,IAAb,EAAmBwD,WAAnB,EAAgC1C,IAAhC,CAAsC2C,EAAD,IAAqB;AAC5D,gBAAIJ,IAAI,CAACrC,OAAT,EAAkB;AACdqC,cAAAA,IAAI,CAACpB,QAAL,GAAgBL,MAAM,CAACM,QAAP,CAAgBC,GAAhC;AACAkB,cAAAA,IAAI,CAAC1G,IAAL,GAAYiF,MAAM,CAACtB,IAAP,CAAY8B,MAAxB;AACAiB,cAAAA,IAAI,CAAChB,IAAL,GAAY,KAAZ;AACAgB,cAAAA,IAAI,CAACE,WAAL,GAAmBE,EAAnB;AACH;AACJ,WAPK,CAAN;AAQA;;AACJ;AACI;AApER;AAsEH,KAvED,MAuEO;AACHC,MAAAA,GAAG,CAAE,uBAAF,CAAH;AACH;AACJ;AAED;AACA;AACA;AACA;AACA;AACA;;;AACO,WAASC,YAAT,CAAsBxL,GAAtB,EAAmCyL,GAAnC,EAAwD;AAC3DzL,IAAAA,GAAG,GAAGN,IAAI,CAACgM,IAAL,CAAU1L,GAAV,CAAN;AACAyL,IAAAA,GAAG,GAAG/L,IAAI,CAACC,KAAL,CAAW8L,GAAX,CAAN;AACA,WAAO/L,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACiM,MAAL,MAAiBF,GAAG,GAAGzL,GAAvB,CAAX,IAA0CA,GAAjD;AACH;AAED;;;AACO,WAAS4L,iBAAT,CAA2BC,YAA3B,EAAyD;AAC5D,QAAIC,IAAY,GAAG,CAAnB;AACA,QAAIC,UAAkB,GAAG;AAAA;AAAA,8BAASjJ,GAAT,CAAakJ,gBAAb,EAAzB;;AACA,QAAID,UAAU,GAAGF,YAAjB,EAA+B;AAC3B,UAAII,UAAgB,GAAG,IAAIrH,IAAJ,EAAvB;AACAqH,MAAAA,UAAU,CAACC,OAAX,CAAmBL,YAAY,GAAG,IAAlC;AACAI,MAAAA,UAAU,CAACE,QAAX,CAAoB,CAApB;AACAF,MAAAA,UAAU,CAACG,UAAX,CAAsB,CAAtB;AACAH,MAAAA,UAAU,CAACI,UAAX,CAAsB,CAAtB;AACA,UAAIC,kBAA0B,GAAGL,UAAU,CAACvF,OAAX,EAAjC;AACA4F,MAAAA,kBAAkB,GAAIA,kBAAD,GAAuB,IAA5C;AACAR,MAAAA,IAAI,GAAI,CAACC,UAAU,GAAGO,kBAAd,IAAoC,KAA5C;AACH;;AACD,WAAO5M,IAAI,CAACC,KAAL,CAAWmM,IAAX,CAAP;AACH;;AACM,WAASS,aAAT,CAAuBC,GAAvB,EAAoC;AACvC,QAAI,8BAA8BC,IAA9B,CAAmCD,GAAnC,CAAJ,EAA6C;AACzC,aAAO,IAAP;AACH,KAFD,MAEO;AACH,aAAO,KAAP;AACH;AACJ;;AACM,WAASE,eAAT,CAAyBlI,IAAzB,EAAqD;AACxD,UAAMmI,SAAS,GAAG;AAAA;AAAA,8BAAS7J,GAAT,CAAa8J,iBAAb,CAA+B;AAAA;AAAA,wBAAMC,eAAN,CAAsBC,KAArD,CAAlB;AACA,QAAIN,GAAG,GAAG,EAAV;;AACA,QAAIhI,IAAI,KAAK;AAAA;AAAA,oBAAIuI,gBAAJ,CAAqBC,6BAAlC,EAAiE;AAC7DR,MAAAA,GAAG,GAAG;AAAA;AAAA,8BAAQjN,MAAR,CAAe,qBAAf,CAAN;AACH,KAFD,MAEO,IAAIiF,IAAI,KAAK;AAAA;AAAA,oBAAIuI,gBAAJ,CAAqBE,iCAAlC,EAAqE;AACxET,MAAAA,GAAG,GAAG;AAAA;AAAA,8BAAQ/I,gBAAR,CAAyB,qBAAzB,EAAgD,CAAC;AAAA;AAAA,gCAASX,GAAT,CAAa5B,IAAd,CAAhD,CAAN;AACH;;AACD,UAAMgM,kBAAkB,GAAG,IAAI;AAAA;AAAA,wBAAMC,WAAN,CAAkBC,kBAAtB,EAA3B;AACAF,IAAAA,kBAAkB,CAACG,UAAnB,GAAgC7I,IAAhC;AACA0I,IAAAA,kBAAkB,CAACI,OAAnB,GAA6Bd,GAA7B;AACA;AAAA;AAAA,oCAAY1J,GAAZ,CAAgByK,sBAAhB,CAAuCZ,SAAvC,EAAkDH,GAAlD,EAAuDU,kBAAvD;AACH;;AACM,WAASM,cAAT,CAAwBC,MAAxB,EAAwC3M,EAAxC,EAAoD;AACvD2M,IAAAA,MAAM,GAAGA,MAAM,GAAGA,MAAH,GAAY,CAA3B;AACA,UAAMC,OAAO,GAAG;AAAA;AAAA,oBAAI9L,OAAJ,GAAc+L,kBAAd,CAAiC7L,QAAjC,CAA0C2L,MAA1C,CAAhB;AACA3M,IAAAA,EAAE,CAAC8M,UAAH,CAAcF,OAAO,CAACG,OAAtB;AACH;;AACM,WAASC,eAAT,CAAyBC,SAAzB,EAA4C;AAC/C;AACA,QAAIC,IAAI,GAAG,IAAIpJ,IAAJ,CAASmJ,SAAS,GAAG,IAArB,CAAX,CAF+C,CAI/C;;AACA,QAAIjH,KAAK,GAAGkH,IAAI,CAACjH,QAAL,KAAkB,CAA9B,CAL+C,CAKb;;AAClC,QAAItH,GAAG,GAAGuO,IAAI,CAACxH,OAAL,EAAV;AACA,QAAIyH,KAAK,GAAGD,IAAI,CAACE,QAAL,EAAZ;AACA,QAAIC,OAAO,GAAGH,IAAI,CAACI,UAAL,EAAd,CAR+C,CAU/C;;AACA,QAAIC,OAAO,GAAGvH,KAAK,GAAG,EAAR,GAAa,MAAMA,KAAnB,GAA2BA,KAAzC;AACA,QAAIwH,KAAK,GAAG7O,GAAG,GAAG,EAAN,GAAW,MAAMA,GAAjB,GAAuBA,GAAnC;AACA,QAAI8O,OAAO,GAAGN,KAAK,GAAG,EAAR,GAAa,MAAMA,KAAnB,GAA2BA,KAAzC;AACA,QAAIO,SAAS,GAAGL,OAAO,GAAG,EAAV,GAAe,MAAMA,OAArB,GAA+BA,OAA/C,CAd+C,CAgB/C;;AACA,WAAQ,GAAEE,OAAQ,IAAGC,KAAM,IAAGC,OAAQ,IAAGC,SAAU,EAAnD;AACH;;AACM,WAASC,UAAT,CAAoBC,QAAgB,GAAG,GAAvC,EAA4CC,WAA5C,EAAyE;AAC5E,WAAO,UAAUC,MAAV,EAAuBC,WAAvB,EAA4CC,UAA5C,EAA4E;AAC/E,UAAIC,MAAgB,GAAGD,UAAU,CAACjJ,KAAlC;AACA,UAAImJ,MAAe,GAAG,KAAtB;;AACAF,MAAAA,UAAU,CAACjJ,KAAX,GAAmB,UAAU,GAAGoJ,IAAb,EAA0B;AACzC,YAAID,MAAJ,EAAY;AACRL,UAAAA,WAAW,QAAX,IAAAA,WAAW;AACX;AACH;;AACDK,QAAAA,MAAM,GAAG,IAAT;AAEAE,QAAAA,UAAU,CAAC,MAAM;AACbF,UAAAA,MAAM,GAAG,KAAT;AACH,SAFS,EAEPN,QAAQ,GAAG,IAFJ,CAAV;AAGAK,QAAAA,MAAM,CAACI,KAAP,CAAa,IAAb,EAAmBF,IAAnB;AACH,OAXD;;AAYA,aAAOH,UAAP;AACH,KAhBD;AAiBH;AACD;AACA;AACA;AACA;AACA;;;AACO,WAASM,sBAAT,CAAgCC,GAAhC,EAA2C;AAC9C,QAAIC,MAAM,GAAG,IAAIpH,IAAJ,CAASmH,GAAT,CAAb;AACAC,IAAAA,MAAM,CAACC,CAAP,IAAY,CAACC,IAAI,CAACC,cAAL,GAAsBC,MAAtB,GAA+BF,IAAI,CAACG,uBAAL,GAA+BD,MAA/D,IAAyE,CAArF;AACA,WAAOJ,MAAP;AACH;AACD;;;AACO,WAASM,uBAAT,CAAiCP,GAAjC,EAAsC;AACzC,QAAIQ,KAAK,GAAGL,IAAI,CAACG,uBAAL,EAAZ;AACA,QAAIG,MAAM,GAAG,IAAIC,IAAJ,CAASF,KAAK,CAACG,KAAf,EAAsBH,KAAK,CAACH,MAA5B,CAAb;AACA,QAAIO,MAAM,GAAG,IAAIF,IAAJ,CAASP,IAAI,CAACC,cAAL,GAAsBO,KAA/B,EAAsCR,IAAI,CAACC,cAAL,GAAsBC,MAA5D,CAAb;AACA,WAAOL,GAAG,CAACa,QAAJ,CAAaD,MAAM,CAACC,QAAP,CAAgBJ,MAAhB,CAAb,CAAP;AACH;;AACM,WAASK,UAAT,CAAoBC,IAApB,EAA0B;AAC7B,QAAItK,KAAK,GAAG,CAAZ,CAD6B,CACb;AAEhB;;AACA,SAAK,IAAIuK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,IAAI,CAACpI,MAAzB,EAAiCqI,CAAC,EAAlC,EAAsC;AAClC;AACA,UAAID,IAAI,CAACC,CAAD,CAAJ,KAAY,CAAhB,EAAmB;AACf;AACAD,QAAAA,IAAI,CAACtK,KAAD,CAAJ,GAAcsK,IAAI,CAACC,CAAD,CAAlB;AACAvK,QAAAA,KAAK;AACR;AACJ,KAX4B,CAa7B;;;AACA,SAAK,IAAIuK,CAAC,GAAGvK,KAAb,EAAoBuK,CAAC,GAAGD,IAAI,CAACpI,MAA7B,EAAqCqI,CAAC,EAAtC,EAA0C;AACtCD,MAAAA,IAAI,CAACC,CAAD,CAAJ,GAAU,CAAV;AACH;;AAED,WAAOD,IAAP;AACH,G,CACD;;;AACO,WAASE,SAAT,CAAmBC,GAAnB,EAAwB;AAC3B,QAAIA,GAAG,KAAK,IAAR,IAAgB,OAAOA,GAAP,KAAe,QAAnC,EAA6C;AACzC,aAAOA,GAAP,CADyC,CAC7B;AACf,KAH0B,CAK3B;;;AACA,QAAIC,KAAK,CAACC,OAAN,CAAcF,GAAd,CAAJ,EAAwB;AACpB,UAAIG,OAAO,GAAG,EAAd;;AACA,WAAK,IAAIL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGE,GAAG,CAACvI,MAAxB,EAAgCqI,CAAC,EAAjC,EAAqC;AACjCK,QAAAA,OAAO,CAACL,CAAD,CAAP,GAAaC,SAAS,CAACC,GAAG,CAACF,CAAD,CAAJ,CAAtB;AACH;;AACD,aAAOK,OAAP;AACH,KAZ0B,CAc3B;;;AACA,QAAIC,OAAO,GAAG,EAAd;;AACA,SAAK,IAAIxO,GAAT,IAAgBoO,GAAhB,EAAqB;AACjB,UAAIA,GAAG,CAACK,cAAJ,CAAmBzO,GAAnB,CAAJ,EAA6B;AACzBwO,QAAAA,OAAO,CAACxO,GAAD,CAAP,GAAemO,SAAS,CAACC,GAAG,CAACpO,GAAD,CAAJ,CAAxB;AACH;AACJ;;AACD,WAAOwO,OAAP;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;qBAhhBevR,e;gBA8BAe,U;mBAuCAC,a;iBAOAM,W;mBAQAC,a;mBAKAC,a;kBAUAC,Y;oBAiBAS,c;kBAQAW,Y;kBAiDAgC,Y;2BAmCAS,qB;kBAeAnB,Y;qBASA0B,e;qBAMAQ,e;0BA6BAQ,oB;2BAUAU,qB;yBAWAS,mB;qBAOMG,e;kBAwFNiE,Y;uBAOAI,iB;mBAeAW,a;qBAOAG,e;oBAaAc,c;qBAKAM,e;gBAmBAW,U;4BAwBAW,sB;6BAMAQ,uB;gBAMAO,U;eAqBAG;;;;;;;;;;AA7oBWlP,MAAAA,a,OAAAA,a;AAAemK,MAAAA,G,OAAAA,G;AAAKzK,MAAAA,E,OAAAA,E;AAAU2I,MAAAA,M,OAAAA,M;AAAQG,MAAAA,W,OAAAA,W;AAAaD,MAAAA,S,OAAAA,S;AAAWS,MAAAA,a,OAAAA,a;AAAe2F,MAAAA,I,OAAAA,I;AAAM7H,MAAAA,I,OAAAA,I;AAAMmD,MAAAA,W,OAAAA,W;AAAawF,MAAAA,K,OAAAA,K;AAAOrB,MAAAA,I,OAAAA,I;;AAC/HsB,MAAAA,O,iBAAAA,O;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,qB,iBAAAA,qB;AAAuBC,MAAAA,K,iBAAAA,K;;AACvBC,MAAAA,K,oBAAAA,K;;AACAC,MAAAA,G,kBAAAA,G;;AACAC,MAAAA,W,kBAAAA,W;;AAEAC,MAAAA,M,kBAAAA,M;;AACAC,MAAAA,Q,kBAAAA,Q;;AACAC,MAAAA,Q,kBAAAA,Q;;AACAC,MAAAA,Q,kBAAAA,Q;;AACAC,MAAAA,W,kBAAAA,W;;;;;;;;;0BAEI3S,Q,GAAN,MAAMA,QAAN,CAAe;AAElB;AACJ;AACA;AACA;AACA;AAC+B,eAApB4S,oBAAoB,CAACC,IAAD,EAAsB;AAC7C,cAAIC,MAAM,GAAG,EAAb;AACA,cAAIC,GAAG,GAAGF,IAAI,CAAChK,MAAf;;AACA,eAAK,IAAIqI,CAAS,GAAG,CAArB,EAAwBA,CAAC,GAAG6B,GAA5B,EAAiC7B,CAAC,IAAI,CAAtC,EAAyC;AACrC,gBAAIA,CAAC,GAAG,CAAJ,GAAQ6B,GAAZ,EAAiB;AACbD,cAAAA,MAAM,CAACE,IAAP,CAAY;AAAE,0BAAUH,IAAI,CAAC3B,CAAD,CAAhB;AAAqB,uBAAO2B,IAAI,CAAC3B,CAAC,GAAG,CAAL;AAAhC,eAAZ;AACH;AACJ;;AACD,iBAAO4B,MAAP;AACH;AACD;AACJ;AACA;AACA;AACA;;;AACiC,eAAtBG,sBAAsB,CAACJ,IAAD,EAAsB;AAC/C,cAAIC,MAAuB,GAAG,EAA9B;AACA,cAAIC,GAAG,GAAGF,IAAI,CAAChK,MAAf;;AACA,eAAK,IAAIqI,CAAS,GAAG,CAArB,EAAwBA,CAAC,GAAG6B,GAA5B,EAAiC7B,CAAC,IAAI,CAAtC,EAAyC;AACrC,gBAAIA,CAAC,GAAG,CAAJ,GAAQ6B,GAAZ,EAAiB;AACb,kBAAIG,IAAI,GAAG;AAAA;AAAA,yCAAX;AACAA,cAAAA,IAAI,CAACC,YAAL,CAAkBN,IAAI,CAAC3B,CAAD,CAAtB,EAA2B2B,IAAI,CAAC3B,CAAC,GAAG,CAAL,CAA/B;AACA4B,cAAAA,MAAM,CAACE,IAAP,CAAYE,IAAZ;AACH;AACJ;;AACD,iBAAOJ,MAAP;AACH;;AACmB,eAAbM,aAAa,CAACC,MAAD,EAAqBC,MAArB,EAAyC;AACzD,eAAK,IAAItQ,GAAT,IAAgBqQ,MAAhB,EAAwB;AACpB,gBAAIH,IAAI,GAAGI,MAAM,CAACC,IAAP,CAAYjR,CAAC,IAAIA,CAAC,CAACc,MAAF,IAAYiQ,MAAM,CAACrQ,GAAD,CAAN,CAAYI,MAAzC,CAAX;;AACA,gBAAI8P,IAAJ,EAAU;AACNG,cAAAA,MAAM,CAACrQ,GAAD,CAAN,CAAYwQ,GAAZ,IAAmBN,IAAI,CAACM,GAAxB;AACH;AACJ;;AACD,eAAK,IAAIxQ,GAAT,IAAgBsQ,MAAhB,EAAwB;AACpB,gBAAIJ,IAAI,GAAGG,MAAM,CAACE,IAAP,CAAYjR,CAAC,IAAIA,CAAC,CAACc,MAAF,IAAYkQ,MAAM,CAACtQ,GAAD,CAAN,CAAYI,MAAzC,CAAX;;AACA,gBAAI,CAAC8P,IAAL,EAAW;AACPG,cAAAA,MAAM,CAACL,IAAP,CAAYM,MAAM,CAACtQ,GAAD,CAAlB;AACH;AACJ;;AACD,iBAAOqQ,MAAP;AAEH;AAAA;AACL;AACA;AACA;AACA;;;AAC6B,eAAlBI,kBAAkB,CAACC,MAAD,EAAiB;AACtC,cAAIZ,MAAuB,GAAG,EAA9B;;AACA,cAAIa,QAAQ,GAAI5N,EAAD,IAAgB;AAC3B,gBAAI6N,KAAK,GAAG;AAAA;AAAA,4BAAInR,OAAJ,GAAcoR,aAAd,CAA4BlR,QAA5B,CAAqCoD,EAArC,CAAZ;;AACA,gBAAI6N,KAAJ,EAAW;AACP,kBAAIA,KAAK,CAAC5K,IAAN,IAAc;AAAA;AAAA,8BAAI8K,QAAJ,CAAaC,aAA3B,IAA4CH,KAAK,CAAC5K,IAAN,IAAc;AAAA;AAAA,8BAAI8K,QAAJ,CAAaE,eAA3E,EAA4F;AACxF,qBAAK,IAAIhR,GAAT,IAAgB4Q,KAAK,CAACK,QAAtB,EAAgC;AAC5B,sBAAIf,IAAI,GAAG;AAAA;AAAA,6CAAX;;AACA,sBAAIU,KAAK,CAAC5K,IAAN,IAAc;AAAA;AAAA,kCAAI8K,QAAJ,CAAaE,eAA/B,EAAgD;AAC5Cd,oBAAAA,IAAI,CAACC,YAAL,CAAkBS,KAAK,CAACK,QAAN,CAAejR,GAAf,CAAlB,EAAuC4Q,KAAK,CAACM,KAAN,GAAcN,KAAK,CAACrQ,SAAN,CAAgBP,GAAhB,CAArD;AACH,mBAFD,MAEO;AACHkQ,oBAAAA,IAAI,CAACC,YAAL,CAAkBS,KAAK,CAACK,QAAN,CAAejR,GAAf,CAAlB,EAAuC4Q,KAAK,CAACrQ,SAAN,CAAgBP,GAAhB,CAAvC;AACH;;AAED8P,kBAAAA,MAAM,CAACE,IAAP,CAAYE,IAAZ;AACH;AACJ,eAXD,MAWO;AACH,oBAAIU,KAAK,CAAC5K,IAAN,IAAc;AAAA;AAAA,gCAAI8K,QAAJ,CAAaK,oBAA/B,EAAqD;AACjD,uBAAK,IAAIjD,CAAS,GAAG,CAArB,EAAwBA,CAAC,GAAG0C,KAAK,CAACM,KAAlC,EAAyChD,CAAC,EAA1C,EAA8C;AAC1C,yBAAK,IAAIlO,GAAT,IAAgB4Q,KAAK,CAACK,QAAtB,EAAgC;AAC5BN,sBAAAA,QAAQ,CAACC,KAAK,CAACK,QAAN,CAAejR,GAAf,CAAD,CAAR;AACH;AACJ;AACJ,iBAND,MAMO;AACH,uBAAK,IAAIA,GAAT,IAAgB4Q,KAAK,CAACK,QAAtB,EAAgC;AAC5BN,oBAAAA,QAAQ,CAACC,KAAK,CAACK,QAAN,CAAejR,GAAf,CAAD,CAAR;AACH;AACJ;AAGJ;AACJ,aA3BD,MA2BO;AACH0O,cAAAA,KAAK,CAAC,UAAD,EAAa3L,EAAb,CAAL;AACH;AAEJ,WAjCD;;AAkCA4N,UAAAA,QAAQ,CAACD,MAAD,CAAR;AACA,iBAAOZ,MAAP;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;;;AACwB,eAAbsB,aAAa,CAACZ,GAAD,EAAca,SAAkB,GAAG,KAAnC,EAA0C;AAC1D,cAAIb,GAAG,GAAG,KAAV,EAAiB;AACb,mBAAOA,GAAG,GAAG,EAAb;AACH,WAFD,MAEO,IAAIA,GAAG,IAAI,QAAX,EAAqB;AACxB,gBAAIa,SAAJ,EAAe;AACX,qBAAQ9T,IAAI,CAACgM,IAAL,CAAUiH,GAAG,GAAG,IAAN,GAAa,EAAvB,IAA6B,EAA9B,GAAoC,GAA3C;AACH,aAFD,MAEO;AACH,kBAAIA,GAAG,GAAG,IAAN,IAAc,CAAlB,EAAqB;AACjB,uBAAO,CAACjT,IAAI,CAAC+T,KAAL,CAAWd,GAAG,GAAG,IAAN,GAAa,EAAxB,IAA8B,EAA/B,EAAmCe,OAAnC,CAA2C,CAA3C,IAAgD,GAAvD;AACH,eAFD,MAEO;AACH,uBAAQhU,IAAI,CAAC+T,KAAL,CAAWd,GAAG,GAAG,IAAN,GAAa,EAAxB,IAA8B,EAA/B,GAAqC,GAA5C;AACH;AACJ;AACJ,WAVM,MAUA;AAEH,gBAAIa,SAAJ,EAAe;AACX,qBAAQ9T,IAAI,CAACgM,IAAL,CAAUiH,GAAG,GAAG,OAAN,GAAgB,EAA1B,IAAgC,EAAjC,GAAuC,GAA9C;AACH,aAFD,MAEO;AACH,kBAAKA,GAAG,GAAG,OAAN,IAAiB,CAAtB,EAA0B;AACtB,uBAAO,CAACjT,IAAI,CAAC+T,KAAL,CAAWd,GAAG,GAAG,OAAN,GAAgB,EAA3B,IAAiC,EAAlC,EAAsCe,OAAtC,CAA8C,CAA9C,IAAmD,GAA1D;AACH,eAFD,MAEO;AACH,uBAAQhU,IAAI,CAAC+T,KAAL,CAAWd,GAAG,GAAG,OAAN,GAAgB,EAA3B,IAAiC,EAAlC,GAAwC,GAA/C;AACH;AAEJ;AACJ;AACJ;;AA7HiB,O","sourcesContent":["import { Material, Prefab, builtinResMgr, log, sp, Node, Sprite, SpriteAtlas, Animation, AnimationClip, Vec2, Vec3, SpriteFrame, error, view } from \"cc\";\r\nimport { LangMgr } from \"../mgr/LangMgr\";\r\nimport { ItemInfo } from \"../model/item/ItemInfo\";\r\nimport { LoadResAsync } from \"../mgr/ResMgr\";\r\nimport { tab } from \"../../Table/table_gen\";\r\nimport { Func } from \"./Func\";\r\nimport { ItemData } from \"../model/item/ItemData\";\r\nimport { CommonTipsPop } from \"../model/common/CommonTipsPop\";\r\nimport { ShowItemNotEnoughTips, UIMgr } from \"../mgr/UIMgr\";\r\nimport { proto } from \"client_protocol\";\r\nimport { Net } from \"../net/Net\";\r\nimport { RecruitType } from \"../../Common/script/EnumTypeMgr\";\r\nimport { Long } from \"protobufjs\";\r\nimport { Avatar } from \"../fight/animation/Avatar\";\r\nimport { ViewName } from \"../define/ViewDefine\";\r\nimport { RoleData } from \"../model/role/RoleData\";\r\nimport { ChatData } from \"../model/chat/ChatData\";\r\nimport { ChatControl } from \"../model/chat/ChatControl\";\r\n\r\nexport class GameUtil {\r\n\r\n    /**\r\n     * 根据数组[itemid,num,itemid,num.......]格式转换成[{itemId,num}.....]格式\r\n     * @param list \r\n     * @returns \r\n     */\r\n    static convertRewardsByList(list: Array<number>) {\r\n        let rewads = [];\r\n        let len = list.length;\r\n        for (let i: number = 0; i < len; i += 2) {\r\n            if (i + 1 < len) {\r\n                rewads.push({ \"itemId\": list[i], \"num\": list[i + 1] });\r\n            }\r\n        }\r\n        return rewads;\r\n    }\r\n    /**\r\n    * 根据数组[itemid,num,itemid,num.......]格式转换成[{itemId,num}.....]格式\r\n    * @param list \r\n    * @returns \r\n    */\r\n    static convertItemInfosByList(list: Array<number>) {\r\n        let rewads: Array<ItemInfo> = [];\r\n        let len = list.length;\r\n        for (let i: number = 0; i < len; i += 2) {\r\n            if (i + 1 < len) {\r\n                let item = new ItemInfo();\r\n                item.initItemData(list[i], list[i + 1])\r\n                rewads.push(item);\r\n            }\r\n        }\r\n        return rewads;\r\n    }\r\n    static itemsAddItems(items1: ItemInfo[], items2: ItemInfo[]) {\r\n        for (let key in items1) {\r\n            let item = items2.find(a => a.itemId == items1[key].itemId);\r\n            if (item) {\r\n                items1[key].num += item.num;\r\n            }\r\n        }\r\n        for (let key in items2) {\r\n            let item = items1.find(a => a.itemId == items2[key].itemId);\r\n            if (!item) {\r\n                items1.push(items2[key]);\r\n            }\r\n        }\r\n        return items1;\r\n\r\n    }/**\r\n     * 根据掉落id 获取奖励\r\n     * @param dropId \r\n     * @returns \r\n     */\r\n    static getRewardsByDropId(dropId: number) {\r\n        let rewads: Array<ItemInfo> = [];\r\n        let callBack = (id: number) => {\r\n            let table = tab.getData().DropTableById.getValue(id);\r\n            if (table) {\r\n                if (table.Type == tab.DropType.DropType_Odds || table.Type == tab.DropType.DropType_Weight) {\r\n                    for (let key in table.ItemList) {\r\n                        let item = new ItemInfo();\r\n                        if (table.Type == tab.DropType.DropType_Weight) {\r\n                            item.initItemData(table.ItemList[key], table.Count * table.ItemCount[key]);\r\n                        } else {\r\n                            item.initItemData(table.ItemList[key], table.ItemCount[key]);\r\n                        }\r\n\r\n                        rewads.push(item);\r\n                    }\r\n                } else {\r\n                    if (table.Type == tab.DropType.DropType_GroupWeight) {\r\n                        for (let i: number = 0; i < table.Count; i++) {\r\n                            for (let key in table.ItemList) {\r\n                                callBack(table.ItemList[key]);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        for (let key in table.ItemList) {\r\n                            callBack(table.ItemList[key]);\r\n                        }\r\n                    }\r\n\r\n\r\n                }\r\n            } else {\r\n                error(\"掉落id错误==\", id);\r\n            }\r\n\r\n        }\r\n        callBack(dropId);\r\n        return rewads;\r\n    }\r\n    /**\r\n     * \r\n     * @param num \r\n     * @param isConsume 是否是消耗类型 \r\n     * @returns \r\n     */\r\n    static convertNumber(num: number, isConsume: boolean = false) {\r\n        if (num < 10000) {\r\n            return num + \"\";\r\n        } else if (num <= 10000000) {\r\n            if (isConsume) {\r\n                return (Math.ceil(num / 1000 * 10) / 10) + \"K\"\r\n            } else {\r\n                if (num % 1000 != 0) {\r\n                    return (Math.round(num / 1000 * 10) / 10).toFixed(1) + \"K\"\r\n                } else {\r\n                    return (Math.round(num / 1000 * 10) / 10) + \"K\"\r\n                }\r\n            }\r\n        } else {\r\n\r\n            if (isConsume) {\r\n                return (Math.ceil(num / 1000000 * 10) / 10) + \"M\"\r\n            } else {\r\n                if ((num % 1000000 != 0)) {\r\n                    return (Math.round(num / 1000000 * 10) / 10).toFixed(1) + \"M\"\r\n                } else {\r\n                    return (Math.round(num / 1000000 * 10) / 10) + \"M\"\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function getTimeGuildTXT(timeleft: number): string {\r\n    if (timeleft < 0) {\r\n        return;\r\n    }\r\n    let dayStr = LangMgr.getLab(\"Tips_common_day\")\r\n    let hourStr = LangMgr.getLab(\"Tips_common_hour\")\r\n\r\n    let day = Math.floor(timeleft / 86400)\r\n    let dayleft = timeleft % 86400\r\n    let hour = Math.floor(dayleft / 3600)\r\n    if (day > 0) { //天时\r\n        return `${day}${dayStr}`\r\n    }\r\n    let minuteStr = LangMgr.getLab(\"Tips_common_minute\")\r\n    let hourleft = dayleft % 3600\r\n    let min = Math.floor(hourleft / 60)\r\n    if (hour > 0) { //时分\r\n        return `${hour}小${hourStr}`\r\n    }\r\n    let sec = hourleft % 60\r\n\r\n    let secondStr = LangMgr.getLab(\"Tips_common_second\")\r\n    //分秒\r\n    if (min > 0) {\r\n        return `${min}${minuteStr}`\r\n    }\r\n\r\n    return `${sec}${secondStr}`\r\n}\r\n\r\nexport function getTimeTXT(timeleft: number): string {\r\n    if (timeleft < 0) {\r\n        return;\r\n    }\r\n    let dayStr = LangMgr.getLab(\"Tips_common_day\")\r\n    let hourStr = LangMgr.getLab(\"Tips_common_hour\")\r\n\r\n    let day = Math.floor(timeleft / 86400)\r\n    let dayleft = timeleft % 86400\r\n    let hour = Math.floor(dayleft / 3600)\r\n    if (day > 0) { //天时\r\n        if (hour > 0) {\r\n            return `${day}${dayStr}${hour}${hourStr}`\r\n        } else {\r\n            return `${day}${dayStr}`\r\n        }\r\n    }\r\n    let minuteStr = LangMgr.getLab(\"Tips_common_minute\")\r\n    let hourleft = dayleft % 3600\r\n    let min = Math.floor(hourleft / 60)\r\n    if (hour > 0) { //时分\r\n        if (min > 0) {\r\n            return `${hour}${hourStr}${min}${minuteStr}`\r\n        } else {\r\n            return `${hour}${hourStr}`\r\n        }\r\n        return\r\n    }\r\n    let sec = hourleft % 60\r\n\r\n    let secondStr = LangMgr.getLab(\"Tips_common_second\")\r\n    //分秒\r\n    if (min > 0) {\r\n        return `${min}${minuteStr}${sec}${secondStr}`\r\n    }\r\n\r\n    return `${sec}${secondStr}`\r\n}\r\n\r\nexport function setTextTime_2(iLeftSecond: number) {\r\n    let iHour = Math.floor(iLeftSecond / (60 * 60));\r\n    let iMin = Math.floor(iLeftSecond % (60 * 60) / 60);\r\n    let iSecond = Math.floor(iLeftSecond % 60);\r\n    return String(iHour >= 10 ? iHour : \"0\" + iHour) + \":\" + String(iMin >= 10 ? iMin : \"0\" + iMin)\r\n        + \":\" + String(iSecond >= 10 ? iSecond : \"0\" + iSecond)\r\n}\r\nexport function setTextTime(iLeftSecond: number): string {\r\n    if (iLeftSecond < 86400) {\r\n        // 小于1天\r\n        return setTextTime_2(iLeftSecond);\r\n    } else {\r\n        return getTimeTXT(iLeftSecond);\r\n    }\r\n}\r\nexport function setTextTime_3(iLeftSecond: number) {\r\n    let iMin = Math.floor(iLeftSecond % (60 * 60) / 60);\r\n    let iSecond = Math.floor(iLeftSecond % 60);\r\n    return String(iMin >= 10 ? iMin : \"0\" + iMin) + \":\" + String(iSecond >= 10 ? iSecond : \"0\" + iSecond)\r\n}\r\nexport function setTextTime_4(iLeftSecond: number) {\r\n    let day = Math.floor(iLeftSecond / 86400)\r\n    let dayleft = iLeftSecond % 86400\r\n    let iHour = Math.floor(dayleft / (60 * 60));\r\n    let iMin = Math.floor(dayleft % (60 * 60) / 60);\r\n    let iSecond = Math.floor(dayleft % 60);\r\n    return String(day >= 10 ? day : \"0\" + day) + \":\" + String(iHour >= 10 ? iHour : \"0\" + iHour) + \":\" + String(iMin >= 10 ? iMin : \"0\" + iMin)\r\n        + \":\" + String(iSecond >= 10 ? iSecond : \"0\" + iSecond)\r\n}\r\n/* spine置灰 */\r\nexport function setGraySpine(sp: sp.Skeleton, isGray: boolean) {\r\n    let nowMaterial = sp.customMaterial;\r\n    if (isGray) {\r\n        if (nowMaterial && nowMaterial[\"effectAsset\"] && nowMaterial[\"effectAsset\"].name == \"SpineGray\") {\r\n            return\r\n        }\r\n        let mat: Material = builtinResMgr.get(`ui-sprite-gray-material`);\r\n        sp.customMaterial = mat\r\n    } else {\r\n        if (nowMaterial && nowMaterial[\"effectAsset\"] && nowMaterial[\"effectAsset\"].name == \"builtin-spine\") {\r\n            return\r\n        }\r\n        let mat: Material = builtinResMgr.get(`default-spine-material`);\r\n        sp.customMaterial = mat;\r\n    }\r\n}\r\n// 数组中的元素按照职业排序[2, 1, 4, 3, 5]\r\nexport function sortByVocation(arr: number[]) {\r\n    return arr.sort((a, b) => {\r\n        const heroTabA = tab.getData().HeroTableById.getValue(a);\r\n        const heroTabB = tab.getData().HeroTableById.getValue(b);\r\n        return heroTabA.Class - heroTabB.Class;\r\n    })\r\n}\r\n/* 判断各种抽卡材料不足的情况处理 */\r\nexport function gachaReplace(gachaId: number, key: RecruitType, cb: Function): boolean {\r\n    const gachaTab = tab.getData().GachaTableById.getValue(gachaId);\r\n    const itemId = gachaTab.ItemId;\r\n    const count = gachaTab.ItemCount;\r\n    const itemTab = tab.getData().ItemTableById.getValue(itemId);\r\n    const itemCount = ItemData.ins.getCount(itemId);\r\n    /* 如果道具不足的情况下判断是否有替代消耗 */\r\n    const addCount = count - itemCount;\r\n    // 转化为代替物\r\n    const addItemId = gachaTab.SubItemId;\r\n    if (!addItemId) {\r\n        ShowItemNotEnoughTips(itemId);\r\n        return false\r\n    }\r\n    const addItemTab = tab.getData().ItemTableById.getValue(addItemId);\r\n    const addItemNeedCount = addCount * gachaTab.SubItemBaseCount;\r\n    /* 如果拥有的代替物数量够显示弹窗 */\r\n    const havaAddItemCount = ItemData.ins.getCount(addItemId);\r\n    // 是否需要弹窗\r\n    if (!checkSameDay(key)) {\r\n        const tipsStr = LangMgr.getCombineString(\"Tips_recruit_resource_1\", [LangMgr.getLab(itemTab.Name), addItemNeedCount, LangMgr.getLab(addItemTab.Name)]);\r\n        CommonTipsPop.create(tipsStr, ((val) => {\r\n            if (val) {\r\n                if (havaAddItemCount < addItemNeedCount) {\r\n                    ShowItemNotEnoughTips(addItemId);\r\n                    return false\r\n                } else {\r\n                    cb();\r\n                }\r\n            }\r\n        }), {\r\n            gacha: key\r\n        })\r\n    } else {\r\n        if (havaAddItemCount >= addItemNeedCount) {\r\n            return true\r\n        } else {\r\n            // ShowItemNotEnoughTips(itemId);\r\n            // 跳转到钻石界面\r\n            if (addItemId === 1) {\r\n                UIMgr.ins.show({ viewName: ViewName.DiamondBuyPop })\r\n            } else {\r\n                ShowItemNotEnoughTips(itemId);\r\n            }\r\n            return false\r\n        }\r\n    }\r\n}\r\n// 判断购买的弹窗\r\nexport function dailyBuyShop(itemId: number, CostCount: number, getItemId: number, key: string, cb: Function, recuitType?: RecruitType) {\r\n    const itemTab = tab.getData().ItemTableById.getValue(itemId);\r\n    const itemTabName = LangMgr.getLab(itemTab.Name);\r\n\r\n    const itemGetTab = tab.getData().ItemTableById.getValue(getItemId);\r\n    //let itemGetTabName = \"物品\"\r\n    let itemGetTabName = \"\"\r\n    if (itemGetTab) {\r\n        itemGetTabName = LangMgr.getLab(itemGetTab.Name);\r\n    }\r\n\r\n    const itemCount = ItemData.ins.getCount(itemId);\r\n    const type = recuitType ? recuitType : RecruitType.BuyDailyShop\r\n    if (!checkSameDay(type)) {\r\n        const tipsStr = LangMgr.getCombineString(key, [itemTabName, CostCount, itemGetTabName]);\r\n        CommonTipsPop.create(tipsStr, ((val) => {\r\n            if (val) {\r\n                if (itemCount < CostCount) {\r\n                    ShowItemNotEnoughTips(itemId);\r\n                } else {\r\n                    cb();\r\n                }\r\n            }\r\n        }), {\r\n            gacha: type\r\n        })\r\n    } else {\r\n        if (itemCount < CostCount) {\r\n            ShowItemNotEnoughTips(itemId);\r\n        } else {\r\n            cb();\r\n        }\r\n    }\r\n}\r\n/* 判断是否花费材料的购买处理 */\r\nexport function ConsumptionToPurchase(itemId: number, CostCount: number, key: string, cb: Function) {\r\n    // const itemTab = tab.getData().ItemTableById.getValue(itemId);\r\n    const itemCount = ItemData.ins.getCount(itemId);\r\n    const tipsStr = LangMgr.getCombineString(key, [CostCount]);\r\n    CommonTipsPop.create(tipsStr, ((val) => {\r\n        if (val) {\r\n            if (itemCount < CostCount) {\r\n                ShowItemNotEnoughTips(itemId);\r\n            } else {\r\n                cb();\r\n            }\r\n        }\r\n    }))\r\n}\r\n/* 检查用户选择时间是否是同一天 */\r\nexport function checkSameDay(key: RecruitType): boolean {\r\n    var currentDate = new Date();\r\n    var today = currentDate.toDateString();\r\n    var dismissTime = Func.getItem(\"dismissTime\" + key);\r\n    if (!dismissTime || dismissTime !== today) {\r\n        return false\r\n    }\r\n    return true;\r\n}\r\nexport function getPlayInfoById(id: string) {\r\n    let msg = new proto.Msg_GetSimpleRoleReq();\r\n    msg.roleId = id;\r\n    Net.Send(proto.Ptl.GetSimpleRoleReq, msg)\r\n}\r\n// 处理战斗力\r\nexport function handleNumerText(_score: number | Long): string {\r\n    const score = Number(_score);\r\n    if (score >= 100000000) {\r\n        let value = String(score / 100000000);\r\n        // log(\"valeu==\",value);\r\n        let index = value.indexOf(\".\");\r\n        if (index == -1) {\r\n            return value + \"亿\";\r\n        } else {\r\n            index += 3;\r\n        }\r\n        // log(\"score==\",score,\"===valeu==\",value,\"==\",index);\r\n        return value.slice(0, index) + \"亿\"\r\n    } else if (score > 10000) {\r\n        let value = String(score / 10000);\r\n        let index = value.indexOf(\".\");\r\n        if (index == -1) {\r\n            return value + \"萬\";\r\n        } else {\r\n            index += 3;\r\n        }\r\n        // log(\"score==\",score,\"===valeu==\",value,\"==\",index);\r\n        return value.slice(0, index) + \"萬\"\r\n    }\r\n    else {\r\n        return String(score)\r\n    }\r\n}\r\n// 计算距离下周一的倒计时\r\nexport function getTimeUntilNextWeek() {\r\n    const now = new Date();\r\n    const dayOfWeek = now.getDay();\r\n    const daysUntilNextMonday = (dayOfWeek === 0) ? 1 : 8 - dayOfWeek;\r\n    const nextMonday = new Date(now);\r\n    nextMonday.setDate(now.getDate() + daysUntilNextMonday);\r\n    const millisecondsUntilNextMonday = nextMonday.getTime() - now.getTime();\r\n    return Math.floor(millisecondsUntilNextMonday / 1000);\r\n}\r\n// 计算距离下个月的倒计时\r\nexport function getTimeUntilNextMonth() {\r\n    const now = new Date();\r\n    const year = now.getFullYear();\r\n    const month = now.getMonth();\r\n    const nextMonth = (month === 11) ? 0 : month + 1;\r\n    const nextMonthYear = (month === 11) ? year + 1 : year;\r\n    const firstDayOfNextMonth = new Date(nextMonthYear, nextMonth, 1);\r\n    const millisecondsUntilNextMonth = firstDayOfNextMonth.getTime() - now.getTime();\r\n    return Math.floor(millisecondsUntilNextMonth / 1000)\r\n}\r\n// 计算距离明天的倒计时\r\nexport function getTimeUntilNextDay() {\r\n    const now = new Date();\r\n    const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);\r\n    const millisecondsUntilTomorrow = tomorrow.getTime() - now.getTime();\r\n    return Math.floor(millisecondsUntilTomorrow / 1000);\r\n}\r\n/* 创建hero spine */\r\nexport async function createAnimation(animNode: Node, animId: number, addAnimId?: number, cb?: Function) {\r\n    const animaData: tab.AnimationTable = tab.getData().AnimationTableById.getValue(animId);\r\n    const path = animaData.Path;\r\n    if (animaData.Scale.length > 0) {\r\n        animNode.scale = new Vec3(animaData.Scale[0], animaData.Scale[1], 1)\r\n    }\r\n    if (path) {\r\n        switch (animaData.Type) {\r\n            // 如果当前是spine\r\n            case tab.AnimationType.AnimationType_SkeletonData:\r\n                let spine = animNode.getComponent(sp.Skeleton);\r\n                if (!spine) {\r\n                    spine = animNode.addComponent(sp.Skeleton);\r\n                }\r\n                await LoadResAsync(path, sp.SkeletonData).then((spData: sp.SkeletonData) => {\r\n                    if (spine.isValid) {\r\n                        spine.skeletonData = spData\r\n                        spine.premultipliedAlpha = false\r\n                        spine.enableBatch = true\r\n                        spine.setAnimation(0, animaData.AnimationName, animaData.Loop);\r\n                        if (addAnimId) {\r\n                            const addAnimaData = tab.getData().AnimationTableById.getValue(addAnimId);\r\n                            spine.addAnimation(0, addAnimaData.AnimationName, addAnimaData.Loop);\r\n                        }\r\n                        addAnimId === 0 ? spine.timeScale = 0 : spine.timeScale = 1\r\n                    }\r\n                })\r\n                break;\r\n            case tab.AnimationType.AnimationType_Plist:\r\n                // 如果是plist\r\n                let spr = animNode.getComponent(Sprite);\r\n                if (!spr) {\r\n                    spr = animNode.addComponent(Sprite);\r\n                }\r\n                let animCom = animNode.getComponent(Animation);\r\n                if (!animCom) {\r\n                    animCom = animNode.addComponent(Animation);\r\n                }\r\n                await LoadResAsync(path, SpriteAtlas).then((atlas: SpriteAtlas) => {\r\n                    if (spr.isValid && animCom.isValid) {\r\n                        spr.sizeMode = Sprite.SizeMode.RAW;\r\n                        spr.type = Sprite.Type.SIMPLE;\r\n                        spr.trim = false;\r\n                        const anim_clip = AnimationClip.createWithSpriteFrames(Avatar.setPlistArray(atlas, animaData), animaData.FPS);\r\n                        anim_clip.name = animaData.AnimationName ? animaData.AnimationName : \"defaultAnim\";\r\n                        anim_clip.wrapMode = animaData.Loop ? AnimationClip.WrapMode.Loop : AnimationClip.WrapMode.Normal;\r\n                        animCom.defaultClip = anim_clip;\r\n                        animCom.play(anim_clip.name);\r\n                        if (!animaData.Loop) {\r\n                            animCom.on(Animation.EventType.FINISHED, e => {\r\n                                cb();\r\n                            })\r\n                        }\r\n                    }\r\n                })\r\n                break;\r\n            case tab.AnimationType.AnimationType_SpriteFrame:\r\n                let _spr = animNode.getComponent(Sprite);\r\n                if (!_spr) {\r\n                    _spr = animNode.addComponent(Sprite);\r\n                }\r\n                if (animNode.getComponent(Animation)) {\r\n                    animNode.getComponent(Animation).destroy();\r\n                }\r\n                _spr.spriteFrame = null;\r\n                await LoadResAsync(path, SpriteFrame).then((sf: SpriteFrame) => {\r\n                    if (_spr.isValid) {\r\n                        _spr.sizeMode = Sprite.SizeMode.RAW;\r\n                        _spr.type = Sprite.Type.SIMPLE;\r\n                        _spr.trim = false;\r\n                        _spr.spriteFrame = sf;\r\n                    }\r\n                })\r\n                break\r\n            default:\r\n                break;\r\n        }\r\n    } else {\r\n        log(`cocos animation 路径不存在`)\r\n    }\r\n}\r\n\r\n/**\r\n    获取随机整数\r\n    @param min 随机的最小值\r\n    @param max 随机的最大值(不包括该值)\r\n    @returns 返回一个整数，范围是 [min, max)\r\n*/\r\nexport function getRandomInt(min: number, max: number): number {\r\n    min = Math.ceil(min);\r\n    max = Math.floor(max);\r\n    return Math.floor(Math.random() * (max - min)) + min;\r\n}\r\n\r\n/** 根据开始时间的秒数获取已经过了几天(只要过零点就加1天)*/\r\nexport function getPassDaysByZero(startSeconds: number): number {\r\n    let days: number = 0;\r\n    let nowSeconds: number = RoleData.ins.getServerUtcTime();\r\n    if (nowSeconds > startSeconds) {\r\n        let m_dateHelp: Date = new Date();\r\n        m_dateHelp.setTime(startSeconds * 1000);\r\n        m_dateHelp.setHours(0);\r\n        m_dateHelp.setMinutes(0);\r\n        m_dateHelp.setSeconds(0);\r\n        let t_startZeroSeconds: number = m_dateHelp.getTime();\r\n        t_startZeroSeconds = (t_startZeroSeconds) / 1000;\r\n        days = ((nowSeconds - t_startZeroSeconds) / 86400);\r\n    }\r\n    return Math.floor(days);\r\n}\r\nexport function isChEngNumber(str: string) {\r\n    if (/^[a-zA-Z0-9\\u4E00-\\u9FA5]+$/.test(str)) {\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n}\r\nexport function sendChatToGuild(type: tab.ChatBreviaryType) {\r\n    const channelId = ChatData.ins.getChanneIdByType(proto.ChatChannelType.Guild);\r\n    let str = \"\"\r\n    if (type === tab.ChatBreviaryType.ChatBreviaryType_GuildGiftLow) {\r\n        str = LangMgr.getLab(\"chatbreviary_text_2\");\r\n    } else if (type === tab.ChatBreviaryType.ChatBreviaryType_GuildGiftBargain) {\r\n        str = LangMgr.getCombineString(\"chatbreviary_text_1\", [RoleData.ins.name]);\r\n    }\r\n    const clientCustomNotice = new proto.ChatMessage.ClientCustomNotice()\r\n    clientCustomNotice.noticeType = type\r\n    clientCustomNotice.content = str;\r\n    ChatControl.ins.requestSendChatMessage(channelId, str, clientCustomNotice);\r\n}\r\nexport function refreshFlagImg(flagId: number, sp: Sprite) {\r\n    flagId = flagId ? flagId : 1;\r\n    const flagtab = tab.getData().GuildFlagTableById.getValue(flagId);\r\n    sp.setTexture(flagtab.IconUrl);\r\n}\r\nexport function formatTimestamp(timestamp: number) {\r\n    // 创建日期对象，时间戳需要是毫秒\r\n    let date = new Date(timestamp * 1000);\r\n\r\n    // 获取日期中的月、日、小时和分钟\r\n    let month = date.getMonth() + 1;  // 月份从0开始，所以要加1\r\n    let day = date.getDate();\r\n    let hours = date.getHours();\r\n    let minutes = date.getMinutes();\r\n\r\n    // 补0处理，如果是个位数\r\n    let s_month = month < 10 ? '0' + month : month;\r\n    let s_day = day < 10 ? '0' + day : day;\r\n    let s_hours = hours < 10 ? '0' + hours : hours;\r\n    let s_minutes = minutes < 10 ? '0' + minutes : minutes;\r\n\r\n    // 返回格式化后的字符串\r\n    return `${s_month}-${s_day} ${s_hours}:${s_minutes}`;\r\n}\r\nexport function ButtonLock(lockTime: number = 0.3, callBackFun?: Function): any {\r\n    return function (target: any, propertyKey: string, descriptor: PropertyDescriptor) {\r\n        let oldFun: Function = descriptor.value;\r\n        let isLock: boolean = false;\r\n        descriptor.value = function (...args: any[]) {\r\n            if (isLock) {\r\n                callBackFun?.()\r\n                return\r\n            }\r\n            isLock = true;\r\n\r\n            setTimeout(() => {\r\n                isLock = false\r\n            }, lockTime * 1000);\r\n            oldFun.apply(this, args);\r\n        }\r\n        return descriptor\r\n    }\r\n}\r\n/**\r\n * 修正触摸坐标\r\n * 主要处理屏幕坐标系与设计尺寸不一致导致转换的位置信息错误\r\n * @param pos \r\n */\r\nexport function AmendmentEventLocation(pos: Vec3) {\r\n    let newpos = new Vec3(pos)\r\n    newpos.y -= (view.getVisibleSize().height - view.getDesignResolutionSize().height) / 2\r\n    return newpos\r\n}\r\n/* 根据手机分辨率处理节点 */\r\nexport function getLocationInResolution(pos) {\r\n    let dSize = view.getDesignResolutionSize();\r\n    let desVec = new Vec2(dSize.width, dSize.height);\r\n    let winVec = new Vec2(view.getVisibleSize().width, view.getVisibleSize().height);\r\n    return pos.subtract(winVec.subtract(desVec));\r\n}\r\nexport function moveZeroes(nums) {\r\n    let index = 0;  // 指针，用来遍历非零元素\r\n\r\n    // 遍历整个数组\r\n    for (let i = 0; i < nums.length; i++) {\r\n        // 如果当前元素不是0\r\n        if (nums[i] !== 0) {\r\n            // 将非零元素放到当前指针的位置\r\n            nums[index] = nums[i];\r\n            index++;\r\n        }\r\n    }\r\n\r\n    // 从指针位置开始，填充0\r\n    for (let i = index; i < nums.length; i++) {\r\n        nums[i] = 0;\r\n    }\r\n\r\n    return nums;\r\n}\r\n// 深拷贝\r\nexport function deepClone(obj) {\r\n    if (obj === null || typeof obj !== 'object') {\r\n        return obj; // 如果是基本类型，直接返回\r\n    }\r\n\r\n    // 处理数组\r\n    if (Array.isArray(obj)) {\r\n        let arrCopy = [];\r\n        for (let i = 0; i < obj.length; i++) {\r\n            arrCopy[i] = deepClone(obj[i]);\r\n        }\r\n        return arrCopy;\r\n    }\r\n\r\n    // 处理对象\r\n    let objCopy = {};\r\n    for (let key in obj) {\r\n        if (obj.hasOwnProperty(key)) {\r\n            objCopy[key] = deepClone(obj[key]);\r\n        }\r\n    }\r\n    return objCopy;\r\n}"]}