{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/activity/wonderfulActivity/CycleGiftItem.ts"],"names":["_decorator","Component","Label","Node","Sprite","Vec3","tab","dailyBuyShop","proto","Net","MallDataMgr","ItemPoolMgr","ItemInfo","AdMgr","PayControl","ShowTips","LangMgr","MALLNAME","ChannelMgr","ccclass","property","CycleGiftItem","mallItemTab","_view_name","DailyGift","boughtCount","_CostItemId","_CostItemNum","initData","viewData","viewName","setStaticView","setAsyncView","awards","GetItemIds","awardNums","GetItemNum","firstAward","firstAwardNum","otherAward","otherAwardNums","i","length","push","firstInfo","itemId","num","ins","createRewadItem","node_first_item","setPosition","node_layout","destroyAllChildren","awardInfo","RechargeId","rechargeTab","getData","RechargeTableById","getValue","lbl_price","node_price_btn","getChildByName","getComponent","string","getSdkRechargeShowPrice","IconUrl","sp_chaozhi","node","active","setTexture","getFixedShopData","get","Id","node_ads_btn","CostType","MallCostType","MallCostType_Advert","MallCostType_Recharge","node_diamonds","MallCostType_CostItem","maxAdTimes","getAdCountMaxByType","AdType","curAdTimes","getAdCountByType","lbl_limit_time","String","node_nothing","LimitCount","CostItemIds","CostItemNum","lbl_diamond","itemTab","ItemTableById","sp_diamond","Icon","clickBuy","console","log","sendMsg","msg","Msg_BuyFixedShopCommodityReq","commodityId","Send","Ptl","BuyFixedShopCommodityReq","clickFreeBuyItem","self","getLab","playVideoAd","clicRMBkBuy","requestPay","set"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, Sprite, Vec3 } from 'cc';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { dailyBuyShop } from '../../../utils/GameUtil';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../../net/Net';\r\nimport { MallDataMgr } from '../../shop/MallDataMgr';\r\nimport { ItemPoolMgr } from '../../item/ItemPoolMgr';\r\nimport { ItemInfo } from '../../item/ItemInfo';\r\nimport { AdMgr } from '../../AdMgr';\r\nimport { PayControl } from '../../pay/PayControl';\r\nimport { ShowTips } from '../../../mgr/UIMgr';\r\nimport { LangMgr } from '../../../mgr/LangMgr';\r\nimport { MALLNAME } from '../../../../Common/script/EnumTypeMgr';\r\nimport { ChannelMgr } from '../../../../channel/ChannelMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('CycleGiftItem')\r\nexport class CycleGiftItem extends Component {\r\n    @property(Node)\r\n    node_first_item: Node = null;\r\n    @property(Node)\r\n    node_layout: Node = null;\r\n    @property(Node)\r\n    node_price_btn: Node = null;\r\n    @property(Node)\r\n    node_ads_btn: Node = null;\r\n    @property(Label)\r\n    lbl_limit_time: Label = null;\r\n    @property(Node)\r\n    node_nothing: Node = null;\r\n    @property(Sprite)\r\n    sp_chaozhi: Sprite = null;\r\n\r\n    @property(Node)\r\n    node_diamonds: Node = null;\r\n    @property(Label)\r\n    lbl_diamond: Label = null;\r\n    @property(Sprite)\r\n    sp_diamond: Sprite = null;\r\n\r\n    private mallItemTab: tab.MallItemTabe = null;\r\n    private _view_name: MALLNAME = MALLNAME.DailyGift;\r\n    private boughtCount: number = 0;\r\n    private _CostItemId: number = 0;\r\n    private _CostItemNum: number = 0;\r\n    initData(viewData, viewName: MALLNAME) {\r\n        //   根据商品id设置item\r\n        this._view_name = viewName;\r\n        this.mallItemTab = viewData;\r\n        //先创建首个奖励\r\n        this.setStaticView();\r\n        this.setAsyncView();\r\n    }\r\n    setStaticView() {\r\n        const awards = this.mallItemTab.GetItemIds;\r\n        const awardNums = this.mallItemTab.GetItemNum;\r\n        const firstAward = awards[0];\r\n        const firstAwardNum = awardNums[0];\r\n        const otherAward = [];\r\n        const otherAwardNums = [];\r\n        for (let i = 1; i < awards.length; i++) {\r\n            otherAward.push(awards[i]);\r\n            otherAwardNums.push(awardNums[i]);\r\n        }\r\n        const firstInfo = new ItemInfo();\r\n        firstInfo.itemId = firstAward;\r\n        firstInfo.num = firstAwardNum;\r\n        ItemPoolMgr.ins.createRewadItem(firstInfo, this.node_first_item);\r\n        if (otherAward.length === 0) {\r\n            this.node_first_item.setPosition(new Vec3(0, -135, 0));\r\n        }\r\n        this.node_layout.destroyAllChildren();\r\n        for (let i = 0; i < otherAward.length; i++) {\r\n            const awardInfo = new ItemInfo();\r\n            awardInfo.itemId = otherAward[i];\r\n            awardInfo.num = otherAwardNums[i];\r\n            ItemPoolMgr.ins.createRewadItem(awardInfo, this.node_layout);\r\n        }\r\n        // 显示价格\r\n        if (this.mallItemTab.RechargeId) {\r\n            const rechargeTab = tab.getData().RechargeTableById.getValue(this.mallItemTab.RechargeId);\r\n            const lbl_price = this.node_price_btn.getChildByName(\"price_txt\").getComponent(Label);\r\n            lbl_price.string = ChannelMgr.getSdkRechargeShowPrice(rechargeTab);\r\n        }\r\n        if (this.mallItemTab.IconUrl) {\r\n            this.sp_chaozhi.node.active = true;\r\n            this.sp_chaozhi.setTexture(this.mallItemTab.IconUrl)\r\n        } else {\r\n            this.sp_chaozhi.node.active = false;\r\n        }\r\n    }\r\n    setAsyncView() {\r\n        this.boughtCount = MallDataMgr.ins.getFixedShopData(this._view_name).get(this.mallItemTab.Id);\r\n        this.node_ads_btn.active = this.mallItemTab.CostType === tab.MallCostType.MallCostType_Advert;\r\n        this.node_price_btn.active = this.mallItemTab.CostType === tab.MallCostType.MallCostType_Recharge;\r\n        this.node_diamonds.active = this.mallItemTab.CostType === tab.MallCostType.MallCostType_CostItem;\r\n        if (this.node_ads_btn.active) {\r\n            // 当前是广告 显示广告次数跟广告剩余次数\r\n            const maxAdTimes = AdMgr.ins.getAdCountMaxByType(this.mallItemTab.AdType);\r\n            const curAdTimes = AdMgr.ins.getAdCountByType(this.mallItemTab.AdType);\r\n            this.lbl_limit_time.string = String(maxAdTimes - curAdTimes);\r\n            this.node_nothing.active = curAdTimes >= maxAdTimes\r\n        } else if (this.node_price_btn.active) {\r\n            this.lbl_limit_time.string = String(this.mallItemTab.LimitCount - this.boughtCount);\r\n            this.node_nothing.active = this.boughtCount >= this.mallItemTab.LimitCount\r\n        } else {\r\n            this._CostItemId = this.mallItemTab.CostItemIds[0];\r\n            this._CostItemNum = this.mallItemTab.CostItemNum[0];\r\n            this.lbl_diamond.string = String(this._CostItemNum);\r\n            const itemTab = tab.getData().ItemTableById.getValue(this._CostItemId);\r\n            this.sp_diamond.setTexture(itemTab.Icon);\r\n            this.lbl_limit_time.string = String(this.mallItemTab.LimitCount - this.boughtCount);\r\n            this.node_nothing.active = this.boughtCount >= this.mallItemTab.LimitCount\r\n        }\r\n    }\r\n    // 道具购买\r\n    clickBuy() {\r\n        if (this.boughtCount >= this.mallItemTab.LimitCount) {\r\n            console.log(\"没有次数了\")\r\n            return\r\n        }\r\n        const sendMsg = () => {\r\n            let msg = new proto.Msg_BuyFixedShopCommodityReq();\r\n            msg.commodityId = this.mallItemTab.Id;\r\n            msg.num = 1;\r\n            Net.Send(proto.Ptl.BuyFixedShopCommodityReq, msg);\r\n        }\r\n        if (this._CostItemId) {\r\n            // 花钻石\r\n            dailyBuyShop(this._CostItemId, this._CostItemNum, -1, \"Tips_common_buy\", () => {\r\n                sendMsg();\r\n            })\r\n        } else {\r\n            //免费 判断是否有广告次数\r\n            sendMsg();\r\n        }\r\n    }\r\n    clickFreeBuyItem() {\r\n        var self = this;\r\n        const maxAdTimes = AdMgr.ins.getAdCountMaxByType(this.mallItemTab.AdType);\r\n        const curAdTimes = AdMgr.ins.getAdCountByType(this.mallItemTab.AdType);\r\n        if (curAdTimes >= maxAdTimes) {\r\n            ShowTips(LangMgr.getLab('Tips_timeshortage'));\r\n            return\r\n        }\r\n\r\n        AdMgr.ins.playVideoAd(this.mallItemTab.AdType, () => {\r\n            let msg = new proto.Msg_BuyFixedShopCommodityReq();\r\n            msg.commodityId = self.mallItemTab.Id;\r\n            msg.num = 1;\r\n            Net.Send(proto.Ptl.BuyFixedShopCommodityReq, msg);\r\n        }, false)\r\n    }\r\n    clicRMBkBuy() {\r\n        var self = this;\r\n        if (self.boughtCount >= self.mallItemTab.LimitCount) {\r\n            ShowTips(LangMgr.getLab('Tips_timeshortage'));\r\n            return\r\n        }\r\n        PayControl.ins.requestPay(self.mallItemTab.RechargeId, () => {\r\n            MallDataMgr.ins.getFixedShopData(self._view_name).set(self.mallItemTab.Id, self.boughtCount + 1);\r\n            self.setAsyncView();\r\n        })\r\n    }\r\n}\r\n\r\n\r\n"]}