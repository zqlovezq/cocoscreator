{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/base/move/bullet/BulletMoveRound.ts"],"names":["BulletMoveRound","Vec3","BulletMoveLine","tempPos","tempPos1","roundCount","totalCount","oneWayTime","waitingTime","setLiftTime","t","abs","info","configTab","Round","checkFlip","velocityFlip","updateFrame","dt","Math","max","checkRotate","getPassTimeRoundCount","floor","passTime"],"mappings":";;;qGAQaA,e;;;;;;;;;;;;;;;AARJC,MAAAA,I,OAAAA,I;;AAEAC,MAAAA,c,iBAAAA,c;;;;;;;;;AAGHC,MAAAA,O,GAAU,IAAIF,IAAJ,E;AACVG,MAAAA,Q,GAAW,IAAIH,IAAJ,E;AACjB;;iCACaD,e,GAAN,MAAMA,eAAN;AAAA;AAAA,4CAA6C;AAAA;AAAA;AAAA,eAChDK,UADgD;AAC7B;AAD6B,eAEhDC,UAFgD;AAE7B;AAF6B,eAGhDC,UAHgD;AAG7B;AAH6B,eAIhDC,WAJgD,GAI1B,CAJ0B;AAAA;;AAIvB;AAEzBC,QAAAA,WAAW,CAACC,CAAD,EAAY;AACnB,eAAKH,UAAL,GAAkBG,CAAlB;AACA,eAAKL,UAAL,GAAkB,CAAlB;AACA,eAAKC,UAAL,GAAkB,KAAKK,GAAL,CAASC,IAAT,CAAcC,SAAd,CAAwBC,KAAxB,CAA8B,CAA9B,IAAmC,CAArD;AACAJ,UAAAA,CAAC,GAAGA,CAAC,GAAG,KAAKJ,UAAb;AACA,gBAAMG,WAAN,CAAkBC,CAAlB;AACH;;AAEDK,QAAAA,SAAS,GAAG;AACR,cAAI,KAAKP,WAAL,IAAoB,CAAxB,EAA2B;AACvB,iBAAKG,GAAL,CAASK,YAAT;AACH;AACJ;;AAEDC,QAAAA,WAAW,CAACC,EAAD,EAAmB;AAC1B,cAAI,KAAKV,WAAL,GAAmB,CAAvB,EAA0B;AACtB,iBAAKA,WAAL,IAAoBU,EAApB;AACA,iBAAKV,WAAL,GAAmBW,IAAI,CAACC,GAAL,CAAS,KAAKZ,WAAd,EAA2B,CAA3B,CAAnB;AACA,iBAAKO,SAAL;AACA,iBAAKM,WAAL;AACA;AACH;;AACD,gBAAMJ,WAAN,CAAkBC,EAAlB;;AAEA,cAAI,KAAKb,UAAL,IAAmB,KAAKiB,qBAAL,EAAvB,EAAqD;AACjD,iBAAKjB,UAAL,GAAkB,KAAKiB,qBAAL,EAAlB;;AACA,gBAAI,KAAKjB,UAAL,IAAmB,KAAKC,UAA5B,EAAwC;AACpC;AACH;;AACD,iBAAKE,WAAL,GAAmB,KAAKG,GAAL,CAASC,IAAT,CAAcC,SAAd,CAAwBC,KAAxB,CAA8B,CAA9B,CAAnB;AACA,iBAAKC,SAAL;AACH;AACJ;;AACDO,QAAAA,qBAAqB,GAAG;AACpB,iBAAOH,IAAI,CAACI,KAAL,CAAW,KAAKC,QAAL,GAAgB,KAAKjB,UAAhC,CAAP;AACH;;AAzC+C,O","sourcesContent":["import { Vec3, math, v2, v3 } from \"cc\";\nimport { AbsMoveType, BulletMove } from \"../AbsMove\";\nimport { BulletMoveLine } from \"./BulletMoveLine\";\nimport { CDTime } from \"../../cd/CDTime\";\n\nconst tempPos = new Vec3();\nconst tempPos1 = new Vec3();\n/** 回旋--直线 */\nexport class BulletMoveRound extends BulletMoveLine {\n    roundCount: number //回旋次数\n    totalCount: number //总次数\n    oneWayTime: number //表里配置的为单程时间\n    waitingTime: number = 0  //等待时间\n\n    setLiftTime(t: number) {\n        this.oneWayTime = t\n        this.roundCount = 0\n        this.totalCount = this.abs.info.configTab.Round[0] * 2\n        t = t * this.totalCount\n        super.setLiftTime(t)\n    }\n\n    checkFlip() {\n        if (this.waitingTime == 0) {\n            this.abs.velocityFlip()\n        }\n    }\n\n    updateFrame(dt: number): void {\n        if (this.waitingTime > 0) {\n            this.waitingTime -= dt\n            this.waitingTime = Math.max(this.waitingTime, 0)\n            this.checkFlip()\n            this.checkRotate()\n            return\n        }\n        super.updateFrame(dt)\n\n        if (this.roundCount != this.getPassTimeRoundCount()) {\n            this.roundCount = this.getPassTimeRoundCount()\n            if (this.roundCount == this.totalCount) {\n                return\n            }\n            this.waitingTime = this.abs.info.configTab.Round[1]\n            this.checkFlip()\n        }\n    }\n    getPassTimeRoundCount() {\n        return Math.floor(this.passTime / this.oneWayTime)\n    }\n}"]}