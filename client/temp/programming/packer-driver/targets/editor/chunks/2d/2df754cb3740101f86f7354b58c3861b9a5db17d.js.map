{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/role/roleInfo/RoleInfoDecorationsItem.ts"],"names":["_decorator","Component","Node","Sprite","tab","RoleData","RedMgr","RedDotType","HEADTYPE","ccclass","property","RoleInfoDecorationsItem","itemId","roleInfoView","onLoad","node_select","active","initHeadData","view","itemHeadTab","getData","ItemTableById","getValue","headImg","setTexture","Icon","ins","avatarInfo","headFrame","headFrameImg","node_use","headIcon","node_lock","checkHeadIsHave","headIconRed","isRed","Head_Icon_Red","node_red","headIconItemRed","initFrameData","itemFrameTab","checkFrameIsHave","headFrameRed","headFrameItemRed","initData","headId","headFrameId","clickSelectHead","selectHead","default_view","HEADICON","clientData","newHeadIcon","replace","setClientData","HEADFRAME","newHeadFrame","refreshEvent","unSelectHead"],"mappings":"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","sourcesContent":["import { _decorator, Component, log, Node, Sprite } from 'cc';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { RoleData } from '../RoleData';\r\nimport { RoleInfoDecorationsPop } from './RoleInfoDecorationsPop';\r\nimport { RedMgr } from '../../../mgr/RedMgr';\r\nimport { RedDotType } from '../../../red/RedDotType';\r\nimport { HEADTYPE } from '../../../../Common/script/EnumTypeMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('RoleInfoDecorationsItem')\r\nexport class RoleInfoDecorationsItem extends Component {\r\n    @property(Sprite)\r\n    headImg: Sprite = null;\r\n    @property(Sprite)\r\n    headFrameImg: Sprite = null;\r\n    @property(Node)\r\n    node_use: Node = null;\r\n    @property(Node)\r\n    node_select: Node = null;\r\n    @property(Node)\r\n    node_lock: Node = null;\r\n    @property(Node)\r\n    node_red: Node = null;\r\n    public itemId: number = 0;\r\n    private roleInfoView: RoleInfoDecorationsPop = null;\r\n    protected onLoad(): void {\r\n        this.node_select.active = false;\r\n    }\r\n    initHeadData(itemId: number, view: RoleInfoDecorationsPop) {\r\n        this.itemId = itemId;\r\n        this.roleInfoView = view;\r\n        // this.headImg.node.parent.active = false;\r\n        // this.headFrameImg.node.parent.active = false;\r\n        const itemHeadTab = tab.getData().ItemTableById.getValue(itemId);\r\n        if (itemHeadTab) {\r\n            // this.headImg.node.parent.active = true;\r\n            this.headImg.setTexture(itemHeadTab.Icon);\r\n        }\r\n        if (RoleData.ins.avatarInfo.headFrame) {\r\n            this.headFrameImg.setTexture(tab.getData().ItemTableById.getValue(RoleData.ins.avatarInfo.headFrame).Icon);\r\n        }\r\n        this.node_use.active = itemId === RoleData.ins.avatarInfo.headIcon;\r\n        this.node_lock.active = !view.checkHeadIsHave(itemId);\r\n\r\n        const headIconRed = RedMgr.ins.isRed(RedDotType.Head_Icon_Red, \"0\");\r\n        if (!headIconRed) {\r\n            this.node_red.active = false;\r\n        } else {\r\n            const headIconItemRed = RedMgr.ins.isRed(RedDotType.Head_Icon_Red, \"0\", \"\" + itemId);\r\n            this.node_red.active = headIconItemRed;\r\n        }\r\n    }\r\n    initFrameData(itemId: number, view: RoleInfoDecorationsPop) {\r\n        this.itemId = itemId;\r\n        this.roleInfoView = view;\r\n        // this.headImg.node.parent.active = false;\r\n        // this.headFrameImg.node.parent.active = false;\r\n        const itemFrameTab = tab.getData().ItemTableById.getValue(itemId);\r\n        if (itemFrameTab) {\r\n            // this.headFrameImg.node.parent.active = true;\r\n            this.headFrameImg.setTexture(itemFrameTab.Icon);\r\n        }\r\n        if (RoleData.ins.avatarInfo.headIcon) {\r\n            this.headImg.setTexture(tab.getData().ItemTableById.getValue(RoleData.ins.avatarInfo.headIcon).Icon);\r\n        }\r\n        this.node_use.active = itemId === RoleData.ins.avatarInfo.headFrame;\r\n        this.node_lock.active = !view.checkFrameIsHave(itemId);\r\n\r\n        const headFrameRed = RedMgr.ins.isRed(RedDotType.Head_Icon_Red, \"1\");\r\n        if (!headFrameRed) {\r\n            this.node_red.active = false;\r\n        } else {\r\n            const headFrameItemRed = RedMgr.ins.isRed(RedDotType.Head_Icon_Red, \"1\", \"\" + itemId);\r\n            this.node_red.active = headFrameItemRed;\r\n        }\r\n    }\r\n    initData(headId: number, headFrameId: number) {\r\n        // this.headImg.node.parent.active = false;\r\n        // this.headFrameImg.node.parent.active = false;\r\n        const itemHeadTab = tab.getData().ItemTableById.getValue(headId);\r\n        if (itemHeadTab) {\r\n            // this.headImg.node.parent.active = true;\r\n            this.headImg.setTexture(itemHeadTab.Icon);\r\n        }\r\n        const itemFrameTab = tab.getData().ItemTableById.getValue(headFrameId);\r\n        if (itemFrameTab) {\r\n            // this.headFrameImg.node.parent.active = true;\r\n            this.headFrameImg.setTexture(itemFrameTab.Icon);\r\n        }\r\n    }\r\n    clickSelectHead() {\r\n        if (!this.node_select.active) {\r\n            if (this.roleInfoView) {\r\n                this.roleInfoView.selectHead(this);\r\n            }\r\n            this.node_select.active = true;\r\n            if (this.node_red.active) {\r\n                this.node_red.active = false;\r\n                if (this.roleInfoView.default_view === HEADTYPE.HEADICON) {\r\n                    RoleData.ins.clientData.newHeadIcon = RoleData.ins.clientData.newHeadIcon.replace(\",\" + this.itemId, \"\");\r\n                    RoleData.ins.setClientData(\"newHeadIcon\", RoleData.ins.clientData.newHeadIcon)\r\n                }\r\n                if (this.roleInfoView.default_view === HEADTYPE.HEADFRAME) {\r\n                    RoleData.ins.clientData.newHeadFrame = RoleData.ins.clientData.newHeadFrame.replace(\",\" + this.itemId, \"\");\r\n                    RoleData.ins.setClientData(\"newHeadFrame\", RoleData.ins.clientData.newHeadFrame)\r\n                }\r\n                RedMgr.refreshEvent(RedDotType.Head_Icon_Red);\r\n            }\r\n        }\r\n    }\r\n    unSelectHead() {\r\n        this.node_select.active = false;\r\n    }\r\n}\r\n\r\n\r\n"]}