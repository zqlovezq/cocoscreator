{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/mutation/TalentMiniTipsPop.ts"],"names":["_decorator","Color","Component","Label","Node","Sprite","tab","LangMgr","proto","Net","RoleData","ShowItemNotEnoughTips","UIMgr","ItemData","GameUtil","ViewName","ccclass","property","TalentMiniTipsPop","_talentData","setData","data","node","active","needGeneRes","MaterialCountList","haveCount","ins","getCount","MaterialIdList","itemData","getData","ItemTableById","getValue","lbl_gold","color","fromHEX","GetKeyValue_ConfigTable","InterfaceTxtRed","lbl_name","string","getLab","AttrType","lbl_value","getCombineString","AttrValue","lbl_lock_level","UnlockArgs","convertNumber","sp_gold","setTexture","Icon","node_learn","lock_before_node","lock_node","unlock_node","level","gene","smallGeneLevel","playerLv","Id","clickBtn","show","viewName","ResourceBuyPop","CurrencyType","CurrencyType_Gold","msg","Msg_UpgradeGeneLevelReq","type","Type","Send","Ptl","UpgradeGeneLevelReq"],"mappings":"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","sourcesContent":["import { _decorator, Color, Component, Label, Node, Sprite } from 'cc';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../net/Net';\r\nimport { RoleData } from '../role/RoleData';\r\nimport { ShowItemNotEnoughTips, ShowTips, UIMgr } from '../../mgr/UIMgr';\r\nimport { ItemData } from '../item/ItemData';\r\nimport { GameUtil } from '../../utils/GameUtil';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('TalentMiniTipsPop')\r\nexport class TalentMiniTipsPop extends Component {\r\n    @property(Label)\r\n    lbl_name: Label = null;\r\n    @property(Label)\r\n    lbl_value: Label = null;\r\n    @property(Label)\r\n    lbl_lock_level: Label = null;\r\n    @property(Label)\r\n    lbl_gold: Label = null;\r\n    @property(Sprite)\r\n    sp_gold: Sprite = null;\r\n    @property(Node)\r\n    node_learn:Node = null;\r\n    @property(Node)\r\n    lock_node:Node = null;\r\n    @property(Node)\r\n    lock_before_node:Node = null;\r\n    @property(Node)\r\n    unlock_node:Node = null;\r\n    private _talentData: tab.GeneLevelTable = null;\r\n    setData(data: tab.GeneLevelTable) {\r\n        this._talentData = data;\r\n        this.node.active = true;\r\n        const needGeneRes = this._talentData.MaterialCountList[0];\r\n        const haveCount = ItemData.ins.getCount(this._talentData.MaterialIdList[0]);\r\n        const itemData = tab.getData().ItemTableById.getValue(data.MaterialIdList[0]);\r\n        if(haveCount<needGeneRes){\r\n            this.lbl_gold.color = new Color().fromHEX(tab.getData().GetKeyValue_ConfigTable().InterfaceTxtRed);\r\n        }else{\r\n            this.lbl_gold.color = new Color().fromHEX(\"#FFFFFF\");\r\n        }\r\n        this.lbl_name.string = LangMgr.getLab(tab.AttrType[data.AttrType]);\r\n        this.lbl_value.string = LangMgr.getCombineString(\"ui_gene_1\", [this.lbl_name.string, data.AttrValue]);\r\n        this.lbl_lock_level.string = LangMgr.getCombineString(\"ui_gene_2\", [data.UnlockArgs]);\r\n        this.lbl_gold.string =GameUtil.convertNumber(needGeneRes,true);\r\n        this.sp_gold.setTexture(itemData.Icon);\r\n\r\n        this.node_learn.active = false;\r\n        this.lock_before_node.active = false;\r\n        this.lock_node.active = false;\r\n        this.unlock_node.active = false;\r\n        // 获取当前的level\r\n        const level = RoleData.ins.gene.smallGeneLevel;\r\n        const playerLv = RoleData.ins.level;\r\n        if(this._talentData.Id==level+1){\r\n            if(playerLv>=this._talentData.UnlockArgs){\r\n                this.node_learn.active = true;\r\n            }else{\r\n                this.lock_node.active = true;\r\n            }\r\n        }else if(this._talentData.Id<level+1){\r\n            this.unlock_node.active = true\r\n        }else{\r\n            if(playerLv>=this._talentData.UnlockArgs){\r\n                this.lock_before_node.active = true;\r\n            }else{\r\n                this.lock_node.active = true;\r\n            }\r\n        }\r\n    }\r\n    clickBtn() {\r\n        // 升级需要资源\r\n        const needGeneRes = this._talentData.MaterialCountList[0];\r\n        const haveCount = ItemData.ins.getCount(this._talentData.MaterialIdList[0]);\r\n        if(haveCount<needGeneRes){\r\n            ShowItemNotEnoughTips(this._talentData.MaterialIdList[0]);\r\n            // 金币不足\r\n            UIMgr.ins.show({ viewName: ViewName.ResourceBuyPop, data: { \"itemId\": tab.CurrencyType.CurrencyType_Gold } })\r\n            return \r\n        }\r\n        this.node.active = false;\r\n        let msg = new proto.Msg_UpgradeGeneLevelReq();\r\n        msg.type = this._talentData.Type;\r\n        Net.Send(proto.Ptl.UpgradeGeneLevelReq, msg)\r\n    }\r\n}\r\n\r\n\r\n"]}