{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/common/DiamondBuyItem.ts"],"names":["_decorator","Component","Label","Node","Sprite","tab","PayData","PayControl","ChannelMgr","ccclass","property","DiamondBuyItem","_tabData","_rechargeTab","initData","tabData","node_extra_diamond_node","active","node_first_recharge","ins","payInfoMsg","buyDiamondsInfo","boughtGoodsIds","indexOf","GoodsId","lbl_extra_diamond","string","String","Add","lbl_first_recharge_diamond","FirstAdd","getData","RechargeTableById","getValue","RechargeId","lbl_num","GetItemNum","lbl_price","getSdkRechargeShowPrice","sp_icon","setTexture","Icon","clickBuyDiamond","self","requestPay","push"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, Sprite } from 'cc';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { PayData } from '../pay/PayData';\r\nimport { PayControl } from '../pay/PayControl';\r\nimport { ChannelMgr } from '../../../channel/ChannelMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('DiamondBuyItem')\r\nexport class DiamondBuyItem extends Component {\r\n    @property(Sprite)\r\n    sp_icon: Sprite = null;\r\n    @property(Label)\r\n    lbl_num: Label = null;\r\n    @property(Label)\r\n    lbl_price: Label = null;\r\n    @property(Label)\r\n    lbl_extra_diamond = null;\r\n    @property(Node)\r\n    node_extra_diamond_node = null;\r\n    @property(Node)\r\n    node_first_recharge:Node = null;\r\n    @property(Label)\r\n    lbl_first_recharge_diamond = null;\r\n    private _tabData: tab.BuyDiamondsTable = null;\r\n    private _rechargeTab: tab.RechargeTable = null;\r\n    initData(tabData: tab.BuyDiamondsTable) {\r\n        // 根据是否买过获取首冲信息\r\n        this.node_extra_diamond_node.active = false;\r\n        this.node_first_recharge.active = false;\r\n        if(PayData.ins.payInfoMsg.buyDiamondsInfo.boughtGoodsIds.indexOf(tabData.GoodsId)>-1){\r\n            this.lbl_extra_diamond.string = String(tabData.Add);\r\n            this.node_extra_diamond_node.active = tabData.Add>0;\r\n        }else{\r\n            this.lbl_first_recharge_diamond.string = String(tabData.FirstAdd);\r\n            this.node_first_recharge.active = true;\r\n        }\r\n        this._tabData = tabData;\r\n        this._rechargeTab = tab.getData().RechargeTableById.getValue(tabData.RechargeId);\r\n        this.lbl_num.string = \"x\"+tabData.GetItemNum;\r\n        this.lbl_price.string =ChannelMgr.getSdkRechargeShowPrice(this._rechargeTab);// LangMgr.getCombineString(\"ui_commondesc_73\", [this._rechargeTab.Price]);\r\n        this.sp_icon.setTexture(tabData.Icon);\r\n    }\r\n    // 点击购买钻石\r\n    clickBuyDiamond(){\r\n        var self = this;\r\n        PayControl.ins.requestPay(self._tabData.RechargeId,()=>{\r\n            // 刷新这个界面\r\n            if(PayData.ins.payInfoMsg.buyDiamondsInfo.boughtGoodsIds.indexOf(self._tabData.GoodsId)===-1){\r\n                PayData.ins.payInfoMsg.buyDiamondsInfo.boughtGoodsIds.push(self._tabData.GoodsId);\r\n            }\r\n            self.initData(self._tabData)\r\n        })\r\n    }\r\n}\r\n"]}