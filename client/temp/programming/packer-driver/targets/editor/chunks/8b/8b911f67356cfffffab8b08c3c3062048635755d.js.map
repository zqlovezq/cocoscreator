{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/item/EquipmentItem.ts"],"names":["_decorator","Button","Color","Component","Label","log","Node","Sprite","v3","ItemPoolMgr","UIMgr","tab","ViewName","HeroStar","ccclass","property","EquipmentItem","data","touchCallBack","isTouch","isSelectState","initData","initView","button","enabled","start","itemTab","itemTable","qualityImg","setTexture","Quality","iconImg","Icon","setSelectState","equipInfo","type","EquipType","EquipType_Feather","heroStar","node","active","forgeNode","strengthenLvLab","proSpr","starbgNode","showStar","equipTable","EquipStar","h","getData","HeroClassTableByHeroClass","getValue","Class","itemquality","ItemQualityTableByQuality","quality","HeroStarBg","isWear","enhanceLv","string","slotInfo","color","fromHEX","refineLv","forgeLab","setLv","EnhanceLv","setTouchCallBack","callBack","setIsTouchItem","b","onTouchItem","BagType","BagType_Equip","ins","show","viewName","EquipmentDetailPop","BagType_Jade","JadeDetailPop","selectNode","onDisable","onDestroy","targetOff","putItem","putEquipItem","unuse","setPosition"],"mappings":"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","sourcesContent":["import { _decorator, Button, Color, color, Component, Label, labelAssembler, log, Node, Sprite, v3 } from 'cc';\r\nimport { ItemPoolMgr } from './ItemPoolMgr';\r\nimport { EquipInfo } from '../equip/EquipInfo';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { HeroStar } from '../hero/HeroStar';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * EquipmentItem\r\n * zhudingchao\r\n * Mon May 20 2024 16:08:27 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/item/EquipmentItem.ts\r\n *\r\n */\r\n\r\n@ccclass('EquipmentItem')\r\nexport class EquipmentItem extends Component {\r\n    @property(Button)\r\n    button: Button = null;\r\n    @property(Sprite)\r\n    qualityImg: Sprite = null;\r\n    @property(Sprite)\r\n    iconImg: Sprite = null;\r\n    @property(Node)\r\n    selectNode: Node = null;\r\n    @property(Label)\r\n    strengthenLvLab:Label=null;\r\n    @property(HeroStar)\r\n    heroStar:HeroStar=null;\r\n    @property(Sprite)\r\n    proSpr:Sprite=null;\r\n    @property(Node)\r\n    forgeNode:Node=null;\r\n    @property(Label)\r\n    forgeLab:Label=null;\r\n    @property(Sprite)\r\n    starbgNode:Sprite=null;\r\n\r\n    private data:  EquipInfo;\r\n    private touchCallBack: Function;\r\n    private isTouch: boolean = true;\r\n    public isSelectState: boolean = false;\r\n    initData(data:  EquipInfo,isTouch:boolean=true) {\r\n        this.data = data;\r\n        this.isTouch=isTouch;\r\n        this.initView();\r\n        this.touchCallBack =null;\r\n        if (this.button) {\r\n            this.button.enabled = this.isTouch;\r\n        }\r\n      \r\n\r\n    }\r\n\r\n    // initId(id: number, num: number) {\r\n    //     let info = new ItemInfo();\r\n    //     info.itemId = id\r\n    //     info.num = num;\r\n    //     this.initData(info)\r\n    // }\r\n    start(): void {\r\n        this.button.enabled = this.isTouch;\r\n    }\r\n\r\n\r\n    initView() {\r\n        let itemTab = this.data.itemTable;\r\n        this.qualityImg.setTexture(\"textrue/quality/qualityBg_\" + itemTab.Quality);\r\n        this.iconImg.setTexture(itemTab.Icon);\r\n        this.setSelectState(false);\r\n        if(this.equipInfo.type==tab.EquipType.EquipType_Feather){\r\n            this.heroStar.node.active=false;\r\n            this.forgeNode.active=false;\r\n            this.strengthenLvLab.node.active=false;\r\n            this.proSpr.node.active=false;\r\n            this.starbgNode.node.active=false;\r\n\r\n        }else{\r\n            this.proSpr.node.active=true;\r\n            this.heroStar.node.active=true;\r\n            this.starbgNode.node.active=true;\r\n            this.heroStar.showStar(this.data.equipTable.EquipStar);\r\n            let h=tab.getData().HeroClassTableByHeroClass.getValue(this.equipInfo.equipTable.Class)\r\n            this.proSpr.setTexture(h.Icon);\r\n            let itemquality=tab.getData().ItemQualityTableByQuality.getValue(this.equipInfo.quality)\r\n            this.starbgNode.setTexture(itemquality.HeroStarBg);\r\n            if(this.equipInfo.isWear){\r\n                if(this.equipInfo.enhanceLv>0){\r\n                    this.strengthenLvLab.node.active=true;\r\n                    this.strengthenLvLab.string=\"+\"+this.equipInfo.slotInfo.enhanceLv;\r\n                    if(this.equipInfo.enhanceLv<this.equipInfo.slotInfo.enhanceLv){\r\n                        this.strengthenLvLab.color=new Color().fromHEX(\"#C11212\");\r\n                     }else{\r\n                         this.strengthenLvLab.color=new Color().fromHEX(\"#FFFFFF\");\r\n                     }\r\n                }else{\r\n                    this.strengthenLvLab.node.active=false;\r\n                }\r\n                if(this.equipInfo.refineLv>0){\r\n                    this.forgeNode.active=true;\r\n                    this.forgeLab.string=\"+\"+this.equipInfo.refineLv;\r\n                    if(this.equipInfo.refineLv<this.equipInfo.slotInfo.refineLv){\r\n                       this.forgeLab.color=new Color().fromHEX(\"#C11212\");\r\n                    }else{\r\n                        this.forgeLab.color=new Color().fromHEX(\"#FFFFFF\");\r\n                    }\r\n                }else{\r\n                    this.forgeNode.active=false;\r\n                }\r\n            }else{\r\n                this.forgeNode.active=false;\r\n                this.strengthenLvLab.node.active=false;\r\n            }\r\n        }\r\n      \r\n        \r\n        // if (itemTab.Type == tab.ItemType.ItemType_Equip) {\r\n        //     this.numLab.node.active = false;\r\n        // } else {\r\n        //     let itemData = <ItemInfo>this.data;\r\n        //     this.numLab.string = itemData.num + \"\";\r\n        // }\r\n        // this.addTouchEvent();\r\n        // this.setSelectState(false);\r\n\r\n\r\n    }\r\n    setLv(EnhanceLv:number,refineLv:number){\r\n        this.strengthenLvLab.node.active = EnhanceLv>0;\r\n        this.forgeNode.active = refineLv>0;\r\n        this.strengthenLvLab.string=\"+\"+EnhanceLv;\r\n        this.forgeLab.string=\"+\"+refineLv;\r\n    }\r\n    setTouchCallBack(callBack: Function) {\r\n        this.touchCallBack = callBack;\r\n\r\n    }\r\n    setIsTouchItem(b: boolean) {\r\n        this.isTouch = b;\r\n        if (this.button) {\r\n            this.button.enabled = b;\r\n        }\r\n    }\r\n\r\n    private onTouchItem() {\r\n        if (!this.isTouch) {\r\n            return;\r\n        }\r\n        if (this.touchCallBack) {\r\n            this.touchCallBack(this);\r\n        } else {\r\n            log(\"点击了item\")\r\n            let type = this.data.itemTable.BagType;\r\n            if (type == tab.BagType.BagType_Equip) {\r\n                UIMgr.ins.show({ viewName: ViewName.EquipmentDetailPop, data: this.data })\r\n            } else if (type == tab.BagType.BagType_Jade) {\r\n                UIMgr.ins.show({ viewName: ViewName.JadeDetailPop, data: this.data })\r\n            }\r\n        }\r\n    }\r\n    /**设置选择状态 */\r\n    public setSelectState(b: boolean) {\r\n        this.isSelectState = b;\r\n        this.selectNode.active = b;\r\n\r\n    }\r\n    protected onDisable(): void {\r\n        this.heroStar.onDisable();\r\n    }\r\n\r\n    protected onDestroy(): void {\r\n        this.node.targetOff(this);\r\n        log(\"item onDestroy\")\r\n    }\r\n    putItem() {\r\n        ItemPoolMgr.ins.putEquipItem(this.node);\r\n    }\r\n    public get equipInfo() {\r\n        return this.data as EquipInfo;\r\n    }\r\n\r\n    unuse() {\r\n        this.node.targetOff(this);\r\n        this.touchCallBack = null;\r\n        this.isTouch = true;\r\n        this.data = null;\r\n        log(\"item onDisable\")\r\n        this.node.setPosition(v3(0, 0));\r\n    }\r\n\r\n}"]}