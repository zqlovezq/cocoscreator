{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/view/common/FightWeaponTeamItem.ts"],"names":["_decorator","Button","Component","Label","Node","ProgressBar","Sprite","tween","tab","UIMgr","ViewName","RareBookData","BuffControl","AbsObjType","ccclass","property","FightWeaponTeamItem","info","bookId","onLoad","buffNumberLab","node","active","string","setData","isTouch","btn","enabled","blackNode","baseNode","itemTab","getData","ItemTableById","getValue","rogueTab","BookId","bookTab","BookTableById","iconImg","setTexture","Icon","qualityImg","Quality","bookPlaysSpr","PlaystyleName","idlist","GetKeyValue_ConfigTable","FinalBuffId","i","length","rogueId","buffid","Id","num","ins","getBuffNumByObjTypeAndBuffId","role","toString","onClickItem","bookInfo","getBookInfoByItemId","show","viewName","RareBookInfoItemPop","data","setBookId","lookNode","cdBar","progress","activeBook","to","start"],"mappings":"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","sourcesContent":["import { _decorator, Button, Color, Component, Label, Node, Prefab, ProgressBar, Sprite, tween } from \"cc\";\nimport { tab } from \"../../../../Table/table_gen\";\nimport { HeroFightInfo } from \"../../data/HeroFightInfo\";\nimport { RogueInfo } from \"../rogue/RogueInfo\";\nimport { LangMgr } from \"../../../mgr/LangMgr\";\nimport { UIMgr } from \"../../../mgr/UIMgr\";\nimport { ViewName } from \"../../../define/ViewDefine\";\nimport { RareBookInfo } from \"../../../model/rareBook/RareBookInfo\";\nimport { RareBookData } from \"../../../model/rareBook/RareBookData\";\nimport { BuffControl } from \"../../base/buff/BuffControl\";\nimport { AbsObjType } from \"../../base/obj/AbsObj\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('FightWeaponTeamItem')\nexport class FightWeaponTeamItem extends Component {\n    @property(Node)\n    baseNode: Node = null\n    @property(Node)\n    blackNode: Node = null\n\n    @property(Sprite)\n    qualityImg: Sprite = null;\n\n    @property(Sprite)\n    iconImg: Sprite = null;\n\n    @property(Button)\n    btn: Button = null;\n\n    @property(Sprite)\n    bookPlaysSpr: Sprite = null;\n\n    @property(Node)\n    lookNode: Node = null\n\n    @property(ProgressBar)\n    cdBar: ProgressBar = null\n\n    @property(Label)\n    buffNumberLab: Label = null;\n    protected onLoad(): void {\n        this.buffNumberLab.node.active = false\n        this.buffNumberLab.string = \"\"\n    }\n\n    info: RogueInfo\n    setData(info: RogueInfo, isTouch: boolean = false) {\n        this.info = info;\n        this.btn.enabled = isTouch;\n        if (info == null) {\n            this.blackNode.active = true\n            this.baseNode.active = !this.blackNode.active\n            return\n        }\n        this.blackNode.active = false\n        this.baseNode.active = !this.blackNode.active\n\n        let itemTab = tab.getData().ItemTableById.getValue(info.rogueTab.BookId)\n        let bookTab = tab.getData().BookTableById.getValue(info.rogueTab.BookId)\n\n        this.iconImg.setTexture(itemTab.Icon)\n        this.qualityImg.setTexture(\"textrue/quality/qualityBg_\" + itemTab.Quality);\n\n        this.bookPlaysSpr.node.active = bookTab.PlaystyleName != \"\";\n        if (bookTab.PlaystyleName != \"\") {\n            this.bookPlaysSpr.setTexture(bookTab.PlaystyleName)\n        }\n\n        this.buffNumberLab.node.active = false\n        let idlist = tab.getData().GetKeyValue_ConfigTable().FinalBuffId\n        for (let i = 0; i < idlist.length; i++) {\n            let rogueId = idlist[i]\n            let buffid = idlist[i + 1]\n            //指定id显示一个buff层数共享\n            if (info.Id == rogueId) {\n                let num = BuffControl.ins.getBuffNumByObjTypeAndBuffId(AbsObjType.role, buffid)\n                if (num > 0) {\n                    this.buffNumberLab.node.active = true\n                    this.buffNumberLab.string = num.toString()\n                }\n            }\n            i++\n        }\n\n\n    }\n    onClickItem() {\n        let bookId = 0\n        if (this.info && this.info.rogueTab && this.info.rogueTab.BookId) {\n            bookId = this.info.rogueTab.BookId\n        } else {\n            bookId = this.bookId\n        }\n        if (bookId == 0){\n            return\n        }\n\n        let bookInfo = RareBookData.ins.getBookInfoByItemId(bookId)\n        UIMgr.ins.show({ viewName: ViewName.RareBookInfoItemPop, data: { \"bookInfo\": bookInfo } });\n\n        // UIMgr.ins.show({ viewName: ViewName.HeroSkillPop,data: {\n        //     type:this._type,\n        //     heroInfo:this._heroInfo\n        // },zIndex:300})\n    }\n\n\n    bookId: number = 0\n    /** pvp 0未设置， -1未解锁 */\n    setBookId(bookId: number) {\n        this.bookId = bookId\n        if (bookId <= 0) {\n            this.blackNode.active = true\n            this.baseNode.active = !this.blackNode.active\n            this.lookNode.active = bookId == -1\n            return\n        }\n        this.blackNode.active = false\n        this.baseNode.active = !this.blackNode.active\n        this.btn.enabled = false\n        let itemTab = tab.getData().ItemTableById.getValue(bookId)\n        let bookTab = tab.getData().BookTableById.getValue(bookId)\n\n        this.iconImg.setTexture(itemTab.Icon)\n        this.qualityImg.setTexture(\"textrue/quality/qualityBg_\" + itemTab.Quality);\n\n        this.bookPlaysSpr.node.active = bookTab.PlaystyleName != \"\";\n        if (bookTab.PlaystyleName != \"\") {\n            this.bookPlaysSpr.setTexture(bookTab.PlaystyleName)\n        }\n        this.cdBar.node.active = true\n        this.cdBar.progress = 1\n    }\n\n    activeBook() {\n        if (this.bookId > 0) {\n            tween(this.cdBar).to(0.2, { progress: 0 }).start()\n        }\n    }\n\n}\n\n"]}