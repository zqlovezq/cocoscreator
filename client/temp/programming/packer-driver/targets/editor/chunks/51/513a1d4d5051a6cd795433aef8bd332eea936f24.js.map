{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/hero/herobag/HeroBagLayoutCell.ts"],"names":["_decorator","instantiate","Prefab","Node","HeroBagItem","InfiniteCell","HeroDataControl","EventMgr","LocalEvent","HeroData","HeroInfo","tab","ccclass","property","HeroBagLayoutCell","UpdateContent","data","node_content","removeAllChildren","i","length","node","pfb_cell_item","parent","itemTs","getComponent","id","heroInfo","ins","bookId","getById","itemId","heroTab","getData","HeroTableById","getValue","star","DefaultStar","setTouchCallBack","heroId","refreshBagData","emitLocal","Hero_Change","refreshBookData","updateBookCell","getChildByName","String"],"mappings":"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","sourcesContent":["import { _decorator, instantiate, Prefab, Node } from 'cc';\r\nimport { HeroBagItem } from './HeroBagItem';\r\nimport InfiniteCell from '../../../../Common/InfiniteList/InfiniteCell';\r\nimport { HeroDataControl } from './HeroDataControl';\r\nimport { EventMgr } from '../../../mgr/EventMgr';\r\nimport { LocalEvent } from '../../../define/LocalEvent';\r\nimport { HeroData } from '../HeroData';\r\nimport { HeroInfo } from '../HeroInfo';\r\nimport { tab } from '../../../../Table/table_gen';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('HeroBagLayoutCell')\r\nexport class HeroBagLayoutCell extends InfiniteCell {\r\n    @property(Prefab)\r\n    pfb_cell_item: Prefab = null;\r\n    @property(Node)\r\n    node_content: Node = null;\r\n    UpdateContent(data: any) {\r\n        this.node_content.removeAllChildren();\r\n        for (let i = 0; i < data.length; i++) {\r\n            let node = instantiate(this.pfb_cell_item);\r\n            node.parent = this.node_content;\r\n            let itemTs = node.getComponent(HeroBagItem);\r\n            let id = data[i];\r\n            let heroInfo = null;\r\n            if (!HeroDataControl.ins.bookId) {\r\n                heroInfo = HeroData.ins.getById(id);\r\n            }else{\r\n                heroInfo = new HeroInfo();\r\n                let itemId = id\r\n                let heroTab = tab.getData().HeroTableById.getValue(itemId)\r\n                heroInfo.itemId = itemId\r\n                heroInfo.id = 0;\r\n                heroInfo.star = heroTab.DefaultStar;\r\n            }\r\n            itemTs.UpdateContent(heroInfo);\r\n            itemTs.setTouchCallBack(() => {\r\n                if (!HeroDataControl.ins.bookId) {\r\n                    if(HeroDataControl.ins.heroId!==id){\r\n                        HeroDataControl.ins.refreshBagData(id);\r\n                        EventMgr.emitLocal(LocalEvent.Hero_Change,false);\r\n                    }\r\n                }else{\r\n                    if(HeroDataControl.ins.bookId!==id){\r\n                        HeroDataControl.ins.refreshBookData(id);\r\n                        EventMgr.emitLocal(LocalEvent.Hero_Change,false);\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    }\r\n    updateBookCell(itemId:number){\r\n        let node = this.node_content.getChildByName(String(itemId));\r\n        let itemTs = node.getComponent(HeroBagItem);\r\n        let heroInfo = new HeroInfo();\r\n        let heroTab = tab.getData().HeroTableById.getValue(itemId)\r\n        heroInfo.itemId = itemId\r\n        heroInfo.id = 0;\r\n        heroInfo.star = heroTab.DefaultStar;\r\n        itemTs.UpdateContent(heroInfo);\r\n    }\r\n}\r\n\r\n\r\n"]}