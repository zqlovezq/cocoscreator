{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/rareBook/RareBookEquipNode.ts"],"names":["_decorator","Component","instantiate","Label","Node","Sprite","RareBookItem","RareBookData","LangMgr","tab","UIMgr","ViewName","ccclass","property","RareBookEquipNode","bookItemPrefab","currTag","canBookItems","currTargetNode","onTouchItem","info","ins","show","viewName","RareBookEquipPop","data","initView","prefb","canList","getCanBookInfosByHeroClass","slots","getBookSlotsByHeroClass","key","item","bookItems","bookInfo","initData","isLock","tips","getCombineString","bookSlotTable","UnlockArgs","initLockView","initEmptyView","node","active","parent","contentNode","getComponent","push","baseInfo","getBaseBookInfoByHeroClass","baseBookName","string","getLab","itemTable","Name","baseBookIcon","setTexture","Icon","heroclass","getData","HeroClassTableByHeroClass","getValue","baseVocationIcon","onClickToggle","event","tag","Number","getChildByName","target"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Label, Node, Prefab, Sprite } from 'cc';\r\nimport { RareBookItem } from './RareBookItem';\r\nimport { RareBookData } from './RareBookData';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { RareBookInfo } from './RareBookInfo';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * RareBookEquipNode\r\n * zhudingchao\r\n * Tue May 28 2024 19:44:51 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/rareBook/RareBookEquipNode.ts\r\n *\r\n */\r\n\r\n@ccclass('RareBookEquipNode')\r\nexport class RareBookEquipNode extends Component {\r\n    @property([RareBookItem])\r\n    bookItems: Array<RareBookItem> = [];\r\n    @property(Node)\r\n    contentNode: Node = null;\r\n    @property(Sprite)\r\n    baseBookIcon: Sprite = null;\r\n    @property(Sprite)\r\n    baseVocationIcon: Sprite = null;\r\n    @property(Label)\r\n    baseBookName: Label = null;\r\n\r\n    private bookItemPrefab: Prefab;\r\n    private currTag: number = 1;\r\n    private canBookItems: Array<RareBookItem> = [];\r\n    private currTargetNode:Node;\r\n\r\n\r\n    initView(prefb: Prefab = null) {\r\n        if (prefb) {\r\n            this.bookItemPrefab = prefb;\r\n        }\r\n        let canList = RareBookData.ins.getCanBookInfosByHeroClass(this.currTag);\r\n        let slots = RareBookData.ins.getBookSlotsByHeroClass(this.currTag);\r\n        for (let key in slots) {\r\n            let item = this.bookItems[key];\r\n            if (slots[key].bookInfo) {\r\n                item.initData(slots[key].bookInfo, true, this.onTouchItem, false);\r\n            } else {\r\n                if (!slots[key].isLock) {\r\n                    let tips = LangMgr.getCombineString(\"ui_rarebook_2\", [slots[key].bookSlotTable.UnlockArgs])\r\n                    item.initLockView(tips);\r\n                } else {\r\n                    item.initEmptyView();\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let key in this.canBookItems) {\r\n            this.canBookItems[key].node.active = false;\r\n        }\r\n        for (let key in canList) {\r\n            let item = this.canBookItems[key];\r\n            if (!item) {\r\n                let node = instantiate(this.bookItemPrefab);\r\n                node.parent = this.contentNode;\r\n                item = node.getComponent(RareBookItem);\r\n                this.canBookItems.push(item);\r\n            }\r\n            item.node.active = true;\r\n            item.initData(canList[key], true, this.onTouchItem, false);\r\n        }\r\n        let baseInfo = RareBookData.ins.getBaseBookInfoByHeroClass(this.currTag);\r\n        this.baseBookName.string = LangMgr.getLab(baseInfo.itemTable.Name);\r\n        this.baseBookIcon.setTexture(baseInfo.itemTable.Icon);\r\n        let heroclass = tab.getData().HeroClassTableByHeroClass.getValue(this.currTag);\r\n        this.baseVocationIcon.setTexture(heroclass.Icon);\r\n\r\n    }\r\n    onClickToggle(event, tag) {\r\n        tag = Number(tag);\r\n        if (this.currTag != tag) {\r\n            this.currTag = tag;\r\n            if (this.currTargetNode) {\r\n                this.currTargetNode.getChildByName(\"redNode\").active = true;\r\n            }\r\n            event.target.getChildByName(\"redNode\").active = false;\r\n            this.currTargetNode = event.target;\r\n            this.initView(null);\r\n        }\r\n    }\r\n    onTouchItem = (info: RareBookInfo) => {\r\n        UIMgr.ins.show({viewName:ViewName.RareBookEquipPop,data:{\"bookInfo\":info}})\r\n    }\r\n\r\n}"]}