{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/hero/HeroStar.ts"],"names":["_decorator","Node","Animation","createAnimation","ComponentBase","ccclass","property","HeroStar","star","onLoad","showStar","isValid","enabled","onDisable","i","node_stars","length","node","name","parent","index","Number","charAt","active","level","Math","ceil","animId","getComponent","anim","defaultClip","animName","animState","getState","stop"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAgCC,MAAAA,I,OAAAA,I;AAAuBC,MAAAA,S,OAAAA,S;;AAEvDC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,a,iBAAAA,a;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;0BAGjBO,Q,WADZF,OAAO,CAAC,UAAD,C,UAIHC,QAAQ,CAAC,CAACL,IAAD,CAAD,C,2BAJb,MACaM,QADb;AAAA;AAAA,0CAC4C;AAAA;AAAA;;AACxC;AACA;AAFwC;;AAKxC;AALwC,eAMhCC,IANgC,GAMjB,CANiB;AAAA;;AAO9BC,QAAAA,MAAM,GAAS,CAExB;;AACoB,cAARC,QAAQ,CAACF,IAAD,EAAe;AAChC,cAAG,CAAC,KAAKG,OAAT,EAAiB;AACb;AACH;;AACD,cAAI,KAAKC,OAAT,EAAkB;AACd,iBAAKC,SAAL;AACH;;AACD,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,UAAL,CAAgBC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC7C,gBAAIG,IAAI,GAAG,KAAKF,UAAL,CAAgBD,CAAhB,CAAX;AACA,kBAAMI,IAAI,GAAGD,IAAI,CAACE,MAAL,CAAYD,IAAzB;AACA,gBAAIE,KAAK,GAAGC,MAAM,CAACH,IAAI,CAACI,MAAL,CAAYJ,IAAI,CAACF,MAAL,GAAc,CAA1B,CAAD,CAAlB;AACAC,YAAAA,IAAI,CAACE,MAAL,CAAYI,MAAZ,GAAqBH,KAAK,GAAI,KAAKZ,IAAI,GAAG,CAAP,KAAa,CAAb,GAAiB,CAAjB,GAAqBA,IAAI,GAAG,CAAjC,CAA9B;AACA,gBAAIgB,KAAK,GAAGC,IAAI,CAACC,IAAL,CAAUlB,IAAI,GAAG,CAAjB,CAAZ;AACA,kBAAMmB,MAAM,GAAG,OAAOH,KAAtB;;AACA,gBAAIP,IAAI,CAACE,MAAL,CAAYI,MAAhB,EAAwB;AACpB,oBAAM;AAAA;AAAA,sDAAgBN,IAAhB,EAAsBU,MAAtB,CAAN;AACH;AACJ;AACJ;;AACMd,QAAAA,SAAS,GAAS;AACrB,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,UAAL,CAAgBC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC7C,kBAAMG,IAAI,GAAG,KAAKF,UAAL,CAAgBD,CAAhB,CAAb;;AACA,gBAAIG,IAAI,CAACW,YAAL,CAAkB1B,SAAlB,CAAJ,EAAkC;AAC9B,oBAAM2B,IAAI,GAAGZ,IAAI,CAACW,YAAL,CAAkB1B,SAAlB,CAAb;;AACA,kBAAI2B,IAAI,CAACC,WAAT,EAAsB;AAClB,sBAAMC,QAAQ,GAAGF,IAAI,CAACC,WAAL,CAAiBZ,IAAlC;AACA,sBAAMc,SAAS,GAAGH,IAAI,CAACI,QAAL,CAAcF,QAAd,CAAlB;AACAC,gBAAAA,SAAS,CAACE,IAAV;AACH;AACJ;AACJ;AACJ;;AAzCuC,O;;;;;iBAInB,E","sourcesContent":["import { _decorator, Component, isValid, Node, sp, SpriteFrame, Animation, Sprite, log } from 'cc';\r\nimport { LoadResAsync } from '../../mgr/ResMgr';\r\nimport { createAnimation } from '../../utils/GameUtil';\r\nimport { ComponentBase } from '../../../framework/base/ComponentBase';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('HeroStar')\r\nexport class HeroStar extends ComponentBase {\r\n    // @property(Node)\r\n    // node_star: Node = null;\r\n    @property([Node])\r\n    node_stars: Node[] = []\r\n    /* 显示当前英雄的星级 */\r\n    private star: number = 0;\r\n    protected onLoad(): void {\r\n\r\n    }\r\n    public async showStar(star: number) {\r\n        if(!this.isValid){\r\n            return\r\n        }\r\n        if (this.enabled) {\r\n            this.onDisable();\r\n        }\r\n        for (let i = 0; i < this.node_stars.length; i++) {\r\n            let node = this.node_stars[i];\r\n            const name = node.parent.name;\r\n            let index = Number(name.charAt(name.length - 1));\r\n            node.parent.active = index > (5 - (star % 5 === 0 ? 5 : star % 5));\r\n            let level = Math.ceil(star / 5);\r\n            const animId = 1000 + level;\r\n            if (node.parent.active) {\r\n                await createAnimation(node, animId);\r\n            }\r\n        }\r\n    }\r\n    public onDisable(): void {\r\n        for (let i = 0; i < this.node_stars.length; i++) {\r\n            const node = this.node_stars[i];\r\n            if (node.getComponent(Animation)) {\r\n                const anim = node.getComponent(Animation)\r\n                if (anim.defaultClip) {\r\n                    const animName = anim.defaultClip.name;\r\n                    const animState = anim.getState(animName)\r\n                    animState.stop();\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}