{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/fincaFight/FincaFightItem.ts"],"names":["_decorator","Component","Label","Node","Sprite","PlayerHeadItem","SimpleRoleInfo","UIMgr","ViewName","ButtonLock","GameUtil","LangMgr","FincaFightControl","tab","RoleData","ccclass","property","FincaFightItem","roleId","setData","data","indexOf","robotId","Number","replace","tabInfo","getData","RobotTableById","getValue","palyerHerdItem","setCloseCallBack","lbl_lv","string","String","PlayerLevel","itemHeadTab","ItemTableById","Head","sp_head","setTexture","Icon","lbl_name","getLab","Name","lbl_score","getCombineString","score","lbl_force","convertNumber","powerScore","playerInfo","merge","simpleRole","initHeadInfo","roleInfo","ins","show","viewName","CheckRoleInfoPop","name","node_sweep","active","GetKeyValue_ConfigTable","FincaFightBattleSkip","onClickFight","event","isSweep","reqFincaBattleFight","Boolean"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, Label, Node, Sprite } from 'cc';\r\nimport { proto } from 'client_protocol';\r\nimport { PlayerHeadItem } from '../common/PlayerHeadItem';\r\nimport { SimpleRoleInfo } from '../friends/SimpleRoleInfo';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { ButtonLock, GameUtil } from '../../utils/GameUtil';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { FincaFightControl } from './FincaFightControl';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { RoleData } from '../role/RoleData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('FincaFightItem')\r\nexport class FincaFightItem extends Component {\r\n    @property(PlayerHeadItem)\r\n    palyerHerdItem: PlayerHeadItem = null;\r\n    @property(Label)\r\n    lbl_name: Label = null;\r\n    @property(Label)\r\n    lbl_force: Label = null;\r\n    @property(Label)\r\n    lbl_score: Label = null\r\n    @property(Label)\r\n    lbl_lv:Label = null;\r\n    @property(Sprite)\r\n    sp_head:Sprite = null;\r\n    @property(Node)\r\n    node_sweep:Node = null;\r\n    private roleId: string = \"\";\r\n    setData(data: proto.IFincaBattleRole) {\r\n        this.roleId = data.roleId;\r\n        if (this.roleId.indexOf(\"r_\") > -1) {\r\n            // 当前是机器人 SimpleRoleInfo\r\n            const robotId = Number(this.roleId.replace(\"r_\",\"\"));\r\n            const tabInfo = tab.getData().RobotTableById.getValue(robotId);\r\n            this.palyerHerdItem.setCloseCallBack(()=>{})\r\n            this.lbl_lv.string = String(tabInfo.PlayerLevel);\r\n            let itemHeadTab = tab.getData().ItemTableById.getValue(tabInfo.Head);\r\n            this.sp_head.setTexture(itemHeadTab.Icon);\r\n\r\n            this.lbl_name.string = LangMgr.getLab(tabInfo.Name);\r\n            this.lbl_score.string = LangMgr.getCombineString(\"ui_fincafight_13\", [data.score]);\r\n            this.lbl_force.string = GameUtil.convertNumber(data.powerScore);\r\n        } else {\r\n            const playerInfo = new SimpleRoleInfo();\r\n            playerInfo.merge(data.simpleRole);\r\n            this.palyerHerdItem.initHeadInfo({ roleInfo: playerInfo });\r\n            this.palyerHerdItem.setCloseCallBack(() => {\r\n                UIMgr.ins.show({ viewName: ViewName.CheckRoleInfoPop, data: { \"roleId\": data.roleId } })\r\n            })\r\n\r\n            this.lbl_name.string = data.simpleRole.name;\r\n            this.lbl_force.string = GameUtil.convertNumber(data.powerScore);\r\n            this.lbl_score.string = LangMgr.getCombineString(\"ui_fincafight_13\", [data.score]);\r\n        }\r\n        // 是否显示扫荡按钮\r\n        this.node_sweep.active = RoleData.ins.powerScore>=data.powerScore*(1+tab.getData().GetKeyValue_ConfigTable().FincaFightBattleSkip/10000)\r\n    }\r\n    // 竞技场攻击\r\n    @ButtonLock(1, () => { })\r\n    onClickFight(event: EventTouch, isSweep: string) {\r\n        FincaFightControl.ins.reqFincaBattleFight(this.roleId, Boolean(Number(isSweep)));\r\n    }\r\n}\r\n\r\n\r\n"]}