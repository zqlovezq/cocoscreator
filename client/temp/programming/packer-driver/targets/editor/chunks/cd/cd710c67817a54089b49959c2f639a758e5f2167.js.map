{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/hero/herobag/HeroDetailView.ts"],"names":["_decorator","Color","instantiate","Label","Node","Prefab","Sprite","Toggle","proto","HeroDataControl","HeroBagPainting","ViewPop","HeroInfo","tab","HeroData","ShowItemNotEnoughTips","ShowTips","UIMgr","ViewName","Net","EventMgr","HeroTeamControl","HeroAttrItem","HeroStar","HeroMaterialItem","LocalEvent","HeroDetailEquipItem","ItemData","HeroSkillItem","LangMgr","Func","HeroItem","RedMgr","RedDotType","HERO_DETAIL_VIEW_TYPE","HeroAttrMgr","OpenFunctionMgr","GameUtil","RoleData","HeroRed","stepBranchGuide","EquipData","GuideController","ccclass","property","HeroDetailView","_heroInfo","_teamSlots","_itemTable","_heroTable","_heroStarUpTable","_heroAttrTable","_defaultView","DETAIL","herosMaterialMap","Map","_heroAllAttr","register","onMsg","Ptl","UpTeamSlotLevelRsp","on_s2c_UpTeamSlotLevelRsp","UpHeroStarRsp","on_s2c_UpHeroStarRsp","FinishHeroStarStepRsp","on_s2c_FinishHeroStarStepRsp","ResetHeroStarRsp","on_s2c_ResetHeroStarRsp","ResetTeamSlotLevelRsp","on_s2c_ResetTeamSlotLevelRsp","onLocal","Hero_Change","initData","Hero_Material_Select","refeshMaterial","ChangeEquipRsp","on_s2c_ChangeEquipRsp","Equip_Chang","onEquipChang","SetTeamSlotRsp","on_s2c_SetTeamSlotRsp","EnhanceEquipRsp","on_s2c_EnhanceEquipRsp","msg","error","code","CommonErrorCode","Succeed","ins","refreshTeam","heroId","newLevel","curLevel","getHeroLevel","caleLevel","checkLevelUp","node_ascend","active","getChildByName","getComponent","string","getCombineString","getHeroInfoAttr","id","refreshEvent","HeroupLevel","HeroResonanceLevel","showHeroAttr","showHeroPainting","Combine_Grow","heroInfo","getById","finshedStarSteps","push","stepId","hideView","HeroStarSpecialPop","onShow","itemTable","heroTable","heroStarUpTable","heroAttrTable","setHerosMaterialMap","node_star_toggle","HeroStarUpType","length","NeedStarSteps","node_star_up_red","isRed","HeroupStar","String","node_level_up_red","btn_level_up_red","node_equip_red","checkWearEquip","checkWearJade","node_red_strength","Equip_Strengthen","Class","RISINGSTAR","openData","clickChangeView","node_func_toggle","isChecked","onDestroy","show","viewName","HeroBagView","node_hero_detail","attr","AttrType","AttrType_Attack","AttrType_Hp","AttrType_Defence","attrTotal","AttrType_TotalAttack","AttrType_TotalHp","AttrType_TotalDefence","i","node","node_attribute_layout","children","pfb_hero_attr","parent","ts","value","getAttr","initView","heroTab","node_skill_layout","destroyAllChildren","skillMap","getHeroSkillMap","iconUrl","skillData","get","skill_item","pfb_skill_item","node_max_level_txt","isInTeam","heroInTeam","node_not_in_team_tips","showLevelUpMaterial","node_stuff_level_layout","node_level_up","node_stuff_level_layout_img","showAllHeroAttr","HeroAttrPop","data","setHerosMaterialById","showStarUpMaterial","showHeroUpStar","node_hero_risingstar","node_now_star","showStar","star","curStarUpTab","nextStarUpTab","getHeroStarUpTableByStar","lbl_now_star_max","MaxLevel","lbl_next_star_max","itemList","hero_skill_item","hero_skill_item1","skillDescList","lbl_skill_desc","lbl_skill_desc1","skillNameList","lbl_skill_name","lbl_skill_name1","index","v","nextStarHeroInfo","itemId","DescType","element","item","descLab","nameLab","getLab","StarDesc","StarName","node_next_star","showHeroEquip","node_hero_equip","EQUIP","isTeam","equipItem","showHeroSkin","node_hero_skin","SKIN","upLevel","paintingNode","node_hero_painting","pfb_hero_painting","setExchangeBtn","setViewType","showLevelAnim","clickOneLevelUp","materialMap","getMaterialByLevel","map","MaterialNoEnough","isGold","notEnoughtItemId","forEach","key","totalMaterialCount","getCount","CurrencyType","CurrencyType_Gold","ResourceBuyPop","heroClass","Msg_UpTeamSlotLevelReq","level","Send","UpTeamSlotLevelReq","clickMoreLevelUp","event","type","Number","isOpen","checkFunctionIsOpen","OpenFunctionName","OpenFunctionName_Equipment","showFunctionTips","checkEquipGuide","checkJadeGuide","clickHeroStarUp","MaterialEnough","checkStarUpMaterialEnough","console","log","Msg_UpHeroStarReq","getHerosMaterialMap","starTab","upStarCosts","_type","_count","CostHeroNum","getHerosMaterialMapCount","obj","costType","costHeroIds","costItems","itemCount","heroCost","num","UpHeroStarReq","node_stuff_star_layout","starUpSteps","getFinishStep","node_up_star_item","node_step_star_up","heroItem","itemTs","UpdateContent","setSelect","setTouchCallBack","stage","stage_stepId","stage_sp","grayscale","Boolean","indexOf","redDot","pfb_hero_material","name","cocosNodeZIndex","heroClassTable","HeroClass","HeroStarUpType_AnyHero","HeroClass_Any","setMaterial","itemIds","CostItemId","counts","CostItemNum","k","_ItemData","getByItemId","itemTab","getData","ItemTableById","getValue","sp","lbl","setTexture","Icon","material","size","resonanceLimit","levelUpData","HeroLevelUpTableByLevel","lbl_describe","MinTeamLevel","maxLevelLimit","convertNumber","color","fromHEX","GetKeyValue_ConfigTable","InterfaceTxtRed","clickStarUpStep","refreshEquipRed","euqipId","Wear_Equip","Wear_Jade","onDisable","isGuiding","getView","isEquipGuide","clientData","equipGuildOver","isOpenEquip","isNewEquip","getNewEquip","isJadeGuide","jadeGuildOver","isOpenJade","OpenFunctionName_Jade","list","getJadeEquipInfos","isWear","jadeInfo"],"mappings":"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","sourcesContent":["import { _decorator, Color, EventTouch, instantiate, Label, Node, Prefab, Sprite, Toggle } from 'cc';\r\nimport { proto } from 'client_protocol';\r\nimport { HeroDataControl } from './HeroDataControl';\r\nimport { HeroBagPainting } from './HeroBagPainting';\r\nimport { ViewPop } from '../../../../framework/base/ViewPop';\r\nimport { HeroInfo, materialHeros } from '../HeroInfo';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { HeroData } from '../HeroData';\r\nimport { ShowItemNotEnoughTips, ShowTips, UIMgr } from '../../../mgr/UIMgr';\r\nimport { ViewName } from '../../../define/ViewDefine';\r\nimport { Net } from '../../../net/Net';\r\nimport { EventMgr } from '../../../mgr/EventMgr';\r\nimport { HeroTeamControl } from '../HeroTeamControl';\r\nimport { HeroAttrItem } from './HeroAttrItem';\r\nimport { HeroStar } from '../HeroStar';\r\nimport { HeroMaterialItem } from './HeroMaterialItem';\r\nimport { LocalEvent } from '../../../define/LocalEvent';\r\nimport { HeroDetailEquipItem } from './HeroDetailEquipItem';\r\nimport { ItemData } from '../../item/ItemData';\r\nimport { HeroSkillItem } from './HeroSkillItem';\r\nimport { LangMgr } from '../../../mgr/LangMgr';\r\nimport { Func } from '../../../utils/Func';\r\nimport { HeroItem } from '../../item/HeroItem';\r\nimport { RedMgr } from '../../../mgr/RedMgr';\r\nimport { RedDotType } from '../../../red/RedDotType';\r\nimport { HERO_DETAIL_VIEW_TYPE } from '../../../../Common/script/EnumTypeMgr';\r\nimport { HeroAttr, HeroAttrMgr } from '../../../../Common/script/HeroAttrMgr';\r\nimport { OpenFunctionMgr } from '../../../../Common/component/OpenFunctionMgr';\r\nimport { GameUtil } from '../../../utils/GameUtil';\r\nimport { RoleData } from '../../role/RoleData';\r\nimport { HeroRed } from './HeroRed';\r\nimport { stepBranchGuide } from '../../../guide/GuideTask';\r\nimport { EquipData } from '../../equip/EquipData';\r\nimport { GuideController } from '../../../guide/GuideController';\r\n\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('HeroDetailView')\r\nexport class HeroDetailView extends ViewPop {\r\n    @property(Node)\r\n    node_hero_painting: Node = null;\r\n    @property(Node)\r\n    node_hero_detail: Node = null;\r\n    @property(Node)\r\n    node_hero_risingstar: Node = null;\r\n    @property(Node)\r\n    node_hero_equip: Node = null;\r\n    @property(Node)\r\n    node_hero_skin: Node = null;\r\n    @property(Node)\r\n    node_ascend: Node = null;\r\n    @property(Node)\r\n    node_level_up: Node = null;\r\n    @property(Node)\r\n    node_attribute_layout: Node = null;\r\n    @property(Node)\r\n    node_now_star: Node = null;\r\n    @property(Node)\r\n    node_next_star: Node = null;\r\n    @property(Node)\r\n    node_stuff_star_layout: Node = null;\r\n    @property(Node)\r\n    node_stuff_level_layout: Node = null;\r\n    @property(Node)\r\n    node_stuff_level_layout_img: Node = null;\r\n    @property(Node)\r\n    node_skill_layout: Node = null;\r\n    @property(Node)\r\n    node_up_star_item: Node = null;\r\n    @property(Node)\r\n    node_star_toggle: Node = null;\r\n    @property(Node)\r\n    node_step_star_up: Node = null;\r\n    @property(Node)\r\n    node_max_level_txt: Node = null;\r\n    @property(Node)\r\n    node_star_up_red: Node = null;\r\n    @property(Node)\r\n    node_level_up_red: Node = null;\r\n    @property(Node)\r\n    btn_level_up_red: Node = null;\r\n    @property(Node)\r\n    node_equip_red: Node = null;\r\n    @property(Node)\r\n    node_func_toggle: Node = null;\r\n\r\n    @property(Prefab)\r\n    pfb_hero_painting: Prefab = null;\r\n    @property(Prefab)\r\n    pfb_hero_attr: Prefab = null;\r\n    @property(Prefab)\r\n    pfb_hero_material: Prefab = null;\r\n    @property(Prefab)\r\n    pfb_skill_item: Prefab = null;\r\n\r\n    @property(Label)\r\n    lbl_ascend: Label = null;\r\n    @property(Label)\r\n    lbl_now_star_max: Label = null;\r\n    @property(Label)\r\n    lbl_next_star_max: Label = null;\r\n    @property(Label)\r\n    lbl_skill_desc: Label = null;\r\n    @property(Label)\r\n    lbl_skill_name: Label = null;\r\n    @property(Label)\r\n    lbl_describe: Label = null;\r\n\r\n    @property(Label)\r\n    lbl_skill_desc1: Label = null;\r\n    @property(Label)\r\n    lbl_skill_name1: Label = null;\r\n\r\n    @property(HeroSkillItem)\r\n    hero_skill_item: HeroSkillItem = null;\r\n    @property(HeroSkillItem)\r\n    hero_skill_item1: HeroSkillItem = null;\r\n\r\n    @property(HeroDetailEquipItem)\r\n    equipItem: HeroDetailEquipItem = null;\r\n    @property(Node)\r\n    node_not_in_team_tips: Node = null;\r\n    @property(Node)\r\n    node_red_strength: Node = null;\r\n\r\n    private _heroInfo: HeroInfo = null;\r\n    private _teamSlots: proto.ITeamSlot[] = [];\r\n    private _itemTable: tab.ItemTable;\r\n    private _heroTable: tab.HeroTable;\r\n    private _heroStarUpTable: tab.HeroStarUpTable;\r\n    private _heroAttrTable: tab.HeroAttrTable;\r\n    private _defaultView: HERO_DETAIL_VIEW_TYPE = HERO_DETAIL_VIEW_TYPE.DETAIL;\r\n    public herosMaterialMap: Map<number, materialHeros> = new Map();\r\n    private _heroAllAttr: HeroAttr = null\r\n    /* 注册事件 */\r\n    register(): void {\r\n        /* 英雄升级 */\r\n        EventMgr.onMsg(proto.Ptl.UpTeamSlotLevelRsp, this.on_s2c_UpTeamSlotLevelRsp, this);\r\n        /* 英雄升星 */\r\n        EventMgr.onMsg(proto.Ptl.UpHeroStarRsp, this.on_s2c_UpHeroStarRsp, this);\r\n        /* 英雄进阶 */\r\n        EventMgr.onMsg(proto.Ptl.FinishHeroStarStepRsp, this.on_s2c_FinishHeroStarStepRsp, this);\r\n        /* 重置英雄星级 */\r\n        EventMgr.onMsg(proto.Ptl.ResetHeroStarRsp, this.on_s2c_ResetHeroStarRsp, this);\r\n        /* 重置队伍栏位等级 */\r\n        EventMgr.onMsg(proto.Ptl.ResetTeamSlotLevelRsp, this.on_s2c_ResetTeamSlotLevelRsp, this);\r\n        EventMgr.onLocal(LocalEvent.Hero_Change, this.initData, this);\r\n        EventMgr.onLocal(LocalEvent.Hero_Material_Select, this.refeshMaterial, this);\r\n        EventMgr.onMsg(proto.Ptl.ChangeEquipRsp, this.on_s2c_ChangeEquipRsp, this);\r\n        EventMgr.onLocal(LocalEvent.Equip_Chang, this.onEquipChang, this);\r\n        EventMgr.onMsg(proto.Ptl.SetTeamSlotRsp, this.on_s2c_SetTeamSlotRsp, this);\r\n        /* 一键升级刷新红点 */\r\n        EventMgr.onMsg(proto.Ptl.EnhanceEquipRsp, this.on_s2c_EnhanceEquipRsp, this);\r\n    }\r\n\r\n    on_s2c_UpTeamSlotLevelRsp(msg: proto.Msg_UpTeamSlotLevelRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        HeroTeamControl.ins.refreshTeam(HeroDataControl.ins.heroId, msg.newLevel);\r\n        /* 显示升级动画 */\r\n        let curLevel = this._heroInfo.getHeroLevel();\r\n        let caleLevel = this._heroInfo.checkLevelUp();\r\n        if (caleLevel - curLevel > 1) {\r\n            this.node_ascend.active = true;\r\n            this.node_ascend.getChildByName(\"ascend_label\").getComponent(Label).string = LangMgr.getCombineString(\"ui_hero_60\", [caleLevel]);\r\n        } else {\r\n            this.node_ascend.active = false\r\n        }\r\n        this._heroAllAttr = HeroAttrMgr.getHeroInfoAttr(this._heroInfo.id);\r\n        RedMgr.refreshEvent(RedDotType.HeroupLevel);\r\n        RedMgr.refreshEvent(RedDotType.HeroResonanceLevel);\r\n        this.showHeroAttr();\r\n        this.showHeroPainting(true);\r\n    }\r\n    /* 提升英雄星级 */\r\n    on_s2c_UpHeroStarRsp(msg: proto.Msg_UpHeroStarRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.initData();\r\n        RedMgr.refreshEvent(RedDotType.Combine_Grow);\r\n    }\r\n    /* 进阶英雄 */\r\n    on_s2c_FinishHeroStarStepRsp(msg: proto.Msg_FinishHeroStarStepRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        let heroInfo = HeroData.ins.getById(msg.heroId);\r\n        heroInfo.finshedStarSteps.push(msg.stepId);\r\n        UIMgr.ins.hideView(ViewName.HeroStarSpecialPop);\r\n        this.initData();\r\n    }\r\n    /* 重置英雄星级 */\r\n    on_s2c_ResetHeroStarRsp(msg: proto.Msg_ResetHeroStarRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.initData();\r\n    }\r\n    /* 重置队伍栏位等级 */\r\n    on_s2c_ResetTeamSlotLevelRsp(msg: proto.Msg_ResetTeamSlotLevelRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.initData();\r\n    }\r\n    /* 上阵英雄 */\r\n    on_s2c_SetTeamSlotRsp(msg: proto.Msg_SetTeamSlotRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.initData();\r\n    }\r\n    onShow() {\r\n        this.initData();\r\n    }\r\n    /* 初始化 */\r\n    initData() {\r\n        this._heroInfo = HeroData.ins.getById(HeroDataControl.ins.heroId);\r\n        this._itemTable = this._heroInfo.itemTable;\r\n        this._heroTable = this._heroInfo.heroTable;\r\n        this._heroStarUpTable = this._heroInfo.heroStarUpTable;\r\n        this._heroAttrTable = this._heroInfo.heroAttrTable;\r\n        this.herosMaterialMap = this._heroInfo.setHerosMaterialMap();\r\n        this._heroAllAttr = HeroAttrMgr.getHeroInfoAttr(this._heroInfo.id);\r\n        this.node_ascend.active = false;\r\n        this.showHeroPainting();\r\n        this.node_star_toggle.active = this._heroStarUpTable.HeroStarUpType.length > 0 || this._heroStarUpTable.NeedStarSteps.length > 0;\r\n        /* 显示是否有红点 */\r\n        this.node_star_up_red.active = RedMgr.ins.isRed(RedDotType.HeroupStar, String(this._heroInfo.id));\r\n        this.node_level_up_red.active = RedMgr.ins.isRed(RedDotType.HeroupLevel, String(this._heroInfo.id));\r\n        this.btn_level_up_red.active = RedMgr.ins.isRed(RedDotType.HeroupLevel, String(this._heroInfo.id));\r\n        this.node_equip_red.active = HeroRed.ins.checkWearEquip(this._heroInfo) || HeroRed.ins.checkWearJade(this._heroInfo);\r\n        this.node_red_strength.active = RedMgr.ins.isRed(RedDotType.Equip_Strengthen, String(this._heroInfo.heroTable.Class))\r\n\r\n        if (this._heroStarUpTable.HeroStarUpType.length === 0 && this._heroStarUpTable.NeedStarSteps.length === 0 && this._defaultView === HERO_DETAIL_VIEW_TYPE.RISINGSTAR) {\r\n            this._defaultView = HERO_DETAIL_VIEW_TYPE.DETAIL;\r\n        }\r\n        if (this.openData) {\r\n            this._defaultView = this.openData;\r\n        }\r\n        this.clickChangeView(null, String(this._defaultView));\r\n        this.node_func_toggle.getChildByName(\"Toggle\" + this._defaultView).getComponent(Toggle).isChecked = true;\r\n    }\r\n    onDestroy() {\r\n        super.onDestroy();\r\n        UIMgr.ins.show({ viewName: ViewName.HeroBagView })\r\n    }\r\n    /* 显示属性 */\r\n    showHeroAttr() {\r\n        this.node_hero_detail.active = this._defaultView === HERO_DETAIL_VIEW_TYPE.DETAIL\r\n        let attr = [tab.AttrType.AttrType_Attack, tab.AttrType.AttrType_Hp, tab.AttrType.AttrType_Defence]\r\n        // 显示时需要显示三项属性加成计算后的结果\r\n        let attrTotal = [tab.AttrType.AttrType_TotalAttack, tab.AttrType.AttrType_TotalHp, tab.AttrType.AttrType_TotalDefence]\r\n        for (let i = 0; i < attr.length; i++) {\r\n            let node = this.node_attribute_layout.children[i];\r\n            if (!node) {\r\n                node = instantiate(this.pfb_hero_attr);\r\n                node.parent = this.node_attribute_layout;\r\n            }\r\n            let ts: HeroAttrItem = node.getComponent(HeroAttrItem);\r\n            const value = this._heroAllAttr.getAttr(attrTotal[i]) ?? this._heroAllAttr.getAttr(attr[i]);\r\n            // const value = this._heroAllAttr.attr[Number(attrTotal[i])]?this._heroAllAttr.attr[Number(attrTotal[i])]:0\r\n            ts.initView(attr[i], value)\r\n        }\r\n        let heroTab = this._heroInfo.heroTable;\r\n        this.node_skill_layout.destroyAllChildren();\r\n\r\n        let skillMap = this._heroInfo.getHeroSkillMap();\r\n        for (let i = 1; i <= 3; i++) {\r\n            let iconUrl = heroTab[\"SkillIcon\" + i];\r\n            if (iconUrl) {\r\n                let skillData: tab.HeroStarUpTable[] = skillMap.get(i);\r\n                if (skillData) {\r\n                    let skill_item = instantiate(this.pfb_skill_item);\r\n                    let ts = skill_item.getComponent(HeroSkillItem);\r\n                    ts.initData(i, this._heroInfo);\r\n                    skill_item.parent = this.node_skill_layout;\r\n                }\r\n            }\r\n        }\r\n        this.node_max_level_txt.active = false;\r\n        // 判断hero是否在队伍中 没有则不显示升级按钮+材料\r\n        const isInTeam = HeroTeamControl.ins.heroInTeam(this._heroInfo.id);\r\n        this.node_not_in_team_tips.active = false;\r\n        if (isInTeam) {\r\n            this.showLevelUpMaterial();\r\n        } else {\r\n            this.node_not_in_team_tips.active = true;\r\n            this.node_stuff_level_layout.active = false;\r\n            this.node_level_up.active = false;\r\n            this.node_stuff_level_layout_img.active = false;\r\n        }\r\n        this.node_level_up_red.active = false;\r\n        this.node_star_up_red.active = RedMgr.ins.isRed(RedDotType.HeroupStar, String(this._heroInfo.id));\r\n        this.btn_level_up_red.active = RedMgr.ins.isRed(RedDotType.HeroupLevel, String(this._heroInfo.id));\r\n    }\r\n    /* 显示全部属性 */\r\n    showAllHeroAttr() {\r\n        UIMgr.ins.show({ viewName: ViewName.HeroAttrPop, data: { \"attrMap\": this._heroAllAttr.attr } })\r\n    }\r\n    refeshMaterial(data) {\r\n        if (data) {\r\n            this._heroInfo.setHerosMaterialById(data[0], data[1], data[2], data[3] ? data[3] : null);\r\n        }\r\n        this.showStarUpMaterial();\r\n    }\r\n    /* 显示升星 */\r\n    showHeroUpStar() {\r\n        this.node_star_up_red.active = false;\r\n        this.node_level_up_red.active = RedMgr.ins.isRed(RedDotType.HeroupLevel, String(this._heroInfo.id));\r\n        this.node_hero_risingstar.active = this._defaultView === HERO_DETAIL_VIEW_TYPE.RISINGSTAR;\r\n        this.node_now_star.getComponent(HeroStar).showStar(this._heroInfo.star);\r\n        /* 等级上限 */\r\n        let curStarUpTab = this._heroInfo.heroStarUpTable;\r\n        let nextStarUpTab = this._heroInfo.getHeroStarUpTableByStar(this._heroInfo.star + 1);\r\n        this.lbl_now_star_max.string = String(curStarUpTab.MaxLevel);\r\n        if (nextStarUpTab) {\r\n            this.lbl_next_star_max.string = String(nextStarUpTab.MaxLevel);\r\n            let itemList = [this.hero_skill_item, this.hero_skill_item1]\r\n            let skillDescList = [this.lbl_skill_desc, this.lbl_skill_desc1]\r\n            let skillNameList = [this.lbl_skill_name, this.lbl_skill_name1]\r\n            for (let index = 0; index < itemList.length; index++) {\r\n                const v = itemList[index];\r\n                v.node.parent.active = false\r\n                skillDescList[index].string = \"\"\r\n                skillNameList[index].string = \"\"\r\n            }\r\n\r\n            let nextStarHeroInfo = new HeroInfo();\r\n            nextStarHeroInfo.star = this._heroInfo.star + 1;\r\n            nextStarHeroInfo.itemId = this._heroInfo.itemId;\r\n            for (let index = 0; index < nextStarUpTab.DescType.length; index++) {\r\n                const element = nextStarUpTab.DescType[index];\r\n                let item = itemList[index]\r\n                item.node.parent.active = true\r\n                item.initData(element, nextStarHeroInfo);\r\n\r\n                let descLab = skillDescList[index]\r\n                let nameLab = skillNameList[index]\r\n\r\n                descLab.string = LangMgr.getLab(nextStarUpTab.StarDesc[index]);\r\n                nameLab.string = LangMgr.getLab(nextStarUpTab.StarName[index]);\r\n            }\r\n\r\n            this.node_next_star.getComponent(HeroStar).showStar(nextStarHeroInfo.star);\r\n\r\n\r\n        }\r\n        this.showStarUpMaterial();\r\n    }\r\n    /* 显示装备 */\r\n    showHeroEquip() {\r\n        this.node_hero_equip.active = this._defaultView === HERO_DETAIL_VIEW_TYPE.EQUIP\r\n        if (this.node_hero_equip.active) {\r\n            let isTeam = HeroTeamControl.ins.heroInTeam(this._heroInfo.id) !== null;\r\n            this.equipItem.initView(this._heroInfo.heroTable.Class, isTeam)\r\n        }\r\n    }\r\n    /* 显示时装 */\r\n    showHeroSkin() {\r\n        this.node_hero_skin.active = this._defaultView === HERO_DETAIL_VIEW_TYPE.SKIN\r\n    }\r\n    showHeroPainting(upLevel?: boolean) {\r\n        /* 加载资源 */\r\n        let paintingNode = null;\r\n        if (this.node_hero_painting.children.length === 0) {\r\n            paintingNode = instantiate(this.pfb_hero_painting);\r\n            paintingNode.parent = this.node_hero_painting;\r\n        } else {\r\n            paintingNode = this.node_hero_painting.children[0];\r\n        }\r\n        let ts: HeroBagPainting = paintingNode.getComponent(HeroBagPainting);\r\n        ts.initData();\r\n        ts.setExchangeBtn(true);\r\n        ts.setViewType(this._defaultView);\r\n        if (upLevel) {\r\n            ts.showLevelAnim();\r\n        }\r\n    }\r\n    /* 点击升级英雄 */\r\n    clickOneLevelUp() {\r\n        /* 先判断是否可以连升N级 如果有显示连升N级按钮 */\r\n        let curLevel = this._heroInfo.getHeroLevel();\r\n        let caleLevel = this._heroInfo.checkLevelUp();\r\n        if (caleLevel === curLevel) {\r\n            // 判断材料\r\n            let materialMap = this._heroInfo.getMaterialByLevel(curLevel, curLevel + 1).map;\r\n            let MaterialNoEnough = false;\r\n            let isGold = false;\r\n            let notEnoughtItemId = 0;\r\n            materialMap.forEach((value, key) => {\r\n                let totalMaterialCount = ItemData.ins.getCount(key);\r\n                if (totalMaterialCount < value) {\r\n                    MaterialNoEnough = true;\r\n                    if (key === tab.CurrencyType.CurrencyType_Gold) {\r\n                        isGold = true;\r\n                    }else{\r\n                        notEnoughtItemId = key;\r\n                    }\r\n                }\r\n            })\r\n            if (MaterialNoEnough) {\r\n                if (isGold) {\r\n                    ShowItemNotEnoughTips(tab.CurrencyType.CurrencyType_Gold);\r\n                    UIMgr.ins.show({ viewName: ViewName.ResourceBuyPop, data: { \"itemId\": tab.CurrencyType.CurrencyType_Gold } })\r\n                } else {\r\n                    ShowItemNotEnoughTips(notEnoughtItemId);\r\n                }\r\n                return;\r\n            }\r\n        }\r\n        let heroClass = this._heroTable.Class;\r\n        let msg = new proto.Msg_UpTeamSlotLevelReq();\r\n        msg.heroClass = heroClass;\r\n        msg.level = 1\r\n        Net.Send(proto.Ptl.UpTeamSlotLevelReq, msg);\r\n    }\r\n    /* 点击连升几级 */\r\n    clickMoreLevelUp() {\r\n        this.node_ascend.active = false\r\n        let curLevel = this._heroInfo.getHeroLevel();\r\n        let caleLevel = this._heroInfo.checkLevelUp();\r\n        let heroClass = this._heroTable.Class;\r\n        let msg = new proto.Msg_UpTeamSlotLevelReq();\r\n        msg.heroClass = heroClass;\r\n        msg.level = caleLevel - curLevel\r\n        Net.Send(proto.Ptl.UpTeamSlotLevelReq, msg);\r\n    }\r\n    /* 点击切换 */\r\n    clickChangeView(event: EventTouch, type: string) {\r\n        // 如果当前的功能未开启\r\n        if (Number(type) === HERO_DETAIL_VIEW_TYPE.EQUIP) {\r\n            const isOpen = OpenFunctionMgr.ins.checkFunctionIsOpen(tab.OpenFunctionName.OpenFunctionName_Equipment);\r\n            if (!isOpen) {\r\n                OpenFunctionMgr.ins.showFunctionTips(tab.OpenFunctionName.OpenFunctionName_Equipment);\r\n                this.node_func_toggle.getChildByName(\"Toggle\" + this._defaultView).getComponent(Toggle).isChecked = true;\r\n                return;\r\n            }\r\n        }\r\n        this.node_hero_risingstar.active = false;\r\n        this.node_hero_detail.active = false;\r\n        this.node_hero_skin.active = false;\r\n        this.node_hero_equip.active = false;\r\n        this._defaultView = Number(type);\r\n        const paintingNode = this.node_hero_painting.children[0];\r\n        if (paintingNode) {\r\n            let ts: HeroBagPainting = paintingNode.getComponent(HeroBagPainting);\r\n            ts.setViewType(this._defaultView);\r\n        }\r\n        // this.showView();\r\n        switch (this._defaultView) {\r\n            case HERO_DETAIL_VIEW_TYPE.DETAIL:\r\n                this.showHeroAttr();\r\n                break;\r\n            case HERO_DETAIL_VIEW_TYPE.RISINGSTAR:\r\n                this.showHeroUpStar();\r\n                break\r\n            case HERO_DETAIL_VIEW_TYPE.EQUIP:\r\n                this.showHeroEquip();\r\n                break;\r\n            case HERO_DETAIL_VIEW_TYPE.SKIN:\r\n                this.showHeroSkin();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.checkEquipGuide();\r\n        this.checkJadeGuide();\r\n    }\r\n    /* 点击英雄升星 */\r\n    clickHeroStarUp() {\r\n        let MaterialEnough = this._heroInfo.checkStarUpMaterialEnough();\r\n        if (!MaterialEnough) {\r\n            console.log(\"cocos 材料不足\")\r\n            ShowTips(LangMgr.getLab(\"Tips_materialshortage\"));\r\n            return;\r\n        }\r\n        let msg = new proto.Msg_UpHeroStarReq()\r\n        const map = this._heroInfo.getHerosMaterialMap();\r\n        let starTab = this._heroInfo.heroStarUpTable;\r\n        let upStarCosts: proto.IUpHeroStarCost[] = []\r\n        for (let i = 0; i < starTab.HeroStarUpType.length; i++) {\r\n            let _type: tab.HeroStarUpType = starTab.HeroStarUpType[i];\r\n            let _count: number = starTab.CostHeroNum[i];\r\n            if (this._heroInfo.getHerosMaterialMapCount(_type) < _count) {\r\n                console.log(`cocos type=${_type} 需要的数量为${_count} 当前的数量为${this._heroInfo.getHerosMaterialMapCount(_type)}`)\r\n                ShowTips(LangMgr.getLab(\"Tips_materialshortage\"));\r\n                return\r\n            }\r\n            let obj: proto.IUpHeroStarCost = {\r\n                costType: _type,\r\n                costHeroIds: [],\r\n                costItems: []\r\n            }\r\n            upStarCosts.push(obj);\r\n        }\r\n        let itemCount = 0;\r\n        map.forEach((value, key) => {\r\n            let heroCost: proto.IUpHeroStarCost = null;\r\n            for (let i = 0; i < upStarCosts.length; i++) {\r\n                if (value.type === upStarCosts[i].costType) {\r\n                    heroCost = upStarCosts[i]\r\n                }\r\n            }\r\n            let costHeroIds = heroCost.costHeroIds;\r\n            let costItems = heroCost.costItems;\r\n            if (value.itemId) {\r\n                itemCount++\r\n                costItems[0] = {\r\n                    itemId: value.itemId,\r\n                    num: itemCount\r\n                }\r\n            } else {\r\n                costHeroIds.push(key);\r\n            }\r\n        })\r\n        msg.heroId = this._heroInfo.id;\r\n        msg.upStarCosts = upStarCosts;\r\n        Net.Send(proto.Ptl.UpHeroStarReq, msg)\r\n    }\r\n\r\n    /* 显示升星所需要的材料 */\r\n    showStarUpMaterial() {\r\n        let starTab = this._heroInfo.heroStarUpTable;\r\n        if (!starTab) {\r\n            return;\r\n        }\r\n        // this.node_stuff_star_layout.destroyAllChildren();\r\n        for (let i = 0; i < 2; i++) {\r\n            if (this.node_stuff_star_layout.children[i]) {\r\n                this.node_stuff_star_layout.children[i].active = false;\r\n            }\r\n        }\r\n\r\n        /* 升星满足阶段 */\r\n        let starUpSteps = starTab.NeedStarSteps;\r\n        // console.log(`cocos starUpSteps length=${starUpSteps.length}---完成步数=${this._heroInfo.getFinishStep()}`)\r\n        if (starUpSteps.length > 0 && this._heroInfo.getFinishStep() < 4) {\r\n            this.node_up_star_item.active = false;\r\n            this.node_up_star_item.parent.getChildByName(\"starup_btn\").active = false;\r\n            this.node_stuff_star_layout.active = false;\r\n            this.node_step_star_up.active = true;\r\n            let heroItem = this.node_step_star_up.getChildByName(\"HeroItem\");\r\n            let itemTs: HeroItem = heroItem.getComponent(HeroItem);\r\n            itemTs.UpdateContent(this._heroInfo);\r\n            itemTs.setSelect(false);\r\n            itemTs.setTouchCallBack(() => {\r\n\r\n            })\r\n            /* 设置状态 */\r\n            for (let i = 0; i < 4; i++) {\r\n                let stage = this.node_step_star_up.getChildByName(\"stage\" + (i + 1) + \"_btn\");\r\n                let stage_stepId = starUpSteps[i];\r\n                let stage_sp = stage.getComponent(Sprite);\r\n                stage_sp.grayscale = Boolean(this._heroInfo.finshedStarSteps.indexOf(stage_stepId) === -1);\r\n                let redDot = stage.getChildByName(\"redDot\");\r\n                redDot.active = this._heroInfo.checkStarUpMaterialEnough(stage_stepId) && stage_sp.grayscale;\r\n            }\r\n        } else {\r\n            this.node_up_star_item.parent.getChildByName(\"starup_btn\").active = true;\r\n            this.node_stuff_star_layout.active = true;\r\n            this.node_step_star_up.active = false;\r\n            for (let i = 0; i < starTab.HeroStarUpType.length; i++) {\r\n                let type: tab.HeroStarUpType = starTab.HeroStarUpType[i];\r\n                let item = null;\r\n                if (this.node_stuff_star_layout.getChildByName(\"item\" + type)) {\r\n                    item = this.node_stuff_star_layout.getChildByName(\"item\" + type)\r\n                } else {\r\n                    item = instantiate(this.pfb_hero_material);\r\n                    item.name = \"item\" + type;\r\n                    item.parent = this.node_stuff_star_layout;\r\n                }\r\n                Func.cocosNodeZIndex(item, type);\r\n                item.active = true;\r\n                let heroClass = this._heroInfo.heroClassTable.HeroClass;\r\n                if (type == tab.HeroStarUpType.HeroStarUpType_AnyHero) {\r\n                    heroClass = tab.HeroClass.HeroClass_Any\r\n                }\r\n                item.getComponent(HeroMaterialItem).setMaterial(type, heroClass);\r\n            }\r\n            let itemIds = starTab.CostItemId;\r\n            let counts = starTab.CostItemNum;\r\n            this.node_up_star_item.active = itemIds.length > 0;\r\n            for (let k = 0; k < itemIds.length; k++) {\r\n                let _ItemData = ItemData.ins.getByItemId(itemIds[k]);\r\n                let itemTab = tab.getData().ItemTableById.getValue(itemIds[k]);\r\n                let sp = this.node_up_star_item.children[0].getChildByName(\"JinBi\").getComponent(Sprite);\r\n                let lbl = this.node_up_star_item.children[0].getChildByName(\"skill_txt\").getComponent(Label);\r\n                if (_ItemData && _ItemData.num) {\r\n                    //lbl.string = counts[k] + \" / \" + _ItemData.num;\r\n                    lbl.string = _ItemData.num + \" / \" + counts[k];\r\n                } else {\r\n                    //lbl.string = counts[k] + \" / \" + 0;\r\n                    lbl.string = 0 + \" / \" + counts[k];\r\n                }\r\n                sp.setTexture(itemTab.Icon);\r\n            }\r\n        }\r\n    }\r\n    /* 显示升级所需要的材料 */\r\n    showLevelUpMaterial() {\r\n        let level = this._heroInfo.getHeroLevel();\r\n        let material = this._heroInfo.getMaterialByLevel(level, level + 1);\r\n        for (let i = 0; i < this.node_stuff_level_layout.children.length; i++) {\r\n            let item = this.node_stuff_level_layout.children[i];\r\n            item.active = false;\r\n        }\r\n        let index = 0;\r\n        let map = material.map\r\n        if (map.size === 0) {\r\n            this.node_ascend.active = false;\r\n            this.node_level_up.active = false;\r\n            this.node_stuff_level_layout_img.active = false;\r\n            /* 因为共鸣等级无法升级 */\r\n            if (material.resonanceLimit) {\r\n                let level = this._heroInfo.getHeroLevel();\r\n                let levelUpData: tab.HeroLevelUpTable = tab.getData().HeroLevelUpTableByLevel.getValue(level);\r\n                this.node_stuff_level_layout.active = false;\r\n                this.lbl_describe.node.active = true\r\n                this.lbl_describe.string = LangMgr.getCombineString(\"ui_hero_2\", [5, levelUpData.MinTeamLevel]);\r\n            } else if (material.maxLevelLimit) {\r\n                this.node_max_level_txt.active = true;\r\n                this.lbl_describe.node.active = false;\r\n            }\r\n        } else {\r\n            this.node_level_up.active = true;\r\n            this.node_stuff_level_layout.active = true;\r\n            this.lbl_describe.node.active = false\r\n            this.node_stuff_level_layout_img.active = true;\r\n        }\r\n\r\n        map.forEach((value, key) => {\r\n            let item = this.node_stuff_level_layout.children[index];\r\n            item.active = true;\r\n            // let itemTab = ItemData.ins.getByItemId(key);\r\n\r\n            let _ItemData = ItemData.ins.getByItemId(key);\r\n            let itemTab = tab.getData().ItemTableById.getValue(key);\r\n\r\n            let sp = item.getChildByName(\"JinBi\").getComponent(Sprite);\r\n            let lbl = item.getChildByName(\"skill_txt\").getComponent(Label);\r\n            if (_ItemData && _ItemData.num) {\r\n                // lbl.string = value + \"/\" + _ItemData.num;\r\n                lbl.string = GameUtil.convertNumber(_ItemData.num) + \" / \" + GameUtil.convertNumber(value, true);\r\n            } else {\r\n                // lbl.string = value + \"/\" + 0;\r\n                lbl.string = 0 + \" / \" + value;\r\n            }\r\n\r\n            if (_ItemData && _ItemData.num && Number(_ItemData.num) >= value) {\r\n                lbl.color = new Color().fromHEX(\"#FFFFFF\");\r\n            } else {\r\n                lbl.color = new Color().fromHEX(tab.getData().GetKeyValue_ConfigTable().InterfaceTxtRed);\r\n            }\r\n\r\n            sp.setTexture(itemTab.Icon);\r\n            index++;\r\n        })\r\n    }\r\n    clickStarUpStep(event: EventTouch, type: string) {\r\n        /* 获取当前的stepId数组 */\r\n        let starTab = this._heroInfo.heroStarUpTable;\r\n        let starUpSteps = starTab.NeedStarSteps;\r\n        UIMgr.ins.show({\r\n            viewName: ViewName.HeroStarSpecialPop, data: {\r\n                stepId: starUpSteps[Number(type)]\r\n            }\r\n        })\r\n    }\r\n    on_s2c_EnhanceEquipRsp(msg: proto.Msg_EnhanceEquipRsp) {\r\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            RedMgr.refreshEvent(RedDotType.Equip_Strengthen);\r\n            this.node_red_strength.active = RedMgr.ins.isRed(RedDotType.Equip_Strengthen, String(this._heroInfo.heroTable.Class))\r\n        }\r\n    }\r\n    /**\r\n   * 替换装备成功\r\n   * @param msg \r\n   */\r\n    on_s2c_ChangeEquipRsp(msg: proto.Msg_ChangeEquipRsp) {\r\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            this.refreshEquipRed();\r\n            if (this.node_hero_equip.active) {\r\n                let isTeam = HeroTeamControl.ins.heroInTeam(this._heroInfo.id) !== null;\r\n                this.equipItem.initView(this._heroInfo.heroTable.Class, isTeam)\r\n            }\r\n            this._heroAllAttr = HeroAttrMgr.getHeroInfoAttr(this._heroInfo.id);\r\n            this.showHeroAttr();\r\n        }\r\n    }\r\n    onEquipChang(heroClass: number, euqipId: number) {\r\n        this.refreshEquipRed();\r\n        if (this.node_hero_equip.active) {\r\n            let isTeam = HeroTeamControl.ins.heroInTeam(this._heroInfo.id) !== null;\r\n            if (this._heroInfo.heroTable.Class == heroClass) {\r\n                this.equipItem.initView(this._heroInfo.heroTable.Class, isTeam)\r\n            }\r\n        }\r\n        this._heroAllAttr = HeroAttrMgr.getHeroInfoAttr(this._heroInfo.id);\r\n        this.showHeroAttr();\r\n    }\r\n    // 刷新红点\r\n    refreshEquipRed() {\r\n        RedMgr.refreshEvent(RedDotType.Wear_Equip);\r\n        RedMgr.refreshEvent(RedDotType.Wear_Jade);\r\n        RedMgr.refreshEvent(RedDotType.Equip_Strengthen);\r\n        this.node_equip_red.active = HeroRed.ins.checkWearEquip(this._heroInfo) || HeroRed.ins.checkWearJade(this._heroInfo);\r\n        this.node_red_strength.active = RedMgr.ins.isRed(RedDotType.Equip_Strengthen, String(this._heroInfo.heroTable.Class))\r\n    }\r\n    protected onDisable(): void {\r\n        this.node_now_star.getComponent(HeroStar).onDisable();\r\n        this.node_next_star.getComponent(HeroStar).onDisable();\r\n    }\r\n\r\n    // 检查是否有装备引导\r\n    checkEquipGuide() {\r\n        //条件 1：没有引导过、2：装备开启条件达成、3：有可一键装备的装备\r\n        if (!GuideController.ins.isGuiding()&&!UIMgr.ins.getView(\"EquipmentView\")) {\r\n            const isEquipGuide = Boolean(RoleData.ins.clientData.equipGuildOver);\r\n            const isOpenEquip = OpenFunctionMgr.ins.checkFunctionIsOpen(tab.OpenFunctionName.OpenFunctionName_Equipment);\r\n            const isNewEquip = HeroRed.ins.getNewEquip(this._heroInfo.heroClassTable.HeroClass);\r\n            const isInTeam = HeroTeamControl.ins.heroInTeam(this._heroInfo.id);\r\n            if (!isEquipGuide && isOpenEquip && isNewEquip && Boolean(isInTeam)) {\r\n                if (this._defaultView === HERO_DETAIL_VIEW_TYPE.EQUIP) {\r\n                    stepBranchGuide(504);\r\n                } else {\r\n                    stepBranchGuide(503);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // 检查是否有羽毛引导\r\n    checkJadeGuide() {\r\n        if (!GuideController.ins.isGuiding()) {\r\n            const isJadeGuide = Boolean(RoleData.ins.clientData.jadeGuildOver);\r\n            const isOpenJade = OpenFunctionMgr.ins.checkFunctionIsOpen(tab.OpenFunctionName.OpenFunctionName_Jade);\r\n            let list = EquipData.ins.getJadeEquipInfos();\r\n            let isWear = false;\r\n            for (let key in list) {\r\n                const jadeInfo = list[key];\r\n                if (jadeInfo.isWear) {\r\n                    isWear = true;\r\n                }\r\n            }\r\n\r\n            if (!isJadeGuide && isOpenJade && !isWear && list.length > 0) {\r\n                if (this._defaultView === HERO_DETAIL_VIEW_TYPE.EQUIP) {\r\n                    stepBranchGuide(506);\r\n                } else {\r\n                    stepBranchGuide(505);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}