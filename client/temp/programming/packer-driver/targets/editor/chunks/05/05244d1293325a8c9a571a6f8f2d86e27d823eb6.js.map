{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationRankBottomItem.ts"],"names":["_decorator","Label","Node","Sprite","InfiniteCell","LangMgr","GameUtil","refreshFlagImg","SimpleRoleInfo","PlayerHeadItem","UIMgr","ViewName","AssociationData","ccclass","property","AssociationRankBottomItem","data","simpleRole","simpleGuild","view_type","_rank_index","_isMySelf","UpdateContent","node_role","active","node_guild","index","isSelf","rankData","initPlayerData","initGuildData","simple","playerInfo","merge","palyerHerdItem","initHeadInfo","roleInfo","lbl_role_damage","string","String","score","lbl_role_name","name","lbl_rank","guild","createGuildData","flagId","sp_guild_flag","lbl_guild_name","lbl_guild_score","convertNumber","lbl_members_count","getCombineString","members","setPlayerMyRank","idx","node","getChildByName","getLab","ins","getAssocitionSimpleInfo","onClickGuild","show","viewName","AssociationMainPop"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, Sprite } from 'cc';\r\nimport InfiniteCell from '../../../Common/InfiniteList/InfiniteCell';\r\nimport { proto } from 'client_protocol';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { GameUtil, refreshFlagImg } from '../../utils/GameUtil';\r\nimport { SimpleRoleInfo } from '../friends/SimpleRoleInfo';\r\nimport { PlayerHeadItem } from '../common/PlayerHeadItem';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { AssociationData } from './AssociationData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationRankBottomItem')\r\nexport class AssociationRankBottomItem extends InfiniteCell {\r\n    @property(Node)\r\n    node_role: Node = null;\r\n    @property(Node)\r\n    node_guild: Node = null;\r\n    @property(Label)\r\n    lbl_rank:Label = null;\r\n    @property(Sprite)\r\n    sp_guild_flag:Sprite = null;\r\n    @property(Label)\r\n    lbl_guild_name:Label = null;\r\n    @property(Label)\r\n    lbl_guild_score:Label = null;\r\n    @property(Label)\r\n    lbl_members_count:Label = null;\r\n\r\n    @property(PlayerHeadItem)\r\n    palyerHerdItem:PlayerHeadItem=null;\r\n    @property(Label)\r\n    lbl_role_damage:Label = null;\r\n    @property(Label)\r\n    lbl_role_name:Label = null;\r\n    private data: any = null;\r\n    private simpleRole: proto.ISimpleRole = null;\r\n    private simpleGuild: proto.ISimpleGuild = null;\r\n    private view_type: number = 0;\r\n    private _rank_index:number = 0;\r\n    private _isMySelf:boolean = false;\r\n    UpdateContent(data: any): void {\r\n        this.view_type = data.view_type;\r\n        this.node_role.active = false;\r\n        this.node_guild.active = false;\r\n        this._rank_index = data.index;\r\n        this._isMySelf = data.isSelf;\r\n        if (data) {\r\n            if (this.view_type === 1) {\r\n                this.data = data.rankData as proto.ISimpleRank\r\n                this.initPlayerData(this.data);\r\n            } else {\r\n                this.data = data.rankData as proto.IGuildBossRank\r\n                this.initGuildData(this.data);\r\n            }\r\n\r\n        }\r\n    }\r\n    initPlayerData(data:proto.ISimpleRank){\r\n        this.simpleRole = data.simple;\r\n        this.node_role.active = true;\r\n        const playerInfo = new SimpleRoleInfo();\r\n        playerInfo.merge(this.simpleRole);\r\n        this.palyerHerdItem.initHeadInfo({roleInfo:playerInfo});\r\n\r\n        this.lbl_role_damage.string = String(data.score);\r\n        this.lbl_role_name.string = this.simpleRole.name;\r\n        this.lbl_rank.string = String(this._rank_index + 4);\r\n    }\r\n    initGuildData(data:proto.IGuildBossRank){\r\n        if(data&&data.guild&&data.guild.simple){\r\n            this.node_guild.active = true;\r\n            this.simpleGuild = data.guild.simple;\r\n            this.createGuildData();\r\n        }\r\n    }\r\n    createGuildData(){\r\n        refreshFlagImg(this.simpleGuild?this.simpleGuild.flagId:0,this.sp_guild_flag);\r\n        this.lbl_guild_name.string = this.simpleGuild?this.simpleGuild.name:\"\";\r\n        this.lbl_guild_score.string = GameUtil.convertNumber(this.data.score);\r\n        this.lbl_members_count.string = LangMgr.getCombineString(\"ui_association_4\",[this.data.members]);\r\n        this.lbl_rank.string = String(this._rank_index + 4);\r\n    }\r\n    setPlayerMyRank(idx:number){\r\n        this.lbl_rank.string = String(idx);\r\n        if(idx>0&&idx<=3){\r\n            this.node.getChildByName(\"rank_node\").active = false;\r\n            this.node.getChildByName(\"myno1\").active = idx===1;\r\n            this.node.getChildByName(\"myno2\").active = idx===2;\r\n            this.node.getChildByName(\"myno3\").active = idx===3;\r\n        }else if(idx>3){\r\n            this.node.getChildByName(\"rank_node\").active = true;\r\n        }else{\r\n            this.lbl_rank.string = LangMgr.getLab(\"ui_rank_1\")\r\n        }\r\n        this.simpleGuild = AssociationData.ins.getAssocitionSimpleInfo();\r\n    }\r\n    onClickGuild() {\r\n        if(this.simpleGuild){\r\n            UIMgr.ins.show({ viewName: ViewName.AssociationMainPop, data: { \"rankData\": this.simpleGuild } })\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}