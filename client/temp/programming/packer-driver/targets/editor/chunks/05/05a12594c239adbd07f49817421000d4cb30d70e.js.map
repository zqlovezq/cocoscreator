{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/common/ResourceBuyItem.ts"],"names":["_decorator","Label","Node","Sprite","UITransform","Vec3","ComponentBase","tab","RoleData","ShowTips","UIMgr","RoleControl","ItemData","LangMgr","ViewName","AdMgr","BattleMainDataControl","GameUtil","HeroRed","ccclass","property","ResourceBuyItem","isHaveTime","costItemNum","costItemId","isGetStamina","isBuyGold","_buyGoldType","BuyGoldType","BuyGoldType_Buy1","register","initEnergyView","table","energyNode","active","advanceNode","disCoutNode","lasttime","ins","staminaInfo","remainBuyTimesMap","Type","lastTimeLab","string","DailyCount","numLable","GetItemNum","iconSpr","setTexture","ShowIcon","BuyStaminaType","BuyStaminaType_WatchAdverts","freeBtnNode","buyBtnNode","freeNumLab","accumulateNode","getChildByName","buyStaminaRedPoint","BuyStaminaType_UseCurrency","info","getData","ItemTableById","getValue","CostItemId","buyIconSpr","Icon","buyNumLab","convertNumber","CostItemNum","lt","BuyStaminaType_BuyMissStamina","accumulatenumLab","initGoldView","getGoldHistory","AdType","AdType_BuyGold","CostItemCount","gotTableData","ItemId","costTableData","count","PurchaseCount","timesNode","curAdTimes","getAdCountByType","maxAdTimes","getAdCountMaxByType","red_GoldBuy","lbl_common_name","getLab","Name","stageClearIds","getStageClearIds","length","lastStageId","patrolTab","PatrolTableByPveStageId","hourCount","BaseItemNum","getPrivilegeValue","VipBonus","VipBonus_PatrolMoneyRatio","BuyGoldType_Buy2","BuyGoldType_Buy3","onClickFree","playVideoAd","AdType_BuyStamina","requestBuyStamina","requestBuyGold","onClickBuy","id","isItemsEnoughByList","itemtab","getCombineString","onClickAccumulate","wordPos","node","worldPosition","x","getComponent","contentSize","width","y","show","viewName","EnergyAccumulatePop","data"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, Sprite, UITransform, v2, Vec3 } from 'cc';\r\nimport { ComponentBase } from '../../../framework/base/ComponentBase';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { Role } from '../../fight/base/obj/role/role/Role';\r\nimport { RoleData } from '../role/RoleData';\r\nimport { ShowTips, UIMgr } from '../../mgr/UIMgr';\r\nimport { RoleControl } from '../role/RoleControl';\r\nimport { ItemData } from '../item/ItemData';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { PlatformMgr } from '../../mgr/PlatformMgr';\r\nimport { AdMgr } from '../AdMgr';\r\nimport { BattleMainDataControl } from '../home/battle/BattleMainDataControl';\r\nimport { GameUtil } from '../../utils/GameUtil';\r\nimport { HeroRed } from '../hero/herobag/HeroRed';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * ResourceBuyItem\r\n * zhudingchao\r\n * Mon Jun 17 2024 14:08:04 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/common/ResourceBuyItem.ts\r\n *\r\n */\r\n\r\n@ccclass('ResourceBuyItem')\r\nexport class ResourceBuyItem extends ComponentBase {\r\n    @property(Node)\r\n    energyNode: Node = null;\r\n    @property(Node)\r\n    advanceNode: Node = null;\r\n    @property(Sprite)\r\n    iconSpr: Sprite = null;\r\n    @property(Node)\r\n    disCoutNode: Node = null;\r\n    @property(Label)\r\n    numLable: Label = null;\r\n    @property(Node)\r\n    multiNode: Node = null;\r\n    @property(Node)\r\n    timesNode: Node = null;\r\n    @property(Node)\r\n    buyBtnNode: Node = null;\r\n    @property(Node)\r\n    freeBtnNode: Node = null;\r\n    @property(Node)\r\n    accumulateNode: Node = null;\r\n    @property(Label)\r\n    accumulatenumLab: Label = null;\r\n    @property(Label)\r\n    lastTimeLab: Label = null;\r\n\r\n    @property(Sprite)\r\n    buyIconSpr: Sprite = null;\r\n    @property(Label)\r\n    buyNumLab: Label = null;\r\n    @property(Label)\r\n    freeNumLab: Label = null;\r\n    @property(Label)\r\n    lbl_common_name: Label = null;\r\n    private isHaveTime: boolean = false;\r\n    private costItemNum: number;\r\n    private costItemId: number;\r\n    private isGetStamina: boolean;\r\n    private isBuyGold: boolean = false;\r\n    private _buyGoldType: tab.BuyGoldType = tab.BuyGoldType.BuyGoldType_Buy1;\r\n    register(): void {\r\n\r\n    }\r\n    initEnergyView(table: tab.BuyStaminaTable) {\r\n        this.isGetStamina = true;\r\n        this.energyNode.active = true;\r\n        this.advanceNode.active = false;\r\n        this.disCoutNode.active = false;\r\n        let lasttime = RoleData.ins.staminaInfo.remainBuyTimesMap[table.Type];\r\n        this.lastTimeLab.string = lasttime + \"/\" + table.DailyCount;\r\n        this.isHaveTime = lasttime > 0;\r\n        this.numLable.string = \"x\" + table.GetItemNum + \"\"\r\n        this.iconSpr.setTexture(table.ShowIcon);\r\n        if (table.Type == tab.BuyStaminaType.BuyStaminaType_WatchAdverts) {\r\n            this.freeBtnNode.active = true;\r\n            this.buyBtnNode.active = false;\r\n            this.freeNumLab.string = \"(\" + lasttime + \"/\" + table.DailyCount + \")\";\r\n            this.accumulateNode.active = false;\r\n            this.freeBtnNode.getChildByName(\"redDot\").active = RoleControl.ins.buyStaminaRedPoint();\r\n\r\n        } else if (table.Type == tab.BuyStaminaType.BuyStaminaType_UseCurrency) {\r\n            this.freeBtnNode.active = false;\r\n            this.buyBtnNode.active = true;\r\n            let info = tab.getData().ItemTableById.getValue(table.CostItemId)\r\n            this.buyIconSpr.setTexture(info.Icon);\r\n            this.buyNumLab.string = GameUtil.convertNumber(table.CostItemNum) + \"\";\r\n            let lt = RoleData.ins.staminaInfo.remainBuyTimesMap[tab.BuyStaminaType.BuyStaminaType_BuyMissStamina];\r\n            this.accumulateNode.active = true;\r\n            // this.accumulateNode.active = lt > 0;\r\n            // if (lt > 0) {\r\n            this.accumulatenumLab.string = \"\" + lt;\r\n            // }\r\n            this.costItemId = table.CostItemId;\r\n            this.costItemNum = table.CostItemNum;\r\n        }\r\n    }\r\n    initGoldView(table: tab.BuyGoldTable) {\r\n        const info = RoleData.ins.getGoldHistory(table.Type);\r\n        this._buyGoldType = table.Type;\r\n        this.isBuyGold = true;\r\n        this.energyNode.active = false;\r\n        this.advanceNode.active = true;\r\n        // this.disCoutNode.active = true;\r\n        this.buyBtnNode.active = table.AdType !== tab.AdType.AdType_BuyGold;\r\n        this.freeBtnNode.active = table.AdType == tab.AdType.AdType_BuyGold;\r\n        this.costItemId = table.CostItemId;\r\n        this.costItemNum = table.CostItemCount;\r\n        const gotTableData = tab.getData().ItemTableById.getValue(table.ItemId[0])\r\n        const costTableData = tab.getData().ItemTableById.getValue(table.CostItemId)\r\n        this.iconSpr.setTexture(table.ShowIcon);\r\n        if (this.buyBtnNode.active) {\r\n            this.buyNumLab.string = table.CostItemCount + \"\";\r\n            this.buyIconSpr.setTexture(costTableData.Icon);\r\n            let lasttime = info.count;\r\n            this.lastTimeLab.string = (table.PurchaseCount-lasttime) + \"/\" + table.PurchaseCount;\r\n            this.isHaveTime = lasttime < table.PurchaseCount; \r\n            this.numLable.string = \"x\" + GameUtil.convertNumber(table.CostItemCount) + \"\"\r\n        } else {\r\n            this.timesNode.active = false;\r\n            const curAdTimes = AdMgr.ins.getAdCountByType(tab.AdType.AdType_BuyGold);\r\n            const maxAdTimes = AdMgr.ins.getAdCountMaxByType(tab.AdType.AdType_BuyGold);\r\n            this.freeNumLab.string = \"(\" + (maxAdTimes-curAdTimes) + \"/\" + maxAdTimes + \")\";\r\n            this.freeBtnNode.getChildByName(\"redDot\").active = HeroRed.ins.red_GoldBuy();\r\n            this.isHaveTime = maxAdTimes > curAdTimes;\r\n        }\r\n        this.lbl_common_name.string = LangMgr.getLab(gotTableData.Name);\r\n        // 计算俩小时的金币数量\r\n        const stageClearIds = BattleMainDataControl.ins.getStageClearIds();\r\n        if(stageClearIds.length>0){\r\n            const lastStageId = stageClearIds[stageClearIds.length-1];\r\n            const patrolTab = tab.getData().PatrolTableByPveStageId.getValue(lastStageId);\r\n            const hourCount = patrolTab.BaseItemNum[0]*6*(1 + RoleData.ins.getPrivilegeValue(tab.VipBonus.VipBonus_PatrolMoneyRatio) / 10000);\r\n            if (table.Type == tab.BuyGoldType.BuyGoldType_Buy1) {\r\n                this.numLable.string = \"x \"+GameUtil.convertNumber(2*hourCount)\r\n            } else if (table.Type == tab.BuyGoldType.BuyGoldType_Buy2) {\r\n                this.numLable.string = \"x \"+GameUtil.convertNumber(8*hourCount)\r\n            } else if (table.Type == tab.BuyGoldType.BuyGoldType_Buy3) {\r\n                this.numLable.string = \"x \"+GameUtil.convertNumber(24*hourCount)\r\n            }\r\n        }\r\n    }\r\n    onClickFree() {\r\n        if (this.isHaveTime) {\r\n            if (this.isGetStamina) {\r\n                AdMgr.ins.playVideoAd(tab.AdType.AdType_BuyStamina, () => {\r\n                    RoleControl.ins.requestBuyStamina(tab.BuyStaminaType.BuyStaminaType_WatchAdverts)\r\n                }, false)\r\n\r\n            } else if (this.isBuyGold) {\r\n                AdMgr.ins.playVideoAd(tab.AdType.AdType_BuyGold, () => {\r\n                    RoleControl.ins.requestBuyGold(tab.BuyGoldType.BuyGoldType_Buy1)\r\n                }, false)\r\n            }\r\n        } else {\r\n            //ShowTips(\"今日次数已用完\")\r\n            ShowTips(LangMgr.getLab(\"Tips_timeshortage\"))\r\n        }\r\n\r\n    }\r\n    onClickBuy() {\r\n        if (this.isHaveTime) {\r\n            let id = ItemData.ins.isItemsEnoughByList([this.costItemId], [this.costItemNum]);\r\n            if (id <= 0) {\r\n                if (this.isGetStamina) {\r\n                    RoleControl.ins.requestBuyStamina(tab.BuyStaminaType.BuyStaminaType_UseCurrency)\r\n                } else if (this.isBuyGold) {\r\n                    RoleControl.ins.requestBuyGold(this._buyGoldType);\r\n                }\r\n            } else {\r\n                let itemtab = tab.getData().ItemTableById.getValue(id);\r\n                ShowTips(LangMgr.getCombineString(\"Tips_itemshortage\", [LangMgr.getLab(itemtab.Name)]));\r\n                //ShowTips( LangMgr.getLab(itemtab.Name)+\"不足\");\r\n            }\r\n\r\n        } else {\r\n            //ShowTips(\"今日次数已用完\")\r\n            ShowTips(LangMgr.getLab(\"Tips_timeshortage\"))\r\n        }\r\n    }\r\n    onClickAccumulate() {\r\n        let wordPos = new Vec3(this.node.worldPosition.x + this.node.getComponent(UITransform).contentSize.width / 2 + 30, this.node.worldPosition.y);\r\n        UIMgr.ins.show({ viewName: ViewName.EnergyAccumulatePop, data: { \"worldPos\": wordPos } });\r\n    }\r\n\r\n}"]}