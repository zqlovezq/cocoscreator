{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/equip/EquipControl.ts"],"names":["EquipControl","_decorator","log","AbsControl","EventMgr","proto","EquipData","Net","tab","LocalEvent","ShowTips","LangMgr","ccclass","property","ins","_instance","register","onMsg","Ptl","ChangeEquipRsp","on_s2c_ChangeEquipRsp","EnhanceEquipRsp","on_s2c_EnhanceEquipRsp","RefineEquipRsp","on_s2c_RefineEquipRsp","UpdateHeroMasterLv","on_s2c_UpdateEquipMasterRsp","DecomposeEquipRsp","on_s2c_DecomposeEquipRsp","FeatherRecastRsp","on_s2c_FeatherRecastRsp","FeatherRecastConfirmRsp","on_s2c_FeatherRecastConfirmRsp","SwitchEquipRsp","on_s2c_SwitchEquipRsp","UndressEquipRsp","on_s2c_UndressEquipRsp","LockEquipRsp","on_s2c_LockEquipRsp","requestEquips","reqChangEquips","heroClass","euqipIds","msg","Msg_ChangeEquipReq","equipList","Send","ChangeEquipReq","reqOnekeyEquips","getEquipBagByHeroClass","types","EquipType","EquipType_Gloves","EquipType_Clothing","EquipType_Cloak","EquipType_Hat","slots","getEquipContainerDataByHeroClass","slotData","ids","key","type","slot","equipId","equipInfo","getEquipInfoById","currInfo","value","equipTable","Type","score","push","id","length","getLab","reqEnhanceEquips","slotList","Msg_EnhanceEquipReq","EnhanceEquipReq","reqAddTestEquips","reqRefineEquips","slotIndex","Msg_RefineEquipReq","RefineEquipReq","reqDecomposeEquips","equipIds","Msg_DecomposeEquipReq","DecomposeEquipReq","reqFeatherRecast","Msg_FeatherRecastReq","FeatherRecastReq","reqFeatherRecastConfirmReq","result","Msg_FeatherRecastConfirmReq","FeatherRecastConfirmReq","reqSwitchEquip","id1","id2","heroClass1","heroClass2","Msg_SwitchEquipReq","equipId1","equipId2","SwitchEquipReq","reqUndressEquip","Msg_UndressEquipReq","UndressEquipReq","reqLockEquip","isLock","Msg_LockEquipReq","state","LockEquipReq","error","code","CommonErrorCode","Succeed","changeEquip","updateEquipSlotData","updateData","updateEquipMasterData","masterData","updateEquipInfo","data","switchEquip","emitLocal","Equip_Chang","undressEquip","lockEquip"],"mappings":";;;iLAcaA,Y;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAdEC,MAAAA,U,OAAAA,U;AAAgBC,MAAAA,G,OAAAA,G;;AACtBC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,K,oBAAAA,K;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,O,iBAAAA,O;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBZ,U;AAE9B;;8BACaD,Y,GAAN,MAAMA,YAAN;AAAA;AAAA,oCAAsC;AAGpB,mBAAHc,GAAG,GAAG;AACpB,cAAI,QAAQ,KAAKC,SAAjB,EAA4B;AACxB,iBAAKA,SAAL,GAAiB,IAAIf,YAAJ,EAAjB;AACH;;AACD,iBAAO,KAAKe,SAAZ;AACH;;AAEDC,QAAAA,QAAQ,GAAS;AACb;AAAA;AAAA,oCAASC,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUC,cAAzB,EAAyC,KAAKC,qBAA9C,EAAqE,IAArE;AACA;AAAA;AAAA,oCAASH,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUG,eAAzB,EAA0C,KAAKC,sBAA/C,EAAuE,IAAvE;AACA;AAAA;AAAA,oCAASL,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUK,cAAzB,EAAyC,KAAKC,qBAA9C,EAAqE,IAArE;AACA;AAAA;AAAA,oCAASP,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUO,kBAAzB,EAA6C,KAAKC,2BAAlD,EAA+E,IAA/E;AACA;AAAA;AAAA,oCAAST,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUS,iBAAzB,EAA4C,KAAKC,wBAAjD,EAA2E,IAA3E;AACA;AAAA;AAAA,oCAASX,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUW,gBAAzB,EAA2C,KAAKC,uBAAhD,EAAyE,IAAzE;AACA;AAAA;AAAA,oCAASb,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUa,uBAAzB,EAAkD,KAAKC,8BAAvD,EAAuF,IAAvF;AACA;AAAA;AAAA,oCAASf,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUe,cAAzB,EAAyC,KAAKC,qBAA9C,EAAqE,IAArE;AACA;AAAA;AAAA,oCAASjB,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUiB,eAAzB,EAA0C,KAAKC,sBAA/C,EAAuE,IAAvE;AACA;AAAA;AAAA,oCAASnB,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUmB,YAAzB,EAAuC,KAAKC,mBAA5C,EAAiE,IAAjE;AAGH;;AAEDC,QAAAA,aAAa,GAAG,CAEf;AACD;AACJ;AACA;;;AACIC,QAAAA,cAAc,CAACC,SAAD,EAAoBC,QAApB,EAA6C;AACvD,cAAIC,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAMC,kBAAV,EAAV;AACAD,UAAAA,GAAG,CAACE,SAAJ,GAAgBH,QAAhB;AACAC,UAAAA,GAAG,CAACF,SAAJ,GAAgBA,SAAhB;AACA;AAAA;AAAA,0BAAIK,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAU6B,cAAnB,EAAmCJ,GAAnC;AACH;AACD;;;AACAK,QAAAA,eAAe,CAACP,SAAD,EAAoB;AAC/B,cAAII,SAAS,GAAG;AAAA;AAAA,sCAAU/B,GAAV,CAAcmC,sBAAd,CAAqCR,SAArC,CAAhB;AACA,cAAIS,KAAK,GAAG,CAAC;AAAA;AAAA,0BAAIC,SAAJ,CAAcC,gBAAf,EAAiC;AAAA;AAAA,0BAAID,SAAJ,CAAcE,kBAA/C,EAAmE;AAAA;AAAA,0BAAIF,SAAJ,CAAcG,eAAjF,EAAkG;AAAA;AAAA,0BAAIH,SAAJ,CAAcI,aAAhH,CAAZ;AACA,cAAIC,KAAK,GAAG;AAAA;AAAA,sCAAU1C,GAAV,CAAc2C,gCAAd,CAA+ChB,SAA/C,EAA0DiB,QAAtE;AACA,cAAIC,GAAG,GAAG,EAAV;;AACA,eAAK,IAAIC,GAAT,IAAgBV,KAAhB,EAAuB;AACnB,gBAAIW,IAAI,GAAGX,KAAK,CAACU,GAAD,CAAhB;AACA,gBAAIE,IAAI,GAAGN,KAAK,CAACK,IAAD,CAAhB;;AACA,gBAAIC,IAAI,IAAIA,IAAI,CAACC,OAAL,IAAgB,CAA5B,EAA+B;AAC3B,kBAAIC,SAAS,GAAG;AAAA;AAAA,0CAAUlD,GAAV,CAAcmD,gBAAd,CAA+BH,IAAI,CAACC,OAApC,CAAhB;AACA,kBAAIG,QAAQ,GAAG,IAAf;;AACA,mBAAK,IAAIC,KAAT,IAAkBtB,SAAlB,EAA6B;AACzB,oBAAIsB,KAAK,CAACC,UAAN,CAAiBC,IAAjB,IAAyBR,IAA7B,EAAmC;AAC/B,sBAAIM,KAAK,CAACG,KAAN,GAAcN,SAAS,CAACM,KAA5B,EAAmC;AAC/B,wBAAIJ,QAAJ,EAAc;AACV,0BAAIC,KAAK,CAACG,KAAN,GAAcJ,QAAQ,CAACI,KAA3B,EAAkC;AAC9BJ,wBAAAA,QAAQ,GAAGC,KAAX;AACH;AACJ,qBAJD,MAIO;AACHD,sBAAAA,QAAQ,GAAGC,KAAX;AACH;AACJ;AACJ;AACJ;;AACD,kBAAID,QAAJ,EAAc;AACVP,gBAAAA,GAAG,CAACY,IAAJ,CAASL,QAAQ,CAACM,EAAlB;AACH;AACJ,aAnBD,MAmBO;AACH,kBAAIN,QAAQ,GAAG,IAAf;;AACA,mBAAK,IAAIC,KAAT,IAAkBtB,SAAlB,EAA6B;AACzB,oBAAIsB,KAAK,CAACC,UAAN,CAAiBC,IAAjB,IAAyBR,IAA7B,EAAmC;AAC/B,sBAAIK,QAAJ,EAAc;AACV,wBAAIC,KAAK,CAACG,KAAN,GAAcJ,QAAQ,CAACI,KAA3B,EAAkC;AAC9BJ,sBAAAA,QAAQ,GAAGC,KAAX;AACH;AACJ,mBAJD,MAIO;AACHD,oBAAAA,QAAQ,GAAGC,KAAX;AACH;AACJ;AAEJ;;AACD,kBAAID,QAAJ,EAAc;AACVP,gBAAAA,GAAG,CAACY,IAAJ,CAASL,QAAQ,CAACM,EAAlB;AACH;AACJ;AACJ;;AACD,cAAIb,GAAG,CAACc,MAAJ,GAAa,CAAjB,EAAoB;AAChB,iBAAKjC,cAAL,CAAoBC,SAApB,EAA+BkB,GAA/B;AACH,WAFD,MAEK;AACD;AACA;AAAA;AAAA,sCAAS;AAAA;AAAA,oCAAQe,MAAR,CAAe,aAAf,CAAT;AACH;AAEJ;AACD;AACJ;AACA;;;AACIC,QAAAA,gBAAgB,CAAClC,SAAD,EAAoBmC,QAApB,EAA6C;AACzD,cAAIjC,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAMkC,mBAAV,EAAV;AACAlC,UAAAA,GAAG,CAACiC,QAAJ,GAAeA,QAAf;AACAjC,UAAAA,GAAG,CAACF,SAAJ,GAAgBA,SAAhB;AACA;AAAA;AAAA,0BAAIK,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAU4D,eAAnB,EAAoCnC,GAApC;AACH;AACD;;;AACAoC,QAAAA,gBAAgB,GAAG,CACf;AACA;AACH;AAED;AACJ;AACA;;;AACIC,QAAAA,eAAe,CAACvC,SAAD,EAAoBwC,SAApB,EAAuC;AAClD,cAAItC,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAMuC,kBAAV,EAAV;AACAvC,UAAAA,GAAG,CAACsC,SAAJ,GAAgBA,SAAhB;AACAtC,UAAAA,GAAG,CAACF,SAAJ,GAAgBA,SAAhB;AACA;AAAA;AAAA,0BAAIK,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAUiE,cAAnB,EAAmCxC,GAAnC;AACH;AACD;AACJ;AACA;;;AACIyC,QAAAA,kBAAkB,CAACC,QAAD,EAA0B;AACxCnF,UAAAA,GAAG,CAAC,aAAD,EAAgBmF,QAAhB,CAAH;AACA,cAAI1C,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAM2C,qBAAV,EAAV;AACA3C,UAAAA,GAAG,CAACE,SAAJ,GAAgBwC,QAAhB;AACA;AAAA;AAAA,0BAAIvC,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAUqE,iBAAnB,EAAsC5C,GAAtC;AACH;AAED;AACJ;AACA;;;AACI6C,QAAAA,gBAAgB,CAACzB,OAAD,EAAkB;AAC9B7D,UAAAA,GAAG,CAAC,aAAD,EAAgB6D,OAAhB,CAAH;AACA,cAAIpB,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAM8C,oBAAV,EAAV;AACA9C,UAAAA,GAAG,CAACoB,OAAJ,GAAcA,OAAd;AACA;AAAA;AAAA,0BAAIjB,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAUwE,gBAAnB,EAAqC/C,GAArC;AACH;AACD;AACJ;AACA;;;AACIgD,QAAAA,0BAA0B,CAAC5B,OAAD,EAAiB6B,MAAjB,EAA0E;AAChG1F,UAAAA,GAAG,CAAC,qBAAD,EAAwB6D,OAAxB,CAAH;AACA,cAAIpB,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAMkD,2BAAV,EAAV;AACAlD,UAAAA,GAAG,CAACoB,OAAJ,GAAcA,OAAd;AACApB,UAAAA,GAAG,CAACiD,MAAJ,GAAWA,MAAX;AACA;AAAA;AAAA,0BAAI9C,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAU4E,uBAAnB,EAA4CnD,GAA5C;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;;AACIoD,QAAAA,cAAc,CAACC,GAAD,EAAYC,GAAZ,EAAuBC,UAAvB,EAAyCC,UAAzC,EAA2D;AACrE,cAAIxD,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAMyD,kBAAV,EAAV;AACAzD,UAAAA,GAAG,CAAC0D,QAAJ,GAAeL,GAAf;AACArD,UAAAA,GAAG,CAAC2D,QAAJ,GAAaL,GAAb;AACAtD,UAAAA,GAAG,CAACuD,UAAJ,GAAeA,UAAf;AACAvD,UAAAA,GAAG,CAACwD,UAAJ,GAAeA,UAAf;AACA;AAAA;AAAA,0BAAIrD,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAUqF,cAAnB,EAAmC5D,GAAnC;AACH;;AAED6D,QAAAA,eAAe,CAAChC,EAAD,EAAW/B,SAAX,EAA4B;AACvC,cAAIE,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAM8D,mBAAV,EAAV;AACA9D,UAAAA,GAAG,CAACoB,OAAJ,GAAcS,EAAd;AACA7B,UAAAA,GAAG,CAACF,SAAJ,GAAcA,SAAd;AACA;AAAA;AAAA,0BAAIK,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAUwF,eAAnB,EAAoC/D,GAApC;AACH;;AACDgE,QAAAA,YAAY,CAACnC,EAAD,EAAWoC,MAAX,EAA0B;AAClC,cAAIjE,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAMkE,gBAAV,EAAV;AACAlE,UAAAA,GAAG,CAACoB,OAAJ,GAAcS,EAAd;AACA7B,UAAAA,GAAG,CAACmE,KAAJ,GAAUF,MAAM,GAAC,CAAD,GAAG,CAAnB;AACA;AAAA;AAAA,0BAAI9D,IAAJ,CAAS;AAAA;AAAA,8BAAM5B,GAAN,CAAU6F,YAAnB,EAAiCpE,GAAjC;AACH;AAED;AACJ;AACA;AACA;;;AACIvB,QAAAA,qBAAqB,CAACuB,GAAD,EAAgC;AACjD,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD;AAAA;AAAA,wCAAUrG,GAAV,CAAcsG,WAAd,CAA0BzE,GAAG,CAACE,SAA9B,EAAyCF,GAAG,CAACF,SAA7C;AACH;AAGJ;AACD;AACJ;AACA;AACA;;;AACInB,QAAAA,sBAAsB,CAACqB,GAAD,EAAiC;AACnD,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD;AAAA;AAAA,wCAAUrG,GAAV,CAAcuG,mBAAd,CAAkC1E,GAAG,CAACF,SAAtC,EAAiDE,GAAG,CAAC2E,UAArD;AAEH;AAEJ;AACD;AACJ;AACA;AACA;;;AACI9F,QAAAA,qBAAqB,CAACmB,GAAD,EAAgC;AACjD,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD;AAAA;AAAA,wCAAUrG,GAAV,CAAcuG,mBAAd,CAAkC1E,GAAG,CAACF,SAAtC,EAAiD,CAACE,GAAG,CAAC2E,UAAL,CAAjD;AAEH;AAEJ;AACD;AACJ;AACA;AACA;;;AACI5F,QAAAA,2BAA2B,CAACiB,GAAD,EAAoC;AAC3D;AAAA;AAAA,sCAAU7B,GAAV,CAAcyG,qBAAd,CAAoC5E,GAAG,CAACF,SAAxC,EAAmDE,GAAG,CAAC6E,UAAvD;AACH;AACD;AACJ;AACA;AACA;;;AACI5F,QAAAA,wBAAwB,CAACe,GAAD,EAAmC;AACvD,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD,CACjD;AACH,WAHsD,CAIvD;;AACH;AAED;AACJ;AACA;AACA;;;AACIrF,QAAAA,uBAAuB,CAACa,GAAD,EAAkC;AACrD,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD;AAAA;AAAA,wCAAUrG,GAAV,CAAc2G,eAAd,CAA8B9E,GAAG,CAAC+E,IAAlC;AACH,WAHoD,CAIrD;;AACH;AACD;AACJ;AACA;AACA;;;AACI1F,QAAAA,8BAA8B,CAACW,GAAD,EAAyC;AACnE,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD;AAAA;AAAA,wCAAUrG,GAAV,CAAc2G,eAAd,CAA8B9E,GAAG,CAAC+E,IAAlC;AACH,WAHkE,CAInE;;AACH;;AAEDxF,QAAAA,qBAAqB,CAACS,GAAD,EAAgC;AACjD,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD,gBAAInB,GAAG,GAACrD,GAAG,CAAC2D,QAAZ;AACA,gBAAIL,GAAG,GAACtD,GAAG,CAAC0D,QAAZ,CAFiD,CAGjD;;AAED;AAAA;AAAA,wCAAUvF,GAAV,CAAc6G,WAAd,CAA0B3B,GAA1B,EAA8BC,GAA9B,EAAkCtD,GAAG,CAACuD,UAAtC,EAAiDvD,GAAG,CAACwD,UAArD,EALkD,CAMrD;AAEA;;AACG;AAAA;AAAA,sCAASyB,SAAT,CAAmB;AAAA;AAAA,0CAAWC,WAA9B,EAA0ClF,GAAG,CAACuD,UAA9C,EAAyDF,GAAzD;AACA;AAAA;AAAA,sCAAS4B,SAAT,CAAmB;AAAA;AAAA,0CAAWC,WAA9B,EAA0ClF,GAAG,CAACwD,UAA9C,EAAyDF,GAAzD,EAVkD,CAWjD;AACH,WAbgD,CAcjD;;AACH;;AAED7D,QAAAA,sBAAsB,CAACO,GAAD,EAAgC;AAClD,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD;AACC;AACA;AAAA;AAAA,wCAAUrG,GAAV,CAAcgH,YAAd,CAA2BnF,GAAG,CAACoB,OAA/B,EAAuCpB,GAAG,CAACF,SAA3C;AACA;AAAA;AAAA,sCAASmF,SAAT,CAAmB;AAAA;AAAA,0CAAWC,WAA9B,EAA0ClF,GAAG,CAACF,SAA9C,EAAwDE,GAAG,CAACoB,OAA5D;AACH;AACL;;AAEDzB,QAAAA,mBAAmB,CAACK,GAAD,EAA6B;AAC5C,cAAIA,GAAG,CAACqE,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAA5C,EAAqD;AACjD;AACC;AACA;AAAA;AAAA,wCAAUrG,GAAV,CAAciH,SAAd,CAAwBpF,GAAG,CAACoB,OAA5B,EAAoCpB,GAAG,CAACmE,KAAJ,IAAW,CAA/C,EAHgD,CAIjD;AACF;AACL;;AAvRwC,O;;AAAhC9G,MAAAA,Y,CAEMe,S","sourcesContent":["import { Node, _decorator, js, log, sys } from \"cc\";\nimport { AbsControl } from \"../../../framework/base/IAbs\";\nimport { EventMgr } from \"../../mgr/EventMgr\";\nimport { proto } from \"client_protocol\";\nimport { EquipData } from \"./EquipData\";\nimport { Net } from \"../../net/Net\";\nimport { tab } from \"../../../Table/table_gen\";\nimport { LocalEvent } from \"../../define/LocalEvent\";\nimport { ShowTips } from \"../../mgr/UIMgr\";\nimport { LangMgr } from \"../../mgr/LangMgr\";\n\nconst { ccclass, property } = _decorator;\n\n/** 装备 */\nexport class EquipControl extends AbsControl {\n\n    private static _instance: EquipControl;\n    public static get ins() {\n        if (null == this._instance) {\n            this._instance = new EquipControl();\n        }\n        return this._instance;\n    }\n\n    register(): void {\n        EventMgr.onMsg(proto.Ptl.ChangeEquipRsp, this.on_s2c_ChangeEquipRsp, this);\n        EventMgr.onMsg(proto.Ptl.EnhanceEquipRsp, this.on_s2c_EnhanceEquipRsp, this);\n        EventMgr.onMsg(proto.Ptl.RefineEquipRsp, this.on_s2c_RefineEquipRsp, this);\n        EventMgr.onMsg(proto.Ptl.UpdateHeroMasterLv, this.on_s2c_UpdateEquipMasterRsp, this);\n        EventMgr.onMsg(proto.Ptl.DecomposeEquipRsp, this.on_s2c_DecomposeEquipRsp, this)\n        EventMgr.onMsg(proto.Ptl.FeatherRecastRsp, this.on_s2c_FeatherRecastRsp, this)\n        EventMgr.onMsg(proto.Ptl.FeatherRecastConfirmRsp, this.on_s2c_FeatherRecastConfirmRsp, this)\n        EventMgr.onMsg(proto.Ptl.SwitchEquipRsp, this.on_s2c_SwitchEquipRsp, this);\n        EventMgr.onMsg(proto.Ptl.UndressEquipRsp, this.on_s2c_UndressEquipRsp, this);\n        EventMgr.onMsg(proto.Ptl.LockEquipRsp, this.on_s2c_LockEquipRsp, this);\n       \n\n    }\n\n    requestEquips() {\n\n    }\n    /**\n     * 请求替换 穿戴 装备\n     */\n    reqChangEquips(heroClass: number, euqipIds: Array<number>) {\n        let msg = new proto.Msg_ChangeEquipReq();\n        msg.equipList = euqipIds;\n        msg.heroClass = heroClass;\n        Net.Send(proto.Ptl.ChangeEquipReq, msg)\n    }\n    /**请求一键穿戴装备 */\n    reqOnekeyEquips(heroClass: number) {\n        let equipList = EquipData.ins.getEquipBagByHeroClass(heroClass);\n        let types = [tab.EquipType.EquipType_Gloves, tab.EquipType.EquipType_Clothing, tab.EquipType.EquipType_Cloak, tab.EquipType.EquipType_Hat]\n        let slots = EquipData.ins.getEquipContainerDataByHeroClass(heroClass).slotData;\n        let ids = [];\n        for (let key in types) {\n            let type = types[key];\n            let slot = slots[type];\n            if (slot && slot.equipId != 0) {\n                let equipInfo = EquipData.ins.getEquipInfoById(slot.equipId);\n                let currInfo = null;\n                for (let value of equipList) {\n                    if (value.equipTable.Type == type) {\n                        if (value.score > equipInfo.score) {\n                            if (currInfo) {\n                                if (value.score > currInfo.score) {\n                                    currInfo = value;\n                                }\n                            } else {\n                                currInfo = value;\n                            }\n                        }\n                    }\n                }\n                if (currInfo) {\n                    ids.push(currInfo.id);\n                }\n            } else {\n                let currInfo = null;\n                for (let value of equipList) {\n                    if (value.equipTable.Type == type) {\n                        if (currInfo) {\n                            if (value.score > currInfo.score) {\n                                currInfo = value;\n                            }\n                        } else {\n                            currInfo = value;\n                        }\n                    }\n\n                }\n                if (currInfo) {\n                    ids.push(currInfo.id);\n                }\n            }\n        }\n        if (ids.length > 0) {\n            this.reqChangEquips(heroClass, ids);\n        }else{\n            //ShowTips(\"没有可穿戴的装备\")\n            ShowTips(LangMgr.getLab(\"ui_equip_28\"))\n        }\n\n    }\n    /**\n     * 请求强化装备\n     */\n    reqEnhanceEquips(heroClass: number, slotList: Array<number>) {\n        let msg = new proto.Msg_EnhanceEquipReq();\n        msg.slotList = slotList;\n        msg.heroClass = heroClass;\n        Net.Send(proto.Ptl.EnhanceEquipReq, msg)\n    }\n    /**请求添加测试装备 */\n    reqAddTestEquips() {\n        // let msg = new proto.Msg_FinishStageReq;\n        // Net.Send(proto.Ptl.FinishStageReq, msg);\n    }\n\n    /**\n    * 请求淬炼装备\n    */\n    reqRefineEquips(heroClass: number, slotIndex: number) {\n        let msg = new proto.Msg_RefineEquipReq();\n        msg.slotIndex = slotIndex;\n        msg.heroClass = heroClass;\n        Net.Send(proto.Ptl.RefineEquipReq, msg)\n    }\n    /**\n    * 请求分解装备\n    */\n    reqDecomposeEquips(equipIds: Array<number>) {\n        log(\"分解---------\", equipIds)\n        let msg = new proto.Msg_DecomposeEquipReq();\n        msg.equipList = equipIds;\n        Net.Send(proto.Ptl.DecomposeEquipReq, msg)\n    }\n\n    /**\n    * 请求羽毛重铸\n    */\n    reqFeatherRecast(equipId: number) {\n        log(\"重铸---------\", equipId)\n        let msg = new proto.Msg_FeatherRecastReq();\n        msg.equipId = equipId;\n        Net.Send(proto.Ptl.FeatherRecastReq, msg)\n    }\n    /**\n    * 请求羽毛重铸\n    */\n    reqFeatherRecastConfirmReq(equipId: number,result: proto.Msg_FeatherRecastConfirmReq.ConfirmResult) {\n        log(\"重铸---------结果------\", equipId)\n        let msg = new proto.Msg_FeatherRecastConfirmReq();\n        msg.equipId = equipId;\n        msg.result=result;\n        Net.Send(proto.Ptl.FeatherRecastConfirmReq, msg)\n    }\n    /**\n     * 请求交换装备\n     * @param id1 \n     * @param id2 \n     * @param heroClass1 \n     * @param heroClass2 \n     */\n    reqSwitchEquip(id1:number,id2:number,heroClass1:number,heroClass2:number){\n        let msg = new proto.Msg_SwitchEquipReq();\n        msg.equipId1 = id1;\n        msg.equipId2=id2;\n        msg.heroClass1=heroClass1;\n        msg.heroClass2=heroClass2;\n        Net.Send(proto.Ptl.SwitchEquipReq, msg)\n    }\n\n    reqUndressEquip(id:number,heroClass:number){\n        let msg = new proto.Msg_UndressEquipReq();\n        msg.equipId = id;\n        msg.heroClass=heroClass;\n        Net.Send(proto.Ptl.UndressEquipReq, msg)\n    }\n    reqLockEquip(id:number,isLock:boolean){\n        let msg = new proto.Msg_LockEquipReq();\n        msg.equipId = id;\n        msg.state=isLock?1:0;\n        Net.Send(proto.Ptl.LockEquipReq, msg)\n    }\n\n    /**\n     * 替换装备成功\n     * @param msg \n     */\n    on_s2c_ChangeEquipRsp(msg: proto.Msg_ChangeEquipRsp) {\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            EquipData.ins.changeEquip(msg.equipList, msg.heroClass);\n        }\n\n\n    }\n    /**\n     * 强化装备成功\n     * @param msg \n     */\n    on_s2c_EnhanceEquipRsp(msg: proto.Msg_EnhanceEquipRsp) {\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            EquipData.ins.updateEquipSlotData(msg.heroClass, msg.updateData);\n         \n        }\n\n    }\n    /**\n    * 淬炼装备成功\n    * @param msg \n    */\n    on_s2c_RefineEquipRsp(msg: proto.Msg_RefineEquipRsp) {\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            EquipData.ins.updateEquipSlotData(msg.heroClass, [msg.updateData]);\n            \n        }\n\n    }\n    /**\n     * 更新装备大师数据\n     * @param msg \n     */\n    on_s2c_UpdateEquipMasterRsp(msg: proto.Msg_UpdateHeroMasterLv) {\n        EquipData.ins.updateEquipMasterData(msg.heroClass, msg.masterData);\n    }\n    /**\n    * 分解装备成功\n    * @param msg \n    */\n    on_s2c_DecomposeEquipRsp(msg: proto.Msg_DecomposeEquipRsp) {\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            // EquipData.ins.removeEquipByIds(msg.equipList);\n        }\n        // EquipData.ins.updateEquipMasterData(msg.heroClass,msg.masterData);\n    }\n\n    /**\n     * 羽毛重铸\n     * @param msg \n     */\n    on_s2c_FeatherRecastRsp(msg: proto.Msg_FeatherRecastRsp) {\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            EquipData.ins.updateEquipInfo(msg.data as proto.EquipData);\n        }\n        // EquipData.ins.updateEquipMasterData(msg.heroClass,msg.masterData);\n    }\n    /**\n    * 羽毛重铸\n    * @param msg \n    */\n    on_s2c_FeatherRecastConfirmRsp(msg: proto.Msg_FeatherRecastConfirmRsp) {\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            EquipData.ins.updateEquipInfo(msg.data as proto.EquipData);\n        }\n        // EquipData.ins.updateEquipMasterData(msg.heroClass,msg.masterData);\n    }\n    \n    on_s2c_SwitchEquipRsp(msg: proto.Msg_SwitchEquipRsp) {\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            let id1=msg.equipId2;\n            let id2=msg.equipId1; \n            //req的参数rsp时会原封返回给前端，前端需要根据回传自己做脱卸或穿戴操作\n\n           EquipData.ins.switchEquip(id1,id2,msg.heroClass1,msg.heroClass2);\n        //    if(msg.equipId1&&msg.equipId1!=0){\n            \n        //    }\n           EventMgr.emitLocal(LocalEvent.Equip_Chang,msg.heroClass1,id1);\n           EventMgr.emitLocal(LocalEvent.Equip_Chang,msg.heroClass2,id2);\n            // EquipData.ins.updateEquipInfo();\n        }\n        // EquipData.ins.updateEquipMasterData(msg.heroClass,msg.masterData);\n    }\n    \n    on_s2c_UndressEquipRsp(msg: proto.Msg_UndressEquipRsp){\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            // EquipData.ins.switchEquip(msg.equipId1,msg.equipId2,msg.heroClass1,msg.heroClass2)\n             // EquipData.ins.updateEquipInfo();\n             EquipData.ins.undressEquip(msg.equipId,msg.heroClass);\n             EventMgr.emitLocal(LocalEvent.Equip_Chang,msg.heroClass,msg.equipId);\n         }\n    }\n     \n    on_s2c_LockEquipRsp(msg: proto.Msg_LockEquipRsp){\n        if (msg.error.code == proto.CommonErrorCode.Succeed) {\n            // EquipData.ins.switchEquip(msg.equipId1,msg.equipId2,msg.heroClass1,msg.heroClass2)\n             // EquipData.ins.updateEquipInfo();\n             EquipData.ins.lockEquip(msg.equipId,msg.state==1);\n            //  EventMgr.emitLocal(LocalEvent.Equip_Chang,msg.heroClass,msg.equipId);\n         }\n    }\n    \n}"]}