{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/hero/herobag/HeroMaterialItem.ts"],"names":["_decorator","Color","Component","Label","Node","Sprite","HeroData","LangMgr","HeroStar","tab","HeroDataControl","UIMgr","ViewName","ccclass","property","HeroMaterialItem","_heroInfo","_curCount","_curMaterialType","HeroStarUpType","HeroStarUpType_SameNameHero","_stepId","setMaterial","type","heroClass","stepId","ins","getById","heroId","sp_head","setTexture","itemTable","Icon","node_specify","active","obj","_heroStar","_heroName","getLab","Name","_heroClass","HeroClass","heroClassTab","getData","HeroClassTableByHeroClass","getValue","sp_vocation","getHerosByType","star","node_star","getComponent","showStar","lbl_hero_name","string","getCombineString","HeroStarUpType_SameClassHero","itemQualityTab","getItemQualityTableByStar","sp_quality_bg","QualityFrame","sp_quality_star_bg","HeroStarBg","getHerosMaterialMapCount","node_universal","node_universal_add","needCount","lbl_hero_num","color","fromHEX","clickMaterial","show","viewName","HeroMaterialPop","data","onDisable"],"mappings":"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","sourcesContent":["import { _decorator, Color, Component, Label, Node, Sprite } from 'cc';\r\nimport { HeroData } from '../HeroData';\r\nimport { HeroInfo } from '../HeroInfo';\r\nimport { LangMgr } from '../../../mgr/LangMgr';\r\nimport { HeroStar } from '../HeroStar';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { HeroDataControl } from './HeroDataControl';\r\nimport { UIMgr } from '../../../mgr/UIMgr';\r\nimport { ViewName } from '../../../define/ViewDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('HeroMaterialItem')\r\nexport class HeroMaterialItem extends Component {\r\n    @property(Sprite)\r\n    sp_head:Sprite = null;\r\n    @property(Sprite)\r\n    sp_quality_bg:Sprite = null;//品质框\r\n    @property(Sprite)\r\n    sp_quality_star_bg:Sprite = null;//装备星级职业底\r\n    @property(Sprite)\r\n    sp_vocation:Sprite = null;\r\n    \r\n    @property(Label)\r\n    lbl_hero_num:Label = null;\r\n    @property(Label)\r\n    lbl_hero_name:Label = null;\r\n\r\n    @property(Node)\r\n    node_star:Node = null;\r\n    @property(Node)\r\n    node_specify:Node = null;\r\n    @property(Node)\r\n    node_universal:Node = null;\r\n    @property(Node)\r\n    node_universal_add:Node = null;\r\n\r\n\r\n    private _heroInfo:HeroInfo = null;\r\n    private _curCount:number = null;\r\n    private _curMaterialType:tab.HeroStarUpType = tab.HeroStarUpType.HeroStarUpType_SameNameHero;\r\n    private _stepId:number = 0;\r\n    setMaterial(type:tab.HeroStarUpType,heroClass:tab.HeroClass,stepId?:number){\r\n        this._heroInfo = HeroData.ins.getById(HeroDataControl.ins.heroId);\r\n        this._curMaterialType = type;\r\n        if(stepId){\r\n            this._stepId = stepId;\r\n        }\r\n        this.sp_head.setTexture(this._heroInfo.itemTable.Icon);\r\n        this.node_specify.active = type==tab.HeroStarUpType.HeroStarUpType_SameNameHero;\r\n\r\n        let obj = null;\r\n        let _heroStar = 0;\r\n        let _heroName = LangMgr.getLab(this._heroInfo.itemTable.Name);\r\n        let _heroClass = LangMgr.getLab(tab.HeroClass[heroClass]);\r\n        const heroClassTab = tab.getData().HeroClassTableByHeroClass.getValue(heroClass);\r\n        this.sp_vocation.setTexture(heroClassTab.Icon);\r\n        obj = this._heroInfo.getHerosByType(type,this._stepId);\r\n        _heroStar = obj.star;\r\n        this.node_star.getComponent(HeroStar).showStar(_heroStar);\r\n        if(type==tab.HeroStarUpType.HeroStarUpType_SameNameHero){\r\n            this.lbl_hero_name.string = LangMgr.getCombineString(\"Tips_herostarup1\",[_heroStar,_heroName]);\r\n        }else if(type==tab.HeroStarUpType.HeroStarUpType_SameClassHero){\r\n            this.lbl_hero_name.string = LangMgr.getCombineString(\"Tips_herostarup2\",[_heroStar,_heroClass]);\r\n        }else{\r\n            this.lbl_hero_name.string = LangMgr.getCombineString(\"Tips_herostarup3\",[_heroStar]);\r\n        }\r\n\r\n        let itemQualityTab = HeroDataControl.ins.getItemQualityTableByStar(_heroStar);\r\n        this.sp_quality_bg.setTexture(itemQualityTab.QualityFrame);\r\n        this.sp_quality_star_bg.setTexture(itemQualityTab.HeroStarBg);\r\n\r\n        // this._curCount = obj.map.size\r\n        this._curCount = this._heroInfo.getHerosMaterialMapCount(type);\r\n        this.node_universal.active = type!==tab.HeroStarUpType.HeroStarUpType_SameNameHero;\r\n        this.node_universal_add.active = this._curCount<obj.needCount;\r\n        this.lbl_hero_num.string = this._curCount+\"/\"+obj.needCount;\r\n        if(this._curCount>=obj.needCount){\r\n            this.lbl_hero_num.color = new Color().fromHEX(\"#FFFFFF\");\r\n        }else{\r\n            this.lbl_hero_num.color = new Color().fromHEX(\"#FC1818\");\r\n        }\r\n    }\r\n    clickMaterial(){\r\n        if(this._curMaterialType===tab.HeroStarUpType.HeroStarUpType_SameNameHero){\r\n            return\r\n        }\r\n        UIMgr.ins.show({ viewName: ViewName.HeroMaterialPop,data:{\r\n            type:this._curMaterialType,\r\n            stepId:this._stepId\r\n        }})\r\n    }\r\n    protected onDisable(): void {\r\n        this.node_star.getComponent(HeroStar).onDisable();\r\n    }\r\n}\r\n\r\n\r\n"]}