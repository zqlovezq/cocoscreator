{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/activity/firstRecharge/FirstRechargePop.ts"],"names":["_decorator","Label","Node","RichText","sp","Sprite","Toggle","ViewPop","tab","ItemPoolMgr","ItemInfo","LangMgr","LoadResAsync","HeroDataControl","ViewName","UIMgr","PayData","PayControl","ChannelMgr","RoleData","RedMgr","RedDotType","CommonTipsPop","HeroItem","ccclass","property","FirstRechargePop","Skeleton","firstTable","register","onShow","table","ins","getFirstRechargeTable","node_toggles","Id","getComponent","isChecked","refreshEvent","First_Recharge","initView","setClientData","String","setToggles","tables","getFirstRechargeTabs","boughtGoodsIds","payInfoMsg","firstRechargeInfo","node_one_buy","active","length","i","_tab","_id","indexOf","getFirstTab","id","key","switchView","e","type","Number","otherItemLayout","destroyAllChildren","mainItemNode","itemInfo","initItemData","FRItemIds","FRItemNum","heroNode","createRewadItem","heroTs","setLevel","info","desRichtext","string","getLab","WordKey","RateShow","discountSpr","node","setTexture","AnimationId","itemTable","Type","ItemType","ItemType_Hero","propNode","tempTab","getData","AnimationTableById","getValue","spData","Path","SkeletonData","hero_spine","skeletonData","setAnimation","AnimationName","AnimationType","AnimationType_SpriteFrame","chest_spine","chestSpr","AnimationType_SkeletonData","rechargeTable","RechargeTableById","RechargeId","allRechargeTable","priceLabel","getSdkRechargeShowPrice","allPriceLabel","onClickBuy","cb","requestPay","isShowFirstRecharge","onClose","tipsStr","create","val","onClickOneBuy","onClickHero","ItemTableById","refreshBookData","show","viewName","HeroBagView","data","viewType","zIndex"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, EventTouch, Label, Node, RichText, sp, Sprite, Toggle } from 'cc';\r\nimport { ViewPop } from '../../../../framework/base/ViewPop';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { ItemPoolMgr } from '../../item/ItemPoolMgr';\r\nimport { ItemInfo } from '../../item/ItemInfo';\r\nimport { LangMgr } from '../../../mgr/LangMgr';\r\nimport { LoadResAsync } from '../../../mgr/ResMgr';\r\nimport { HeroDataControl } from '../../hero/herobag/HeroDataControl';\r\nimport { ViewName } from '../../../define/ViewDefine';\r\nimport { UIMgr } from '../../../mgr/UIMgr';\r\nimport { PayData } from '../../pay/PayData';\r\nimport { PayControl } from '../../pay/PayControl';\r\nimport { ChannelMgr } from '../../../../channel/ChannelMgr';\r\nimport { RoleData } from '../../role/RoleData';\r\nimport { RedMgr } from '../../../mgr/RedMgr';\r\nimport { RedDotType } from '../../../red/RedDotType';\r\nimport { CommonTipsPop } from '../../common/CommonTipsPop';\r\nimport { HeroItem } from '../../item/HeroItem';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * FirstRechargePop\r\n * zhudingchao\r\n * Thu Jun 20 2024 11:19:29 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/activity/firstRecharge/FirstRechargePop.ts\r\n *\r\n */\r\n\r\n@ccclass('FirstRechargePop')\r\nexport class FirstRechargePop extends ViewPop {\r\n    @property(RichText)\r\n    desRichtext: RichText = null;\r\n    @property(Sprite)\r\n    discountSpr: Sprite = null;\r\n    @property(Node)\r\n    heroNode: Node = null;\r\n    @property(Node)\r\n    propNode: Node = null;\r\n    @property(Node)\r\n    mainItemNode: Node = null;\r\n    @property(Node)\r\n    otherItemLayout: Node = null;\r\n    @property(Label)\r\n    priceLabel: Label = null;\r\n    @property(sp.Skeleton)\r\n    hero_spine: sp.Skeleton = null\r\n    @property(sp.Skeleton)\r\n    chest_spine: sp.Skeleton = null\r\n    @property(Sprite)\r\n    chestSpr: Sprite = null\r\n    @property(Node)\r\n    buyBtnNode: Node = null;\r\n    @property([Node])\r\n    node_toggles: Node[] = [];\r\n    @property(Node)\r\n    node_one_buy: Node = null;\r\n    @property(Label)\r\n    allPriceLabel: Label = null;\r\n    private firstTable: tab.FirstRechargeTable;\r\n    register(): void {\r\n\r\n    }\r\n    onShow(): void {\r\n        let table = PayData.ins.getFirstRechargeTable();\r\n        if (table) {\r\n            this.firstTable = table;\r\n            this.node_toggles[table.Id - 1].getComponent(Toggle).isChecked = true;\r\n            RedMgr.refreshEvent(RedDotType.First_Recharge);\r\n            this.initView();\r\n        }\r\n        if (this.firstTable && this.firstTable.Id) {\r\n            RoleData.ins.setClientData(\"openFirstRecharge\", String(this.firstTable.Id));\r\n        } else {\r\n            RoleData.ins.setClientData(\"openFirstRecharge\", \"1\");\r\n        }\r\n    }\r\n    // 设置toggle\r\n    setToggles() {\r\n        let tables = PayData.ins.getFirstRechargeTabs();\r\n        let boughtGoodsIds = PayData.ins.payInfoMsg.firstRechargeInfo.boughtGoodsIds;\r\n        this.node_one_buy.active = boughtGoodsIds.length === 0;\r\n        for (let i = 0; i < tables.length; i++) {\r\n            const _tab = tables[i];\r\n            const _id = _tab.Id;\r\n            this.node_toggles[i].active = boughtGoodsIds.indexOf(_id) < 0;\r\n            // const lbl = this.node_toggles[i].getChildByName(\"name_txt\").getComponent(Label);\r\n            // const rechargeTable = tab.getData().RechargeTableById.getValue(_id);\r\n            // lbl.string=ChannelMgr.getSdkRechargeShowPrice(rechargeTable);\r\n        }\r\n    }\r\n    getFirstTab(id: number) {\r\n        let tables = PayData.ins.getFirstRechargeTabs();\r\n        for (let key in tables) {\r\n            let _id = tables[key].Id;\r\n            if (_id === id) {\r\n                return tables[key]\r\n            }\r\n        }\r\n    }\r\n    switchView(e: EventTouch, type: string) {\r\n        if (this.firstTable.Id === Number(type)) {\r\n            return;\r\n        }\r\n        this.firstTable = this.getFirstTab(Number(type));\r\n        this.initView();\r\n    }\r\n    async initView() {\r\n        this.setToggles();\r\n        this.otherItemLayout.destroyAllChildren();\r\n        this.mainItemNode.destroyAllChildren();\r\n        let itemInfo = new ItemInfo();\r\n        itemInfo.initItemData(this.firstTable.FRItemIds[0], this.firstTable.FRItemNum[0]);\r\n        const heroNode = ItemPoolMgr.ins.createRewadItem(itemInfo, this.mainItemNode);\r\n        const heroTs = heroNode.getComponent(HeroItem);\r\n        if(heroTs){\r\n            heroTs.setLevel(0);\r\n        }\r\n        for (let i = 1; i < this.firstTable.FRItemIds.length; i++) {\r\n            let info = new ItemInfo();\r\n            info.initItemData(this.firstTable.FRItemIds[i], this.firstTable.FRItemNum[i]);\r\n            ItemPoolMgr.ins.createRewadItem(info, this.otherItemLayout);\r\n        }\r\n        this.desRichtext.string = LangMgr.getLab(this.firstTable.WordKey);\r\n        if (this.firstTable.RateShow && this.firstTable.RateShow != \"\") {\r\n            this.discountSpr.node.active = true;\r\n            this.discountSpr.setTexture(this.firstTable.RateShow);\r\n        } else {\r\n            this.discountSpr.node.active = false;\r\n        }\r\n        if (this.firstTable.AnimationId) {\r\n            if (itemInfo.itemTable.Type == tab.ItemType.ItemType_Hero) {\r\n                this.heroNode.active = true;\r\n                this.propNode.active = false;\r\n                let tempTab: tab.AnimationTable = tab.getData().AnimationTableById.getValue(this.firstTable.AnimationId)\r\n                let spData = await LoadResAsync(tempTab.Path, sp.SkeletonData)\r\n                this.hero_spine.skeletonData = spData\r\n                this.hero_spine.setAnimation(0, tempTab.AnimationName, true)\r\n            } else {\r\n                this.heroNode.active = false;\r\n                this.propNode.active = true;\r\n                let tempTab: tab.AnimationTable = tab.getData().AnimationTableById.getValue(this.firstTable.AnimationId)\r\n                if (tempTab.Type == tab.AnimationType.AnimationType_SpriteFrame) {\r\n                    this.chest_spine.node.active = false;\r\n                    this.chestSpr.setTexture(tempTab.Path);\r\n                } else if (tempTab.Type == tab.AnimationType.AnimationType_SkeletonData) {\r\n                    this.chestSpr.node.active = false;\r\n                    let spData = await LoadResAsync(tempTab.Path, sp.SkeletonData)\r\n                    this.chest_spine.skeletonData = spData\r\n                    this.chest_spine.setAnimation(0, tempTab.AnimationName, true)\r\n                }\r\n            }\r\n\r\n        } else {\r\n            this.hero_spine.node.active = false;\r\n        }\r\n\r\n        let rechargeTable = tab.getData().RechargeTableById.getValue(this.firstTable.RechargeId);\r\n        let allRechargeTable = tab.getData().RechargeTableById.getValue(1004);\r\n        this.priceLabel.string = ChannelMgr.getSdkRechargeShowPrice(rechargeTable);\r\n        this.allPriceLabel.string = ChannelMgr.getSdkRechargeShowPrice(allRechargeTable);\r\n    }\r\n    onClickBuy() {\r\n        const cb = (()=>{\r\n            PayControl.ins.requestPay(this.firstTable.RechargeId, () => {\r\n                if(PayData.ins.isShowFirstRecharge()){\r\n                    this.onShow();\r\n                }else{\r\n                    this.onClose();\r\n                }\r\n            });\r\n        })\r\n        let boughtGoodsIds = PayData.ins.payInfoMsg.firstRechargeInfo.boughtGoodsIds;\r\n        if(boughtGoodsIds.length===0){\r\n            const tipsStr = LangMgr.getLab(\"Tips_firstrecharge_1\");\r\n            CommonTipsPop.create(tipsStr, ((val) => {\r\n                if (val) {\r\n                    cb();\r\n                }\r\n            }))\r\n        }else{\r\n            cb();\r\n        }\r\n    }\r\n    // 一键购买\r\n    onClickOneBuy() {\r\n        let boughtGoodsIds = PayData.ins.payInfoMsg.firstRechargeInfo.boughtGoodsIds;\r\n        if (boughtGoodsIds.length === 0) {\r\n            PayControl.ins.requestPay(1004, () => {\r\n                RoleData.ins.setClientData(\"openFirstRecharge\", String(4));\r\n                this.onClose();\r\n            });\r\n        }\r\n    }\r\n    onClickHero() {\r\n        let itemTable = tab.getData().ItemTableById.getValue(this.firstTable.FRItemIds[0])\r\n        if (itemTable.Type == tab.ItemType.ItemType_Hero) {\r\n            HeroDataControl.ins.refreshBookData(itemTable.Id);\r\n            UIMgr.ins.show({ viewName: ViewName.HeroBagView, data: { viewType: 2 }, zIndex: 300 })\r\n        }\r\n\r\n    }\r\n}"]}