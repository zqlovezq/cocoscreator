{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/view/common/FightRoleTeamItem.ts"],"names":["_decorator","Button","Component","Label","Node","Sprite","tab","EventMgr","FightEvent","UIMgr","ViewName","HeroInfo","HeroDataControl","HeroStar","ccclass","property","FightRoleTeamItem","info","callback","onLoad","onFight","Role_Level_Up","onLevelUp","heroItemId","lastLv","lv","itemId","lv_txt","string","level","toString","onDestroy","unTarget","setCallback","fb","setData","isTouch","btn","enabled","blackNode","active","baseNode","itemTab","getData","ItemTableById","getValue","heroTab","HeroTableById","heroClassTab","HeroClassTableByHeroClass","Class","sp_vocation","setTexture","Icon","iconImg","leader","intoIndex","itemQualityTab","ins","getItemQualityTableByStar","star","starbgImg","HeroStarBg","qualityImg","QualityFrame","heroStar","showStar","onClickItem","heroInfo","id","show","viewName","HeroSkillPop","data","type","HeroStarDescType","HeroStarDescType_First","zIndex"],"mappings":"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","sourcesContent":["import { _decorator, Button, Color, Component, Label, Node, Prefab, Sprite } from \"cc\";\nimport { tab } from \"../../../../Table/table_gen\";\nimport { HeroFightInfo } from \"../../data/HeroFightInfo\";\nimport { EventMgr } from \"../../../mgr/EventMgr\";\nimport { FightEvent } from \"../../define/FightEvent\";\nimport { UIMgr } from \"../../../mgr/UIMgr\";\nimport { ViewName } from \"../../../define/ViewDefine\";\nimport { HeroInfo } from \"../../../model/hero/HeroInfo\";\nimport { HeroDataControl } from \"../../../model/hero/herobag/HeroDataControl\";\nimport { HeroStar } from \"../../../model/hero/HeroStar\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('FightRoleTeamItem')\nexport class FightRoleTeamItem extends Component {\n    @property(Node)\n    baseNode: Node = null\n    @property(Node)\n    blackNode: Node = null\n\n    @property(Sprite)\n    qualityImg: Sprite = null;\n    @property(Sprite)\n    iconImg: Sprite = null;\n    @property(Label)\n    lv_txt: Label = null;\n    @property(Sprite)\n    sp_vocation: Sprite = null;//职业\n\n    @property(Node)\n    leader: Node = null;//职业\n\n    @property(Button)\n    btn: Button = null;\n    @property(Sprite)\n    starbgImg: Sprite = null;\n\n    @property(HeroStar)\n    heroStar: HeroStar = null;\n\n    info: HeroFightInfo = null\n    protected onLoad(): void {\n        EventMgr.onFight(FightEvent.Role_Level_Up, this.onLevelUp, this)\n\n    }\n\n    onLevelUp(heroItemId: number, lastLv: number, lv: number) {\n        if (this.info == null) {\n            return\n        }\n\n        if (this.info.itemId != heroItemId) {\n            return\n        }\n        this.lv_txt.string = this.info.level.toString()\n    }\n\n    protected onDestroy(): void {\n        EventMgr.unTarget(this)\n    }\n\n    callback: Function\n    setCallback(fb: Function) {\n        this.callback = fb\n    }\n\n    setData(info: HeroFightInfo, isTouch = false) {\n        this.info = info\n        this.btn.enabled = isTouch;\n        if (info == null) {\n            this.blackNode.active = true\n            this.baseNode.active = !this.blackNode.active\n            return\n        }\n        this.blackNode.active = false\n        this.baseNode.active = !this.blackNode.active\n\n\n        let itemTab = tab.getData().ItemTableById.getValue(info.itemId)\n        let heroTab = tab.getData().HeroTableById.getValue(info.itemId)\n\n        let heroClassTab = tab.getData().HeroClassTableByHeroClass.getValue(heroTab.Class)\n\n        this.sp_vocation.setTexture(heroClassTab.Icon);\n\n        this.iconImg.setTexture(itemTab.Icon)\n        // this.qualityImg.setTexture(\"textrue/quality/qualityBg_\" + itemTab.Quality);\n\n        this.lv_txt.string = info.level.toString()\n        this.leader.active = info.intoIndex == 1\n        let itemQualityTab = HeroDataControl.ins.getItemQualityTableByStar(info.star);\n        this.starbgImg.setTexture(itemQualityTab.HeroStarBg);\n        this.qualityImg.setTexture(itemQualityTab.QualityFrame)\n        this.heroStar.showStar(info.star);\n    }\n    onClickItem() {\n        if (this.callback) {\n            return this.callback(this.info)\n            return\n        }\n        let heroInfo = new HeroInfo();\n        heroInfo.id = this.info.id;\n        heroInfo.itemId = this.info.itemId\n        heroInfo.level = this.info.level;\n        heroInfo.star = this.info.star;\n        UIMgr.ins.show({\n            viewName: ViewName.HeroSkillPop, data: {\n                type: tab.HeroStarDescType.HeroStarDescType_First,\n                heroInfo: heroInfo\n            }, zIndex: 300\n        })\n    }\n}"]}