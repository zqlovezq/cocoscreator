{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/base/damage/DamegeCalculation.ts"],"names":["DamegeCalculation","_decorator","FightMacro","DamageLab","ccclass","property","bullet_damageCalculate","bullet","defanseAbs","damage","checkBulletDamageGroup","info","groupId","configTab","SameLow","addDamegeGroupId","buff_AttackHeal","buff","index","effect","addHp","addParm","Parameters","MAX_CHANCE","Math","floor","abs","onHitDamage","addShowDamageNum","buff_BigHpHeal","buff_NowHpHeal"],"mappings":";;;kHAeaA,iB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAfEC,MAAAA,U,OAAAA,U;;AAKNC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U;;AAM9B;mCACaD,iB,GAAN,MAAMA,iBAAN,CAAwB;AAC3B;;AAEA;AACJ;AACA;AACA;AACA;AACiC,eAAtBM,sBAAsB,CAACC,MAAD,EAAiBC,UAAjB,EAAsC;AAC/D,cAAIC,MAAM,GAAG,CAAC,EAAd;;AAEA,cAAID,UAAU,CAACE,sBAAX,CAAkCH,MAAM,CAACI,IAAP,CAAYC,OAA9C,CAAJ,EAA4D;AACxD,gBAAIL,MAAM,CAACI,IAAP,CAAYE,SAAZ,CAAsBC,OAA1B,EAAmC;AAAC;AAChCL,cAAAA,MAAM,GAAGA,MAAM,GAAGF,MAAM,CAACI,IAAP,CAAYE,SAAZ,CAAsBC,OAA/B,GAAyC,KAAlD;AACH;AACJ,WAP8D,CAS/D;;;AAEAN,UAAAA,UAAU,CAACO,gBAAX,CAA4BR,MAAM,CAACI,IAAP,CAAYC,OAAxC;AAEA,iBAAOH,MAAP;AACH;AAED;;;AACsB,eAAfO,eAAe,CAACC,IAAD,EAAaC,KAAb,EAA4BC,MAA5B,EAA+C;AACjE,cAAIC,KAAK,GAAGH,IAAI,CAACI,OAAL,CAAaH,KAAb,IAAsBC,MAAM,CAACG,UAAP,CAAkB,CAAlB,CAAtB,GAA6C;AAAA;AAAA,wCAAWC,UAApE;AACAH,UAAAA,KAAK,GAAGI,IAAI,CAACC,KAAL,CAAWL,KAAX,CAAR;AAEA,cAAIM,GAAG,GAAGT,IAAI,CAACS,GAAf;AACAT,UAAAA,IAAI,CAACS,GAAL,CAASf,IAAT,CAAcgB,WAAd,CAA0BP,KAA1B;AACA;AAAA;AAAA,sCAAUQ,gBAAV,CAA2BR,KAA3B,EAAkC,KAAlC,EAAyCM,GAAzC,EAA8C,CAA9C;AACH;AAED;;;AACqB,eAAdG,cAAc,CAACZ,IAAD,EAAaC,KAAb,EAA4BC,MAA5B,EAA+C;AAChE,cAAIC,KAAK,GAAGH,IAAI,CAACI,OAAL,CAAaH,KAAb,IAAsBC,MAAM,CAACG,UAAP,CAAkB,CAAlB,CAAtB,GAA6C;AAAA;AAAA,wCAAWC,UAApE;AACAH,UAAAA,KAAK,GAAGI,IAAI,CAACC,KAAL,CAAWL,KAAX,CAAR;AAEA,cAAIM,GAAG,GAAGT,IAAI,CAACS,GAAf;AACAT,UAAAA,IAAI,CAACS,GAAL,CAASf,IAAT,CAAcgB,WAAd,CAA0BP,KAA1B;AAEA;AAAA;AAAA,sCAAUQ,gBAAV,CAA2BR,KAA3B,EAAkC,KAAlC,EAAyCM,GAAzC,EAA8C,CAA9C;AACH;AACD;;;AACqB,eAAdI,cAAc,CAACb,IAAD,EAAaC,KAAb,EAA4BC,MAA5B,EAA+C;AAChE,cAAIC,KAAK,GAAGH,IAAI,CAACI,OAAL,CAAaH,KAAb,IAAsBC,MAAM,CAACG,UAAP,CAAkB,CAAlB,CAAtB,GAA6C;AAAA;AAAA,wCAAWC,UAApE;AACAH,UAAAA,KAAK,GAAGI,IAAI,CAACC,KAAL,CAAWL,KAAX,CAAR;AAEA,cAAIM,GAAG,GAAGT,IAAI,CAACS,GAAf;AACAT,UAAAA,IAAI,CAACS,GAAL,CAASf,IAAT,CAAcgB,WAAd,CAA0BP,KAA1B;AAGA;AAAA;AAAA,sCAAUQ,gBAAV,CAA2BR,KAA3B,EAAkC,KAAlC,EAAyCM,GAAzC,EAA8C,CAA9C;AACH;;AAtD0B,O","sourcesContent":["import { Node, _decorator, js, math, sys } from \"cc\";\nimport { AbsControl } from \"../../../../framework/base/IAbs\";\nimport { Bullet } from \"../obj/bullet/Bullet\";\nimport { AbsRole } from \"../obj/role/AbsRole\";\nimport { Buff } from \"../buff/Buff\";\nimport { FightMacro } from \"../../define/FightDefine\";\nimport { DamageLab } from \"./DamageLab\";\nimport { EffectTab } from \"../../power/powerTab/EffectTab\";\nconst { ccclass, property } = _decorator;\n\nexport interface DamegeClass {\n\n}\n\n/** 伤害计算 */\nexport class DamegeCalculation {\n    //-------------------伤害计算--------------\n\n    /**\n     * 伤害计算\n     * @param bullet 子弹\n     * @param defanseAbs 防御者\n     */\n    static bullet_damageCalculate(bullet: Bullet, defanseAbs: AbsRole) {\n        let damage = -10\n\n        if (defanseAbs.checkBulletDamageGroup(bullet.info.groupId)) {\n            if (bullet.info.configTab.SameLow) {//同组子弹伤害衰减\n                damage = damage * bullet.info.configTab.SameLow / 10000\n            }\n        }\n\n        // damage = Math.max(damage, 0)\n\n        defanseAbs.addDamegeGroupId(bullet.info.groupId)\n\n        return damage\n    }\n\n    /** 攻击治疗  */\n    static buff_AttackHeal(buff: Buff, index: number, effect: EffectTab) {\n        let addHp = buff.addParm[index] * effect.Parameters[0] / FightMacro.MAX_CHANCE\n        addHp = Math.floor(addHp)\n\n        let abs = buff.abs\n        buff.abs.info.onHitDamage(addHp)\n        DamageLab.addShowDamageNum(addHp, false, abs, 0)\n    }\n\n    /** 最大生命百分比回血  */\n    static buff_BigHpHeal(buff: Buff, index: number, effect: EffectTab) {\n        let addHp = buff.addParm[index] * effect.Parameters[0] / FightMacro.MAX_CHANCE\n        addHp = Math.floor(addHp)\n\n        let abs = buff.abs\n        buff.abs.info.onHitDamage(addHp)\n\n        DamageLab.addShowDamageNum(addHp, false, abs, 0)\n    }\n    /** 当前生命百分比掉血   */\n    static buff_NowHpHeal(buff: Buff, index: number, effect: EffectTab) {\n        let addHp = buff.addParm[index] * effect.Parameters[0] / FightMacro.MAX_CHANCE\n        addHp = Math.floor(addHp)\n\n        let abs = buff.abs\n        buff.abs.info.onHitDamage(addHp)\n\n\n        DamageLab.addShowDamageNum(addHp, false, abs, 0)\n    }\n\n}"]}