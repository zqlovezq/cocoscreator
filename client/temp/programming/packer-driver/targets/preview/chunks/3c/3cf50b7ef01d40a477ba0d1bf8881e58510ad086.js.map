{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationChangeFlagPop.ts"],"names":["_decorator","instantiate","Node","Prefab","Sprite","ViewPop","tab","AssociationChangeFlagItem","UIMgr","AssociationChangeInfoPop","refreshFlagImg","ccclass","property","AssociationChangeFlagPop","view","onShow","ins","getView","getComponent","curSelectFlagId","sp_flag_img","showView","register","unRegister","onDestroy","self","node_content","destroyAllChildren","flagtab","getData","GuildFlagTable","i","item","pfb_flag","parent","name","String","Id","itemTs","initData","setSelectCb","onSelect","_selectItem","getChildByName","unSelect","length","onClickChangeFlag","refreshFlagId","onClose"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Node, Prefab, Sprite } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { AssociationChangeFlagItem } from './AssociationChangeFlagItem';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { AssociationChangeInfoPop } from './AssociationChangeInfoPop';\r\nimport { refreshFlagImg } from '../../utils/GameUtil';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationChangeFlagPop')\r\nexport class AssociationChangeFlagPop extends ViewPop {\r\n    @property(Prefab)\r\n    pfb_flag: Prefab = null;\r\n    @property(Node)\r\n    node_content: Node = null;\r\n    @property(Sprite)\r\n    sp_flag_img:Sprite = null;\r\n    private view:AssociationChangeInfoPop = null;\r\n    onShow(): void {\r\n        // 当前旗帜id\r\n        this.view = UIMgr.ins.getView(\"AssociationChangeInfoPop\").getComponent(AssociationChangeInfoPop);\r\n        refreshFlagImg(this.view.curSelectFlagId,this.sp_flag_img);\r\n        this.showView();\r\n    }\r\n    register(): void {\r\n\r\n    }\r\n    unRegister(): void {\r\n        super.unRegister();\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy();\r\n    }\r\n    showView() {\r\n        var self = this;\r\n        this.node_content.destroyAllChildren();\r\n        for (let i = 0; i < tab.getData().GuildFlagTable.length; i++) {\r\n            const flagtab = tab.getData().GuildFlagTable[i];\r\n            const item = instantiate(this.pfb_flag);\r\n            item.parent = this.node_content;\r\n            item.name = String(flagtab.Id);\r\n            const itemTs: AssociationChangeFlagItem = item.getComponent(AssociationChangeFlagItem);\r\n            itemTs.initData(flagtab.Id)\r\n            itemTs.setSelectCb(() => {\r\n                if (flagtab.Id === this.view.curSelectFlagId) {\r\n                    return;\r\n                } else {\r\n                    itemTs.onSelect();\r\n                    const _selectItem = self.node_content.getChildByName(String(self.view.curSelectFlagId));\r\n                    _selectItem.getComponent(AssociationChangeFlagItem).unSelect();\r\n                    self.view.curSelectFlagId = flagtab.Id;\r\n                    refreshFlagImg(flagtab.Id,this.sp_flag_img);\r\n                }\r\n            })\r\n            if (flagtab.Id === this.view.curSelectFlagId) {\r\n                itemTs.onSelect();\r\n            }\r\n        }\r\n    }\r\n    /* 确定更换旗帜 */\r\n    onClickChangeFlag(){\r\n        this.view.refreshFlagId();\r\n        this.onClose();\r\n    }\r\n}\r\n\r\n\r\n"]}