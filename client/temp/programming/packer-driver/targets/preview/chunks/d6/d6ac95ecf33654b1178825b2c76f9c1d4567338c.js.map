{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/base/effect/EffectUI.ts"],"names":["_decorator","Component","Layers","Node","Avatar","ccclass","property","EffectUI","avatar","create","anim","effects","pop","nn","layer","Enum","DEFAULT","addComponent","node","angle","put","removeFromParent","reset","push","destory","i","length","destroy","isValid","recycle","run","animId","cb","addChild","setCb","remove","setAnimationId"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,I,OAAAA,I;;AAE/BC,MAAAA,M,iBAAAA,M;;;;;;;;;OAGH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;0BAGjBO,Q,WADZF,OAAO,CAAC,UAAD,C,2BAAR,MACaE,QADb,SAC8BN,SAD9B,CACwC;AAAA;AAAA;AAAA,eAmCpCO,MAnCoC,GAmCnB,IAnCmB;AAAA;;AAGvB,eAANC,MAAM,GAAG;AACZ,cAAIC,IAAI,GAAGH,QAAQ,CAACI,OAAT,CAAiBC,GAAjB,EAAX;;AACA,cAAIF,IAAI,IAAI,IAAZ,EAAkB;AACd,gBAAIG,EAAE,GAAG,IAAIV,IAAJ,CAAS,UAAT,CAAT;AACAU,YAAAA,EAAE,CAACC,KAAH,GAAWZ,MAAM,CAACa,IAAP,CAAYC,OAAvB;AACAN,YAAAA,IAAI,GAAGG,EAAE,CAACI,YAAH,CAAgBV,QAAhB,CAAP;AACH;;AACDG,UAAAA,IAAI,CAACQ,IAAL,CAAUC,KAAV,GAAkB,CAAlB;AACA,iBAAOT,IAAP;AACH;;AAES,eAAHU,GAAG,CAACV,IAAD,EAAiB;AACvBA,UAAAA,IAAI,CAACQ,IAAL,CAAUG,gBAAV;AACAX,UAAAA,IAAI,CAACY,KAAL;AACAf,UAAAA,QAAQ,CAACI,OAAT,CAAiBY,IAAjB,CAAsBb,IAAtB;AACH;;AAEa,eAAPc,OAAO,GAAG;AACb,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,QAAQ,CAACI,OAAT,CAAiBe,MAArC,EAA6CD,CAAC,EAA9C,EAAkD;AAC9ClB,YAAAA,QAAQ,CAACI,OAAT,CAAiBc,CAAjB,EAAoBP,IAApB,CAAyBS,OAAzB;AACH;;AACDpB,UAAAA,QAAQ,CAACI,OAAT,CAAiBe,MAAjB,GAA0B,CAA1B;AACH;;AAEDJ,QAAAA,KAAK,GAAG;AACJ,cAAI,KAAKd,MAAL,IAAe,KAAKA,MAAL,CAAYoB,OAA/B,EAAuC;AACnC,iBAAKpB,MAAL,CAAYqB,OAAZ;AACH;;AAED,eAAKrB,MAAL,GAAc,IAAd;AACH;;AAGDsB,QAAAA,GAAG,CAACC,MAAD,EAAiBC,EAAjB,EAAgC;AAC/B,eAAKxB,MAAL,GAAc;AAAA;AAAA,gCAAOC,MAAP,EAAd;AACA,eAAKS,IAAL,CAAUe,QAAV,CAAmB,KAAKzB,MAAL,CAAYU,IAA/B;AACA,eAAKV,MAAL,CAAY0B,KAAZ,CAAkB,MAAM;AACpB,iBAAKC,MAAL;AACAH,YAAAA,EAAE,IAAIA,EAAE,EAAR;AACH,WAHD;AAIA,eAAKxB,MAAL,CAAY4B,cAAZ,CAA2BL,MAA3B;AACH;;AAEDI,QAAAA,MAAM,GAAG;AACL5B,UAAAA,QAAQ,CAACa,GAAT,CAAa,IAAb;AACH;;AAhDmC,O,UAC7BT,O,GAAsB,E","sourcesContent":["import { _decorator, Component, Layers, Node } from \"cc\";\nimport { AbsRole } from \"../obj/role/AbsRole\";\nimport { Avatar } from \"../../animation/Avatar\";\nimport { AbsObj } from \"../obj/AbsObj\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('EffectUI')\nexport class EffectUI extends Component {\n    static effects: EffectUI[] = [];\n\n    static create() {\n        let anim = EffectUI.effects.pop()\n        if (anim == null) {\n            let nn = new Node(\"EffectUI\");\n            nn.layer = Layers.Enum.DEFAULT\n            anim = nn.addComponent(EffectUI)\n        }\n        anim.node.angle = 0\n        return anim\n    }\n\n    static put(anim: EffectUI) {\n        anim.node.removeFromParent()\n        anim.reset()\n        EffectUI.effects.push(anim)\n    }\n\n    static destory() {\n        for (let i = 0; i < EffectUI.effects.length; i++) {\n            EffectUI.effects[i].node.destroy()\n        }\n        EffectUI.effects.length = 0\n    }\n\n    reset() {\n        if (this.avatar && this.avatar.isValid){\n            this.avatar.recycle()\n        }\n        \n        this.avatar = null\n    }\n\n    avatar: Avatar = null;\n    run(animId: number, cb?: Function) {\n        this.avatar = Avatar.create()\n        this.node.addChild(this.avatar.node)\n        this.avatar.setCb(() => {\n            this.remove()\n            cb && cb()\n        })\n        this.avatar.setAnimationId(animId)\n    }\n\n    remove() {\n        EffectUI.put(this)\n    }\n\n}"]}