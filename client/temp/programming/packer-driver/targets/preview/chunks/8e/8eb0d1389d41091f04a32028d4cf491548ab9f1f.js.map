{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/jianghu/everyDayChallenge/EveryDayChallengeBoxItem.ts"],"names":["_decorator","Component","Label","Node","ProgressBar","GameUtil","handleNumerText","ViewName","UIMgr","GameplayControl","ccclass","property","EveryDayChallengeBoxItem","lastScore","totalScore","dropId","isCanReceive","rewards","initView","currScore","isReceive","updateView","boxScoreLab","string","openBoxNode","active","boxNode","scoreBar","progress","cangetNode","onClickItem","event","getRewardsByDropId","ins","show","viewName","CommonBoxTipsPop","data","target","worldPosition","requestDailyChallengeReward"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, Label, Node, ProgressBar } from 'cc';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { GameUtil, handleNumerText } from '../../../utils/GameUtil';\r\nimport { ItemInfo } from '../../item/ItemInfo';\r\nimport { ViewName } from '../../../define/ViewDefine';\r\nimport { UIMgr } from '../../../mgr/UIMgr';\r\nimport { GameplayControl } from '../GameplayControl';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * EveryDayChallengeBoxItem\r\n * zhudingchao\r\n * Wed Jul 10 2024 15:07:38 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/jianghu/everyDayChallenge/EveryDayChallengeBoxItem.ts\r\n *\r\n */\r\n\r\n@ccclass('EveryDayChallengeBoxItem')\r\nexport class EveryDayChallengeBoxItem extends Component {\r\n    @property(ProgressBar)\r\n    scoreBar: ProgressBar = null;\r\n    @property(Node)\r\n    boxNode: Node = null;\r\n    @property(Node)\r\n    openBoxNode: Node = null;\r\n    @property(Label)\r\n    boxScoreLab: Label = null;\r\n    @property(Node)\r\n    cangetNode:Node=null;\r\n    private lastScore: number;\r\n    private totalScore:number;\r\n    private dropId:number;\r\n    private isCanReceive:boolean=false;\r\n    private rewards:Array<ItemInfo>;\r\n\r\n    initView(lastScore: number,totalScore:number, currScore: number,dropId:number,isReceive:boolean) {\r\n        this.rewards=null;\r\n        this.lastScore = lastScore;\r\n        this.totalScore=totalScore;\r\n        this.dropId=dropId;\r\n        this.updateView(currScore,isReceive);\r\n        // this.scoreBar.progress=progress;\r\n        this.boxScoreLab.string = handleNumerText(totalScore);\r\n    }\r\n    updateView( currScore: number,isReceive:boolean) {\r\n        this.openBoxNode.active = isReceive;\r\n        this.boxNode.active = !isReceive;\r\n        this.isCanReceive=false;\r\n        if (isReceive) {\r\n            this.scoreBar.progress = 1;\r\n            this.cangetNode.active=false;\r\n        } else {\r\n            if (currScore <= this.lastScore) {\r\n                this.scoreBar.progress = 0\r\n                this.cangetNode.active=false;\r\n                this.isCanReceive=false;\r\n            } else if(currScore>=this.totalScore){\r\n                this.scoreBar.progress = 1\r\n                this.cangetNode.active=true;\r\n                this.isCanReceive=true;\r\n            } else {\r\n                let progress = (currScore - this.lastScore) / (this.totalScore - this.lastScore);\r\n                this.scoreBar.progress = progress;\r\n                this.cangetNode.active=false;\r\n                this.isCanReceive=false;\r\n            }\r\n        }\r\n      \r\n    }\r\n\r\n    onClickItem(event:EventTouch) {\r\n        if(!this.isCanReceive){\r\n            if(!this.rewards){\r\n                this.rewards=GameUtil.getRewardsByDropId(this.dropId);\r\n            }\r\n            UIMgr.ins.show({viewName:ViewName.CommonBoxTipsPop,data:{\"worldPos\":event.target.worldPosition,\"rewadInfos\": this.rewards}})\r\n        }else{\r\n            GameplayControl.ins.requestDailyChallengeReward();\r\n        }\r\n        // let rewads=[];\r\n        // for(let key in this.table.ItemId){\r\n        //     let itemInfo=new ItemInfo();\r\n        //     itemInfo.initItemData(this.table.ItemId[key],this.table.ItemNum[key]);\r\n        //     rewads.push(itemInfo);\r\n        // }\r\n      //  UIMgr.ins.show({viewName:ViewName.CommonBoxTipsPop,data:{\"worldPos\":this.node.worldPosition,\"rewadInfos\":rewads,\"isDown\":true}})\r\n    }\r\n}"]}