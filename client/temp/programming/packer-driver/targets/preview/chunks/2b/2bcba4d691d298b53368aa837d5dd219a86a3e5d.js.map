{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/equip/EquipmentViewItem.ts"],"names":["_decorator","Component","instantiate","Label","Node","Prefab","EquipmentAttrItem","UIMgr","ViewName","LangMgr","tab","ccclass","property","EquipmentViewItem","slotInfo","equipInfo","currLevel","isMaxLevel","type","start","initData","limitLevel","equipTable","EnhanceLimit","maxLevelLab","string","qhstr","getLab","EquipUpgradeType","EquipUpgradeType_Enhance","nameLab","getCombineString","enhanceLv","nowLab","nextLab","initAttrItem","baseAttrInfos","RefineLimit","EquipUpgradeType_Refine","refineLv","extraAttrInfos","onClickHelpBtn","event","node","currentTarget","key","ins","show","viewName","CommonBlackTipsPop","data","worldPosition","attrs","attrNode","removeAllChildren","attrItemPrefab","getComponent","parent"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, instantiate, Label, log, Node, Prefab, Sprite } from 'cc';\r\nimport { EquipInfo } from './EquipInfo';\r\nimport { proto } from 'client_protocol';\r\nimport { EquipAttrInfo } from './EquipAttrInfo';\r\nimport { EquipmentAttrItem } from './EquipmentAttrItem';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { tab } from '../../../Table/table_gen';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('EquipmentViewItem')\r\nexport class EquipmentViewItem extends Component {\r\n    @property(Label)\r\n    nameLab:Label=null;\r\n    @property(Label)\r\n    maxLevelLab:Label=null;\r\n    @property(Label)\r\n    nowLab:Label=null;\r\n    @property(Label)\r\n    nextLab:Label=null;\r\n    @property(Node)\r\n    attrNode:Node=null;\r\n    @property(Prefab)\r\n    attrItemPrefab=null;\r\n\r\n    private slotInfo:proto.IEquipSlotData;\r\n    private equipInfo:EquipInfo;\r\n    private currLevel:number;\r\n    private isMaxLevel:boolean;\r\n    private type:number;\r\n\r\n    start() {\r\n\r\n    }\r\n    initData(equipInfo:EquipInfo,type:number){\r\n        this.slotInfo=equipInfo.slotInfo;\r\n        this.equipInfo=equipInfo;\r\n        this.type=type;\r\n        if(type==1){\r\n            //强化\r\n            let limitLevel=equipInfo.equipTable.EnhanceLimit;\r\n            this.maxLevelLab.string=limitLevel+\"\"\r\n            let qhstr=LangMgr.getLab(tab.EquipUpgradeType[tab.EquipUpgradeType.EquipUpgradeType_Enhance])\r\n            // this.nameLab.string=\"强化等级(上限\"+limitLevel+\"级)\";\r\n            this.nameLab.string=LangMgr.getCombineString(\"ui_equip_1\",[qhstr])+LangMgr.getCombineString(\"ui_equip_2\",[limitLevel]);\r\n          \r\n            this.currLevel=this.equipInfo.enhanceLv;\r\n            // for(let key in this.equipInfo.)\r\n          \r\n            if(this.equipInfo.enhanceLv>=limitLevel){\r\n                //该装备强化上限\r\n                this.nowLab.string=limitLevel+\"\"\r\n                this.isMaxLevel=true;\r\n                this.nextLab.string=LangMgr.getLab(\"ui_equip_18\");\r\n            }else{\r\n                this.nowLab.string=this.slotInfo.enhanceLv+\"\"\r\n                this.isMaxLevel=false;\r\n                this.nextLab.string=this.slotInfo.enhanceLv+1+\"\";\r\n            }\r\n            this.initAttrItem(this.equipInfo.baseAttrInfos);\r\n\r\n            \r\n        }else if(type==2){\r\n          \r\n            let limitLevel=equipInfo.equipTable.RefineLimit;\r\n            let qhstr=LangMgr.getLab(tab.EquipUpgradeType[tab.EquipUpgradeType.EquipUpgradeType_Refine])\r\n            // this.nameLab.string=\"强化等级(上限\"+limitLevel+\"级)\";\r\n            this.nameLab.string=LangMgr.getCombineString(\"ui_equip_1\",[qhstr])+LangMgr.getCombineString(\"ui_equip_2\",[limitLevel]);\r\n           \r\n\r\n          \r\n            this.currLevel=this.equipInfo.refineLv;\r\n            // for(let key in this.equipInfo.)\r\n          \r\n            if(this.equipInfo.refineLv>=limitLevel){\r\n                //该装备强化上限\r\n                this.nowLab.string=limitLevel+\"\"\r\n                this.isMaxLevel=true;\r\n            }else{\r\n                this.nowLab.string=this.equipInfo.refineLv+\"\"\r\n                this.isMaxLevel=false;\r\n                this.nextLab.string=this.equipInfo.refineLv+1+\"\";\r\n            }\r\n            this.initAttrItem(this.equipInfo.extraAttrInfos);\r\n        }\r\n    }\r\n    onClickHelpBtn(event:EventTouch){\r\n        // log(\"type===\",this.type);\r\n        let node:Node=event.currentTarget;\r\n        let key=\"Tips_equip_1\"\r\n        if(this.type==1){\r\n            key=\"Tips_equip_1\"\r\n        }else{\r\n            key=\"Tips_equip_2\"\r\n        }\r\n        UIMgr.ins.show({ viewName: ViewName.CommonBlackTipsPop,data:{\"worldPos\":node.worldPosition,\"WordTableKey\":key }});\r\n    \r\n        \r\n    }\r\n   \r\n\r\n    initAttrItem(attrs:Array<EquipAttrInfo>){\r\n        this.attrNode.removeAllChildren();\r\n        for(let key in attrs){\r\n            let node:Node= instantiate(this.attrItemPrefab);\r\n            node.getComponent(EquipmentAttrItem).initData(attrs[key],this.currLevel,this.isMaxLevel)\r\n            node.parent=this.attrNode;\r\n           \r\n        }\r\n\r\n\r\n    }\r\n\r\n \r\n}\r\n\r\n\r\n"]}