{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/framework/collision/Fixed.ts"],"names":["Fixed","value","valueOf","toString","String","Chain","toFixed","num","n","Math","round","m","pow","toFixedFloor","floor","mulToRatio","Ratio","vec3","v3","x","y","add","sub","mul","div","rem","max","getDecimalPlace","Decimals","sqrt","sin","cos","tan","asin","acos","atan","DEG","RAD","PI","E","LN2","LN10","LOG2E","LOG10E","SQRT1_2","SQRT2","temp"],"mappings":";;;kEAKqBA,K;;;;;;;;;;;;;;;AAHrB;AACA;AACA;;;yBACqBA,K,GAAN,MAAMA,KAAN,CAAY;AAAA;AAAA,eAqBhBC,KArBgB;AAAA;;AAuBhBC,QAAAA,OAAO,GAAG;AACb,iBAAO,KAAKD,KAAZ;AACH;;AAEME,QAAAA,QAAQ,GAAG;AACd,iBAAOC,MAAM,CAAC,KAAKH,KAAN,CAAb;AACH;AAED;AACJ;AACA;AACA;AACA;;;AACuB,eAALA,KAAK,CAACA,KAAD,EAAe;AAC9B,cAAI,CAACD,KAAK,CAACK,KAAX,EAAkB;AACdL,YAAAA,KAAK,CAACK,KAAN,GAAc,IAAIL,KAAJ,EAAd;AACH;;AACDA,UAAAA,KAAK,CAACK,KAAN,CAAYJ,KAAZ,GAAoBA,KAApB;AACA,iBAAOD,KAAK,CAACK,KAAb;AACH;AAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACyB,eAAPC,OAAO,CAACC,GAAD,EAAcC,CAAd,EAAqB;AAAA,cAAPA,CAAO;AAAPA,YAAAA,CAAO,GAAH,CAAG;AAAA;;AACtC,cAAIA,CAAC,IAAI,CAAT,EAAY;AACR,mBAAOC,IAAI,CAACC,KAAL,CAAWH,GAAX,CAAP;AACH,WAFD,MAEO;AACH,gBAAMI,CAAC,GAAGF,IAAI,CAACG,GAAL,CAAS,EAAT,EAAaJ,CAAb,CAAV;AACA,mBAAOC,IAAI,CAACC,KAAL,CAAWH,GAAG,IAAII,CAAC,GAAG,EAAR,CAAH,GAAiB,EAA5B,IAAkCA,CAAzC;AACH;AACJ;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAC8B,eAAZE,YAAY,CAACN,GAAD,EAAcC,CAAd,EAAqB;AAAA,cAAPA,CAAO;AAAPA,YAAAA,CAAO,GAAH,CAAG;AAAA;;AAC3C,cAAIA,CAAC,IAAI,CAAT,EAAY;AACR,mBAAOC,IAAI,CAACC,KAAL,CAAWH,GAAX,CAAP;AACH,WAFD,MAEO;AACH,gBAAMI,CAAC,GAAGF,IAAI,CAACG,GAAL,CAAS,EAAT,EAAaJ,CAAb,CAAV;AACA,mBAAOC,IAAI,CAACK,KAAL,CAAWP,GAAG,IAAII,CAAC,GAAG,EAAR,CAAH,GAAiB,EAA5B,IAAkCA,CAAzC;AACH;AACJ;AAED;AACJ;AACA;AACA;AACA;;;AAc4B,eAAVI,UAAU,CAACR,GAAD,EAAc;AAClC,iBAAOE,IAAI,CAACK,KAAL,CAAWP,GAAG,GAAGP,KAAK,CAACgB,KAAvB,CAAP;AACH;AAGD;;;AACkB,eAAJC,IAAI,CAACC,EAAD,EAAW;AACzBA,UAAAA,EAAE,CAACC,CAAH,GAAOnB,KAAK,CAACM,OAAN,CAAcY,EAAE,CAACC,CAAjB,CAAP;AACAD,UAAAA,EAAE,CAACE,CAAH,GAAOpB,KAAK,CAACM,OAAN,CAAcY,EAAE,CAACE,CAAjB,CAAP;AACH;AAED;AACJ;AACA;;;AACWC,QAAAA,GAAG,CAACd,GAAD,EAAqB;AAC3B,eAAKN,KAAL,GAAa,CAACQ,IAAI,CAACK,KAAL,CAAW,KAAKb,KAAL,GAAaD,KAAK,CAACgB,KAA9B,IAAuCP,IAAI,CAACK,KAAL,CAAWP,GAAG,GAAGP,KAAK,CAACgB,KAAvB,CAAxC,IAAyEhB,KAAK,CAACgB,KAA5F;AACA,iBAAO,IAAP;AACH;;AAED;AACJ;AACA;AACWM,QAAAA,GAAG,CAACf,GAAD,EAAqB;AAC3B,eAAKN,KAAL,GAAa,CAACQ,IAAI,CAACK,KAAL,CAAW,KAAKb,KAAL,GAAaD,KAAK,CAACgB,KAA9B,IAAuCP,IAAI,CAACK,KAAL,CAAWP,GAAG,GAAGP,KAAK,CAACgB,KAAvB,CAAxC,IAAyEhB,KAAK,CAACgB,KAA5F;AACA,iBAAO,IAAP;AACH;;AAED;AACJ;AACA;AACWO,QAAAA,GAAG,CAAChB,GAAD,EAAqB;AAC3B,eAAKN,KAAL,GAAcQ,IAAI,CAACK,KAAL,CAAW,KAAKb,KAAL,GAAaD,KAAK,CAACgB,KAA9B,IAAuCP,IAAI,CAACK,KAAL,CAAWP,GAAG,GAAGP,KAAK,CAACgB,KAAvB,CAAxC,GAAyEhB,KAAK,CAACgB,KAA/E,GAAuFhB,KAAK,CAACgB,KAA1G;AACA,iBAAO,IAAP;AACH;;AAGD;AACJ;AACA;AACWQ,QAAAA,GAAG,CAACjB,GAAD,EAAqB;AAC3B,eAAKN,KAAL,GAAcQ,IAAI,CAACK,KAAL,CAAW,KAAKb,KAAL,GAAaD,KAAK,CAACgB,KAA9B,IAAuCP,IAAI,CAACK,KAAL,CAAWP,GAAG,GAAGP,KAAK,CAACgB,KAAvB,CAArD;AACA,iBAAO,IAAP;AACH;;AAED;AACJ;AACA;AACWS,QAAAA,GAAG,CAAClB,GAAD,EAAsB;AAC5B,cAAMI,CAAC,GAAGF,IAAI,CAACG,GAAL,CAAS,EAAT,EAAaH,IAAI,CAACiB,GAAL,CAAS1B,KAAK,CAAC2B,eAAN,CAAsB,KAAK1B,KAA3B,CAAT,EAA4CD,KAAK,CAAC2B,eAAN,CAAsBpB,GAAtB,CAA5C,CAAb,CAAV;AACA,iBAAOP,KAAK,CAACM,OAAN,CAAc,KAAKL,KAAL,GAAaU,CAA3B,IAAgCX,KAAK,CAACM,OAAN,CAAcC,GAAG,GAAGI,CAApB,CAAhC,GAAyDA,CAAhE;AACH;;AAED;AACJ;AACA;AACWC,QAAAA,GAAG,CAACL,GAAD,EAAqB;AAC3B,eAAKN,KAAL,GAAaQ,IAAI,CAACG,GAAL,CAASZ,KAAK,CAACM,OAAN,CAAc,KAAKL,KAAnB,EAA0BD,KAAK,CAAC4B,QAAhC,CAAT,EAAoD5B,KAAK,CAACM,OAAN,CAAc,KAAKL,KAAnB,EAA0BM,GAA1B,CAApD,CAAb;AACA,iBAAO,IAAP;AACH;;AAED;AACJ;AACA;AACWsB,QAAAA,IAAI,GAAU;AACjB,eAAK5B,KAAL,GAAaQ,IAAI,CAACoB,IAAL,CAAU7B,KAAK,CAACM,OAAN,CAAc,KAAKL,KAAnB,EAA0BD,KAAK,CAAC4B,QAAhC,CAAV,CAAb;AACA,iBAAO,IAAP;AACH;;AAED;AACJ;AACA;AACWE,QAAAA,GAAG,CAACX,CAAD,EAAmB;AACzB,eAAKlB,KAAL,GAAaD,KAAK,CAACM,OAAN,CAAcG,IAAI,CAACqB,GAAL,CAASX,CAAT,CAAd,EAA2BnB,KAAK,CAAC4B,QAAjC,CAAb;AACA,iBAAO,IAAP;AACH;;AAEMG,QAAAA,GAAG,CAACZ,CAAD,EAAmB;AACzB,eAAKlB,KAAL,GAAaD,KAAK,CAACM,OAAN,CAAcG,IAAI,CAACsB,GAAL,CAASZ,CAAT,CAAd,EAA2BnB,KAAK,CAAC4B,QAAjC,CAAb;AACA,iBAAO,IAAP;AACH;;AAEMI,QAAAA,GAAG,CAACb,CAAD,EAAmB;AACzB,eAAKlB,KAAL,GAAaD,KAAK,CAACM,OAAN,CAAcG,IAAI,CAACuB,GAAL,CAASb,CAAT,CAAd,EAA2BnB,KAAK,CAAC4B,QAAjC,CAAb;AACA,iBAAO,IAAP;AACH;;AAEMK,QAAAA,IAAI,CAACd,CAAD,EAAmB;AAC1B,eAAKlB,KAAL,GAAaD,KAAK,CAACM,OAAN,CAAcG,IAAI,CAACwB,IAAL,CAAUd,CAAV,CAAd,EAA4BnB,KAAK,CAAC4B,QAAlC,CAAb;AACA,iBAAO,IAAP;AACH;;AAEMM,QAAAA,IAAI,CAACf,CAAD,EAAmB;AAC1B,eAAKlB,KAAL,GAAaD,KAAK,CAACM,OAAN,CAAcG,IAAI,CAACyB,IAAL,CAAUf,CAAV,CAAd,EAA4BnB,KAAK,CAAC4B,QAAlC,CAAb;AACA,iBAAO,IAAP;AACH;;AAEMO,QAAAA,IAAI,CAAChB,CAAD,EAAmB;AAC1B,eAAKlB,KAAL,GAAaD,KAAK,CAACM,OAAN,CAAcG,IAAI,CAAC0B,IAAL,CAAUhB,CAAV,CAAd,EAA4BnB,KAAK,CAAC4B,QAAlC,CAAb;AACA,iBAAO,IAAP;AACH;;AApMsB,O;;AACvB;AADiB5B,MAAAA,K,CAEHoC,G,GAAM,iB;AAFHpC,MAAAA,K,CAGHqC,G,GAAM,oB;AAEpB;AALiBrC,MAAAA,K,CAMHsC,E,GAAK,iB;AANFtC,MAAAA,K,CAOHuC,C,GAAI,iB;AAPDvC,MAAAA,K,CAQHwC,G,GAAM,kB;AARHxC,MAAAA,K,CASHyC,I,GAAO,iB;AATJzC,MAAAA,K,CAUH0C,K,GAAQ,kB;AAVL1C,MAAAA,K,CAWH2C,M,GAAS,kB;AAXN3C,MAAAA,K,CAYH4C,O,GAAU,kB;AAZP5C,MAAAA,K,CAaH6C,K,GAAQ,kB;AAbL7C,MAAAA,K,CAeHK,K,GAAe,I;AAC7B;AAhBiBL,MAAAA,K,CAiBHgB,K,GAAQ,I;AACtB;AAlBiBhB,MAAAA,K,CAmBH4B,Q,GAAW,C;;AAnBR5B,MAAAA,K,CAoFH2B,e,GAAkB,UAAUpB,GAAV,EAAe;AAC3C,YAAIA,GAAG,IAAIA,GAAG,KAAKE,IAAI,CAACK,KAAL,CAAWP,GAAX,CAAnB,EAAoC;AAChC,eAAK,IAAIC,CAAC,GAAG,CAAR,EAAWG,CAAC,GAAG,EAAf,EAAmBmC,IAAI,GAAG,CAA/B,EAAkCtC,CAAC,GAAG,EAAtC,EAA0CA,CAAC,IAAI,CAAL,EAAQG,CAAC,IAAI,EAAvD,EAA2D;AACvDmC,YAAAA,IAAI,GAAGvC,GAAG,GAAGI,CAAb;AACA,gBAAImC,IAAI,IAAIrC,IAAI,CAACK,KAAL,CAAWgC,IAAX,CAAZ,EAA8B,OAAOtC,CAAP;AACjC;;AACD,iBAAO,EAAP;AACH,SAND,MAMO;AACH,iBAAO,CAAP;AACH;AACJ,O","sourcesContent":["import { Vec3 } from \"cc\";\n\n/**\n * 定点数，比decimal更轻量更快\n */\nexport default class Fixed {\n    // 角度弧度常量\n    public static DEG = 57.29577951308232;\n    public static RAD = 0.017453292519943295;\n\n    // 系统常量\n    public static PI = 3.141592653589793;\n    public static E = 2.718281828459045;\n    public static LN2 = 0.6931471805599453;\n    public static LN10 = 2.302585092994046;\n    public static LOG2E = 1.4426950408889634;\n    public static LOG10E = 0.4342944819032518;\n    public static SQRT1_2 = 0.7071067811865476;\n    public static SQRT2 = 1.4142135623730951;\n\n    public static Chain: Fixed = null;\n    // 缩放的比例\n    public static Ratio = 1000;\n    // 保留小数的位数\n    public static Decimals = 3;\n\n    public value: number;\n\n    public valueOf() {\n        return this.value;\n    }\n\n    public toString() {\n        return String(this.value);\n    }\n\n    /**\n     * 链式调用\n     * @example\n     * const value = Fixed.value(10).add(20.123).mul(2).sqrt().value;\n     */\n    public static value(value): Fixed {\n        if (!Fixed.Chain) {\n            Fixed.Chain = new Fixed();\n        }\n        Fixed.Chain.value = value;\n        return Fixed.Chain;\n    }\n\n    /**\n     * 保留n为小数，并四舍五入\n     * @example\n     * (2.335).toFixed(2)\n     * Fixed.toFixed(2.335, 2)\n     * @param {Number} num 浮点数\n     * @param {Number} n 整数\n     * @returns {Number}\n     */\n    public static toFixed(num: number, n = 0) {\n        if (n == 0) {\n            return Math.round(num);\n        } else {\n            const m = Math.pow(10, n);\n            return Math.round(num * (m * 10) / 10) / m;\n        }\n    }\n    /**\n     * 保留n为小数，并向下\n     * @example\n     * (2.335).toFixed(2)\n     * Fixed.toFixed(2.335, 2)\n     * @param {Number} num 浮点数\n     * @param {Number} n 整数\n     * @returns {Number}\n     */\n    public static toFixedFloor(num: number, n = 0) {\n        if (n == 0) {\n            return Math.round(num);\n        } else {\n            const m = Math.pow(10, n);\n            return Math.floor(num * (m * 10) / 10) / m;\n        }\n    }\n\n    /**\n     * 获得小数位数\n     * @param {Number} num 浮点数\n     * @returns {Number}\n     */\n    public static getDecimalPlace = function (num) {\n        if (num && num !== Math.floor(num)) {\n            for (let n = 1, m = 10, temp = 0; n < 20; n += 1, m *= 10) {\n                temp = num * m;\n                if (temp == Math.floor(temp)) return n;\n            }\n            return 20;\n        } else {\n            return 0;\n        }\n    }\n\n\n    public static mulToRatio(num: number) {\n        return Math.floor(num * Fixed.Ratio)\n    }\n\n\n    /** 把vec3 xy转成定点数 */\n    public static vec3(v3: Vec3) {\n        v3.x = Fixed.toFixed(v3.x)\n        v3.y = Fixed.toFixed(v3.y)\n    }\n\n    /**\n     * 小数相加\n     */\n    public add(num: number): Fixed {\n        this.value = (Math.floor(this.value * Fixed.Ratio) + Math.floor(num * Fixed.Ratio)) / Fixed.Ratio\n        return this;\n    };\n\n    /**\n     * 小数相减\n     */\n    public sub(num: number): Fixed {\n        this.value = (Math.floor(this.value * Fixed.Ratio) - Math.floor(num * Fixed.Ratio)) / Fixed.Ratio\n        return this;\n    };\n\n    /**\n     * 小数相乘\n     */\n    public mul(num: number): Fixed {\n        this.value = (Math.floor(this.value * Fixed.Ratio) * Math.floor(num * Fixed.Ratio)) / Fixed.Ratio / Fixed.Ratio;\n        return this;\n    };\n\n\n    /**\n     * 小数相除\n     */\n    public div(num: number): Fixed {\n        this.value = (Math.floor(this.value * Fixed.Ratio) / Math.floor(num * Fixed.Ratio));\n        return this;\n    };\n\n    /**\n     * 取余\n     */\n    public rem(num: number): number {\n        const m = Math.pow(10, Math.max(Fixed.getDecimalPlace(this.value), Fixed.getDecimalPlace(num)));\n        return Fixed.toFixed(this.value * m) % Fixed.toFixed(num * m) / m;\n    };\n\n    /**\n     * 幂\n     */\n    public pow(num: number): Fixed {\n        this.value = Math.pow(Fixed.toFixed(this.value, Fixed.Decimals), Fixed.toFixed(this.value, num));\n        return this;\n    };\n\n    /**\n     * 开方\n     */\n    public sqrt(): Fixed {\n        this.value = Math.sqrt(Fixed.toFixed(this.value, Fixed.Decimals));\n        return this;\n    };\n\n    /**\n     * 三角函数\n     */\n    public sin(x: number): Fixed {\n        this.value = Fixed.toFixed(Math.sin(x), Fixed.Decimals);\n        return this;\n    };\n\n    public cos(x: number): Fixed {\n        this.value = Fixed.toFixed(Math.cos(x), Fixed.Decimals);\n        return this;\n    };\n\n    public tan(x: number): Fixed {\n        this.value = Fixed.toFixed(Math.tan(x), Fixed.Decimals);\n        return this;\n    };\n\n    public asin(x: number): Fixed {\n        this.value = Fixed.toFixed(Math.asin(x), Fixed.Decimals);\n        return this;\n    };\n\n    public acos(x: number): Fixed {\n        this.value = Fixed.toFixed(Math.acos(x), Fixed.Decimals);\n        return this;\n    };\n\n    public atan(x: number): Fixed {\n        this.value = Fixed.toFixed(Math.atan(x), Fixed.Decimals);\n        return this;\n    };\n}"]}