{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationMainView.ts"],"names":["_decorator","Button","instantiate","Label","log","Node","NodeEventType","Prefab","ProgressBar","ScrollView","Sprite","Toggle","UITransform","Vec3","ComponentBase","AssociationControl","AssociationView","UIMgr","proto","ViewName","ASSOCIATIONVIEW","InfiniteList","AssociationPlayerItem","AssociationData","tab","AssociationOperatePop","EventMgr","getPlayInfoById","getTimeUntilNextDay","setTextTime","RoleData","LangMgr","RedMgr","RedDotType","OpenFunctionMgr","ccclass","property","AssociationMainView","view_type","NONE","_list","_openData","endBossTimer","endTimer","updateTimer","timerLab","string","unschedule","updateBossTimer","timerBossLab","getLab","register","onMsg","Ptl","SetGuildMemberJobRsp","on_s2c_SetGuildMemberJobRsp","KickGuildMemberRsp","on_s2c_KickGuildMemberRsp","SignGuildRsp","on_s2c_SignGuildRsp","SetGuildNoticeRsp","on_s2c_SetGuildNoticeRsp","SetGuildNameAndFlagRsp","on_s2c_SetGuildNameAndFlagRsp","GuileLevelUpPush","on_s2c_GuileLevelUpPush","GetSimpleRoleRsp","on_s2c_GetSimpleRoleRsp","node_hide","on","TOUCH_START","active","node_small_tips","unRegister","onDestroy","onShow","openData","EVENT","INFO","onTouchStar","setView","clickGetApplyList","ins","show","viewName","AssociationApplyListPop","onClose","view","getView","getComponent","onClickChat","isOpen","checkFunctionIsOpen","OpenFunctionName","OpenFunctionName_Chat","ChatPop","data","ChatChannelType","Guild","showFunctionTips","isRefresh","node_info","node_event","toggle_info","isChecked","toggle_event","getMemberArr","initList","setGuildSimpleInfo","PveStageType","PveStageType_GuildBoss","AssociationBossView","initBossEndTimer","switchView","e","Number","list_view","Refresh","Init","getCellNumber","getCellCount","bind","getCellSize","getCellHeight","getCellIdentifer","getCellView","getCellData","GetCellData","_scrollView","node","targetOff","off","length","idx","identifer","cell","pfb_item","msg","lbl_leader_name","role","name","getAssocitionSimpleInfo","leaderName","guildData","flagtab","getData","GuildFlagTableById","getValue","flagId","sp_guild_flag","setTexture","IconUrl","lbl_guild_name","leaderId","lbl_guild_notice","notice","memberCountInfo","getGuildMembersCount","memberData","getMemberData","id","lbl_guild_member_count","memberCount","totalCount","setExpLevel","schedule","guildPositionTab","GuildPositionTableByPosition","job","node_guild_setting","Setting","node_write_notice","WriteNotification","getAssocitionInfo","isBanNotice","node_guild_proces","Proces","setSignBtn","reqGetJoinGuildRequests","refreshEvent","Guild_Activity","showSmallTips","target","ts","setData","scrollViewMidY","height","worldPos","parent","convertToWorldSpaceAR","position","viewPos","convertToNodeSpaceAR","distanceToCenter","y","setPosition","x","error","code","CommonErrorCode","Succeed","onClickBargainGiftPop","type","GuildOFName","GuildOFName_GuildGift","getBargainGift","AssociationGiftPop","onClickChangeInfo","AssociationChangeInfoPop","onClickChangeNotice","AssociationChangeNoticePop","onClickSign","AssociationDonatePop","onClickGuildBoss","GuildOFName_GuildBoss","guildInfo","signCount","signTimes","maxSignCount","GuildSignInTable","maxRemainSignCount","node_sign","interactable","grayscale","Guild_Sign","exp","level","lvData","GuildLevelTableById","nextLvData","lbl_guild_exp","Exp","lbl_guild_lv","String","_progress","bar_guild_exp","progress","onClickTaskBtn","GuildOFName_GuildTask","AssociationTaskPop","onClickSkillBtn","GuildOFName_GuildAttr","AssociationSkillPop","onClickLogBtn","AssociationLogPop","getFunctionTips"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,M,OAAAA,M;AAA+BC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,G,OAAAA,G;AAAKC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;;AACvJC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,kB,iBAAAA,kB;;AACAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,K,oBAAAA,K;;AACAC,MAAAA,Q,iBAAAA,Q;;AACgBC,MAAAA,e,iBAAAA,e;;AAClBC,MAAAA,Y;;AACEC,MAAAA,qB,iBAAAA,qB;;AACAC,MAAAA,e,kBAAAA,e;;AACAC,MAAAA,G,kBAAAA,G;;AACAC,MAAAA,qB,kBAAAA,qB;;AACAC,MAAAA,Q,kBAAAA,Q;;AACAC,MAAAA,e,kBAAAA,e;AAAiBC,MAAAA,mB,kBAAAA,mB;AAAqBC,MAAAA,W,kBAAAA,W;;AACtCC,MAAAA,Q,kBAAAA,Q;;AAEAC,MAAAA,O,kBAAAA,O;;AAEAC,MAAAA,M,kBAAAA,M;;AACAC,MAAAA,U,kBAAAA,U;;AACAC,MAAAA,e,kBAAAA,e;;;;;;AA3BT;AACA;AACA;AACA;AACA;;;;;OAwBM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBpC,U;;qCAGjBqC,mB,WADZF,OAAO,CAAC,qBAAD,C,UAEHC,QAAQ,CAAC/B,IAAD,C,UAER+B,QAAQ,CAAC/B,IAAD,C,UAER+B,QAAQ;AAAA;AAAA,uC,UAERA,QAAQ,CAAC7B,MAAD,C,UAGR6B,QAAQ,CAACjC,KAAD,C,UAERiC,QAAQ,CAACjC,KAAD,C,UAERiC,QAAQ,CAACjC,KAAD,C,UAERiC,QAAQ,CAACjC,KAAD,C,WAERiC,QAAQ,CAACjC,KAAD,C,WAERiC,QAAQ,CAACjC,KAAD,C,WAERiC,QAAQ,CAAC5B,WAAD,C,WAER4B,QAAQ,CAAC1B,MAAD,C,WAGR0B,QAAQ,CAAC/B,IAAD,C,WAER+B,QAAQ,CAAC/B,IAAD,C,WAER+B,QAAQ,CAACjC,KAAD,C,WAGRiC,QAAQ,CAAC/B,IAAD,C,WAER+B,QAAQ,CAAC/B,IAAD,C,WAER+B,QAAQ,CAAC/B,IAAD,C,WAER+B,QAAQ,CAACzB,MAAD,C,WAERyB,QAAQ,CAACzB,MAAD,C,WAERyB,QAAQ,CAACjC,KAAD,C,WAGRiC,QAAQ,CAAC/B,IAAD,C,2BAhDb,MACagC,mBADb;AAAA;AAAA,0CACuD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAWtB;AAXsB;;AAarB;AAbqB;;AAepB;AAfoB;;AAiBxB;AAjBwB;;AAmBd;AAnBc;;AAqBvB;AArBuB;;AAAA;;AAyBtB;AAzBsB;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAkD3CC,SAlD2C,GAkDd;AAAA;AAAA,kDAAgBC,IAlDF;AAAA,eAmD3CC,KAnD2C,GAmDb,EAnDa;AAAA,eAoD3CC,SApD2C,GAoD1B,IApD0B;AAAA,eAqD3CC,YArD2C,GAqDpB,CArDoB;AAAA,eAsD3CC,QAtD2C,GAsDxB,CAtDwB;;AAAA,eAyVnDC,WAzVmD,GAyVrC,MAAM;AAChB,iBAAKD,QAAL;;AACA,gBAAI,KAAKA,QAAL,IAAiB,CAArB,EAAwB;AACpB;AACA,mBAAKE,QAAL,CAAcC,MAAd,GAAuB;AAAA;AAAA,8CAAY,KAAKH,QAAjB,CAAvB;AACH,aAHD,MAGO;AACH,mBAAKI,UAAL,CAAgB,KAAKH,WAArB;AACH;AACJ,WAjWkD;;AAAA,eA8WnDI,eA9WmD,GA8WjC,MAAM;AACpB,iBAAKN,YAAL;;AACA,gBAAI,KAAKA,YAAL,IAAqB,CAAzB,EAA4B;AACxB,mBAAKO,YAAL,CAAkBH,MAAlB,GAA2B;AAAA;AAAA,sCAAQI,MAAR,CAAe,mBAAf,IAAoC;AAAA;AAAA,8CAAY,KAAKR,YAAjB,CAA/D;AACH,aAFD,MAEO;AACH,mBAAKK,UAAL,CAAgB,KAAKC,eAArB;AACH;AACJ,WArXkD;AAAA;;AAuDnDG,QAAAA,QAAQ,GAAS;AACb;AACA;AAAA;AAAA,oCAASC,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUC,oBAAzB,EAA+C,KAAKC,2BAApD,EAAiF,IAAjF;AACA;;AACA;AAAA;AAAA,oCAASH,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUG,kBAAzB,EAA6C,KAAKC,yBAAlD,EAA6E,IAA7E;AACA;;AACA;AAAA;AAAA,oCAASL,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUK,YAAzB,EAAuC,KAAKC,mBAA5C,EAAiE,IAAjE;AACA;;AACA;AAAA;AAAA,oCAASP,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUO,iBAAzB,EAA4C,KAAKC,wBAAjD,EAA2E,IAA3E;AACA;;AACA;AAAA;AAAA,oCAAST,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUS,sBAAzB,EAAiD,KAAKC,6BAAtD,EAAqF,IAArF;AACA;AAAA;AAAA,oCAASX,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUW,gBAAzB,EAA2C,KAAKC,uBAAhD,EAAyE,IAAzE;AACA;AAAA;AAAA,oCAASb,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUa,gBAAzB,EAA2C,KAAKC,uBAAhD,EAAyE,IAAzE;AACA,eAAKC,SAAL,CAAeC,EAAf,CAAkB/D,aAAa,CAACgE,WAAhC,EAA8C,MAAI;AAC9C,iBAAKF,SAAL,CAAeG,MAAf,GAAwB,KAAxB;AACA,iBAAKC,eAAL,CAAqBD,MAArB,GAA8B,KAA9B;AACH,WAHD,EAGI,IAHJ;AAIH;;AACDE,QAAAA,UAAU,GAAS;AACf,gBAAMA,UAAN;AACH;;AACSC,QAAAA,SAAS,GAAS;AACxB,gBAAMA,SAAN;AACH;;AACDC,QAAAA,MAAM,CAACC,QAAD,EAAgB;AAClB,eAAKtC,SAAL,GAAiBsC,QAAQ,GAAG;AAAA;AAAA,kDAAgBC,KAAnB,GAA2B;AAAA;AAAA,kDAAgBC,IAApE;;AACA,cAAIF,QAAJ,EAAc;AACV,iBAAKnC,SAAL,GAAiBmC,QAAjB;AACH;;AACD,eAAKG,WAAL;AACA,eAAKC,OAAL;AACH;AACD;;;AACAC,QAAAA,iBAAiB,GAAG;AAChB,eAAKF,WAAL;AACA;AAAA;AAAA,8BAAMG,GAAN,CAAUC,IAAV,CAAe;AAAEC,YAAAA,QAAQ,EAAE;AAAA;AAAA,sCAASC;AAArB,WAAf;AACH;;AACDC,QAAAA,OAAO,GAAG;AACN,cAAMC,IAAI,GAAG;AAAA;AAAA,8BAAML,GAAN,CAAUM,OAAV,CAAkB,iBAAlB,EAAqCC,YAArC;AAAA;AAAA,iDAAb;AACAF,UAAAA,IAAI,CAACD,OAAL;AACH;;AACDI,QAAAA,WAAW,GAAG;AACV;AACA,eAAKX,WAAL;AACA,cAAMY,MAAM,GAAG;AAAA;AAAA,kDAAgBT,GAAhB,CAAoBU,mBAApB,CAAyC;AAAA;AAAA,0BAAIC,gBAAJ,CAAqBC,qBAA9D,CAAf;;AACA,cAAGH,MAAH,EAAU;AACN;AAAA;AAAA,gCAAMT,GAAN,CAAUC,IAAV,CAAe;AAAEC,cAAAA,QAAQ,EAAE;AAAA;AAAA,wCAASW,OAArB;AAA8BC,cAAAA,IAAI,EAAE;AAAE,+BAAe;AAAA;AAAA,oCAAMC,eAAN,CAAsBC;AAAvC;AAApC,aAAf;AACH,WAFD,MAEK;AACD;AAAA;AAAA,oDAAgBhB,GAAhB,CAAoBiB,gBAApB,CAAsC;AAAA;AAAA,4BAAIN,gBAAJ,CAAqBC,qBAA3D;AACH;AACJ;;AACDd,QAAAA,OAAO,CAACoB,SAAD,EAAsB;AACzB,eAAKC,SAAL,CAAe9B,MAAf,GAAwB,KAAKjC,SAAL,KAAmB;AAAA;AAAA,kDAAgBwC,IAA3D;AACA,eAAKwB,UAAL,CAAgB/B,MAAhB,GAAyB,KAAKjC,SAAL,KAAmB;AAAA;AAAA,kDAAgBuC,KAA5D;AACA,eAAK0B,WAAL,CAAiBC,SAAjB,GAA6B,KAAKlE,SAAL,KAAmB;AAAA;AAAA,kDAAgBwC,IAAhE;AACA,eAAK2B,YAAL,CAAkBD,SAAlB,GAA8B,KAAKlE,SAAL,KAAmB;AAAA;AAAA,kDAAgBuC,KAAjE;;AACA,kBAAQ,KAAKvC,SAAb;AACI,iBAAK;AAAA;AAAA,oDAAgBwC,IAArB;AACI;AACA,mBAAK/B,UAAL,CAAgB,KAAKC,eAArB;AACA,mBAAKR,KAAL,GAAa;AAAA;AAAA,sDAAgB0C,GAAhB,CAAoBwB,YAApB,EAAb;AACA,mBAAKC,QAAL,CAAcP,SAAd;AACA,mBAAKQ,kBAAL;AACA;;AACJ,iBAAK;AAAA;AAAA,oDAAgB/B,KAArB;AACI;AACA,kBAAI,KAAKpC,SAAL,KAAmB;AAAA;AAAA,8BAAIoE,YAAJ,CAAiBC,sBAAxC,EAAgE;AAC5D;AAAA;AAAA,oCAAM5B,GAAN,CAAUC,IAAV,CAAe;AAAEC,kBAAAA,QAAQ,EAAE;AAAA;AAAA,4CAAS2B;AAArB,iBAAf;AACH;;AACD,mBAAKtE,SAAL,GAAiB,IAAjB;AACA,mBAAKuE,gBAAL;AACA;;AACJ;AACI;AAjBR;AAmBH;;AACDC,QAAAA,UAAU,CAACC,CAAD,EAAgB3B,IAAhB,EAA8B;AACpC,eAAKR,WAAL;;AACA,cAAIoC,MAAM,CAAC5B,IAAD,CAAN,KAAiB,KAAKjD,SAA1B,EAAqC;AACjC;AACH;;AACD,eAAKA,SAAL,GAAiB6E,MAAM,CAAC5B,IAAD,CAAvB;AACA,eAAKP,OAAL;AACH;;AACD2B,QAAAA,QAAQ,CAACP,SAAD,EAAsB;AAC1B,cAAIA,SAAJ,EAAe;AACX,iBAAKgB,SAAL,CAAeC,OAAf;AACH,WAFD,MAEO;AACH,iBAAKD,SAAL,CAAeE,IAAf,CAAoB;AAChBC,cAAAA,aAAa,EAAE,KAAKC,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CADC;AAEhBC,cAAAA,WAAW,EAAE,KAAKC,aAAL,CAAmBF,IAAnB,CAAwB,IAAxB,CAFG;AAGhBG,cAAAA,gBAAgB,EAAE,KAAKA,gBAAL,CAAsBH,IAAtB,CAA2B,IAA3B,CAHF;AAIhBI,cAAAA,WAAW,EAAE,KAAKA,WAAL,CAAiBJ,IAAjB,CAAsB,IAAtB,CAJG;AAKhBK,cAAAA,WAAW,EAAE,KAAKC,WAAL,CAAiBN,IAAjB,CAAsB,IAAtB;AALG,aAApB,EADG,CAQH;;AACA,gBAAIO,WAAW,GAAG,KAAKZ,SAAL,CAAe3B,YAAf,CAA4BhF,UAA5B,CAAlB;;AACA,iBAAK2G,SAAL,CAAea,IAAf,CAAoBC,SAApB,CAA8B,KAAKd,SAAL,CAAea,IAA7C;;AACAD,YAAAA,WAAW,CAACC,IAAZ,CAAiBE,GAAjB,CAAqB7H,aAAa,CAACgE,WAAnC,EAAgD,KAAKS,WAArD,EAAkE,IAAlE,EAAwE,IAAxE;;AACA,iBAAKqC,SAAL,CAAea,IAAf,CAAoB5D,EAApB,CAAuB,cAAvB,EAAuC,MAAM;AACzC,mBAAKG,eAAL,CAAqBD,MAArB,GAA8B,KAA9B;AACH,aAFD,EAEG,IAFH;;AAGAyD,YAAAA,WAAW,CAACC,IAAZ,CAAiB5D,EAAjB,CAAoB/D,aAAa,CAACgE,WAAlC,EAA+C,KAAKS,WAApD,EAAiE,IAAjE,EAAuE,IAAvE;AACH;AACJ;;AACDA,QAAAA,WAAW,GAAG;AACV,eAAKP,eAAL,CAAqBD,MAArB,GAA8B,KAA9B;AACH;;AACDiD,QAAAA,YAAY,GAAG;AACX,iBAAO,KAAKhF,KAAL,CAAW4F,MAAlB;AACH;;AACDT,QAAAA,aAAa,CAACU,GAAD,EAAc;AACvB,iBAAO,GAAP;AACH;;AACDT,QAAAA,gBAAgB,CAACS,GAAD,EAAc;AAC1B,iBAAO,uBAAP;AACH;;AACDR,QAAAA,WAAW,CAACQ,GAAD,EAAcC,SAAd,EAAiC;AACxC,cAAIC,IAAI,GAAGrI,WAAW,CAAC,KAAKsI,QAAN,CAAX,CAA2B/C,YAA3B;AAAA;AAAA,6DAAX;AACA,iBAAO8C,IAAP;AACH;;AACDR,QAAAA,WAAW,CAACM,GAAD,EAAc;AACrB,iBAAO;AAAErC,YAAAA,IAAI,EAAE,KAAKxD,KAAL,CAAW6F,GAAX,CAAR;AAAyB9C,YAAAA,IAAI,EAAE;AAA/B,WAAP;AACH;;AACDpB,QAAAA,uBAAuB,CAACsE,GAAD,EAAiC;AACpD,eAAKC,eAAL,CAAqB5F,MAArB,GAA8B2F,GAAG,CAACE,IAAJ,CAASC,IAAvC;AACA;AAAA;AAAA,kDAAgB1D,GAAhB,CAAoB2D,uBAApB,GAA8CC,UAA9C,GAA2DL,GAAG,CAACE,IAAJ,CAASC,IAApE;AACH;;AACDhC,QAAAA,kBAAkB,GAAG;AACjB,cAAMmC,SAA4B,GAAG;AAAA;AAAA,kDAAgB7D,GAAhB,CAAoB2D,uBAApB,EAArC;;AACA,cAAIE,SAAJ,EAAe;AACX,gBAAMC,OAAO,GAAG;AAAA;AAAA,4BAAIC,OAAJ,GAAcC,kBAAd,CAAiCC,QAAjC,CAA0CJ,SAAS,CAACK,MAAV,GAAmBL,SAAS,CAACK,MAA7B,GAAsC,CAAhF,CAAhB;AACA,iBAAKC,aAAL,CAAmBC,UAAnB,CAA8BN,OAAO,CAACO,OAAtC;AACA,iBAAKC,cAAL,CAAoB1G,MAApB,GAA6BiG,SAAS,CAACH,IAAvC;;AACA,gBAAGG,SAAS,CAACD,UAAb,EAAwB;AACpB,mBAAKJ,eAAL,CAAqB5F,MAArB,GAA8BiG,SAAS,CAACD,UAAxC;AACH,aAFD,MAEK;AACD;AAAA;AAAA,sDAAgBC,SAAS,CAACU,QAA1B;AACH;;AACD,iBAAKC,gBAAL,CAAsB5G,MAAtB,GAA+BiG,SAAS,CAACY,MAAzC;AACA,gBAAMC,eAAe,GAAG;AAAA;AAAA,oDAAgB1E,GAAhB,CAAoB2E,oBAApB,EAAxB;AACA,gBAAMC,UAAU,GAAG;AAAA;AAAA,oDAAgB5E,GAAhB,CAAoB6E,aAApB,CAAkC;AAAA;AAAA,sCAAS7E,GAAT,CAAa8E,EAA/C,CAAnB;AACA,iBAAKC,sBAAL,CAA4BnH,MAA5B,GAAqC8G,eAAe,CAACM,WAAhB,GAA8B,GAA9B,GAAoCN,eAAe,CAACO,UAAzF;AAEA,iBAAKC,WAAL;AAEA,iBAAKrH,UAAL,CAAgB,KAAKH,WAArB;AACA,iBAAKD,QAAL,GAAgB;AAAA;AAAA,6DAAhB,CAjBW,CAkBX;;AACA,iBAAKE,QAAL,CAAcC,MAAd,GAAuB;AAAA;AAAA,4CAAY,KAAKH,QAAjB,CAAvB;AACA,iBAAK0H,QAAL,CAAc,KAAKzH,WAAnB,EAAgC,CAAhC,EApBW,CAqBX;;AACA,gBAAM0H,gBAAgB,GAAG;AAAA;AAAA,4BAAIrB,OAAJ,GAAcsB,4BAAd,CAA2CpB,QAA3C,CAAoDW,UAAU,CAACU,GAA/D,CAAzB;AACA,iBAAKC,kBAAL,CAAwBlG,MAAxB,GAAiC+F,gBAAgB,CAACI,OAAlD;AACA,iBAAKC,iBAAL,CAAuBpG,MAAvB,GAAgC+F,gBAAgB,CAACM,iBAAjB,IAAsC,CAAC;AAAA;AAAA,oDAAgB1F,GAAhB,CAAoB2F,iBAApB,GAAwCC,WAA/G;AACA,iBAAKC,iBAAL,CAAuBxG,MAAvB,GAAgC+F,gBAAgB,CAACU,MAAjD;AACA,iBAAKC,UAAL,GA1BW,CA2BX;;AACA;AAAA;AAAA,0DAAmB/F,GAAnB,CAAuBgG,uBAAvB,CAA+C,CAA/C;AACA;AAAA;AAAA,kCAAOC,YAAP,CAAoB;AAAA;AAAA,0CAAWC,cAA/B;AACH;AACJ;;AACDC,QAAAA,aAAa,CAACC,MAAD,EAAetF,IAAf,EAAyC;AAClD;AACA,eAAKxB,eAAL,CAAqBD,MAArB,GAA8B,IAA9B;AACA,eAAKH,SAAL,CAAeG,MAAf,GAAwB,IAAxB;AACA,cAAMgH,EAAE,GAAG,KAAK/G,eAAL,CAAqBiB,YAArB;AAAA;AAAA,6DAAX;AACA8F,UAAAA,EAAE,CAACC,OAAH,CAAWxF,IAAX;AACA,cAAMyF,cAAc,GAAG,KAAKrE,SAAL,CAAea,IAAf,CAAoBxC,YAApB,CAAiC7E,WAAjC,EAA8C8K,MAA9C,GAAuD,CAA9E;AACA,cAAMC,QAAQ,GAAGL,MAAM,CAACM,MAAP,CAAcnG,YAAd,CAA2B7E,WAA3B,EAAwCiL,qBAAxC,CAA8DP,MAAM,CAACQ,QAArE,CAAjB;AACA,cAAMC,OAAO,GAAG,KAAK3E,SAAL,CAAea,IAAf,CAAoBxC,YAApB,CAAiC7E,WAAjC,EAA8CoL,oBAA9C,CAAmEL,QAAnE,CAAhB;AACA,cAAMM,gBAAgB,GAAGF,OAAO,CAACG,CAAR,GAAYT,cAArC;;AACA,cAAIQ,gBAAgB,GAAG,CAAvB,EAA0B;AACtB,iBAAKzH,eAAL,CAAqB2H,WAArB,CAAiC,IAAItL,IAAJ,CAASkL,OAAO,CAACK,CAAjB,EAAoBL,OAAO,CAACG,CAA5B,EAA+B,CAA/B,CAAjC;AACH,WAFD,MAEO;AACH,iBAAK1H,eAAL,CAAqB2H,WAArB,CAAiC,IAAItL,IAAJ,CAASkL,OAAO,CAACK,CAAjB,EAAoBL,OAAO,CAACG,CAAR,GAAYD,gBAAZ,GAA+B,EAAnD,EAAuD,CAAvD,CAAjC;AACH;AACJ;AACD;;;AACA1I,QAAAA,2BAA2B,CAACkF,GAAD,EAAsC;AAC7D,cAAIA,GAAG,CAAC4D,KAAJ,IAAa5D,GAAG,CAAC4D,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAAzD,EAAkE;AAClE,eAAKxH,OAAL,CAAa,IAAb;AACH;AACD;;;AACAvB,QAAAA,yBAAyB,CAACgF,GAAD,EAAoC;AACzD,cAAIA,GAAG,CAAC4D,KAAJ,IAAa5D,GAAG,CAAC4D,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAAzD,EAAkE;AAClE,eAAKxH,OAAL,CAAa,KAAb;AACH;AACD;;;AACAyH,QAAAA,qBAAqB,CAACvF,CAAD,EAAgBwF,IAAhB,EAA8B;AAC/C,cAAM/G,MAAM,GAAG;AAAA;AAAA,kDAAgBT,GAAhB,CAAoBU,mBAApB,CAAwC;AAAA;AAAA,0BAAI+G,WAAJ,CAAgBC,qBAAxD,CAAf;;AACA,cAAIjH,MAAJ,EAAY;AACR,gBAAI;AAAA;AAAA,oDAAgBT,GAAhB,CAAoB2H,cAApB,CAAmCH,IAAnC,CAAJ,EAA8C;AAC1C;AAAA;AAAA,kCAAMxH,GAAN,CAAUC,IAAV,CAAe;AAAEC,gBAAAA,QAAQ,EAAE;AAAA;AAAA,0CAAS0H,kBAArB;AAAyC9G,gBAAAA,IAAI,EAAC0G;AAA9C,eAAf;AACH;AACJ,WAJD,MAIO;AACH;AAAA;AAAA,oDAAgBxH,GAAhB,CAAoBiB,gBAApB,CAAqC;AAAA;AAAA,4BAAIwG,WAAJ,CAAgBC,qBAArD;AACH;AACJ;AACD;;;AACAG,QAAAA,iBAAiB,CAAC7F,CAAD,EAAgBwF,IAAhB,EAA8B;AAC3C,eAAK3H,WAAL;AACA;AAAA;AAAA,8BAAMG,GAAN,CAAUC,IAAV,CAAe;AAAEC,YAAAA,QAAQ,EAAE;AAAA;AAAA,sCAAS4H;AAArB,WAAf;AACH;;AACDC,QAAAA,mBAAmB,CAAC/F,CAAD,EAAgBwF,IAAhB,EAA8B;AAC7C,eAAK3H,WAAL;AACA;AAAA;AAAA,8BAAMG,GAAN,CAAUC,IAAV,CAAe;AAAEC,YAAAA,QAAQ,EAAE;AAAA;AAAA,sCAAS8H;AAArB,WAAf;AACH;AACD;;;AACAC,QAAAA,WAAW,CAACjG,CAAD,EAAgBwF,IAAhB,EAA8B;AACrC,eAAK3H,WAAL;AACA;AAAA;AAAA,8BAAMG,GAAN,CAAUC,IAAV,CAAe;AAAEC,YAAAA,QAAQ,EAAE;AAAA;AAAA,sCAASgI;AAArB,WAAf;AACH;AACD;;;AACAC,QAAAA,gBAAgB,CAACnG,CAAD,EAAgBwF,IAAhB,EAA8B;AAC1C,cAAM/G,MAAM,GAAG;AAAA;AAAA,kDAAgBT,GAAhB,CAAoBU,mBAApB,CAAwC;AAAA;AAAA,0BAAI+G,WAAJ,CAAgBW,qBAAxD,CAAf;;AACA,cAAI3H,MAAJ,EAAY;AACR;AAAA;AAAA,gCAAMT,GAAN,CAAUC,IAAV,CAAe;AAAEC,cAAAA,QAAQ,EAAE;AAAA;AAAA,wCAAS2B;AAArB,aAAf;AACH,WAFD,MAEO;AACH;AAAA;AAAA,oDAAgB7B,GAAhB,CAAoBiB,gBAApB,CAAqC;AAAA;AAAA,4BAAIwG,WAAJ,CAAgBW,qBAArD;AACH;AACJ;;AACD3J,QAAAA,mBAAmB,CAAC8E,GAAD,EAA8B;AAC7C,cAAIA,GAAG,CAAC4D,KAAJ,IAAa5D,GAAG,CAAC4D,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAAzD,EAAkE;AAClE,eAAKvB,UAAL;AACH;;AACDA,QAAAA,UAAU,GAAG;AACT,cAAMsC,SAAS,GAAG;AAAA;AAAA,kDAAgBrI,GAAhB,CAAoB2F,iBAApB,EAAlB;AACA,cAAM2C,SAAS,GAAGD,SAAS,CAACE,SAA5B;AACA,cAAMC,YAAY,GAAG;AAAA;AAAA,0BAAIzE,OAAJ,GAAc0E,gBAAd,CAA+BvF,MAApD;AACA,cAAMwF,kBAAkB,GAAGF,YAAY,GAAGF,SAA1C;AACA,eAAKK,SAAL,CAAepI,YAAf,CAA4BxF,MAA5B,EAAoC6N,YAApC,GAAmDF,kBAAkB,GAAG,CAAxE;AACA,eAAKC,SAAL,CAAepI,YAAf,CAA4B/E,MAA5B,EAAoCqN,SAApC,GAAgDH,kBAAkB,IAAI,CAAtE;AACA;AAAA;AAAA,gCAAOzC,YAAP,CAAoB;AAAA;AAAA,wCAAW6C,UAA/B;AACA,eAAK5D,WAAL;AACH;;AACDnG,QAAAA,uBAAuB,CAACwE,GAAD,EAAgC;AACnD,cAAMM,SAA4B,GAAG;AAAA;AAAA,kDAAgB7D,GAAhB,CAAoB2D,uBAApB,EAArC;AACAE,UAAAA,SAAS,CAACkF,GAAV,GAAgBxF,GAAG,CAACwF,GAApB;AACAlF,UAAAA,SAAS,CAACmF,KAAV,GAAkBzF,GAAG,CAACyF,KAAtB;AACA,eAAK9D,WAAL;AACH;;AACDA,QAAAA,WAAW,GAAE;AACT,cAAMrB,SAA4B,GAAG;AAAA;AAAA,kDAAgB7D,GAAhB,CAAoB2D,uBAApB,EAArC;;AACA,cAAGE,SAAH,EAAa;AACT,gBAAMoF,MAAM,GAAG;AAAA;AAAA,4BAAIlF,OAAJ,GAAcmF,mBAAd,CAAkCjF,QAAlC,CAA2CJ,SAAS,CAACmF,KAArD,CAAf;AACA,gBAAMG,UAAU,GAAG;AAAA;AAAA,4BAAIpF,OAAJ,GAAcmF,mBAAd,CAAkCjF,QAAlC,CAA2CJ,SAAS,CAACmF,KAAV,GAAkB,CAA7D,CAAnB;AACA,iBAAKI,aAAL,CAAmBxL,MAAnB,GAA4BiG,SAAS,CAACkF,GAAV,GAAgB,GAAhB,IAAuBI,UAAU,GAAGA,UAAU,CAACE,GAAd,GAAoBJ,MAAM,CAACI,GAA5D,CAA5B;AACA,iBAAKC,YAAL,CAAkB1L,MAAlB,GAA2B2L,MAAM,CAAC1F,SAAS,CAACmF,KAAX,CAAjC;;AACA,gBAAMQ,SAAS,GAAG3F,SAAS,CAACkF,GAAV,IAAiBI,UAAU,GAAGA,UAAU,CAACE,GAAd,GAAoBJ,MAAM,CAACI,GAAtD,CAAlB;;AACA,iBAAKI,aAAL,CAAmBC,QAAnB,GAA8BF,SAAS,GAAG,CAAZ,GAAgB,CAAhB,GAAoBA,SAAlD;AAEA,gBAAM9E,eAAe,GAAG;AAAA;AAAA,oDAAgB1E,GAAhB,CAAoB2E,oBAApB,EAAxB;AACA,iBAAKI,sBAAL,CAA4BnH,MAA5B,GAAqC8G,eAAe,CAACM,WAAhB,GAA8B,GAA9B,GAAoCN,eAAe,CAACO,UAAzF;AACH;AACJ;;AACDtG,QAAAA,wBAAwB,CAAC4E,GAAD,EAAmC;AACvD,cAAIA,GAAG,CAAC4D,KAAJ,IAAa5D,GAAG,CAAC4D,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAAzD,EAAkE;AAClEpM,UAAAA,GAAG,CAAC,gBAAD,CAAH;AACA,eAAK4E,OAAL,CAAa,IAAb;AACH;;AACDjB,QAAAA,6BAA6B,CAAC0E,GAAD,EAAwC;AACjE,cAAIA,GAAG,CAAC4D,KAAJ,IAAa5D,GAAG,CAAC4D,KAAJ,CAAUC,IAAV,IAAkB;AAAA;AAAA,8BAAMC,eAAN,CAAsBC,OAAzD,EAAkE;AAClEpM,UAAAA,GAAG,CAAC,mBAAD,CAAH;AACA,eAAK4E,OAAL,CAAa,IAAb;AACH;AACD;;;AACA6J,QAAAA,cAAc,GAAG;AACb,eAAK9J,WAAL;AACA,cAAMY,MAAM,GAAG;AAAA;AAAA,kDAAgBT,GAAhB,CAAoBU,mBAApB,CAAwC;AAAA;AAAA,0BAAI+G,WAAJ,CAAgBmC,qBAAxD,CAAf;;AACA,cAAInJ,MAAJ,EAAY;AACR;AAAA;AAAA,gCAAMT,GAAN,CAAUC,IAAV,CAAe;AAAEC,cAAAA,QAAQ,EAAE;AAAA;AAAA,wCAAS2J;AAArB,aAAf;AACH,WAFD,MAEO;AACH;AAAA;AAAA,oDAAgB7J,GAAhB,CAAoBiB,gBAApB,CAAqC;AAAA;AAAA,4BAAIwG,WAAJ,CAAgBmC,qBAArD;AACH;AACJ;AACD;;;AACAE,QAAAA,eAAe,GAAG;AACd,eAAKjK,WAAL;AACA,cAAMY,MAAM,GAAG;AAAA;AAAA,kDAAgBT,GAAhB,CAAoBU,mBAApB,CAAwC;AAAA;AAAA,0BAAI+G,WAAJ,CAAgBsC,qBAAxD,CAAf;;AACA,cAAItJ,MAAJ,EAAY;AACR;AAAA;AAAA,gCAAMT,GAAN,CAAUC,IAAV,CAAe;AAAEC,cAAAA,QAAQ,EAAE;AAAA;AAAA,wCAAS8J;AAArB,aAAf;AACH,WAFD,MAEO;AACH;AAAA;AAAA,oDAAgBhK,GAAhB,CAAoBiB,gBAApB,CAAqC;AAAA;AAAA,4BAAIwG,WAAJ,CAAgBsC,qBAArD;AACH;AACJ;;AACDE,QAAAA,aAAa,GAAG;AACZ,eAAKpK,WAAL;AACA;AAAA;AAAA,8BAAMG,GAAN,CAAUC,IAAV,CAAe;AAAEC,YAAAA,QAAQ,EAAE;AAAA;AAAA,sCAASgK;AAArB,WAAf;AACH;;AAWDpI,QAAAA,gBAAgB,GAAG;AACf,eAAKjE,UAAL,CAAgB,KAAKC,eAArB;AACA,cAAM2C,MAAM,GAAG;AAAA;AAAA,kDAAgBT,GAAhB,CAAoBU,mBAApB,CAAwC;AAAA;AAAA,0BAAI+G,WAAJ,CAAgBW,qBAAxD,CAAf;;AACA,cAAI3H,MAAJ,EAAY;AACR,iBAAKjD,YAAL,GAAoB;AAAA;AAAA,6DAApB;AACA,iBAAKO,YAAL,CAAkBH,MAAlB,GAA2B;AAAA;AAAA,oCAAQI,MAAR,CAAe,mBAAf,IAAoC;AAAA;AAAA,4CAAY,KAAKR,YAAjB,CAA/D;AACA,iBAAK2H,QAAL,CAAc,KAAKrH,eAAnB,EAAoC,CAApC;AACH,WAJD,MAIK;AACD,iBAAKC,YAAL,CAAkBH,MAAlB,GAA2B;AAAA;AAAA,oDAAgBoC,GAAhB,CAAoBmK,eAApB,CAAoC;AAAA;AAAA,4BAAI1C,WAAJ,CAAgBW,qBAApD,CAA3B;AACH;AACJ;;AA7WkD,O;;;;;iBAEjC,I;;;;;;;iBAEC,I;;;;;;;iBAEO,I;;;;;;;iBAEP,I;;;;;;;iBAGK,I;;;;;;;iBAEC,I;;;;;;;iBAEC,I;;;;;;;iBAEJ,I;;;;;;;iBAEU,I;;;;;;;iBAET,I;;;;;;;iBAEM,I;;;;;;;iBAEL,I;;;;;;;iBAGA,I;;;;;;;iBAEN,I;;;;;;;iBAEA,I;;;;;;;iBAGS,I;;;;;;;iBAED,I;;;;;;;iBAEA,I;;;;;;;iBAEJ,I;;;;;;;iBAEC,I;;;;;;;iBAED,I;;;;;;;iBAGL,I","sourcesContent":["/*\r\n * @Date: 2024-08-28 11:02:22\r\n * @LastEditors: wzq\r\n * @LastEditTime: 2024-11-05 10:09:52\r\n */\r\n\r\nimport { _decorator, Button, Component, EventTouch, instantiate, Label, log, Node, NodeEventType, Prefab, ProgressBar, ScrollView, Sprite, Toggle, UITransform, Vec3 } from 'cc';\r\nimport { ComponentBase } from '../../../framework/base/ComponentBase';\r\nimport { AssociationControl } from './AssociationControl';\r\nimport { AssociationView } from './AssociationView';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { ASSOCIATIONPOP, ASSOCIATIONVIEW } from '../../../Common/script/EnumTypeMgr';\r\nimport InfiniteList from '../../../Common/InfiniteList/InfiniteList';\r\nimport { AssociationPlayerItem } from './AssociationPlayerItem';\r\nimport { AssociationData } from './AssociationData';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { AssociationOperatePop } from './AssociationOperatePop';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nimport { getPlayInfoById, getTimeUntilNextDay, setTextTime } from '../../utils/GameUtil';\r\nimport { RoleData } from '../role/RoleData';\r\nimport { ChatData } from '../chat/ChatData';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { ChatControl } from '../chat/ChatControl';\r\nimport { RedMgr } from '../../mgr/RedMgr';\r\nimport { RedDotType } from '../../red/RedDotType';\r\nimport { OpenFunctionMgr } from '../../../Common/component/OpenFunctionMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationMainView')\r\nexport class AssociationMainView extends ComponentBase {\r\n    @property(Node)\r\n    node_info: Node = null;\r\n    @property(Node)\r\n    node_event: Node = null;\r\n    @property(InfiniteList)\r\n    list_view: InfiniteList = null;\r\n    @property(Prefab)\r\n    pfb_item: Prefab = null;\r\n\r\n    @property(Label)\r\n    lbl_guild_name: Label = null;//公会名字\r\n    @property(Label)\r\n    lbl_leader_name: Label = null;//公会舰长名字\r\n    @property(Label)\r\n    lbl_guild_notice: Label = null;//公会公告\r\n    @property(Label)\r\n    lbl_guild_lv: Label = null;//公会等级\r\n    @property(Label)\r\n    lbl_guild_member_count: Label = null;//公会成员数量\r\n    @property(Label)\r\n    lbl_guild_exp: Label = null;//公会成员数量\r\n    @property(ProgressBar)\r\n    bar_guild_exp: ProgressBar = null;\r\n    @property(Sprite)\r\n    sp_guild_flag: Sprite = null;//公会旗帜\r\n\r\n    @property(Node)\r\n    node_small_tips: Node = null;\r\n    @property(Node)\r\n    node_sign: Node = null;\r\n    @property(Label)\r\n    timerLab: Label = null;\r\n\r\n    @property(Node)\r\n    node_guild_setting: Node = null;\r\n    @property(Node)\r\n    node_write_notice: Node = null;\r\n    @property(Node)\r\n    node_guild_proces: Node = null;\r\n    @property(Toggle)\r\n    toggle_info: Toggle = null;\r\n    @property(Toggle)\r\n    toggle_event: Toggle = null;\r\n    @property(Label)\r\n    timerBossLab: Label = null;\r\n\r\n    @property(Node)\r\n    node_hide:Node = null;\r\n\r\n    private view_type: ASSOCIATIONVIEW = ASSOCIATIONVIEW.NONE;\r\n    private _list: proto.IGuildMember[] = []\r\n    private _openData: any = null;\r\n    private endBossTimer: number = 0;\r\n    private endTimer: number = 0;\r\n    register(): void {\r\n        /* 成员信息变动 */\r\n        EventMgr.onMsg(proto.Ptl.SetGuildMemberJobRsp, this.on_s2c_SetGuildMemberJobRsp, this);\r\n        /* 踢出公会 */\r\n        EventMgr.onMsg(proto.Ptl.KickGuildMemberRsp, this.on_s2c_KickGuildMemberRsp, this);\r\n        /* 监听公会签到 */\r\n        EventMgr.onMsg(proto.Ptl.SignGuildRsp, this.on_s2c_SignGuildRsp, this);\r\n        /* 监听公会公告修改 */\r\n        EventMgr.onMsg(proto.Ptl.SetGuildNoticeRsp, this.on_s2c_SetGuildNoticeRsp, this);\r\n        /* 监听设置公会名字和旗帜 */\r\n        EventMgr.onMsg(proto.Ptl.SetGuildNameAndFlagRsp, this.on_s2c_SetGuildNameAndFlagRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.GuileLevelUpPush, this.on_s2c_GuileLevelUpPush, this);\r\n        EventMgr.onMsg(proto.Ptl.GetSimpleRoleRsp, this.on_s2c_GetSimpleRoleRsp, this);\r\n        this.node_hide.on(NodeEventType.TOUCH_START, (()=>{\r\n            this.node_hide.active = false;\r\n            this.node_small_tips.active = false;\r\n        }), this);\r\n    }\r\n    unRegister(): void {\r\n        super.unRegister();\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy();\r\n    }\r\n    onShow(openData: any) {\r\n        this.view_type = openData ? ASSOCIATIONVIEW.EVENT : ASSOCIATIONVIEW.INFO;\r\n        if (openData) {\r\n            this._openData = openData\r\n        }\r\n        this.onTouchStar();\r\n        this.setView();\r\n    }\r\n    /* 点击获取申请列表 */\r\n    clickGetApplyList() {\r\n        this.onTouchStar();\r\n        UIMgr.ins.show({ viewName: ViewName.AssociationApplyListPop })\r\n    }\r\n    onClose() {\r\n        const view = UIMgr.ins.getView(\"AssociationView\").getComponent(AssociationView);\r\n        view.onClose();\r\n    }\r\n    onClickChat() {\r\n        // 判断聊天是否开启\r\n        this.onTouchStar();\r\n        const isOpen = OpenFunctionMgr.ins.checkFunctionIsOpen( tab.OpenFunctionName.OpenFunctionName_Chat)\r\n        if(isOpen){\r\n            UIMgr.ins.show({ viewName: ViewName.ChatPop, data: { \"channelType\": proto.ChatChannelType.Guild } })\r\n        }else{\r\n            OpenFunctionMgr.ins.showFunctionTips( tab.OpenFunctionName.OpenFunctionName_Chat)\r\n        }\r\n    }\r\n    setView(isRefresh?: boolean) {\r\n        this.node_info.active = this.view_type === ASSOCIATIONVIEW.INFO;\r\n        this.node_event.active = this.view_type === ASSOCIATIONVIEW.EVENT;\r\n        this.toggle_info.isChecked = this.view_type === ASSOCIATIONVIEW.INFO;\r\n        this.toggle_event.isChecked = this.view_type === ASSOCIATIONVIEW.EVENT;\r\n        switch (this.view_type) {\r\n            case ASSOCIATIONVIEW.INFO:\r\n                // 公会信息界面\r\n                this.unschedule(this.updateBossTimer)\r\n                this._list = AssociationData.ins.getMemberArr();\r\n                this.initList(isRefresh);\r\n                this.setGuildSimpleInfo();\r\n                break;\r\n            case ASSOCIATIONVIEW.EVENT:\r\n                //工会任务界面 \r\n                if (this._openData === tab.PveStageType.PveStageType_GuildBoss) {\r\n                    UIMgr.ins.show({ viewName: ViewName.AssociationBossView })\r\n                }\r\n                this._openData = null;\r\n                this.initBossEndTimer();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    switchView(e: EventTouch, view: string) {\r\n        this.onTouchStar();\r\n        if (Number(view) === this.view_type) {\r\n            return\r\n        }\r\n        this.view_type = Number(view);\r\n        this.setView();\r\n    }\r\n    initList(isRefresh?: boolean) {\r\n        if (isRefresh) {\r\n            this.list_view.Refresh();\r\n        } else {\r\n            this.list_view.Init({\r\n                getCellNumber: this.getCellCount.bind(this),\r\n                getCellSize: this.getCellHeight.bind(this),\r\n                getCellIdentifer: this.getCellIdentifer.bind(this),\r\n                getCellView: this.getCellView.bind(this),\r\n                getCellData: this.GetCellData.bind(this),\r\n            });\r\n            // this.list_view.node.on(\"scrolling\", this.onScrolling, this);\r\n            let _scrollView = this.list_view.getComponent(ScrollView);\r\n            this.list_view.node.targetOff(this.list_view.node);\r\n            _scrollView.node.off(NodeEventType.TOUCH_START, this.onTouchStar, this, true);\r\n            this.list_view.node.on(\"scroll-began\", () => {\r\n                this.node_small_tips.active = false;\r\n            }, this);\r\n            _scrollView.node.on(NodeEventType.TOUCH_START, this.onTouchStar, this, true);\r\n        }\r\n    }\r\n    onTouchStar() {\r\n        this.node_small_tips.active = false;\r\n    }\r\n    getCellCount() {\r\n        return this._list.length\r\n    }\r\n    getCellHeight(idx: number) {\r\n        return 120\r\n    }\r\n    getCellIdentifer(idx: number) {\r\n        return \"AssociationPlayerItem\";\r\n    }\r\n    getCellView(idx: number, identifer: string) {\r\n        let cell = instantiate(this.pfb_item).getComponent(AssociationPlayerItem);\r\n        return cell;\r\n    }\r\n    GetCellData(idx: number) {\r\n        return { data: this._list[idx], view: this };\r\n    }\r\n    on_s2c_GetSimpleRoleRsp(msg: proto.Msg_GetSimpleRoleRsp){\r\n        this.lbl_leader_name.string = msg.role.name;\r\n        AssociationData.ins.getAssocitionSimpleInfo().leaderName = msg.role.name;\r\n    }\r\n    setGuildSimpleInfo() {\r\n        const guildData: proto.SimpleGuild = AssociationData.ins.getAssocitionSimpleInfo();\r\n        if (guildData) {\r\n            const flagtab = tab.getData().GuildFlagTableById.getValue(guildData.flagId ? guildData.flagId : 1);\r\n            this.sp_guild_flag.setTexture(flagtab.IconUrl);\r\n            this.lbl_guild_name.string = guildData.name;\r\n            if(guildData.leaderName){\r\n                this.lbl_leader_name.string = guildData.leaderName;\r\n            }else{\r\n                getPlayInfoById(guildData.leaderId);\r\n            }\r\n            this.lbl_guild_notice.string = guildData.notice;\r\n            const memberCountInfo = AssociationData.ins.getGuildMembersCount();\r\n            const memberData = AssociationData.ins.getMemberData(RoleData.ins.id);\r\n            this.lbl_guild_member_count.string = memberCountInfo.memberCount + \"/\" + memberCountInfo.totalCount;\r\n\r\n            this.setExpLevel();\r\n\r\n            this.unschedule(this.updateTimer)\r\n            this.endTimer = getTimeUntilNextDay();\r\n            //let tips = \"{0}後可再次領取\"\r\n            this.timerLab.string = setTextTime(this.endTimer);\r\n            this.schedule(this.updateTimer, 1)\r\n            // 设置权限\r\n            const guildPositionTab = tab.getData().GuildPositionTableByPosition.getValue(memberData.job);\r\n            this.node_guild_setting.active = guildPositionTab.Setting;\r\n            this.node_write_notice.active = guildPositionTab.WriteNotification && !AssociationData.ins.getAssocitionInfo().isBanNotice;\r\n            this.node_guild_proces.active = guildPositionTab.Proces;\r\n            this.setSignBtn();\r\n            // 刷新一下申请红点\r\n            AssociationControl.ins.reqGetJoinGuildRequests(0);\r\n            RedMgr.refreshEvent(RedDotType.Guild_Activity);\r\n        }\r\n    }\r\n    showSmallTips(target: Node, data: proto.IGuildMember) {\r\n        // AssociationOperatePop\r\n        this.node_small_tips.active = true;\r\n        this.node_hide.active = true;\r\n        const ts = this.node_small_tips.getComponent(AssociationOperatePop);\r\n        ts.setData(data);\r\n        const scrollViewMidY = this.list_view.node.getComponent(UITransform).height / 2;\r\n        const worldPos = target.parent.getComponent(UITransform).convertToWorldSpaceAR(target.position);\r\n        const viewPos = this.list_view.node.getComponent(UITransform).convertToNodeSpaceAR(worldPos);\r\n        const distanceToCenter = viewPos.y + scrollViewMidY;\r\n        if (distanceToCenter > 0) {\r\n            this.node_small_tips.setPosition(new Vec3(viewPos.x, viewPos.y, 0))\r\n        } else {\r\n            this.node_small_tips.setPosition(new Vec3(viewPos.x, viewPos.y - distanceToCenter + 40, 0))\r\n        }\r\n    }\r\n    /* 队员信息变动 */\r\n    on_s2c_SetGuildMemberJobRsp(msg: proto.Msg_SetGuildMemberJobRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.setView(true);\r\n    }\r\n    /* 踢出队员 */\r\n    on_s2c_KickGuildMemberRsp(msg: proto.Msg_KickGuildMemberRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.setView(false);\r\n    }\r\n    /* 点击鸡多多界面 */\r\n    onClickBargainGiftPop(e: EventTouch, type: string) {\r\n        const isOpen = AssociationData.ins.checkFunctionIsOpen(tab.GuildOFName.GuildOFName_GuildGift);\r\n        if (isOpen) {\r\n            if (AssociationData.ins.getBargainGift(type)) {\r\n                UIMgr.ins.show({ viewName: ViewName.AssociationGiftPop ,data:type});\r\n            }\r\n        } else {\r\n            AssociationData.ins.showFunctionTips(tab.GuildOFName.GuildOFName_GuildGift);\r\n        }\r\n    }\r\n    /* 点击更改信息 */\r\n    onClickChangeInfo(e: EventTouch, type: string) {\r\n        this.onTouchStar();\r\n        UIMgr.ins.show({ viewName: ViewName.AssociationChangeInfoPop })\r\n    }\r\n    onClickChangeNotice(e: EventTouch, type: string) {\r\n        this.onTouchStar();\r\n        UIMgr.ins.show({ viewName: ViewName.AssociationChangeNoticePop })\r\n    }\r\n    /* 点击签到 */\r\n    onClickSign(e: EventTouch, type: string) {\r\n        this.onTouchStar();\r\n        UIMgr.ins.show({ viewName: ViewName.AssociationDonatePop })\r\n    }\r\n    /* 点击公会boss */\r\n    onClickGuildBoss(e: EventTouch, type: string) {\r\n        const isOpen = AssociationData.ins.checkFunctionIsOpen(tab.GuildOFName.GuildOFName_GuildBoss);\r\n        if (isOpen) {\r\n            UIMgr.ins.show({ viewName: ViewName.AssociationBossView })\r\n        } else {\r\n            AssociationData.ins.showFunctionTips(tab.GuildOFName.GuildOFName_GuildBoss);\r\n        }\r\n    }\r\n    on_s2c_SignGuildRsp(msg: proto.Msg_SignGuildRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.setSignBtn();\r\n    }\r\n    setSignBtn() {\r\n        const guildInfo = AssociationData.ins.getAssocitionInfo();\r\n        const signCount = guildInfo.signTimes;\r\n        const maxSignCount = tab.getData().GuildSignInTable.length;\r\n        const maxRemainSignCount = maxSignCount - signCount;\r\n        this.node_sign.getComponent(Button).interactable = maxRemainSignCount > 0;\r\n        this.node_sign.getComponent(Sprite).grayscale = maxRemainSignCount <= 0;\r\n        RedMgr.refreshEvent(RedDotType.Guild_Sign);\r\n        this.setExpLevel();\r\n    }\r\n    on_s2c_GuileLevelUpPush(msg:proto.Msg_GuileLevelUpPush){\r\n        const guildData: proto.SimpleGuild = AssociationData.ins.getAssocitionSimpleInfo();\r\n        guildData.exp = msg.exp;\r\n        guildData.level = msg.level;\r\n        this.setExpLevel();\r\n    }\r\n    setExpLevel(){\r\n        const guildData: proto.SimpleGuild = AssociationData.ins.getAssocitionSimpleInfo();\r\n        if(guildData){\r\n            const lvData = tab.getData().GuildLevelTableById.getValue(guildData.level)\r\n            const nextLvData = tab.getData().GuildLevelTableById.getValue(guildData.level + 1)\r\n            this.lbl_guild_exp.string = guildData.exp + \"/\" + (nextLvData ? nextLvData.Exp : lvData.Exp);\r\n            this.lbl_guild_lv.string = String(guildData.level);\r\n            const _progress = guildData.exp / (nextLvData ? nextLvData.Exp : lvData.Exp)\r\n            this.bar_guild_exp.progress = _progress > 1 ? 1 : _progress;\r\n\r\n            const memberCountInfo = AssociationData.ins.getGuildMembersCount();\r\n            this.lbl_guild_member_count.string = memberCountInfo.memberCount + \"/\" + memberCountInfo.totalCount;\r\n        }\r\n    }\r\n    on_s2c_SetGuildNoticeRsp(msg: proto.Msg_SetGuildNoticeRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        log(\"cocos 设置公会公告成功\")\r\n        this.setView(true);\r\n    }\r\n    on_s2c_SetGuildNameAndFlagRsp(msg: proto.Msg_SetGuildNameAndFlagRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        log(\"cocos 设置工会旗帜 姓名成功\")\r\n        this.setView(true);\r\n    }\r\n    /* 点击任务按钮 */\r\n    onClickTaskBtn() {\r\n        this.onTouchStar();\r\n        const isOpen = AssociationData.ins.checkFunctionIsOpen(tab.GuildOFName.GuildOFName_GuildTask);\r\n        if (isOpen) {\r\n            UIMgr.ins.show({ viewName: ViewName.AssociationTaskPop })\r\n        } else {\r\n            AssociationData.ins.showFunctionTips(tab.GuildOFName.GuildOFName_GuildTask);\r\n        }\r\n    }\r\n    /* 点击技能按钮 */\r\n    onClickSkillBtn() {\r\n        this.onTouchStar();\r\n        const isOpen = AssociationData.ins.checkFunctionIsOpen(tab.GuildOFName.GuildOFName_GuildAttr);\r\n        if (isOpen) {\r\n            UIMgr.ins.show({ viewName: ViewName.AssociationSkillPop })\r\n        } else {\r\n            AssociationData.ins.showFunctionTips(tab.GuildOFName.GuildOFName_GuildAttr);\r\n        }\r\n    }\r\n    onClickLogBtn() {\r\n        this.onTouchStar();\r\n        UIMgr.ins.show({ viewName: ViewName.AssociationLogPop })\r\n    }\r\n    updateTimer = () => {\r\n        this.endTimer--;\r\n        if (this.endTimer >= 0) {\r\n            //let tips = \"{0}後可再次領取\"\r\n            this.timerLab.string = setTextTime(this.endTimer);\r\n        } else {\r\n            this.unschedule(this.updateTimer)\r\n        }\r\n    }\r\n\r\n    initBossEndTimer() {\r\n        this.unschedule(this.updateBossTimer)\r\n        const isOpen = AssociationData.ins.checkFunctionIsOpen(tab.GuildOFName.GuildOFName_GuildBoss);\r\n        if (isOpen) {\r\n            this.endBossTimer = getTimeUntilNextDay();\r\n            this.timerBossLab.string = LangMgr.getLab(\"ui_commondesc_109\")+setTextTime(this.endBossTimer);\r\n            this.schedule(this.updateBossTimer, 1)\r\n        }else{\r\n            this.timerBossLab.string = AssociationData.ins.getFunctionTips(tab.GuildOFName.GuildOFName_GuildBoss);\r\n        }\r\n    }\r\n    updateBossTimer = () => {\r\n        this.endBossTimer--;\r\n        if (this.endBossTimer >= 0) {\r\n            this.timerBossLab.string = LangMgr.getLab(\"ui_commondesc_109\")+setTextTime(this.endBossTimer);\r\n        } else {\r\n            this.unschedule(this.updateBossTimer)\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}