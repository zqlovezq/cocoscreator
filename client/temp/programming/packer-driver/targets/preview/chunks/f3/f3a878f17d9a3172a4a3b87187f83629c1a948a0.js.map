{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/hero/StaticBaseAttr.ts"],"names":["_decorator","tab","HeroData","ccclass","property","StaticBaseAttr","getAttrByHeroId","heroId","outMap","Map","clear","heroInfo","ins","getById","level","getHeroLevel","heroStarUpTable","i","getData","HeroStarUpTable","length","starTab","HeroStar","star","itemId","HeroId","HeroStarUpTableById","getValue","Id","_heroLevelUpAttrTable","HeroAttrTableById","AttrPerLevel","heroAttrTable","HeroAttrType","type","set","HeroAttrValue","get"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U;AAE9B;;gCAEaK,c,WADZF,OAAO,CAAC,gBAAD,C,gBAAR,MACaE,cADb,CAC4B;AACxB;AAC6B,eAAfC,eAAe,CAACC,MAAD,EAAsBC,MAAtB,EAAqF;AAC9G;AACAA,UAAAA,MAAM,GAAGA,MAAM,GAAGA,MAAH,GAAY,IAAIC,GAAJ,EAA3B;AACAD,UAAAA,MAAM,CAACE,KAAP;AACA,cAAIC,QAAQ,GAAG;AAAA;AAAA,oCAASC,GAAT,CAAaC,OAAb,CAAqBN,MAArB,CAAf;AACA,cAAIO,KAAK,GAAGH,QAAQ,CAACI,YAAT,EAAZ;AAEA,cAAIC,eAAe,GAAG,IAAtB;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG;AAAA;AAAA,0BAAIC,OAAJ,GAAcC,eAAd,CAA8BC,MAAlD,EAA0DH,CAAC,EAA3D,EAA+D;AAC3D,gBAAII,OAAO,GAAG;AAAA;AAAA,4BAAIH,OAAJ,GAAcC,eAAd,CAA8BF,CAA9B,CAAd;;AACA,gBAAII,OAAO,CAACC,QAAR,KAAqBX,QAAQ,CAACY,IAA9B,IAAsCZ,QAAQ,CAACa,MAAT,KAAoBH,OAAO,CAACI,MAAtE,EAA8E;AAC1ET,cAAAA,eAAe,GAAG;AAAA;AAAA,8BAAIE,OAAJ,GAAcQ,mBAAd,CAAkCC,QAAlC,CAA2CN,OAAO,CAACO,EAAnD,CAAlB;AACH;AACJ;;AACD,cAAIC,qBAAqB,GAAG;AAAA;AAAA,0BAAIX,OAAJ,GAAcY,iBAAd,CAAgCH,QAAhC,CAAyCX,eAAe,CAACe,YAAzD,CAA5B,CAd8G,CAgB9G;;;AACA,eAAK,IAAId,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAGN,QAAQ,CAACqB,aAAT,CAAuBC,YAAvB,CAAoCb,MAAxD,EAAgEH,EAAC,EAAjE,EAAqE;AACjE,gBAAIiB,IAAI,GAAGvB,QAAQ,CAACqB,aAAT,CAAuBC,YAAvB,CAAoChB,EAApC,CAAX;AACAT,YAAAA,MAAM,CAAC2B,GAAP,CAAWD,IAAX,EAAiBvB,QAAQ,CAACqB,aAAT,CAAuBI,aAAvB,CAAqCnB,EAArC,CAAjB;AACH,WApB6G,CAqB9G;;;AACA,eAAK,IAAIA,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGY,qBAAqB,CAACI,YAAtB,CAAmCb,MAAvD,EAA+DH,GAAC,EAAhE,EAAoE;AAChE,gBAAIiB,KAAI,GAAGL,qBAAqB,CAACI,YAAtB,CAAmChB,GAAnC,CAAX;;AACA,gBAAIT,MAAM,CAAC6B,GAAP,CAAWH,KAAX,CAAJ,EAAsB;AAClB1B,cAAAA,MAAM,CAAC2B,GAAP,CAAWD,KAAX,EAAiB1B,MAAM,CAAC6B,GAAP,CAAWH,KAAX,IAAkBL,qBAAqB,CAACO,aAAtB,CAAoCnB,GAApC,KAA0CH,KAAK,GAAG,CAAlD,CAAnC;AACH,aAFD,MAEO;AACHN,cAAAA,MAAM,CAAC2B,GAAP,CAAWD,KAAX,EAAiBL,qBAAqB,CAACO,aAAtB,CAAoCnB,GAApC,KAA0CH,KAAK,GAAG,CAAlD,CAAjB;AACH;AACJ;;AACD,iBAAON,MAAP;AACH;;AAjCuB,O","sourcesContent":["import { _decorator } from 'cc';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { HeroData } from './HeroData';\r\nimport { Long } from 'protobufjs';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/** 静态基础属性 */\r\n@ccclass('StaticBaseAttr')\r\nexport class StaticBaseAttr {\r\n    /** 获取英雄基础属性 */\r\n    public static getAttrByHeroId(heroId: number|Long, outMap?: Map<tab.AttrType, number>): Map<tab.AttrType, number> {\r\n        /* 基础属性 */\r\n        outMap = outMap ? outMap : new Map();\r\n        outMap.clear()\r\n        let heroInfo = HeroData.ins.getById(heroId);\r\n        let level = heroInfo.getHeroLevel();\r\n\r\n        let heroStarUpTable = null;\r\n        for (let i = 0; i < tab.getData().HeroStarUpTable.length; i++) {\r\n            let starTab = tab.getData().HeroStarUpTable[i];\r\n            if (starTab.HeroStar === heroInfo.star && heroInfo.itemId === starTab.HeroId) {\r\n                heroStarUpTable = tab.getData().HeroStarUpTableById.getValue(starTab.Id);\r\n            }\r\n        }\r\n        let _heroLevelUpAttrTable = tab.getData().HeroAttrTableById.getValue(heroStarUpTable.AttrPerLevel);\r\n\r\n        // 先获得初始属性id\r\n        for (let i = 0; i < heroInfo.heroAttrTable.HeroAttrType.length; i++) {\r\n            let type = heroInfo.heroAttrTable.HeroAttrType[i];\r\n            outMap.set(type, heroInfo.heroAttrTable.HeroAttrValue[i]);\r\n        }\r\n        // 获取升级属性\r\n        for (let i = 0; i < _heroLevelUpAttrTable.HeroAttrType.length; i++) {\r\n            let type = _heroLevelUpAttrTable.HeroAttrType[i];\r\n            if (outMap.get(type)) {\r\n                outMap.set(type, outMap.get(type) +_heroLevelUpAttrTable.HeroAttrValue[i] * (level - 1));\r\n            } else {\r\n                outMap.set(type, _heroLevelUpAttrTable.HeroAttrValue[i] * (level - 1));\r\n            }\r\n        }\r\n        return outMap;\r\n    }\r\n}\r\n\r\n\r\n"]}