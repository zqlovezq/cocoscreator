{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationDataMgr.ts"],"names":["_decorator","log","AbsControl","proto","Net","EventMgr","ccclass","property","AssociationDataMgr","AssocitionData","ins","_instance","register","onMsg","Ptl","CreateGuildRsp","on_s2c_CreateGuildRsp","ApplyJoinGuildRsp","on_s2c_ApplyJoinGuildRsp","QuitGuildRsp","on_s2c_QuitGuildRsp","initAssociationData","msg","init","guild","reqCreateGuild","name","flagId","notice","Msg_CreateGuildReq","Send","CreateGuildReq","error","code","CommonErrorCode","Succeed","reqJoinGuild","guildId","Msg_ApplyJoinGuildReq","ApplyJoinGuildReq","reqQuitGuild","Msg_QuitGuildReq","QuitGuildReq"],"mappings":"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","sourcesContent":["import { _decorator, Component, log, Node } from 'cc';\r\nimport { AbsControl } from '../../../framework/base/IAbs';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../net/Net';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationDataMgr')\r\nexport class AssociationDataMgr extends AbsControl {\r\n    private static _instance: AssociationDataMgr;\r\n    private AssocitionData: proto.GuildInfo = null;\r\n    public static get ins() {\r\n        if (null == this._instance) {\r\n            this._instance = new AssociationDataMgr();\r\n        }\r\n        return this._instance;\r\n    }\r\n    register(): void {\r\n        /* 监听创建公会信息 */\r\n        EventMgr.onMsg(proto.Ptl.CreateGuildRsp, this.on_s2c_CreateGuildRsp, this);\r\n        /* 监听申请加入公会信息 */\r\n        EventMgr.onMsg(proto.Ptl.ApplyJoinGuildRsp, this.on_s2c_ApplyJoinGuildRsp, this);\r\n        /* 监听退出公会信息 */\r\n        EventMgr.onMsg(proto.Ptl.QuitGuildRsp, this.on_s2c_QuitGuildRsp, this);\r\n    }\r\n    /* 初始化公会信息 */\r\n    initAssociationData(msg: proto.Msg_GetGuildInfoRsp) {\r\n        this.init();\r\n        this.AssocitionData = msg.guild as proto.GuildInfo;\r\n    }\r\n    /* 发送创建公会 */\r\n    reqCreateGuild(name: string, flagId: number, notice: string = \"\") {\r\n        let msg = new proto.Msg_CreateGuildReq();\r\n        msg.name = name;\r\n        msg.flagId = flagId;\r\n        msg.notice = notice;\r\n        Net.Send(proto.Ptl.CreateGuildReq, msg);\r\n    }\r\n    /* 接收创建公会的信息 */\r\n    on_s2c_CreateGuildRsp(msg: proto.Msg_CreateGuildRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        log(\"cocos 公会创建成功\")\r\n    }\r\n    /* 申请加入公会 */\r\n    reqJoinGuild(guildId: string) {\r\n        let msg = new proto.Msg_ApplyJoinGuildReq();\r\n        msg.guildId = guildId;\r\n        Net.Send(proto.Ptl.ApplyJoinGuildReq, msg);\r\n    }\r\n    /* 接收申请加入公会的信息 */\r\n    on_s2c_ApplyJoinGuildRsp(msg: proto.Msg_ApplyJoinGuildRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        log(\"cocos 加入公会成功\")\r\n    }\r\n    /* 退出公会 */\r\n    reqQuitGuild() {\r\n        let msg = new proto.Msg_QuitGuildReq();\r\n        Net.Send(proto.Ptl.QuitGuildReq, msg);\r\n    }\r\n    /* 接收退出公会的信息 */\r\n    on_s2c_QuitGuildRsp(msg:proto.Msg_QuitGuildRsp){\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        log(\"cocos 退出公会成功\")\r\n    }\r\n}\r\n\r\n\r\n"]}