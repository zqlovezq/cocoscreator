{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationCreatePop.ts"],"names":["_decorator","EditBox","Label","Toggle","ViewPop","SettingsManager","RoleData","tab","ShowItemNotEnoughTips","ShowTips","AssociationControl","AssociationData","LangMgr","ccclass","property","AssociationCreatePop","_clickToggle","onShow","toggle_auto_enter","isChecked","ins","getSetting","lbl_cost_diamond","string","String","getData","GetKeyValue_ConfigTable","CreateGuildCostDiamond","onDestroy","register","unRegister","reqCreateGuild","diamond","edit_box_create_name","length","console","log","curTime","getServerUtcTime","getAssocitionInfo","notAllowJoinTime","str","getCombineString","GuildJoinCd","onClose","noticeStr","edit_box_create_notice","getLab","onClickEnter","onClickAutoEnterToggle"],"mappings":"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","sourcesContent":["import { _decorator, Component, EditBox, Label, Node, Toggle } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { SettingsManager } from '../role/SettingsManager';\r\nimport { RoleData } from '../role/RoleData';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { ShowItemNotEnoughTips, ShowTips } from '../../mgr/UIMgr';\r\nimport { AssociationControl } from './AssociationControl';\r\nimport { AssociationData } from './AssociationData';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationCreatePop')\r\nexport class AssociationCreatePop extends ViewPop {\r\n    @property(Toggle)\r\n    toggle_auto_enter: Toggle = null;//自动审批加入按钮\r\n    @property(EditBox)\r\n    edit_box_create_name: EditBox = null;//创建公会的名字\r\n    @property(EditBox)\r\n    edit_box_create_notice: EditBox = null;//创建公会的公告\r\n    @property(Label)\r\n    lbl_cost_diamond: Label = null;\r\n    private _clickToggle: boolean = false;\r\n    onShow(): void {\r\n        this.toggle_auto_enter.isChecked = !SettingsManager.ins.getSetting(\"needCheckAssociation\")\r\n        this.lbl_cost_diamond.string = String(tab.getData().GetKeyValue_ConfigTable().CreateGuildCostDiamond)\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy();\r\n    }\r\n    register(): void {\r\n\r\n    }\r\n    unRegister(): void {\r\n        super.unRegister();\r\n    }\r\n    /* 创建公会 */\r\n    reqCreateGuild() {\r\n        // 钻石不足\r\n        if (RoleData.ins.diamond < tab.getData().GetKeyValue_ConfigTable().CreateGuildCostDiamond) {\r\n            ShowItemNotEnoughTips(1);\r\n            return;\r\n        }\r\n        if (this.edit_box_create_name.string.length === 0) {\r\n            console.log(\"公会名字不能为空\")\r\n            return;\r\n        }\r\n        // 当前时间不足\r\n        const curTime = RoleData.ins.getServerUtcTime();\r\n        if (AssociationData.ins.getAssocitionInfo()&&curTime < AssociationData.ins.getAssocitionInfo().notAllowJoinTime) {\r\n            console.log(\"创建公会cd未结束\");\r\n            const str = LangMgr.getCombineString(\"Tips_association_4\", [tab.getData().GetKeyValue_ConfigTable().GuildJoinCd / 60]);\r\n            ShowTips(str);\r\n            return\r\n        }\r\n        this.onClose();\r\n        let noticeStr = this.edit_box_create_notice.string;\r\n        if (!noticeStr) {\r\n            noticeStr = LangMgr.getLab(\"ui_association_1\");\r\n        }\r\n        AssociationControl.ins.reqCreateGuild(this.edit_box_create_name.string, 0, noticeStr, !this.toggle_auto_enter.isChecked);\r\n    }\r\n    onClickEnter() {\r\n        this._clickToggle = true;\r\n    }\r\n    onClickAutoEnterToggle() {\r\n        if (this._clickToggle) {\r\n            this._clickToggle = false;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}