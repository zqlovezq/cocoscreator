{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/activity/rookieTask/RookieTaskPop.ts"],"names":["_decorator","instantiate","Label","Node","Prefab","Toggle","ViewPop","TRIALLAYER","TRIALTASK","tab","InfiniteList","RookieTaskItem","EventMgr","proto","UIMgr","ViewName","RookieTaskBarItem","RookieTaskMgr","TrialToggleBtn","setTextTime","TrialLayoutCell","HeroDataControl","TaskData","LocalEvent","RoleData","Net","ccclass","property","RookieTaskPop","_view_type","NONE","_click_day","_cur_day","_countDown","_curTrialToggleBtn","_openName","OpenFunctionName","OpenFunctionName_ActivityNewPlayerTask","_list","getLayerType","_layer_type","onShow","trial_msg","Msg_GetNewPlayerTrialMapReq","Send","Ptl","GetNewPlayerTrialMapReq","on_s2c_GetNewPlayerTrialMapRsp","msg","setOnshow","trialInfo","ins","getTrialTask","ROOKIE","OpenFunctionName_ActivityNewPlayerTask2","ELITE","openName1","openName2","data1","data2","node_toggle_rookie","active","node_toggle_elite","setAsyncView","TASK1","unlockedDays","costDay","node_rookie","node_bg_rookie","node_elite","node_bg_elite","node_toggle_view","getChildByName","getComponent","isChecked","node_toggle_layer","createDayToggle","setView","beginCountDown","isInit","getViewData","list_view","Init","getCellNumber","getCellCount","bind","getCellSize","getCellHeight","getCellIdentifer","getCellView","getCellData","GetCellData","Reload","setBarItem","red_trialRed","refreshAllRed","i","item","node_toggle_day","children","name","String","itemTs","initToggle","id","scoreTab","getData","ActivityNewPlayerTaskScoreTableById","getValue","node_bar_content","Id","initData","trialData","lbl_score","string","score","lbl_score_elite","refreshScore","socreId","newPlayerTaskTab","ActivityNewPlayerTaskTableById","newPlayertrial","Group","receivedScoreIds","push","gotItem","refreshView","Refresh","onDestroy","register","onMsg","ReceiveNewPlayerTrialTaskRewardsRsp","on_s2c_ReceiveNewPlayerTrialTaskRewardsRsp","BuyFixedShopCommodityRsp","on_s2c_BuyFixedShopCommodityRsp","ReceiveNewPlayerTrialScoreRewardsRsp","on_s2c_ReceiveNewPlayerTrialScoreRewardsRsp","ChangedNewPlayerTrialScorePush","on_s2c_ChangedNewPlayerTrialScorePush","GetNewPlayerTrialMapRsp","newPlayerTrialId","emitLocal","TrialRed","error","code","CommonErrorCode","Succeed","show","viewName","CongratulationPop","data","rewards","taskData","getTrialTaskInfo","taskId","isReceived","scoreId","length","GIFT","pfb_task_item","pfb_mall_item","idx","ID","newPlayerData","TASK2","sort","taskId1","taskId2","taskData1","taskData2","Number","arr","getMallTabs","MallId","result","slice","clickSwitchLayer","e","layer","now","getServerUtcTime","endTime","expireTime","updateTime","unschedule","schedule","clickSwitchDay","toggle","day","setSelect","clickSwitchView","view","lbl_count_time","clickShowHero","refreshBookData","RewardId","HeroBagView","viewType","zIndex","ItemInfoPop","itemId","red_node_rookie","checkIsRed","red_score_red","red_node_elite","red_node_day1","red_node_day2","red_node_day3","red_node_day4","red_node_day5","red_node_day6","red_node_day7","red_node_rookie_task1","red_node_rookie_task2","red_node_rookie_gift","red_node_elite_task1","red_node_elite_task2","red_node_elite_gift"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, instantiate, Label, Node, Prefab, Toggle, UITransform } from 'cc';\r\nimport { ViewPop } from '../../../../framework/base/ViewPop';\r\nimport { TRIALLAYER, TRIALTASK } from '../../../../Common/script/EnumTypeMgr';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport InfiniteList from '../../../../Common/InfiniteList/InfiniteList';\r\nimport { RookieTaskItem } from './RookieTaskItem';\r\nimport { EventMgr } from '../../../mgr/EventMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { UIMgr } from '../../../mgr/UIMgr';\r\nimport { ViewName } from '../../../define/ViewDefine';\r\nimport { RookieTaskBarItem } from './RookieTaskBarItem';\r\nimport { RookieTaskMgr } from './RookieTaskMgr';\r\nimport { TrialToggleBtn } from './TrialToggleBtn';\r\nimport { setTextTime } from '../../../utils/GameUtil';\r\nimport { TrialLayoutCell } from './TrialLayoutCell';\r\nimport { HeroDataControl } from '../../hero/herobag/HeroDataControl';\r\nimport { TaskData } from '../../task/TaskData';\r\nimport { MallDataMgr } from '../../shop/MallDataMgr';\r\nimport { LocalEvent } from '../../../define/LocalEvent';\r\nimport { RoleData } from '../../role/RoleData';\r\nimport { Net } from '../../../net/Net';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('RookieTaskPop')\r\nexport class RookieTaskPop extends ViewPop {\r\n    @property(Prefab)\r\n    pfb_task_item: Prefab = null;\r\n    @property(Prefab)\r\n    pfb_mall_item: Prefab = null;\r\n    @property(Prefab)\r\n    pfb_task_bar_item: Prefab = null;\r\n    @property(Prefab)\r\n    pfb_day_toggle: Prefab = null;\r\n    @property(InfiniteList)\r\n    list_view: InfiniteList = null;\r\n    @property(Node)\r\n    node_toggle_day: Node = null;\r\n    @property(Node)\r\n    node_toggle_view: Node = null;\r\n    @property(Node)\r\n    node_toggle_layer: Node = null;\r\n    @property(Node)\r\n    node_bar_content: Node = null;\r\n    @property(Label)\r\n    lbl_count_time: Label = null;\r\n    @property(Label)\r\n    lbl_score: Label = null;\r\n    @property(Node)\r\n    node_rookie: Node = null;\r\n    @property(Node)\r\n    node_elite: Node = null;\r\n    @property(Node)\r\n    node_toggle_elite: Node = null;\r\n    @property(Node)\r\n    node_toggle_rookie: Node = null;\r\n    @property(Node)\r\n    node_bg_rookie: Node = null;\r\n    @property(Node)\r\n    node_bg_elite: Node = null;\r\n    @property(Label)\r\n    lbl_score_elite:Label = null;\r\n\r\n    @property(Node)\r\n    red_node_rookie: Node = null;\r\n    @property(Node)\r\n    red_node_elite: Node = null;\r\n    @property(Node)\r\n    red_node_rookie_task1: Node = null;\r\n    @property(Node)\r\n    red_node_rookie_task2: Node = null;\r\n    @property(Node)\r\n    red_node_rookie_gift: Node = null;\r\n\r\n    @property(Node)\r\n    red_node_elite_task1: Node = null;\r\n    @property(Node)\r\n    red_node_elite_task2: Node = null;\r\n    @property(Node)\r\n    red_node_elite_gift: Node = null;\r\n\r\n    @property(Node)\r\n    red_node_day1: Node = null;\r\n    @property(Node)\r\n    red_node_day2: Node = null;\r\n    @property(Node)\r\n    red_node_day3: Node = null;\r\n    @property(Node)\r\n    red_node_day4: Node = null;\r\n    @property(Node)\r\n    red_node_day5: Node = null;\r\n    @property(Node)\r\n    red_node_day6: Node = null;\r\n    @property(Node)\r\n    red_node_day7: Node = null;\r\n    @property(Node)\r\n\r\n    private _layer_type: TRIALLAYER = TRIALLAYER.NONE\r\n    private _view_type: TRIALTASK = TRIALTASK.NONE\r\n    private _click_day: number = 0;\r\n    private _cur_day: number = 0;\r\n    private _countDown: number = 0;\r\n    // private _mallMap: Map<number, tab.MallItemTabe[]> = new Map();\r\n    private _curTrialToggleBtn: TrialToggleBtn = null;\r\n    private _openName: tab.OpenFunctionName = tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask\r\n    private _list = []\r\n    getLayerType(){\r\n        return this._layer_type;\r\n    }\r\n    onShow(): void {\r\n        let trial_msg = new proto.Msg_GetNewPlayerTrialMapReq();\r\n        Net.Send(proto.Ptl.GetNewPlayerTrialMapReq, trial_msg);\r\n    }\r\n    on_s2c_GetNewPlayerTrialMapRsp(msg: proto.Msg_GetNewPlayerTrialMapRsp){\r\n        this.setOnshow();\r\n    }\r\n    setOnshow(){\r\n        this._openName = tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask;\r\n        let trialInfo = RookieTaskMgr.ins.getTrialTask(this._openName);\r\n        if (trialInfo) {\r\n            this._layer_type = TRIALLAYER.ROOKIE;\r\n        } else {\r\n            this._openName = tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask2;\r\n            this._layer_type = TRIALLAYER.ELITE;\r\n        }\r\n        const openName1 = tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask;\r\n        const openName2 = tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask2;\r\n        const data1 = RookieTaskMgr.ins.getTrialTask(openName1);\r\n        const data2 = RookieTaskMgr.ins.getTrialTask(openName2);\r\n        this.node_toggle_rookie.active = false;\r\n        this.node_toggle_elite.active = false;\r\n        if (data1) {\r\n            this.node_toggle_rookie.active = true;\r\n        }\r\n        if (data2) {\r\n            this.node_toggle_elite.active = true;\r\n        }\r\n\r\n        this.setAsyncView();\r\n    }\r\n    setAsyncView() {\r\n        let trialInfo = RookieTaskMgr.ins.getTrialTask(this._openName);\r\n        this._view_type = TRIALTASK.TASK1;\r\n        this._cur_day = trialInfo.unlockedDays;\r\n        const costDay = this._cur_day-(this._layer_type-1)*7\r\n        this._click_day = costDay > 7 ? 7 : costDay;\r\n\r\n        this.node_rookie.active = this._layer_type === TRIALLAYER.ROOKIE;\r\n        this.node_bg_rookie.active = this.node_rookie.active\r\n        this.node_elite.active = !this.node_rookie.active;\r\n        this.node_toggle_elite.active = RookieTaskMgr.ins.getTrialTask(tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask2) ? true : false\r\n        this.node_bg_elite.active = !this.node_rookie.active\r\n        this.node_toggle_view.getChildByName(\"Toggle\" + this._view_type).getComponent(Toggle).isChecked = true;\r\n        this.node_toggle_layer.getChildByName(\"Toggle\" + this._layer_type).getComponent(Toggle).isChecked = true;\r\n        this.createDayToggle();\r\n        this.setView(true);\r\n        this.beginCountDown();\r\n    }\r\n    setView(isInit: boolean) {\r\n        this._list = this.getViewData();\r\n        if (isInit) {\r\n            this.list_view.Init({\r\n                getCellNumber: this.getCellCount.bind(this),\r\n                getCellSize: this.getCellHeight.bind(this),\r\n                getCellIdentifer: this.getCellIdentifer.bind(this),\r\n                getCellView: this.getCellView.bind(this),\r\n                getCellData: this.GetCellData.bind(this),\r\n            })\r\n        } else {\r\n            this.list_view.Reload(false, true)\r\n        }\r\n        this.setBarItem();\r\n        RookieTaskMgr.ins.red_trialRed();\r\n        this.refreshAllRed();\r\n    }\r\n    // 根据天数创建toggle\r\n    createDayToggle() {\r\n        for (let i = 1; i <= 7; i++) {\r\n            const item = this.node_toggle_day.children[i - 1];\r\n            item.name = String(i);\r\n            const itemTs = item.getComponent(TrialToggleBtn);\r\n            if (i === this._click_day) {\r\n                this._curTrialToggleBtn = itemTs;\r\n            }\r\n            itemTs.initToggle(this, i === this._click_day, i > this._cur_day-(this._layer_type-1)*7,i);\r\n        }\r\n    }\r\n    // 设置itembar\r\n    setBarItem() {\r\n        for (let i = 0; i < 6; i++) {\r\n            const id = this._layer_type * 100 + (6 - i);\r\n            const scoreTab = tab.getData().ActivityNewPlayerTaskScoreTableById.getValue(id);\r\n            const item = this.node_bar_content.children[i];\r\n            item.name = String(scoreTab.Id);\r\n            const itemTs = item.getComponent(RookieTaskBarItem);\r\n            itemTs.initData(scoreTab);\r\n        }\r\n        const trialData = RookieTaskMgr.ins.getTrialTask(this._openName)\r\n        this.lbl_score.string = String(trialData.score);\r\n        this.lbl_score_elite.string = String(trialData.score);\r\n    }\r\n    /* 刷新积分数据 */\r\n    refreshScore(socreId: number) {\r\n        const newPlayerTaskTab = tab.getData().ActivityNewPlayerTaskTableById.getValue(socreId);\r\n        const newPlayertrial = RookieTaskMgr.ins.getTrialTask(newPlayerTaskTab.Group);\r\n        newPlayertrial.receivedScoreIds.push(socreId)\r\n\r\n        const item = this.node_bar_content.getChildByName(String(socreId));\r\n        const itemTs = item.getComponent(RookieTaskBarItem);\r\n        itemTs.gotItem();\r\n    }\r\n    // 领取奖励刷新view\r\n    refreshView() {\r\n        RookieTaskMgr.ins.red_trialRed();\r\n        this.refreshAllRed();\r\n        this.list_view.Refresh();\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy()\r\n    }\r\n    register(): void {\r\n        // 监听任务领取奖励\r\n        EventMgr.onMsg(proto.Ptl.ReceiveNewPlayerTrialTaskRewardsRsp, this.on_s2c_ReceiveNewPlayerTrialTaskRewardsRsp, this);\r\n        // 购买固定商品\r\n        EventMgr.onMsg(proto.Ptl.BuyFixedShopCommodityRsp, this.on_s2c_BuyFixedShopCommodityRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.ReceiveNewPlayerTrialScoreRewardsRsp, this.on_s2c_ReceiveNewPlayerTrialScoreRewardsRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.ChangedNewPlayerTrialScorePush, this.on_s2c_ChangedNewPlayerTrialScorePush, this);\r\n        EventMgr.onMsg(proto.Ptl.GetNewPlayerTrialMapRsp, this.on_s2c_GetNewPlayerTrialMapRsp, this);\r\n    }\r\n    // 积分更新\r\n    on_s2c_ChangedNewPlayerTrialScorePush(msg: proto.Msg_ChangedNewPlayerTrialScorePush) {\r\n        const newPlayertrial = RookieTaskMgr.ins.getTrialTask(msg.newPlayerTrialId);\r\n        newPlayertrial.score = msg.score;\r\n        this.setBarItem();\r\n        EventMgr.emitLocal(LocalEvent.TrialRed)\r\n    }\r\n    // 购买固定商品\r\n    on_s2c_BuyFixedShopCommodityRsp(msg: proto.Msg_BuyFixedShopCommodityRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        this.refreshView();\r\n    }\r\n    // 完成任务\r\n    on_s2c_ReceiveNewPlayerTrialTaskRewardsRsp(msg: proto.Msg_ReceiveNewPlayerTrialTaskRewardsRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        UIMgr.ins.show({ viewName: ViewName.CongratulationPop, data: msg.rewards })\r\n        const taskData = TaskData.ins.getTrialTaskInfo(msg.taskId);\r\n        taskData.isReceived = true;\r\n        this._list = this.getViewData();\r\n        this.refreshView();\r\n        EventMgr.emitLocal(LocalEvent.TrialRed);\r\n    }\r\n    // 领取积分奖励\r\n    on_s2c_ReceiveNewPlayerTrialScoreRewardsRsp(msg: proto.Msg_ReceiveNewPlayerTrialScoreRewardsRsp) {\r\n        if (msg.error && msg.error.code != proto.CommonErrorCode.Succeed) return;\r\n        UIMgr.ins.show({ viewName: ViewName.CongratulationPop, data: msg.rewards })\r\n        this.refreshScore(msg.scoreId)\r\n        this.refreshAllRed();\r\n        EventMgr.emitLocal(LocalEvent.TrialRed)\r\n    }\r\n   \r\n    getCellCount() {\r\n        return this._list.length;\r\n    }\r\n    getCellHeight() {\r\n        if (this._view_type !== TRIALTASK.GIFT) {\r\n            return 120;\r\n        } else {\r\n            return 250\r\n        }\r\n    }\r\n    getCellIdentifer() {\r\n        if (this._view_type !== TRIALTASK.GIFT) {\r\n            return 'RookieTaskItem'\r\n        } else {\r\n            return 'TrialLayoutCell'\r\n        }\r\n    }\r\n    getCellView() {\r\n        if (this._view_type !== TRIALTASK.GIFT) {\r\n            return instantiate(this.pfb_task_item).getComponent(RookieTaskItem);\r\n        } else {\r\n            return instantiate(this.pfb_mall_item).getComponent(TrialLayoutCell);\r\n        }\r\n    }\r\n    GetCellData(idx: number) {\r\n        const ID = this._layer_type * 100 + this._click_day;\r\n        return { data: this._list[idx], id: this._openName }\r\n    }\r\n    // 根据layer clickday viewType获取信息\r\n    getViewData() {\r\n        const ID = this._layer_type * 100 + this._click_day;\r\n        const newPlayerData = tab.getData().ActivityNewPlayerTaskTableById.getValue(ID);\r\n        if (this._view_type === TRIALTASK.TASK1 || this._view_type === TRIALTASK.TASK2) {\r\n            const taskData = newPlayerData['TaskIds' + this._view_type];\r\n            taskData.sort((taskId1: number, taskId2: number) => {\r\n                const taskData1 = TaskData.ins.getTrialTaskInfo(taskId1);\r\n                const taskData2 = TaskData.ins.getTrialTaskInfo(taskId2);\r\n                return Number(taskData1.isReceived) - Number(taskData2.isReceived);\r\n            })\r\n            return taskData;\r\n        } else if (this._view_type === TRIALTASK.GIFT) {\r\n            const arr = RookieTaskMgr.ins.getMallTabs(newPlayerData.MallId);\r\n            const result = [];\r\n            for (let i = 0; i < arr.length; i += 3) {\r\n                result.push(arr.slice(i, i + 3));\r\n            }\r\n            // return this._mallMap.get(newPlayerData.MallId);\r\n            return result\r\n        }\r\n    }\r\n    // 切换layer\r\n    clickSwitchLayer(e: EventTouch, layer: string) {\r\n        if (this._layer_type === Number(layer)) {\r\n            return;\r\n        }\r\n        this._layer_type = Number(layer);\r\n        this._openName = this._layer_type === TRIALLAYER.ROOKIE ? tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask : tab.OpenFunctionName.OpenFunctionName_ActivityNewPlayerTask2;\r\n        this.setAsyncView();\r\n    }\r\n    beginCountDown() {\r\n        const trialData = RookieTaskMgr.ins.getTrialTask(this._openName)\r\n        const now = RoleData.ins.getServerUtcTime()\r\n        const endTime = Number(trialData.expireTime);\r\n        this._countDown = endTime - now;\r\n        this.updateTime()\r\n        this.unschedule(this.updateTime)\r\n        this.schedule(this.updateTime, 1)\r\n    }\r\n    // 切换天数\r\n    clickSwitchDay(toggle: TrialToggleBtn, day: number) {\r\n        this._curTrialToggleBtn.setSelect(false);\r\n        this._curTrialToggleBtn = toggle;\r\n        this._click_day = day;\r\n        this.setView(false);\r\n    }\r\n    // 切换页签\r\n    clickSwitchView(e: EventTouch, view: string) {\r\n        if (this._view_type === Number(view)) {\r\n            return;\r\n        }\r\n        this._view_type = Number(view)\r\n        this.setView(false)\r\n    }\r\n    updateTime() {\r\n        // 获取刷新周期\r\n        this._countDown--;\r\n        if (this._countDown <= 0) {\r\n            this._countDown = 0;\r\n            this.unschedule(this.updateTime);\r\n        } else {\r\n            this.lbl_count_time.string = setTextTime(this._countDown);\r\n        }\r\n    }\r\n    // 点击预览\r\n    clickShowHero() {\r\n        if (this._layer_type === TRIALLAYER.ROOKIE) {\r\n            const data = tab.getData().ActivityNewPlayerTaskScoreTableById.getValue(106);\r\n            HeroDataControl.ins.refreshBookData(data.RewardId);\r\n            UIMgr.ins.show({ viewName: ViewName.HeroBagView, data: { viewType: 2 }, zIndex: 300 })\r\n        } else {\r\n            const data = tab.getData().ActivityNewPlayerTaskScoreTableById.getValue(206);\r\n            UIMgr.ins.show({\r\n                viewName: ViewName.ItemInfoPop, data: {\r\n                    itemId: data.RewardId,\r\n                }\r\n            })\r\n        }\r\n    }\r\n    refreshAllRed() {\r\n        this.red_node_rookie.active = RookieTaskMgr.ins.checkIsRed(TRIALLAYER.ROOKIE)||RookieTaskMgr.ins.red_score_red(TRIALLAYER.ROOKIE);\r\n        this.red_node_elite.active = RookieTaskMgr.ins.checkIsRed(TRIALLAYER.ELITE)||RookieTaskMgr.ins.red_score_red(TRIALLAYER.ELITE);;\r\n        this.red_node_day1.active = RookieTaskMgr.ins.checkIsRed(this._layer_type, 1);\r\n        this.red_node_day2.active = RookieTaskMgr.ins.checkIsRed(this._layer_type, 2);\r\n        this.red_node_day3.active = RookieTaskMgr.ins.checkIsRed(this._layer_type, 3);\r\n        this.red_node_day4.active = RookieTaskMgr.ins.checkIsRed(this._layer_type, 4);\r\n        this.red_node_day5.active = RookieTaskMgr.ins.checkIsRed(this._layer_type, 5);\r\n        this.red_node_day6.active = RookieTaskMgr.ins.checkIsRed(this._layer_type, 6);\r\n        this.red_node_day7.active = RookieTaskMgr.ins.checkIsRed(this._layer_type, 7);\r\n        this.red_node_rookie_task1.active = RookieTaskMgr.ins.checkIsRed(1, this._click_day, TRIALTASK.TASK1);\r\n        this.red_node_rookie_task2.active = RookieTaskMgr.ins.checkIsRed(1, this._click_day, TRIALTASK.TASK2);\r\n        this.red_node_rookie_gift.active = RookieTaskMgr.ins.checkIsRed(1, this._click_day, TRIALTASK.GIFT);\r\n\r\n        this.red_node_elite_task1.active = RookieTaskMgr.ins.checkIsRed(2, this._click_day, TRIALTASK.TASK1);\r\n        this.red_node_elite_task2.active = RookieTaskMgr.ins.checkIsRed(2, this._click_day, TRIALTASK.TASK2);\r\n        this.red_node_elite_gift.active = RookieTaskMgr.ins.checkIsRed(2, this._click_day, TRIALTASK.GIFT);\r\n        // todo\r\n        // EventMgr.emitLocal(LocalEvent.TrialRed)\r\n    }\r\n}\r\n\r\n\r\n"]}