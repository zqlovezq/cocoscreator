{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/friends/FriendControl.ts"],"names":["_decorator","AbsControl","EventMgr","proto","Net","FriendData","RedMgr","RedDotType","ccclass","property","FriendControl","currType","ins","_instance","register","onMsg","Ptl","GetFriendSimpleRoleRsp","on_s2c_GetFriendSimpleRoleRsp","AddFriendPush","on_s2c_AddFriendPush","RemoveFriendPush","on_s2c_RemoveFriendPush","UpdateFriendOnlineTime","on_s2c_UpdateFriendOnlineTime","UpdatFriendPowerScore","on_s2c_UpdatFriendPowerScore","AddBlacklistRsp","on_s2c_Msg_AddBlacklistRsp","RemoveBlacklistRsp","on_s2c_RemoveBlacklistRsp","AddFriendRsp","on_s2c_AddFriendRsp","ConfirmFriendRsp","on_s2c_ConfirmFriendRsp","RemoveFriendRsp","on_s2c_RemoveFriendRsp","RemoveFriendApplyRsp","on_s2c_RemoveFriendApplyRsp","RecommendFriendRsp","on_s2c_RecommendFriendRsp","FindFriendRsp","on_s2c_FindFriendRsp","RecvGiftRsp","on_s2c_RecvGiftRsp","GivingGiftRsp","on_s2c_GivingGiftRsp","SyncGiftList","on_s2c_SyncGiftList","GiftPush","on_s2c_GiftPush","registerCalculateFb","FriendApply","red_FriendApply","FriendValueReceive","red_FriendValueReceive","request","requestGetFriendSimpleRole","FriendListType","FriendList","type","msg","Msg_GetFriendSimpleRoleReq","Send","GetFriendSimpleRoleReq","requestRecommendFriend","Msg_RecommendFriendReq","RecommendFriendReq","requestAddFriend","roleId","Msg_AddFriendReq","AddFriendReq","requestConfirmFriend","roleIds","Msg_ConfirmFriendReq","ConfirmFriendReq","requestRemoveFriend","Msg_RemoveFriendReq","RemoveFriendReq","requestRemoveFriendApply","Msg_RemoveFriendApplyReq","RemoveFriendApplyReq","requestAddBlacklist","Msg_AddBlacklistReq","AddBlacklistReq","requestRemoveBlacklist","Msg_RemoveBlacklistReq","RemoveBlacklistReq","requestFindFriend","name","Msg_FindFriendReq","FindFriendReq","requestRecvGift","Msg_RecvGiftReq","RecvGiftReq","requestGivingGift","Msg_GivingGiftReq","GivingGiftReq","error","code","CommonErrorCode","Succeed","initFrendData","isInitApply","ApplyList","TryAgainLater","setTimeout","addFriendInfo","removeFiendInfo","updateFriendOnlineTime","updatFriendPowerScore","initRecommendFriendData","list","giftListMsg","giftList","giftPush","refreshEvent","receiveGiftSucc","result","givingGiftSucc","getApplyInfos","length","getNotReceiveGiftNum"],"mappings":"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","sourcesContent":["import { _decorator, Component, log, Node } from 'cc';\r\nimport { AbsControl } from '../../../framework/base/IAbs';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../net/Net';\r\nimport { FriendData } from './FriendData';\r\nimport { RedMgr } from '../../mgr/RedMgr';\r\nimport { RedDotType } from '../../red/RedDotType';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * FriendControl\r\n * zhudingchao\r\n * Fri Jun 07 2024 11:11:38 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/friends/FriendControl.ts\r\n *\r\n */\r\n\r\n@ccclass('FriendControl')\r\nexport class FriendControl extends AbsControl {\r\n\r\n    private static _instance: FriendControl;\r\n    public static get ins() {\r\n        if (null == this._instance) {\r\n            this._instance = new FriendControl();\r\n        }\r\n        return this._instance;\r\n    }\r\n    register(): void {\r\n        EventMgr.onMsg(proto.Ptl.GetFriendSimpleRoleRsp, this.on_s2c_GetFriendSimpleRoleRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.AddFriendPush, this.on_s2c_AddFriendPush, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveFriendPush, this.on_s2c_RemoveFriendPush, this);\r\n        EventMgr.onMsg(proto.Ptl.UpdateFriendOnlineTime, this.on_s2c_UpdateFriendOnlineTime, this);\r\n        EventMgr.onMsg(proto.Ptl.UpdatFriendPowerScore, this.on_s2c_UpdatFriendPowerScore, this);\r\n        EventMgr.onMsg(proto.Ptl.AddBlacklistRsp, this.on_s2c_Msg_AddBlacklistRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveBlacklistRsp, this.on_s2c_RemoveBlacklistRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.AddFriendRsp, this.on_s2c_AddFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.ConfirmFriendRsp, this.on_s2c_ConfirmFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveFriendRsp, this.on_s2c_RemoveFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RemoveFriendApplyRsp, this.on_s2c_RemoveFriendApplyRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RecommendFriendRsp, this.on_s2c_RecommendFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.FindFriendRsp, this.on_s2c_FindFriendRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.RecvGiftRsp, this.on_s2c_RecvGiftRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.GivingGiftRsp, this.on_s2c_GivingGiftRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.SyncGiftList, this.on_s2c_SyncGiftList, this);\r\n        EventMgr.onMsg(proto.Ptl.GiftPush, this.on_s2c_GiftPush, this);\r\n\r\n        RedMgr.ins.registerCalculateFb(RedDotType.FriendApply, this.red_FriendApply, this);\r\n        RedMgr.ins.registerCalculateFb(RedDotType.FriendValueReceive, this.red_FriendValueReceive, this);\r\n\r\n\r\n    }\r\n\r\n    request() {\r\n        this.requestGetFriendSimpleRole(proto.FriendListType.FriendList);\r\n        // this.requestGetFriendSimpleRole(proto.FriendListType.ApplyList);\r\n\r\n    }\r\n\r\n\r\n    private currType: proto.FriendListType;\r\n    requestGetFriendSimpleRole(type: proto.FriendListType) {\r\n        let msg = new proto.Msg_GetFriendSimpleRoleReq();\r\n        msg.type = type;\r\n        this.currType = type;\r\n        Net.Send(proto.Ptl.GetFriendSimpleRoleReq, msg)\r\n    }\r\n    requestRecommendFriend() {\r\n        let msg = new proto.Msg_RecommendFriendReq();\r\n        Net.Send(proto.Ptl.RecommendFriendReq, msg)\r\n    }\r\n    requestAddFriend(roleId: string) {\r\n        let msg = new proto.Msg_AddFriendReq();\r\n        msg.roleId = roleId;\r\n        Net.Send(proto.Ptl.AddFriendReq, msg)\r\n    }\r\n    requestConfirmFriend(roleIds: string[]) {\r\n        let msg = new proto.Msg_ConfirmFriendReq();\r\n        msg.roleId = roleIds;\r\n        Net.Send(proto.Ptl.ConfirmFriendReq, msg)\r\n    }\r\n    requestRemoveFriend(roleId: string) {\r\n        let msg = new proto.Msg_RemoveFriendReq;\r\n        msg.roleId = roleId;\r\n        Net.Send(proto.Ptl.RemoveFriendReq, msg)\r\n    }\r\n    requestRemoveFriendApply(roleIds: string[]) {\r\n        let msg = new proto.Msg_RemoveFriendApplyReq;\r\n        msg.roleId = roleIds;\r\n        Net.Send(proto.Ptl.RemoveFriendApplyReq, msg)\r\n    }\r\n    requestAddBlacklist(roleId: string) {\r\n        let msg = new proto.Msg_AddBlacklistReq;\r\n        msg.roleId = roleId;\r\n        Net.Send(proto.Ptl.AddBlacklistReq, msg)\r\n    }\r\n    requestRemoveBlacklist(roleId: string) {\r\n        let msg = new proto.Msg_RemoveBlacklistReq();\r\n        msg.roleId = roleId;\r\n        Net.Send(proto.Ptl.RemoveBlacklistReq, msg)\r\n    }\r\n    requestFindFriend(name: string) {\r\n        let msg = new proto.Msg_FindFriendReq();\r\n        msg.name = name;\r\n        Net.Send(proto.Ptl.FindFriendReq, msg)\r\n    }\r\n    requestRecvGift(roleIds: string[]) {\r\n        let msg = new proto.Msg_RecvGiftReq();\r\n        msg.roleId = roleIds;\r\n        Net.Send(proto.Ptl.RecvGiftReq, msg)\r\n    }\r\n    requestGivingGift(roleIds: string[]) {\r\n        let msg = new proto.Msg_GivingGiftReq();\r\n        msg.roleId = roleIds;\r\n        Net.Send(proto.Ptl.GivingGiftReq, msg)\r\n    }\r\n    on_s2c_GetFriendSimpleRoleRsp(msg: proto.Msg_GetFriendSimpleRoleRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            FriendData.ins.initFrendData(msg);\r\n            if (msg.type == proto.FriendListType.FriendList) {\r\n                if (!FriendData.ins.isInitApply) {\r\n                    this.requestGetFriendSimpleRole(proto.FriendListType.ApplyList);\r\n                }\r\n            }\r\n        } else if (msg.error.code == proto.CommonErrorCode.TryAgainLater) {\r\n            if (this.currType == proto.FriendListType.FriendList) {\r\n                setTimeout(() => {\r\n                    this.requestGetFriendSimpleRole(proto.FriendListType.FriendList);\r\n                }, 1000);\r\n            } else if (this.currType == proto.FriendListType.ApplyList) {\r\n                setTimeout(() => {\r\n                    this.requestGetFriendSimpleRole(proto.FriendListType.ApplyList);\r\n                }, 1000);\r\n            }\r\n\r\n        }\r\n    }\r\n    on_s2c_AddFriendPush(msg: proto.Msg_AddFriendPush) {\r\n        FriendData.ins.addFriendInfo(msg);\r\n    }\r\n    on_s2c_RemoveFriendPush(msg: proto.Msg_RemoveFriendPush) {\r\n        FriendData.ins.removeFiendInfo(msg);\r\n    }\r\n    on_s2c_UpdateFriendOnlineTime(msg: proto.Msg_UpdateFriendOnlineTime) {\r\n        FriendData.ins.updateFriendOnlineTime(msg);\r\n    }\r\n    on_s2c_UpdatFriendPowerScore(msg: proto.Msg_UpdatFriendPowerScore) {\r\n        FriendData.ins.updatFriendPowerScore(msg);\r\n    }\r\n    on_s2c_Msg_AddBlacklistRsp(msg: proto.Msg_AddBlacklistRsp) {\r\n\r\n    }\r\n    on_s2c_RemoveBlacklistRsp(msg: proto.Msg_RemoveBlacklistRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n\r\n        }\r\n    }\r\n    on_s2c_AddFriendRsp(msg: proto.Msg_AddFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n\r\n        }\r\n    }\r\n    on_s2c_ConfirmFriendRsp(msg: proto.Msg_ConfirmFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n\r\n        }\r\n    }\r\n    on_s2c_RemoveFriendApplyRsp(msg: proto.Msg_RemoveFriendApplyRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n\r\n        }\r\n    }\r\n    on_s2c_RemoveFriendRsp(msg: proto.Msg_RemoveFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n\r\n        }\r\n    }\r\n    on_s2c_RecommendFriendRsp(msg: proto.Msg_RecommendFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            FriendData.ins.initRecommendFriendData(msg.list);\r\n        }\r\n    }\r\n    on_s2c_FindFriendRsp(msg: proto.Msg_FindFriendRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n\r\n        }\r\n    }\r\n    /**\r\n     * 同步礼物数据\r\n     * @param msg \r\n     */\r\n    on_s2c_SyncGiftList(msg: proto.Msg_SyncGiftList) {\r\n        FriendData.ins.giftListMsg = msg;\r\n        if(msg.giftList[0]){\r\n            FriendData.ins.giftPush(msg.giftList[0]);\r\n        }\r\n        RedMgr.refreshEvent(RedDotType.FriendValueReceive);\r\n    }\r\n    /**\r\n     * 同步送礼数据\r\n     * @param msg \r\n     */\r\n    on_s2c_GiftPush(msg: proto.Msg_GiftPush) {\r\n        FriendData.ins.giftPush(msg.roleId);\r\n        RedMgr.refreshEvent(RedDotType.FriendValueReceive);\r\n    }\r\n    /**\r\n    * 收取礼物返回\r\n    * @param msg \r\n    */\r\n    on_s2c_RecvGiftRsp(msg: proto.Msg_RecvGiftRsp) {\r\n        FriendData.ins.receiveGiftSucc(msg.result);\r\n        RedMgr.refreshEvent(RedDotType.FriendValueReceive);\r\n    }\r\n    /**\r\n   * 赠与礼物返回\r\n   * @param msg \r\n   */\r\n    on_s2c_GivingGiftRsp(msg: proto.Msg_GivingGiftRsp) {\r\n        FriendData.ins.givingGiftSucc(msg.roleId);\r\n    }\r\n\r\n\r\n    red_FriendApply() {\r\n        let list = FriendData.ins.getApplyInfos();\r\n        return list && list.length > 0;\r\n\r\n    }\r\n    red_FriendValueReceive() {\r\n        return FriendData.ins.getNotReceiveGiftNum() > 0;\r\n    }\r\n}"]}