{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/view/rogue/RogueWeaponHeroItem.ts"],"names":["_decorator","Component","Label","Node","RichText","Sprite","tab","LangMgr","RogueControl","ccclass","property","RogueWeaponHeroItem","owner","rogueInfo","setData","info","itemTab","getData","ItemTableById","getValue","heroItemId","heroname_txt","string","getLab","Name","getCombineString","rogueTab","Level","head","setTexture","Icon","lvv_txt","toString","next_lv_txt","heroTab","HeroTableById","index","probg_node","children","length","element","active","getChildByName","Class","descRich","Description","heroClassTable","HeroClassTableByHeroClass","maxLevel","getMaxSkillLevel","i","lv_layout","lvNode","pro_img","getComponent","select_img","select_pro_img","bg","awaken_node","level","validList","ins","rogueInfos","_rogueInfo","Id","push","k"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,Q,OAAAA,Q;AAAcC,MAAAA,M,OAAAA,M;;AAElDC,MAAAA,G,iBAAAA,G;;AAEAC,MAAAA,O,iBAAAA,O;;AAEAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBV,U;;qCAIjBW,mB,WADZF,OAAO,CAAC,qBAAD,C,UAGHC,QAAQ,CAACR,KAAD,C,UAGRQ,QAAQ,CAACR,KAAD,C,UAGRQ,QAAQ,CAACR,KAAD,C,UAGRQ,QAAQ,CAACN,QAAD,C,UAGRM,QAAQ,CAACL,MAAD,C,UAGRK,QAAQ,CAACP,IAAD,C,UAERO,QAAQ,CAACP,IAAD,C,UAGRO,QAAQ,CAACP,IAAD,C,2BAvBb,MACaQ,mBADb,SACyCV,SADzC,CACmD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAyB/CW,KAzB+C;AAAA,eA0B/CC,SA1B+C;AAAA;;AA4B/CC,QAAAA,OAAO,CAACC,IAAD,EAAkB;AACrB,eAAKF,SAAL,GAAiBE,IAAjB;AAEA,cAAIC,OAAO,GAAG;AAAA;AAAA,0BAAIC,OAAJ,GAAcC,aAAd,CAA4BC,QAA5B,CAAqCJ,IAAI,CAACK,UAA1C,CAAd;AACA,eAAKC,YAAL,CAAkBC,MAAlB,GAA2B;AAAA;AAAA,kCAAQC,MAAR,CAAeP,OAAO,CAACQ,IAAvB,IAA+B;AAAA;AAAA,kCAAQC,gBAAR,CAAyB,uBAAzB,EAAkD,CAACV,IAAI,CAACW,QAAL,CAAcC,KAAf,CAAlD,CAA1D;AACA,eAAKC,IAAL,CAAUC,UAAV,CAAqBb,OAAO,CAACc,IAA7B;AAEA,eAAKC,OAAL,CAAaT,MAAb,GAAsB,CAACP,IAAI,CAACW,QAAL,CAAcC,KAAd,GAAsB,CAAvB,EAA0BK,QAA1B,EAAtB;AACA,eAAKC,WAAL,CAAiBX,MAAjB,GAA0BP,IAAI,CAACW,QAAL,CAAcC,KAAd,CAAoBK,QAApB,EAA1B;AACA,cAAIE,OAAO,GAAG;AAAA;AAAA,0BAAIjB,OAAJ,GAAckB,aAAd,CAA4BhB,QAA5B,CAAqCJ,IAAI,CAACK,UAA1C,CAAd;;AACA,eAAK,IAAIgB,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAKC,UAAL,CAAgBC,QAAhB,CAAyBC,MAArD,EAA6DH,KAAK,EAAlE,EAAsE;AAClE,gBAAMI,OAAO,GAAG,KAAKH,UAAL,CAAgBC,QAAhB,CAAyBF,KAAzB,CAAhB;AACAI,YAAAA,OAAO,CAACC,MAAR,GAAiB,KAAjB;AACH;;AACD,eAAKJ,UAAL,CAAgBK,cAAhB,CAA+B,QAAQR,OAAO,CAACS,KAA/C,EAAsDF,MAAtD,GAA+D,IAA/D;AACA,eAAKG,QAAL,CAActB,MAAd,GAAuB;AAAA;AAAA,kCAAQC,MAAR,CAAeR,IAAI,CAACW,QAAL,CAAcmB,WAA7B,CAAvB;AAEA,cAAIC,cAAc,GAAG;AAAA;AAAA,0BAAI7B,OAAJ,GAAc8B,yBAAd,CAAwC5B,QAAxC,CAAiDe,OAAO,CAACS,KAAzD,CAArB;AACA,cAAMK,QAAQ,GAAG,KAAKC,gBAAL,CAAsBlC,IAAtB,CAAjB;;AACA,eAAK,IAAImC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,SAAL,CAAeb,QAAf,CAAwBC,MAA5C,EAAoDW,CAAC,EAArD,EAAyD;AACrD,gBAAME,MAAM,GAAG,KAAKD,SAAL,CAAeb,QAAf,CAAwBY,CAAxB,CAAf;;AACA,gBAAMd,MAAK,GAAGc,CAAC,GAAG,CAAlB;;AACA,gBAAMG,OAAO,GAAGD,MAAM,CAACV,cAAP,CAAsB,SAAtB,EAAiCY,YAAjC,CAA8CjD,MAA9C,CAAhB;AACA,gBAAMkD,UAAU,GAAGH,MAAM,CAACV,cAAP,CAAsB,YAAtB,CAAnB;AACA,gBAAMc,cAAc,GAAGD,UAAU,CAACb,cAAX,CAA0B,SAA1B,EAAqCY,YAArC,CAAkDjD,MAAlD,CAAvB;AACA,gBAAMoD,EAAE,GAAGL,MAAM,CAACV,cAAP,CAAsB,IAAtB,CAAX;AACAa,YAAAA,UAAU,CAACd,MAAX,GAAoBL,MAAK,KAAKrB,IAAI,CAACW,QAAL,CAAcC,KAA5C;AACA8B,YAAAA,EAAE,CAAChB,MAAH,GAAYL,MAAK,IAAIrB,IAAI,CAACW,QAAL,CAAcC,KAAvB,IAA8B,CAAC4B,UAAU,CAACd,MAAtD;AACAY,YAAAA,OAAO,CAACxB,UAAR,CAAmBiB,cAAc,CAAChB,IAAlC;AACA0B,YAAAA,cAAc,CAAC3B,UAAf,CAA0BiB,cAAc,CAAChB,IAAzC;AACAsB,YAAAA,MAAM,CAACX,MAAP,GAAgBL,MAAK,IAAEY,QAAvB;AACH;;AAED,eAAKU,WAAL,CAAiBjB,MAAjB,GAA0B1B,IAAI,CAACW,QAAL,CAAcC,KAAd,IAAuB,CAAjD;AACH,SA9D8C,CA+D/C;;;AACAsB,QAAAA,gBAAgB,CAACpC,SAAD,EAA8B;AAC1C,cAAI8C,KAAK,GAAG,CAAZ;AACA,cAAMC,SAAS,GAAG;AAAA;AAAA,4CAAaC,GAAb,CAAiBD,SAAnC;AACA,cAAME,UAAU,GAAG,CAACjD,SAAD,CAAnB;;AACA,eAAK,IAAIqC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,SAAS,CAACrB,MAA9B,EAAsCW,CAAC,EAAvC,EAA2C;AACvC,gBAAMa,UAAU,GAAGH,SAAS,CAACV,CAAD,CAA5B;;AACA,gBAAIa,UAAU,CAACC,EAAX,KAAkBnD,SAAS,CAACmD,EAAhC,EAAoC;AAChC;AACH;;AACD,gBAAID,UAAU,CAAC3C,UAAX,KAA0BP,SAAS,CAACO,UAAxC,EAAoD;AAChD0C,cAAAA,UAAU,CAACG,IAAX,CAAgBF,UAAhB;AACH;AACJ;;AACD,eAAI,IAAIG,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACJ,UAAU,CAACvB,MAAzB,EAAgC2B,CAAC,EAAjC,EAAoC;AAChC,gBAAMrD,WAAS,GAAGiD,UAAU,CAACI,CAAD,CAA5B;;AACA,gBAAGrD,WAAS,CAACa,QAAV,CAAmBC,KAAnB,GAAyBgC,KAA5B,EAAkC;AAC9BA,cAAAA,KAAK,GAAG9C,WAAS,CAACa,QAAV,CAAmBC,KAA3B;AACH;AACJ;;AACD,iBAAOgC,KAAP;AACH;;AApF8C,O;;;;;iBAGzB,I;;;;;;;iBAGL,I;;;;;;;iBAGI,I;;;;;;;iBAGA,I;;;;;;;iBAGN,I;;;;;;;iBAGI,I;;;;;;;iBAED,I;;;;;;;iBAGE,I","sourcesContent":["import { _decorator, Component, Label, Node, RichText, sp, Sprite } from \"cc\";\nimport { RogueInfo } from \"./RogueInfo\";\nimport { tab } from \"../../../../Table/table_gen\";\nimport { ResMgr } from \"../../../mgr/ResMgr\";\nimport { LangMgr } from \"../../../mgr/LangMgr\";\nimport { RoguePop } from \"./RoguePop\";\nimport { RogueControl } from \"./RogueControl\";\n\nconst { ccclass, property } = _decorator;\n\n\n@ccclass('RogueWeaponHeroItem')\nexport class RogueWeaponHeroItem extends Component {\n\n    @property(Label)\n    heroname_txt: Label = null\n\n    @property(Label)\n    lvv_txt: Label = null\n\n    @property(Label)\n    next_lv_txt: Label = null\n\n    @property(RichText)\n    descRich: RichText = null\n\n    @property(Sprite)\n    head: Sprite = null\n\n    @property(Node)\n    probg_node: Node = null\n    @property(Node)\n    lv_layout: Node = null;\n\n    @property(Node)\n    awaken_node: Node = null;\n\n    owner: RoguePop\n    rogueInfo: RogueInfo\n\n    setData(info: RogueInfo) {\n        this.rogueInfo = info\n\n        let itemTab = tab.getData().ItemTableById.getValue(info.heroItemId);\n        this.heroname_txt.string = LangMgr.getLab(itemTab.Name) + LangMgr.getCombineString(\"ui_heroresonancepop_3\", [info.rogueTab.Level]);\n        this.head.setTexture(itemTab.Icon)\n\n        this.lvv_txt.string = (info.rogueTab.Level - 1).toString()\n        this.next_lv_txt.string = info.rogueTab.Level.toString()\n        let heroTab = tab.getData().HeroTableById.getValue(info.heroItemId)\n        for (let index = 0; index < this.probg_node.children.length; index++) {\n            const element = this.probg_node.children[index];\n            element.active = false\n        }\n        this.probg_node.getChildByName(\"pro\" + heroTab.Class).active = true\n        this.descRich.string = LangMgr.getLab(info.rogueTab.Description)\n\n        let heroClassTable = tab.getData().HeroClassTableByHeroClass.getValue(heroTab.Class);\n        const maxLevel = this.getMaxSkillLevel(info)\n        for (let i = 0; i < this.lv_layout.children.length; i++) {\n            const lvNode = this.lv_layout.children[i];\n            const index = i + 1;\n            const pro_img = lvNode.getChildByName(\"pro_img\").getComponent(Sprite);\n            const select_img = lvNode.getChildByName(\"select_img\");\n            const select_pro_img = select_img.getChildByName(\"pro_img\").getComponent(Sprite);\n            const bg = lvNode.getChildByName(\"bg\");\n            select_img.active = index === info.rogueTab.Level;\n            bg.active = index <= info.rogueTab.Level&&!select_img.active;\n            pro_img.setTexture(heroClassTable.Icon);\n            select_pro_img.setTexture(heroClassTable.Icon);\n            lvNode.active = index<=maxLevel;\n        }\n\n        this.awaken_node.active = info.rogueTab.Level >= 6\n    }\n    // 获取最大重数\n    getMaxSkillLevel(rogueInfo: RogueInfo) :number{\n        let level = 0;\n        const validList = RogueControl.ins.validList;\n        const rogueInfos = [rogueInfo];\n        for (let i = 0; i < validList.length; i++) {\n            const _rogueInfo = validList[i];\n            if (_rogueInfo.Id === rogueInfo.Id) {\n                continue;\n            }\n            if (_rogueInfo.heroItemId === rogueInfo.heroItemId) {\n                rogueInfos.push(_rogueInfo);\n            }\n        }\n        for(let k=0;k<rogueInfos.length;k++){\n            const rogueInfo = rogueInfos[k];\n            if(rogueInfo.rogueTab.Level>level){\n                level = rogueInfo.rogueTab.Level;\n            }\n        }\n        return level\n    }\n}"]}