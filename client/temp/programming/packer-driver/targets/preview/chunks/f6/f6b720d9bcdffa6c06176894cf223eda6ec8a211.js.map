{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/item/CommonItem.ts"],"names":["_decorator","Button","Color","Component","Label","log","Node","ProgressBar","Sprite","v3","ItemInfo","EquipInfo","tab","ItemPoolMgr","UIMgr","ViewName","HeroStar","GameUtil","HeroDataControl","ccclass","property","CommonItem","data","touchCallBack","isTouch","isSelectState","isConsume","initData","node","getChildByName","active","initView","button","enabled","initId","id","num","info","itemId","start","pieceNode","itemTab","itemTable","qualityImg","setTexture","Quality","iconImg","Icon","setExtraPic","selectNode","starNode","Type","ItemType","ItemType_Equip","numLab","itemData","Number","string","convertNumber","ItemType_Piece","setPiece","setSelectState","consumeNode","needLab","consumeLab","haveLab","needNum","color","fromHEX","getData","GetKeyValue_ConfigTable","InterfaceTxtGreen","InterfaceTxtRed","setTouchCallBack","callBack","setIsTouchItem","b","addTouchEvent","on","EventType","TOUCH_END","onTouchItem","type","BagType","BagType_Equip","ins","show","viewName","EquipmentDetailPop","BagType_Jade","JadeDetailPop","BagType_Fragment","BagType_Goods","BagType_Consumable","ItemInfoPop","BagType_None","isHero","HeroTableById","getValue","refreshBookData","HeroBagView","viewType","zIndex","CommonBlackTipsPop","worldPosition","Desc","getSelect","onDestroy","targetOff","putCommonItem","setShowNum","getItemCount","equipInfo","unuse","setPosition","setStar","star","getComponent","showStar","_isBag","judgeIsBagView","itemInfo","quality","max","ItemQuality","ItemQuality_Purple","bar","progress","num_txt","BagPop","getView","hideConsumeFenMu","LT","MarkTopLeft","LB","MarkBottomLeft","RT","MarkTopRight","sp_LT","sp_LB","sp_RT","onDisable"],"mappings":"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","sourcesContent":["import { _decorator, Button, color, Color, Component, Label, log, Node, ProgressBar, Sprite, v3 } from 'cc';\r\nimport { ItemInfo } from './ItemInfo';\r\nimport { EquipInfo } from '../equip/EquipInfo';\r\nimport { ResMgr } from '../../mgr/ResMgr';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { ItemPoolMgr } from './ItemPoolMgr';\r\nimport { UIMgr } from '../../mgr/UIMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { HeroStar } from '../hero/HeroStar';\r\nimport { GameUtil, handleNumerText } from '../../utils/GameUtil';\r\nimport { HeroDataControl } from '../hero/herobag/HeroDataControl';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('CommonItem')\r\nexport class CommonItem extends Component {\r\n    @property(Button)\r\n    button: Button = null;\r\n    @property(Sprite)\r\n    qualityImg: Sprite = null;\r\n    @property(Sprite)\r\n    iconImg: Sprite = null;\r\n    @property(Node)\r\n    starNode: Node = null;\r\n    @property(Label)\r\n    numLab: Label = null;\r\n    @property(Node)\r\n    selectNode: Node = null;\r\n    @property(Node)\r\n    consumeNode: Node = null;\r\n    @property(Label)\r\n    haveLab: Label = null;\r\n    @property(Label)\r\n    needLab: Label = null;\r\n    @property(Label)\r\n    consumeLab:Label=null;\r\n    @property(Node)\r\n    pieceNode: Node = null;\r\n\r\n    @property(Sprite)\r\n    sp_LT:Sprite = null;\r\n    @property(Sprite)\r\n    sp_LB:Sprite = null;\r\n    @property(Sprite)\r\n    sp_RT:Sprite = null;\r\n    public data: ItemInfo | EquipInfo;\r\n    private touchCallBack: Function;\r\n    private isTouch: boolean = true;\r\n    public isSelectState: boolean = false;\r\n    private isConsume: boolean = false;\r\n    initData(data: ItemInfo | EquipInfo, isTouch: boolean = true, isConsume: boolean = false) {\r\n        this.data = data;\r\n        this.isTouch = isTouch;\r\n        this.node.getChildByName(\"redDot\").active = false;\r\n        this.isConsume = isConsume;\r\n        this.initView();\r\n        this.touchCallBack = null;\r\n        if (this.button) {\r\n            this.button.enabled = this.isTouch;\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n\r\n    initId(id: number, num: number) {\r\n        let info = new ItemInfo();\r\n        info.itemId = id\r\n        info.num = num;\r\n        this.initData(info)\r\n    }\r\n    start(): void {\r\n        this.button.enabled = this.isTouch;\r\n    }\r\n\r\n\r\n    initView() {\r\n        this.pieceNode.active = false;\r\n        let itemTab = this.data.itemTable;\r\n        this.qualityImg.setTexture(\"textrue/quality/qualityBg_\" + itemTab.Quality);\r\n        this.iconImg.setTexture(itemTab.Icon);\r\n        this.setExtraPic();\r\n        this.selectNode.active = false;\r\n        this.starNode.active = false;\r\n        if (itemTab.Type == tab.ItemType.ItemType_Equip || this.isConsume) {\r\n            this.numLab.node.active = false;\r\n        } else {\r\n            let itemData = <ItemInfo>this.data;\r\n            this.numLab.node.active = Number(itemData.num) > 0;\r\n            this.numLab.string = \"x\" +GameUtil.convertNumber(itemData.num) + \"\";\r\n            if(itemTab.Type===tab.ItemType.ItemType_Piece){\r\n                this.setPiece();\r\n            }\r\n        }\r\n        // this.addTouchEvent();\r\n        this.setSelectState(false);\r\n        this.consumeNode.active = this.isConsume;\r\n        if (this.isConsume) {\r\n            let itemData = <ItemInfo>this.data;\r\n            this.needLab.node.active=true;\r\n            this.consumeLab.node.active=true;\r\n            this.haveLab.string = GameUtil.convertNumber(itemData.num) + \"\";\r\n            this.needLab.string = GameUtil.convertNumber(itemData.needNum,true) + \"\";\r\n            if (Number(itemData.num) >= Number(itemData.needNum)) {\r\n                this.haveLab.color = new Color().fromHEX(tab.getData().GetKeyValue_ConfigTable().InterfaceTxtGreen);\r\n            } else {\r\n                this.haveLab.color = new Color().fromHEX(tab.getData().GetKeyValue_ConfigTable().InterfaceTxtRed);\r\n            }\r\n\r\n        }\r\n\r\n\r\n\r\n    }\r\n    setTouchCallBack(callBack: Function) {\r\n        this.touchCallBack = callBack;\r\n    }\r\n    setIsTouchItem(b: boolean) {\r\n        this.isTouch = b;\r\n        if (this.button) {\r\n            this.button.enabled = b;\r\n        }\r\n    }\r\n    private addTouchEvent() {\r\n        this.node.on(Node.EventType.TOUCH_END, this.onTouchItem, this)\r\n    }\r\n    private onTouchItem() {\r\n        if (!this.isTouch) {\r\n            return;\r\n        }\r\n        if (this.touchCallBack) {\r\n            this.touchCallBack(this);\r\n        } else {\r\n            log(\"点击了item==\", this.data.itemId)\r\n            let type = this.data.itemTable.BagType;\r\n            if (type == tab.BagType.BagType_Equip) {\r\n                UIMgr.ins.show({ viewName: ViewName.EquipmentDetailPop, data: this.data })\r\n            } else if (type == tab.BagType.BagType_Jade) {\r\n\r\n                const info = new EquipInfo();\r\n                info.itemId = this.data.itemId;\r\n\r\n                UIMgr.ins.show({ viewName: ViewName.JadeDetailPop, data: info })\r\n                \r\n            } else if (type === tab.BagType.BagType_Fragment || type === tab.BagType.BagType_Goods || type === tab.BagType.BagType_Consumable) {\r\n                UIMgr.ins.show({\r\n                    viewName: ViewName.ItemInfoPop, data: {\r\n                        itemId: this.data.itemId,\r\n                    }\r\n                })\r\n            } else if (type === tab.BagType.BagType_None) {\r\n                const isHero = tab.getData().HeroTableById.getValue(this.data.itemId)?true:false\r\n                if(isHero){\r\n                    HeroDataControl.ins.refreshBookData(this.data.itemId);\r\n                    UIMgr.ins.show({ viewName: ViewName.HeroBagView ,data:{viewType:2},zIndex:300})\r\n                }else{\r\n                    UIMgr.ins.show({ viewName: ViewName.CommonBlackTipsPop, data: { \"worldPos\": this.node.worldPosition, \"WordTableKey\": this.data.itemTable.Desc } });\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**设置选择状态 */\r\n    public setSelectState(b: boolean) {\r\n        this.isSelectState = b;\r\n        this.selectNode.active = b;\r\n\r\n    }\r\n    getSelect() {\r\n        return this.isSelectState;\r\n    }\r\n    protected onDestroy(): void {\r\n        this.node.targetOff(this);\r\n    }\r\n    putCommonItem() {\r\n        ItemPoolMgr.ins.putCommonItem(this.node);\r\n    }\r\n    setShowNum(num: number) {\r\n        this.numLab.string =\"x\" + GameUtil.convertNumber(num) + \"\"\r\n    }\r\n    getItemCount() {\r\n        return Number(this.numLab.string)\r\n    }\r\n    public get equipInfo() {\r\n        return this.data as EquipInfo;\r\n    }\r\n\r\n    unuse() {\r\n        this.node.targetOff(this);\r\n        this.touchCallBack = null;\r\n        this.isTouch = true;\r\n        this.data = null;\r\n        this.isSelectState = false;\r\n\r\n        this.node.setPosition(v3(0, 0));\r\n    }\r\n\r\n    setStar(star: number) {\r\n        this.starNode.active = true;\r\n        this.starNode.getComponent(HeroStar).showStar(star);\r\n    }\r\n    setPiece() {\r\n        const _isBag = this.judgeIsBagView();\r\n        const itemInfo = this.data as ItemInfo;\r\n        const quality = itemInfo.itemTable.Quality;\r\n        const num = Number(itemInfo.num);\r\n        this.pieceNode.active = true;\r\n        let max = quality <= tab.ItemQuality.ItemQuality_Purple ? 30 : 50\r\n        let bar = this.pieceNode.getChildByName(\"piece_bar\").getComponent(ProgressBar);\r\n        bar.node.active = _isBag;\r\n        bar.progress = num / max;\r\n        let num_txt = bar.node.getChildByName(\"num_txt\").getComponent(Label);\r\n        num_txt.string = num + \"/\" + max;\r\n    }\r\n    judgeIsBagView() {\r\n        const BagPop = UIMgr.ins.getView('BagPop');\r\n        if (BagPop) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**隐身消耗数量分母 */\r\n    hideConsumeFenMu(){\r\n        this.needLab.node.active=false;\r\n        this.consumeLab.node.active=false;\r\n    }\r\n    /* 设置左上图表 */\r\n    setExtraPic(){\r\n        const itemTab = this.data.itemTable;\r\n        const LT = itemTab.MarkTopLeft;\r\n        const LB = itemTab.MarkBottomLeft;\r\n        const RT = itemTab.MarkTopRight;\r\n        this.sp_LT.setTexture(LT);\r\n        this.sp_LB.setTexture(LB)\r\n        this.sp_RT.setTexture(RT);\r\n    }\r\n    protected onDisable(): void {\r\n        this.starNode.getComponent(HeroStar).onDisable();\r\n    }\r\n}\r\n\r\n\r\n"]}