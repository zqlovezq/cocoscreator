{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/role/roleInfo/RoleInfoDecorationsPop.ts"],"names":["_decorator","instantiate","Label","Node","Prefab","Sprite","ViewPop","RoleData","RoleInfoDecorationsItem","HEADTYPE","proto","Net","tab","HeroAttrItem","LangMgr","EventMgr","ccclass","property","RoleInfoDecorationsPop","default_view","NONE","cur_select_item","onShow","HEADICON","initView","showViewByType","changeIconState","ins","avatarInfo","headIcon","headFrame","clickSwitchView","e","type","Number","showHeadIconView","HEADFRAME","showHeadFrameView","node_content","destroyAllChildren","headTabs","getData","HeadTable","headList","haveHead","noHavaHead","i","length","id","Id","checkHeadIsHave","push","sort","a","b","itemTab1","ItemTableById","getValue","itemTab2","Sort","combinedArray","item","pfb_item","parent","itemTs","getComponent","initHeadData","headFrameTabs","HeadFramTable","headFrameList","haveFrameHead","noHavaFrameHead","initFrameData","onDestroy","register","onMsg","Ptl","SetHeadIconRsp","on_s2c_SetHeadIconRsp","SetHeadFrameRsp","on_s2c_SetHeadFrameRsp","unRegister","msg","error","code","CommonErrorCode","Succeed","selectHead","unSelectHead","itemId","sendMsg","Msg_SetHeadIconReq","Send","SetHeadIconReq","Msg_SetHeadFrameReq","SetHeadFrameReq","headIcons","checkFrameIsHave","headFrames","headItemId","headFrameId","isInit","node_attr_layout","frameItemTab","sp_frame","setTexture","Icon","lbl_name","string","getLab","Name","frameTab","HeadFramTableById","lbl_desc","Desc","AttrTypes","attrItem","pfb_attr","attrItemTs","AttrValue","headTab","HeadTableById","headItemTab","sp_head","wearBtn","node_btn","getChildByName","wearingBtn","goBtn","active"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, instantiate, Label, Node, Prefab, Sprite } from 'cc';\r\nimport { ViewPop } from '../../../../framework/base/ViewPop';\r\nimport { RoleData } from '../RoleData';\r\nimport { RoleInfoDecorationsItem } from './RoleInfoDecorationsItem';\r\nimport { HEADTYPE } from '../../../../Common/script/EnumTypeMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../../net/Net';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { HeroAttrItem } from '../../hero/herobag/HeroAttrItem';\r\nimport { LangMgr } from '../../../mgr/LangMgr';\r\nimport { EventMgr } from '../../../mgr/EventMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('RoleInfoDecorationsPop')\r\nexport class RoleInfoDecorationsPop extends ViewPop {\r\n    @property(Prefab)\r\n    pfb_item: Prefab = null;\r\n    @property(Prefab)\r\n    pfb_attr: Prefab = null;\r\n    @property(Node)\r\n    node_content: Node = null;\r\n    @property(Node)\r\n    node_btn: Node = null;\r\n\r\n    @property(Node)\r\n    node_head: Node = null;\r\n    @property(Sprite)\r\n    sp_head: Sprite = null;\r\n    @property(Node)\r\n    node_frame: Node = null;\r\n    @property(Sprite)\r\n    sp_frame: Sprite = null;\r\n    @property(Label)\r\n    lbl_name: Label = null;\r\n    @property(Label)\r\n    lbl_desc: Label = null;\r\n    @property(Node)\r\n    node_attr_layout: Node = null;\r\n\r\n    public default_view: HEADTYPE = HEADTYPE.NONE;\r\n    private cur_select_item: RoleInfoDecorationsItem = null;\r\n    onShow(): void {\r\n        this.default_view = HEADTYPE.HEADICON;\r\n        this.initView()\r\n    }\r\n    initView() {\r\n        //拥有的头像\r\n        this.cur_select_item = null;\r\n        this.showViewByType();\r\n        this.changeIconState(RoleData.ins.avatarInfo.headIcon, RoleData.ins.avatarInfo.headFrame,true)\r\n    }\r\n    clickSwitchView(e: EventTouch, type: string) {\r\n        if (this.default_view === Number(type)) {\r\n            return;\r\n        }\r\n        this.default_view = Number(type);\r\n        this.initView();\r\n    }\r\n    showViewByType() {\r\n        switch (this.default_view) {\r\n            case HEADTYPE.HEADICON:\r\n                this.showHeadIconView();\r\n                break;\r\n            case HEADTYPE.HEADFRAME:\r\n                this.showHeadFrameView();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    /* 显示头像界面 */\r\n    showHeadIconView() {\r\n        this.node_content.destroyAllChildren();\r\n        const headTabs = tab.getData().HeadTable;\r\n        const headList = RoleData.ins.avatarInfo.headIcon?[RoleData.ins.avatarInfo.headIcon]:[];\r\n\r\n        const haveHead = [];\r\n        const noHavaHead = [];\r\n\r\n        for (let i = 0; i < headTabs.length; i++) {\r\n            const id = headTabs[i].Id;\r\n            if (id !== RoleData.ins.avatarInfo.headIcon) {\r\n                if (this.checkHeadIsHave(id)) {\r\n                    haveHead.push(id)\r\n                } else {\r\n                    noHavaHead.push(id);\r\n                }\r\n            }\r\n        }\r\n        haveHead.sort((a, b) => {\r\n            let itemTab1 = tab.getData().ItemTableById.getValue(a);\r\n            let itemTab2 = tab.getData().ItemTableById.getValue(b);\r\n            return itemTab1.Sort - itemTab2.Sort;\r\n        })\r\n\r\n        noHavaHead.sort((a, b) => {\r\n            let itemTab1 = tab.getData().ItemTableById.getValue(a);\r\n            let itemTab2 = tab.getData().ItemTableById.getValue(b);\r\n            return itemTab1.Sort - itemTab2.Sort;\r\n        })\r\n        let combinedArray = [...headList, ...haveHead, ...noHavaHead];\r\n        for (let i = 0; i < combinedArray.length; i++) {\r\n            const item = instantiate(this.pfb_item);\r\n            item.parent = this.node_content;\r\n            const itemTs = item.getComponent(RoleInfoDecorationsItem);\r\n            itemTs.initHeadData(combinedArray[i], this);\r\n        }\r\n    }\r\n    /* 显示头像框界面 */\r\n    showHeadFrameView() {\r\n        this.node_content.destroyAllChildren();\r\n        const headFrameTabs = tab.getData().HeadFramTable;\r\n        const headFrameList = RoleData.ins.avatarInfo.headFrame?[RoleData.ins.avatarInfo.headFrame]:[];\r\n\r\n        const haveFrameHead = [];\r\n        const noHavaFrameHead = [];\r\n\r\n        for (let i = 0; i < headFrameTabs.length; i++) {\r\n            const id = headFrameTabs[i].Id;\r\n            if (id !== RoleData.ins.avatarInfo.headFrame) {\r\n                if (this.checkHeadIsHave(id)) {\r\n                    haveFrameHead.push(id)\r\n                } else {\r\n                    noHavaFrameHead.push(id);\r\n                }\r\n            }\r\n        }\r\n        haveFrameHead.sort((a, b) => {\r\n            let itemTab1 = tab.getData().ItemTableById.getValue(a);\r\n            let itemTab2 = tab.getData().ItemTableById.getValue(b);\r\n            return itemTab1.Sort - itemTab2.Sort;\r\n        })\r\n\r\n        noHavaFrameHead.sort((a, b) => {\r\n            let itemTab1 = tab.getData().ItemTableById.getValue(a);\r\n            let itemTab2 = tab.getData().ItemTableById.getValue(b);\r\n            return itemTab1.Sort - itemTab2.Sort;\r\n        })\r\n        let combinedArray = [...headFrameList, ...haveFrameHead, ...noHavaFrameHead];\r\n        for (let i = 0; i < combinedArray.length; i++) {\r\n            const item = instantiate(this.pfb_item);\r\n            item.parent = this.node_content;\r\n            const itemTs = item.getComponent(RoleInfoDecorationsItem);\r\n            itemTs.initFrameData(combinedArray[i], this);\r\n        }\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy()\r\n    }\r\n    register(): void {\r\n        // 更换头像\r\n        EventMgr.onMsg(proto.Ptl.SetHeadIconRsp, this.on_s2c_SetHeadIconRsp, this)\r\n        // 更换头像框\r\n        EventMgr.onMsg(proto.Ptl.SetHeadFrameRsp, this.on_s2c_SetHeadFrameRsp, this)\r\n    }\r\n    unRegister(): void {\r\n        super.unRegister();\r\n    }\r\n    on_s2c_SetHeadIconRsp(msg: proto.Msg_SetHeadIconRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            RoleData.ins.avatarInfo.headIcon = msg.headIcon;\r\n            this.initView();\r\n        }\r\n    }\r\n    on_s2c_SetHeadFrameRsp(msg: proto.Msg_SetHeadFrameRsp) {\r\n        if (!msg.error || msg.error.code == proto.CommonErrorCode.Succeed) {\r\n            RoleData.ins.avatarInfo.headFrame = msg.headFrame;\r\n            this.initView();\r\n        }\r\n    }\r\n    selectHead(item: RoleInfoDecorationsItem) {\r\n        if (this.cur_select_item) {\r\n            this.cur_select_item.unSelectHead();\r\n            this.cur_select_item = null;\r\n        }\r\n        if (item) {\r\n            this.cur_select_item = item;\r\n            if (this.default_view === HEADTYPE.HEADICON) {\r\n                this.changeIconState(this.cur_select_item.itemId, 0)\r\n            } else if (this.default_view === HEADTYPE.HEADFRAME) {\r\n                this.changeIconState(0, this.cur_select_item.itemId)\r\n            }\r\n        }\r\n    }\r\n    // 像服务器发送切换头像、头像框的功能\r\n    sendMsg() {\r\n        if (!this.cur_select_item) {\r\n            return\r\n        }\r\n        if (this.cur_select_item.itemId === RoleData.ins.avatarInfo.headFrame || this.cur_select_item.itemId === RoleData.ins.avatarInfo.headIcon) {\r\n            return;\r\n        }\r\n        switch (this.default_view) {\r\n            case HEADTYPE.HEADICON:\r\n                if (RoleData.ins.avatarInfo.headIcon !== this.cur_select_item.itemId) {\r\n                    let msg = new proto.Msg_SetHeadIconReq();\r\n                    msg.headIcon = this.cur_select_item.itemId;\r\n                    Net.Send(proto.Ptl.SetHeadIconReq, msg)\r\n                }\r\n                break;\r\n            case HEADTYPE.HEADFRAME:\r\n                if (RoleData.ins.avatarInfo.headFrame !== this.cur_select_item.itemId) {\r\n                    let msg = new proto.Msg_SetHeadFrameReq();\r\n                    msg.headFrame = this.cur_select_item.itemId;\r\n                    Net.Send(proto.Ptl.SetHeadFrameReq, msg)\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    // 判断当前headicon是否拥有\r\n    checkHeadIsHave(itemId: number) {\r\n        for (let i = 0; i < RoleData.ins.avatarInfo.headIcons.length; i++) {\r\n            const id = RoleData.ins.avatarInfo.headIcons[i].itemId;\r\n            if (id === itemId) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    // 判断当前头像框是否拥有\r\n    checkFrameIsHave(itemId: number) {\r\n        for (let i = 0; i < RoleData.ins.avatarInfo.headFrames.length; i++) {\r\n            const id = RoleData.ins.avatarInfo.headFrames[i].itemId;\r\n            if (id === itemId) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    /* 根据点击的头像或者头像框 切换头像状态 */\r\n    changeIconState(headItemId: number, headFrameId: number,isInit?:boolean) {\r\n        // this.node_head.active = false;\r\n        // this.node_frame.active = false;\r\n        this.node_attr_layout.destroyAllChildren();\r\n        if (headFrameId) {\r\n            // this.node_frame.active = true;\r\n            const frameItemTab = tab.getData().ItemTableById.getValue(headFrameId);\r\n            this.sp_frame.setTexture(frameItemTab.Icon);\r\n            this.lbl_name.string = LangMgr.getLab(frameItemTab.Name);\r\n            // 查看是否有属性\r\n            const frameTab = tab.getData().HeadFramTableById.getValue(headFrameId);\r\n            this.lbl_desc.string = LangMgr.getLab(frameItemTab.Desc);\r\n            if (frameTab) {\r\n                for (let i = 0; i < frameTab.AttrTypes.length; i++) {\r\n                    const attrItem = instantiate(this.pfb_attr);\r\n                    attrItem.parent = this.node_attr_layout;\r\n                    const attrItemTs = attrItem.getComponent(HeroAttrItem);\r\n                    attrItemTs.initView(frameTab.AttrTypes[i], frameTab.AttrValue[i]);\r\n                }\r\n            }\r\n        }\r\n      if (headItemId) {\r\n            // this.node_head.active = true;\r\n            const headTab = tab.getData().HeadTableById.getValue(headItemId)\r\n            const headItemTab = tab.getData().ItemTableById.getValue(headItemId);\r\n            this.sp_head.setTexture(headItemTab.Icon);\r\n            this.lbl_desc.string = LangMgr.getLab(headItemTab.Desc);\r\n            this.lbl_name.string = LangMgr.getLab(headItemTab.Name);\r\n            if (headTab&&!isInit) {\r\n                for (let i = 0; i < headTab.AttrTypes.length; i++) {\r\n                    const attrItem = instantiate(this.pfb_attr);\r\n                    attrItem.parent = this.node_attr_layout;\r\n                    const attrItemTs = attrItem.getComponent(HeroAttrItem);\r\n                    attrItemTs.initView(headTab.AttrTypes[i], headTab.AttrValue[i]);\r\n                }\r\n            }\r\n        }\r\n        const wearBtn = this.node_btn.getChildByName(\"wear_btn\");\r\n        const wearingBtn = this.node_btn.getChildByName(\"wearing_node\");\r\n        const goBtn = this.node_btn.getChildByName(\"go_btn\");\r\n        wearBtn.active = false;\r\n        wearingBtn.active = false;\r\n        goBtn.active = false\r\n        switch (this.default_view) {\r\n            case HEADTYPE.HEADICON:\r\n                if (headItemId === RoleData.ins.avatarInfo.headIcon) {\r\n                    // 当前已穿带\r\n                    wearingBtn.active = true;\r\n                } else {\r\n                    if (this.checkHeadIsHave(headItemId)) {\r\n                        wearBtn.active = true;\r\n                    } else {\r\n                        goBtn.active = true;\r\n                    }\r\n                }\r\n                break;\r\n            case HEADTYPE.HEADFRAME:\r\n                if (headFrameId === RoleData.ins.avatarInfo.headFrame) {\r\n                    // 当前已穿带\r\n                    wearingBtn.active = true;\r\n                } else {\r\n                    if (this.checkFrameIsHave(headFrameId)) {\r\n                        wearBtn.active = true;\r\n                    } else {\r\n                        goBtn.active = true;\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}