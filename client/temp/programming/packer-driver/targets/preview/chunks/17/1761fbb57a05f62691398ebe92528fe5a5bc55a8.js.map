{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/view/rogue/RogueHeroItem.ts"],"names":["_decorator","Label","Node","sp","Sprite","tab","LoadResAsync","LangMgr","RogueBaseItem","PlayerControl","ccclass","property","RogueHeroItem","Skeleton","setData","info","role","ins","getRole","rogueInfo","heroItemId","upLv","attrData","getAttr","AttrType","AttrType_RogueLevel","isHeroLevel","level","rogueTab","Level","clearAttrByType","heroTab","getData","HeroTableById","getValue","itemTab","ItemTableById","heroname_txt","string","getLab","Name","speciality_txt","Speciality","heroClassTab","HeroClassTableByHeroClass","Class","index","pronames","children","length","element","active","proNode","getChildByName","pro_img","setTexture","Icon","setAnimId","Idle","animId","tempTab","AnimationTableById","spData","Path","SkeletonData","hero_spine","skeletonData","setAnimation","AnimationName"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, sp, Sprite } from \"cc\";\nimport { RogueInfo } from \"./RogueInfo\";\nimport { tab } from \"../../../../Table/table_gen\";\nimport { LoadResAsync, ResMgr } from \"../../../mgr/ResMgr\";\nimport { LangMgr } from \"../../../mgr/LangMgr\";\nimport { RogueBaseItem } from \"./RogueBaseItem\";\nimport { PlayerControl } from \"../../base/obj/role/role/PlayerControl\";\n\nconst { ccclass, property } = _decorator;\n\n\n@ccclass('RogueHeroItem')\nexport class RogueHeroItem extends RogueBaseItem {\n    @property(sp.Skeleton)\n    hero_spine: sp.Skeleton = null\n\n    @property(Sprite)\n    pro_img: Sprite = null\n\n    @property(Node)\n    pronames: Node = null\n\n    @property(Label)\n    heroname_txt: Label = null\n    @property(Label)\n    speciality_txt:Label = null;\n\n\n    setData(info: RogueInfo) {\n        super.setData(info)\n\n        let role = PlayerControl.ins.getRole(this.rogueInfo.heroItemId)\n\n        if (role) {\n            let upLv = role.info.attrData.getAttr(tab.AttrType.AttrType_RogueLevel)\n            if (upLv) {\n                this.rogueInfo.isHeroLevel = true\n                this.rogueInfo.level = this.rogueInfo.rogueTab.Level + upLv\n                role.info.attrData.clearAttrByType(tab.AttrType.AttrType_RogueLevel)\n            }\n        }\n\n        let heroTab = tab.getData().HeroTableById.getValue(info.heroItemId)\n\n        let itemTab = tab.getData().ItemTableById.getValue(info.heroItemId);\n        this.heroname_txt.string = LangMgr.getLab(itemTab.Name)\n        this.speciality_txt.string = LangMgr.getLab(heroTab.Speciality);\n\n        let heroClassTab = tab.getData().HeroClassTableByHeroClass.getValue(heroTab.Class)\n        for (let index = 0; index < this.pronames.children.length; index++) {\n            const element = this.pronames.children[index];\n            element.active = false\n        }\n        const proNode = this.pronames.getChildByName(\"pro\" + heroTab.Class)\n        proNode.active = true;\n        this.pro_img.setTexture(heroClassTab.Icon);\n\n        this.setAnimId(heroTab.Idle)\n    }\n\n    async setAnimId(animId: number) {\n        let tempTab: tab.AnimationTable = tab.getData().AnimationTableById.getValue(animId)\n        let spData = await LoadResAsync(tempTab.Path, sp.SkeletonData)\n        this.hero_spine.skeletonData = spData\n        this.hero_spine.setAnimation(0, tempTab.AnimationName, true)\n    }\n\n\n}"]}