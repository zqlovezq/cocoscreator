{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/jianghu/topWar/TopWarDamageItem.ts"],"names":["_decorator","Component","Label","Node","ProgressBar","GameUtil","UIMgr","ViewName","ItemInfo","ccclass","property","TopWarDamageItem","table","lastScore","initView","currScore","updateView","boxScoreLab","string","convertNumber","Damage","isReceive","openBoxNode","active","boxNode","scoreBar","progress","onClickItem","rewads","key","ItemId","itemInfo","initItemData","ItemNum","push","ins","show","viewName","CommonBoxTipsPop","data","node","worldPosition"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;;AAEpCC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBV,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;kCAGaW,gB,WADZF,OAAO,CAAC,kBAAD,C,UAEHC,QAAQ,CAACN,WAAD,C,UAERM,QAAQ,CAACP,IAAD,C,UAERO,QAAQ,CAACP,IAAD,C,UAERO,QAAQ,CAACR,KAAD,C,2BARb,MACaS,gBADb,SACsCV,SADtC,CACgD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eASpCW,KAToC;AAAA,eAUpCC,SAVoC;AAAA;;AAW5CC,QAAAA,QAAQ,CAACF,KAAD,EAAkCC,SAAlC,EAAqDE,SAArD,EAAwE;AAC5E,eAAKH,KAAL,GAAaA,KAAb;AAEA,eAAKC,SAAL,GAAiBA,SAAjB;AAEA,eAAKG,UAAL,CAAiBD,SAAjB,EAL4E,CAM5E;;AACA,eAAKE,WAAL,CAAiBC,MAAjB,GAA0B;AAAA;AAAA,oCAASC,aAAT,CAAuBP,KAAK,CAACQ,MAA7B,CAA1B;AACH;;AACDJ,QAAAA,UAAU,CAAED,SAAF,EAAqB;AAC3B,cAAIM,SAAS,GAACN,SAAS,IAAE,KAAKH,KAAL,CAAWQ,MAApC;AACA,eAAKE,WAAL,CAAiBC,MAAjB,GAA0BF,SAA1B;AACA,eAAKG,OAAL,CAAaD,MAAb,GAAsB,CAACF,SAAvB;;AACA,cAAIA,SAAJ,EAAe;AACX,iBAAKI,QAAL,CAAcC,QAAd,GAAyB,CAAzB;AACH,WAFD,MAEO;AACH,gBAAIX,SAAS,IAAI,KAAKF,SAAtB,EAAiC;AAC7B,mBAAKY,QAAL,CAAcC,QAAd,GAAyB,CAAzB;AACH,aAFD,MAEO;AACH,kBAAIA,QAAQ,GAAG,CAACX,SAAS,GAAG,KAAKF,SAAlB,KAAgC,KAAKD,KAAL,CAAWQ,MAAX,GAAoB,KAAKP,SAAzD,CAAf;AACA,mBAAKY,QAAL,CAAcC,QAAd,GAAyBA,QAAzB;AACH;AACJ;AACJ;;AACDC,QAAAA,WAAW,GAAG;AACV,cAAIC,MAAM,GAAC,EAAX;;AACA,eAAI,IAAIC,GAAR,IAAe,KAAKjB,KAAL,CAAWkB,MAA1B,EAAiC;AAC7B,gBAAIC,QAAQ,GAAC;AAAA;AAAA,uCAAb;AACAA,YAAAA,QAAQ,CAACC,YAAT,CAAsB,KAAKpB,KAAL,CAAWkB,MAAX,CAAkBD,GAAlB,CAAtB,EAA6C,KAAKjB,KAAL,CAAWqB,OAAX,CAAmBJ,GAAnB,CAA7C;AACAD,YAAAA,MAAM,CAACM,IAAP,CAAYH,QAAZ;AACH;;AACD;AAAA;AAAA,8BAAMI,GAAN,CAAUC,IAAV,CAAe;AAACC,YAAAA,QAAQ,EAAC;AAAA;AAAA,sCAASC,gBAAnB;AAAoCC,YAAAA,IAAI,EAAC;AAAC,0BAAW,KAAKC,IAAL,CAAUC,aAAtB;AAAoC,4BAAab,MAAjD;AAAwD,wBAAS;AAAjE;AAAzC,WAAf;AACH;;AA3C2C,O;;;;;iBAEpB,I;;;;;;;iBAER,I;;;;;;;iBAEI,I;;;;;;;iBAEC,I","sourcesContent":["import { _decorator, Component, Label, Node, ProgressBar } from 'cc';\r\nimport { tab } from '../../../../Table/table_gen';\r\nimport { GameUtil, handleNumerText } from '../../../utils/GameUtil';\r\nimport { UIMgr } from '../../../mgr/UIMgr';\r\nimport { ViewName } from '../../../define/ViewDefine';\r\nimport { ItemInfo } from '../../item/ItemInfo';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * TopWarDamageItem\r\n * zhudingchao\r\n * Mon Jul 08 2024 15:36:09 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/jianghu/topWar/TopWarDamageItem.ts\r\n *\r\n */\r\n\r\n@ccclass('TopWarDamageItem')\r\nexport class TopWarDamageItem extends Component {\r\n    @property(ProgressBar)\r\n    scoreBar: ProgressBar = null;\r\n    @property(Node)\r\n    boxNode: Node = null;\r\n    @property(Node)\r\n    openBoxNode: Node = null;\r\n    @property(Label)\r\n    boxScoreLab: Label = null;\r\n    private table: tab.WorldBossRewardTable;\r\n    private lastScore: number;\r\n    initView(table: tab.WorldBossRewardTable, lastScore: number, currScore: number) {\r\n        this.table = table;\r\n\r\n        this.lastScore = lastScore;\r\n\r\n        this.updateView( currScore);\r\n        // this.scoreBar.progress=progress;\r\n        this.boxScoreLab.string = GameUtil.convertNumber(table.Damage)\r\n    }\r\n    updateView( currScore: number) {\r\n        let isReceive=currScore>=this.table.Damage;\r\n        this.openBoxNode.active = isReceive;\r\n        this.boxNode.active = !isReceive;\r\n        if (isReceive) {\r\n            this.scoreBar.progress = 1;\r\n        } else {\r\n            if (currScore <= this.lastScore) {\r\n                this.scoreBar.progress = 0\r\n            } else {\r\n                let progress = (currScore - this.lastScore) / (this.table.Damage - this.lastScore);\r\n                this.scoreBar.progress = progress;\r\n            }\r\n        }\r\n    }\r\n    onClickItem() {\r\n        let rewads=[];\r\n        for(let key in this.table.ItemId){\r\n            let itemInfo=new ItemInfo();\r\n            itemInfo.initItemData(this.table.ItemId[key],this.table.ItemNum[key]);\r\n            rewads.push(itemInfo);\r\n        }\r\n        UIMgr.ins.show({viewName:ViewName.CommonBoxTipsPop,data:{\"worldPos\":this.node.worldPosition,\"rewadInfos\":rewads,\"isDown\":true}})\r\n    }\r\n}"]}