{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/association/AssociationLogPop.ts"],"names":["_decorator","instantiate","Prefab","UITransform","ViewPop","AssociationData","AssociationLogItem","InfiniteList","Func","LangMgr","ccclass","property","AssociationLogPop","_list","onShow","ins","getGuildLogs","list_view","Init","getCellNumber","getCellCount","bind","getCellSize","getCellHeight","getCellIdentifer","getCellView","getCellData","GetCellData","pos","GetScrollPosOfCell","length","maxY","getContent","getComponent","height","max_y","y","setContentPos","onDestroy","register","unRegister","idx","str","getCombineString","event","roleName","len","getStrZhLen","wid","Math","floor","identifer","cell","pfb_item"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Label, Node, Prefab, UITransform } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { proto } from 'client_protocol';\r\nimport { AssociationData } from './AssociationData';\r\nimport { AssociationLogItem } from './AssociationLogItem';\r\nimport InfiniteList from '../../../Common/InfiniteList/InfiniteList';\r\nimport { Func } from '../../utils/Func';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AssociationLogPop')\r\nexport class AssociationLogPop extends ViewPop {\r\n    @property(Prefab)\r\n    pfb_item:Prefab = null;\r\n    @property(InfiniteList)\r\n    list_view: InfiniteList = null;\r\n    private _list: proto.IGuildLog[] = []\r\n    onShow(): void {\r\n        this._list = AssociationData.ins.getGuildLogs();\r\n        this.list_view.Init({\r\n            getCellNumber: this.getCellCount.bind(this),\r\n            getCellSize: this.getCellHeight.bind(this),\r\n            getCellIdentifer: this.getCellIdentifer.bind(this),\r\n            getCellView: this.getCellView.bind(this),\r\n            getCellData: this.GetCellData.bind(this),\r\n        });\r\n\r\n        const pos = this.list_view.GetScrollPosOfCell(this._list.length-1);\r\n        const maxY = this.list_view.getContent().getComponent(UITransform).height-300;\r\n        let max_y = pos.y>maxY?maxY:pos.y;\r\n        this.list_view.setContentPos(max_y,0, max_y);\r\n    }\r\n    protected onDestroy(): void {\r\n        super.onDestroy()\r\n    }\r\n    register(): void {\r\n        \r\n    }\r\n    unRegister(): void {\r\n        super.unRegister();\r\n    }\r\n    getCellCount() {\r\n        return this._list.length\r\n    }\r\n    getCellHeight(idx: number) {\r\n        const str = LangMgr.getCombineString(\"Tips_associationinfo_\"+this._list[idx].event,[this._list[idx].roleName]);\r\n        const len = Func.getStrZhLen(str);\r\n        const wid = Math.floor(len/22)*45+45;\r\n        return wid\r\n    }\r\n    getCellIdentifer(idx: number) {\r\n        return \"AssociationLogItem\";\r\n    }\r\n    getCellView(idx: number, identifer: string) {\r\n        let cell = instantiate(this.pfb_item).getComponent(AssociationLogItem);\r\n        return cell;\r\n    }\r\n    GetCellData(idx: number) {\r\n        return this._list[idx]\r\n    }\r\n}\r\n\r\n\r\n"]}