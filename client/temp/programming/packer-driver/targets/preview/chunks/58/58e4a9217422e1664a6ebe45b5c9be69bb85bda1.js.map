{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/base/damage/DamegeControl.ts"],"names":["DamegeControl","_decorator","AbsControl","FightMacro","DamageLab","ccclass","property","bullet_damageCalculate","bullet","defanseAbs","damage","checkBulletDamageGroup","info","groupId","configTab","SameLow","addDamegeGroupId","buff_AttackHeal","buff","addHp","addParm","effectTab","Parameters","MAX_CHANCE","Math","floor","abs","onHitDamage","addShowDamageNum","buff_BigHpHeal","buff_NowHpHeal"],"mappings":";;;8HAWaA,a;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAXEC,MAAAA,U,OAAAA,U;;AACNC,MAAAA,U,iBAAAA,U;;AAIAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;AAG9B;;+BACaD,a,GAAN,MAAMA,aAAN;AAAA;AAAA,oCAAuC;AAC1C;AACJ;AACA;AACA;AACA;AACiC,eAAtBO,sBAAsB,CAACC,MAAD,EAAiBC,UAAjB,EAAsC;AAC/D,cAAIC,MAAM,GAAG,CAAC,EAAd;;AAEA,cAAID,UAAU,CAACE,sBAAX,CAAkCH,MAAM,CAACI,IAAP,CAAYC,OAA9C,CAAJ,EAA4D;AACxD,gBAAIL,MAAM,CAACI,IAAP,CAAYE,SAAZ,CAAsBC,OAA1B,EAAmC;AAAC;AAChCL,cAAAA,MAAM,GAAGA,MAAM,GAAGF,MAAM,CAACI,IAAP,CAAYE,SAAZ,CAAsBC,OAA/B,GAAyC,KAAlD;AACH;AACJ;;AAEDN,UAAAA,UAAU,CAACO,gBAAX,CAA4BR,MAAM,CAACI,IAAP,CAAYC,OAAxC;AACA,iBAAOH,MAAP;AACH;AAED;;;AACsB,eAAfO,eAAe,CAACC,IAAD,EAAa;AAC/B,cAAIC,KAAK,GAAGD,IAAI,CAACE,OAAL,GAAeF,IAAI,CAACG,SAAL,CAAeC,UAA9B,GAA2C;AAAA;AAAA,wCAAWC,UAAlE;AACAJ,UAAAA,KAAK,GAAGK,IAAI,CAACC,KAAL,CAAWN,KAAX,CAAR;AAEA,cAAIO,GAAG,GAAGR,IAAI,CAACQ,GAAf;AACAR,UAAAA,IAAI,CAACQ,GAAL,CAASd,IAAT,CAAce,WAAd,CAA0BR,KAA1B;AACA;AAAA;AAAA,sCAAUS,gBAAV,CAA2BT,KAA3B,EAAkC,KAAlC,EAAyCO,GAAzC,EAA8C,CAA9C;AACH;AAED;;;AACqB,eAAdG,cAAc,CAACX,IAAD,EAAa;AAC9B,cAAIC,KAAK,GAAGD,IAAI,CAACE,OAAL,GAAeF,IAAI,CAACG,SAAL,CAAeC,UAA9B,GAA2C;AAAA;AAAA,wCAAWC,UAAlE;AACAJ,UAAAA,KAAK,GAAGK,IAAI,CAACC,KAAL,CAAWN,KAAX,CAAR;AAEA,cAAIO,GAAG,GAAGR,IAAI,CAACQ,GAAf;AACAR,UAAAA,IAAI,CAACQ,GAAL,CAASd,IAAT,CAAce,WAAd,CAA0BR,KAA1B;AAEA;AAAA;AAAA,sCAAUS,gBAAV,CAA2BT,KAA3B,EAAkC,KAAlC,EAAyCO,GAAzC,EAA8C,CAA9C;AACH;AACD;;;AACqB,eAAdI,cAAc,CAACZ,IAAD,EAAa;AAC9B,cAAIC,KAAK,GAAGD,IAAI,CAACE,OAAL,GAAeF,IAAI,CAACG,SAAL,CAAeC,UAA9B,GAA2C;AAAA;AAAA,wCAAWC,UAAlE;AACAJ,UAAAA,KAAK,GAAGK,IAAI,CAACC,KAAL,CAAWN,KAAX,CAAR;AAEA,cAAIO,GAAG,GAAGR,IAAI,CAACQ,GAAf;AACAR,UAAAA,IAAI,CAACQ,GAAL,CAASd,IAAT,CAAce,WAAd,CAA0BR,KAA1B;AAGA;AAAA;AAAA,sCAAUS,gBAAV,CAA2BT,KAA3B,EAAkC,KAAlC,EAAyCO,GAAzC,EAA8C,CAA9C;AACH;;AAjDyC,O","sourcesContent":["import { Node, _decorator, js, math, sys } from \"cc\";\nimport { AbsControl } from \"../../../../framework/base/IAbs\";\nimport { Bullet } from \"../obj/bullet/Bullet\";\nimport { AbsRole } from \"../obj/role/AbsRole\";\nimport { Buff } from \"../buff/Buff\";\nimport { FightMacro } from \"../../define/FightDefine\";\nimport { DamageLab } from \"./DamageLab\";\nconst { ccclass, property } = _decorator;\n\n\n/** 伤害计算 */\nexport class DamegeControl extends AbsControl {\n    /**\n     * 伤害计算\n     * @param bullet 子弹\n     * @param defanseAbs 防御者\n     */\n    static bullet_damageCalculate(bullet: Bullet, defanseAbs: AbsRole) {\n        let damage = -10\n\n        if (defanseAbs.checkBulletDamageGroup(bullet.info.groupId)) {\n            if (bullet.info.configTab.SameLow) {//同组子弹伤害衰减\n                damage = damage * bullet.info.configTab.SameLow / 10000\n            }\n        }\n\n        defanseAbs.addDamegeGroupId(bullet.info.groupId)\n        return damage\n    }\n\n    /** 攻击治疗  */\n    static buff_AttackHeal(buff: Buff) {\n        let addHp = buff.addParm * buff.effectTab.Parameters / FightMacro.MAX_CHANCE\n        addHp = Math.floor(addHp)\n\n        let abs = buff.abs\n        buff.abs.info.onHitDamage(addHp)\n        DamageLab.addShowDamageNum(addHp, false, abs, 0)\n    }\n\n    /** 最大生命百分比回血  */\n    static buff_BigHpHeal(buff: Buff) {\n        let addHp = buff.addParm * buff.effectTab.Parameters / FightMacro.MAX_CHANCE\n        addHp = Math.floor(addHp)\n\n        let abs = buff.abs\n        buff.abs.info.onHitDamage(addHp)\n\n        DamageLab.addShowDamageNum(addHp, false, abs, 0)\n    }\n    /** 当前生命百分比掉血   */\n    static buff_NowHpHeal(buff: Buff) {\n        let addHp = buff.addParm * buff.effectTab.Parameters / FightMacro.MAX_CHANCE\n        addHp = Math.floor(addHp)\n\n        let abs = buff.abs\n        buff.abs.info.onHitDamage(addHp)\n\n        \n        DamageLab.addShowDamageNum(addHp, false, abs, 0)\n    }\n\n}"]}