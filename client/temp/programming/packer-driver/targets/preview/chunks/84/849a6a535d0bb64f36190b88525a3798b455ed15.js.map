{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/rareBook/RareBookEquipPop.ts"],"names":["_decorator","Label","Node","RichText","ViewPop","LangMgr","tab","ShowTips","UIMgr","ViewName","RareBookData","RareBookControl","RareBookSmallItem","ccclass","property","RareBookEquipPop","info","register","onShow","openData","initView","weaponItem","nameLab","string","getLab","itemTable","Name","str","bookTable","Aptitude","HeroAptitude","HeroAptitude_N","getCombineString","HeroAptitude_R","HeroAptitude_SR","rarebooklevelLab","descRichText","bookStarTable","BookDescription","isWear","notcancelNode","active","cancelNode","onClickDevelop","ins","show","viewName","RareBookDetailView","data","onClose","onClickCancel","requestDropBook","id","onClickNotCancel","slots","getBookSlotsByHeroClass","Class","isHavePos","key","bookInfo","isLock","requestTakeBook"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, RichText } from 'cc';\r\nimport { ViewPop } from '../../../framework/base/ViewPop';\r\nimport { WeaponItem } from '../common/WeaponItem';\r\nimport { RareBookInfo } from './RareBookInfo';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { ShowTips, UIMgr } from '../../mgr/UIMgr';\r\nimport { ViewName } from '../../define/ViewDefine';\r\nimport { RareBookData } from './RareBookData';\r\nimport { RareBookControl } from './RareBookControl';\r\nimport { RareBookSmallItem } from './RareBookSmallItem';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * RareBookEquipPop\r\n * zhudingchao\r\n * Tue May 28 2024 14:52:13 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/rareBook/RareBookEquipPop.ts\r\n *\r\n */\r\n\r\n@ccclass('RareBookEquipPop')\r\nexport class RareBookEquipPop extends ViewPop {\r\n    @property(RareBookSmallItem)\r\n    weaponItem: RareBookSmallItem = null;\r\n    @property(Label)\r\n    nameLab: Label = null;\r\n    @property(Label)\r\n    rarebooklevelLab: Label = null;\r\n    @property(RichText)\r\n    descRichText: RichText = null;\r\n    @property(Node)\r\n    developNode: Node = null;\r\n    @property(Node)\r\n    cancelNode: Node = null;\r\n    @property(Node)\r\n    notcancelNode: Node = null;\r\n    private info: RareBookInfo;\r\n    register(): void {\r\n\r\n    }\r\n    onShow(): void {\r\n        this.info = this.openData[\"bookInfo\"];\r\n        if (this.info) {\r\n            this.initView();\r\n        }\r\n    }\r\n    initView() {\r\n        this.weaponItem.initView(this.info, false, null, false);\r\n        this.nameLab.string = LangMgr.getLab(this.info.itemTable.Name);\r\n        let str = \"\";\r\n        if (this.info.bookTable.Aptitude == tab.HeroAptitude.HeroAptitude_N) {\r\n            str = LangMgr.getCombineString(\"ui_rarebook_20\", [1])\r\n        } else if (this.info.bookTable.Aptitude == tab.HeroAptitude.HeroAptitude_R) {\r\n            str = LangMgr.getCombineString(\"ui_rarebook_20\", [2])\r\n        } else if (this.info.bookTable.Aptitude == tab.HeroAptitude.HeroAptitude_SR) {\r\n            str = LangMgr.getCombineString(\"ui_rarebook_20\", [3])\r\n        }\r\n        this.rarebooklevelLab.string = str;\r\n        this.descRichText.string = LangMgr.getLab(this.info.bookStarTable.BookDescription);\r\n        if (this.info.isWear) {\r\n            this.notcancelNode.active = false;\r\n            this.cancelNode.active = true;\r\n        } else {\r\n            this.notcancelNode.active = true;\r\n            this.cancelNode.active = false;\r\n        }\r\n\r\n    }\r\n\r\n    onClickDevelop() {\r\n        UIMgr.ins.show({ viewName: ViewName.RareBookDetailView, data: { \"currInfo\": this.info } })\r\n        this.onClose();\r\n    }\r\n    onClickCancel() {\r\n        RareBookControl.ins.requestDropBook(this.info.id);\r\n        this.onClose();\r\n    }\r\n    onClickNotCancel() {\r\n        let slots = RareBookData.ins.getBookSlotsByHeroClass(this.info.bookTable.Class);\r\n        let isHavePos = false;\r\n        for (let key in slots) {\r\n            if (!slots[key].bookInfo && slots[key].isLock) {\r\n                isHavePos = true;\r\n                break;\r\n            }\r\n        }\r\n        if (isHavePos) {\r\n            RareBookControl.ins.requestTakeBook(this.info.id);\r\n            this.onClose();\r\n        } else {\r\n            ShowTips(LangMgr.getLab(\"Tips_rarebook_3\"));\r\n            this.onClose();\r\n        }\r\n\r\n\r\n    }\r\n}"]}