{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/fight/pvp/obj/PvpObjFactory.ts"],"names":["Layers","Node","Vec3","_decorator","PvpRole","PvpBullet","PvpObjType","ccclass","property","PvpObjFactory","init","getObjList","role","bullet","getRole","parent","args","get","getBullet","absType","obj","pop","addComponent","node","layer","Enum","DEFAULT","active","addChild","setAngle","setScale","ONE","isRecycle","absList","pools","set","put","reset","removeFromParent","objType","push","destroy","forEach","value","key","item","length","Map"],"mappings":"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","sourcesContent":["import { Input, Layers, Node, ObjectCurve, PhysicsSystem, Prefab, Quat, TiledUserNodeData, Vec3, _decorator, instantiate, sp, v3 } from 'cc';\nimport { PvpRole } from './PvpRole';\nimport { PvpBullet } from './PvpBullet';\nimport { PvpObj, PvpObjType } from './PvpObj';\n\n\nconst { ccclass, property } = _decorator;\n\n/**战斗对象工厂 */\n@ccclass('PvpObjFactory')\nexport class PvpObjFactory {\n\n    static pools: Map<number, PvpObj[]> = new Map<number, PvpObj[]>()\n\n\n    static init() {\n        PvpObjFactory.getObjList(PvpObjType.role)\n        PvpObjFactory.getObjList(PvpObjType.bullet)\n    }\n\n    static getRole(parent?: Node, args?: any): PvpRole {\n        return PvpObjFactory.get(PvpObjType.role, parent, args) as PvpRole\n    }\n\n\n    static getBullet(parent?: Node, args?: any): PvpBullet {\n        return PvpObjFactory.get(PvpObjType.bullet, parent, args) as PvpBullet\n    }\n\n\n\n    private static get(absType: PvpObjType, parent?: Node, args?: any) {\n        let obj: PvpObj\n\n        obj = PvpObjFactory.getObjList(absType).pop()\n        if (obj == null) {\n            if (absType === PvpObjType.role) {\n                obj = new Node(\"Role\").addComponent(PvpRole)\n            } else if (absType == PvpObjType.bullet) {\n                obj = new Node(\"bullet\").addComponent(PvpBullet)\n            }\n        }\n\n\n        obj.node.layer = Layers.Enum.DEFAULT\n        obj.node.active = true\n        if (parent) {\n            parent.addChild(obj.node)\n        } else {\n            // FightRootControl.ins.getRootView().addNode(obj.node)\n        }\n        obj.setAngle(0)\n        obj.setScale(Vec3.ONE)\n        obj.isRecycle = false\n        return obj\n    }\n    static getObjList(absType: PvpObjType): PvpObj[] {\n        let absList = PvpObjFactory.pools.get(absType)\n        if (absList == null) {\n            absList = []\n            PvpObjFactory.pools.set(absType, absList)\n        }\n        return absList\n    }\n\n    static put(obj: PvpObj) {\n        if (obj == null || (obj && obj.isRecycle)) {\n            return\n        }\n        obj.isRecycle = true\n        obj.reset()\n        obj.node.removeFromParent()\n        PvpObjFactory.getObjList(obj.objType).push(obj)\n    }\n\n    /** 销毁对象池 */\n    static destroy() {\n        PvpObjFactory.pools.forEach((value, key) => {\n            value.forEach((item) => {\n                item.node.destroy()\n            })\n            value.length = 0\n        })\n    }\n\n}\n"]}