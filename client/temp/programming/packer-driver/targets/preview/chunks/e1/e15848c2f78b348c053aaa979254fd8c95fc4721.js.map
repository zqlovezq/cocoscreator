{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/chat/ChatControl.ts"],"names":["_decorator","AbsControl","EventMgr","proto","Net","ChatData","ccclass","property","ChatControl","ins","_instance","register","onMsg","Ptl","DefaultChatChannelsPush","on_s2c_DefaultChatChannelsPush","SendChatMessageRsp","on_s2c_SendChatMessageRsp","ChatMessagePush","on_s2c_Msg_ChatMessagePush","GuildChatChannelPush","on_s2c_Msg_GuildChatChannelPush","requestSendChatMessage","channelId","content","clientCustomNotice","msg","Msg_SendChatMessageReq","message","ChatMessage","normal","Send","SendChatMessageReq","initChannels","channels","chatMessagePush","channel","id","getChanneIdByType","ChatChannelType","Guild","deleteChannel"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,K,oBAAAA,K;;AACAC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;6BAGaQ,W,WADZF,OAAO,CAAC,aAAD,C,2BAAR,MACaE,WADb;AAAA;AAAA,oCAC6C;AAEpB,mBAAHC,GAAG,GAAG;AACpB,cAAI,QAAQ,KAAKC,SAAjB,EAA4B;AACxB,iBAAKA,SAAL,GAAiB,IAAIF,WAAJ,EAAjB;AACH;;AACD,iBAAO,KAAKE,SAAZ;AACH;;AACDC,QAAAA,QAAQ,GAAS;AACb;AAAA;AAAA,oCAASC,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUC,uBAAzB,EAAkD,KAAKC,8BAAvD,EAAuF,IAAvF;AACA;AAAA;AAAA,oCAASH,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUG,kBAAzB,EAA6C,KAAKC,yBAAlD,EAA6E,IAA7E;AACA;AAAA;AAAA,oCAASL,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUK,eAAzB,EAA0C,KAAKC,0BAA/C,EAA2E,IAA3E;AACA;AAAA;AAAA,oCAASP,KAAT,CAAe;AAAA;AAAA,8BAAMC,GAAN,CAAUO,oBAAzB,EAA+C,KAAKC,+BAApD,EAAqF,IAArF;AACH;;AAEDC,QAAAA,sBAAsB,CAACC,SAAD,EAAkBC,OAAlB,EAAiCC,kBAAjC,EAA4F;AAC9G,cAAIC,GAAG,GAAG,IAAI;AAAA;AAAA,8BAAMC,sBAAV,EAAV;AACAD,UAAAA,GAAG,CAACH,SAAJ,GAAgBA,SAAhB;AACAG,UAAAA,GAAG,CAACE,OAAJ,GAAY,IAAI;AAAA;AAAA,8BAAMC,WAAV,EAAZ;AACAH,UAAAA,GAAG,CAACE,OAAJ,CAAYL,SAAZ,GAAsBA,SAAtB;AACAG,UAAAA,GAAG,CAACE,OAAJ,CAAYE,MAAZ,GAAmBN,OAAnB;;AACA,cAAGC,kBAAH,EAAsB;AAClBC,YAAAA,GAAG,CAACE,OAAJ,CAAYH,kBAAZ,GAAiCA,kBAAjC;AACH;;AACD;AAAA;AAAA,0BAAIM,IAAJ,CAAS;AAAA;AAAA,8BAAMlB,GAAN,CAAUmB,kBAAnB,EAAuCN,GAAvC;AACH;;AAEDX,QAAAA,8BAA8B,CAACW,GAAD,EAAyC;AACnE;AAAA;AAAA,oCAASjB,GAAT,CAAawB,YAAb,CAA0BP,GAAG,CAACQ,QAA9B;AACH;;AACDjB,QAAAA,yBAAyB,CAACS,GAAD,EAAoC,CAE5D;;AACDP,QAAAA,0BAA0B,CAACO,GAAD,EAAiC;AACxD;AAAA;AAAA,oCAASjB,GAAT,CAAa0B,eAAb,CAA6BT,GAAG,CAACE,OAAjC;AACF;;AACDP,QAAAA,+BAA+B,CAACK,GAAD,EAAoC;AAC/D,cAAGA,GAAG,CAACU,OAAP,EAAe;AACX;AAAA;AAAA,sCAAS3B,GAAT,CAAawB,YAAb,CAA0B,CAACP,GAAG,CAACU,OAAL,CAA1B;AACH,WAFD,MAEK;AACD,gBAAMC,EAAE,GAAG;AAAA;AAAA,sCAAS5B,GAAT,CAAa6B,iBAAb,CAA+B;AAAA;AAAA,gCAAMC,eAAN,CAAsBC,KAArD,CAAX;AACA;AAAA;AAAA,sCAAS/B,GAAT,CAAagC,aAAb,CAA2BJ,EAA3B;AACH;AACJ;;AA3CwC,O,UAC1B3B,S","sourcesContent":["import { _decorator, Component, Node } from 'cc';\r\nimport { AbsControl } from '../../../framework/base/IAbs';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nimport { proto } from 'client_protocol';\r\nimport { Net } from '../../net/Net';\r\nimport { ChatData } from './ChatData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * ChatControl\r\n * zhudingchao\r\n * Thu Jun 13 2024 16:30:59 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/chat/ChatControl.ts\r\n *\r\n */\r\n\r\n@ccclass('ChatControl')\r\nexport class ChatControl extends  AbsControl {\r\n    private static _instance: ChatControl;\r\n    public static get ins() {\r\n        if (null == this._instance) {\r\n            this._instance = new ChatControl();\r\n        }\r\n        return this._instance;\r\n    }\r\n    register(): void {\r\n        EventMgr.onMsg(proto.Ptl.DefaultChatChannelsPush, this.on_s2c_DefaultChatChannelsPush, this);\r\n        EventMgr.onMsg(proto.Ptl.SendChatMessageRsp, this.on_s2c_SendChatMessageRsp, this);\r\n        EventMgr.onMsg(proto.Ptl.ChatMessagePush, this.on_s2c_Msg_ChatMessagePush, this);\r\n        EventMgr.onMsg(proto.Ptl.GuildChatChannelPush, this.on_s2c_Msg_GuildChatChannelPush, this);\r\n    }\r\n\r\n    requestSendChatMessage(channelId:number,content:string,clientCustomNotice?:proto.ChatMessage.IClientCustomNotice) {\r\n        let msg = new proto.Msg_SendChatMessageReq();\r\n        msg.channelId = channelId;\r\n        msg.message=new proto.ChatMessage();\r\n        msg.message.channelId=channelId;\r\n        msg.message.normal=content;\r\n        if(clientCustomNotice){\r\n            msg.message.clientCustomNotice = clientCustomNotice;\r\n        }\r\n        Net.Send(proto.Ptl.SendChatMessageReq, msg)\r\n    }\r\n\r\n    on_s2c_DefaultChatChannelsPush(msg: proto.Msg_DefaultChatChannelsPush) {\r\n        ChatData.ins.initChannels(msg.channels);\r\n    }\r\n    on_s2c_SendChatMessageRsp(msg: proto.Msg_SendChatMessageRsp) {\r\n       \r\n    }\r\n    on_s2c_Msg_ChatMessagePush(msg: proto.Msg_ChatMessagePush) {\r\n       ChatData.ins.chatMessagePush(msg.message as proto.ChatMessage);\r\n    }\r\n    on_s2c_Msg_GuildChatChannelPush(msg:proto.Msg_GuildChatChannelPush){\r\n        if(msg.channel){\r\n            ChatData.ins.initChannels([msg.channel]);\r\n        }else{\r\n            const id = ChatData.ins.getChanneIdByType(proto.ChatChannelType.Guild)\r\n            ChatData.ins.deleteChannel(id);\r\n        }\r\n    }\r\n}"]}