{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/common/WeaponInfoItem.ts"],"names":["_decorator","Component","instantiate","Label","Node","RichText","Sprite","HeroStar","LangMgr","tab","HeroTeamControl","HeroData","RogueControl","RareBookData","FightMsgControl","FightData","IsInFightScene","ccclass","property","WeaponInfoItem","info","rogueInfo","initData","bookInfo","initView","ins","stageId","node_recommand","active","nameLab","string","getLab","itemTable","Name","infoSpr","setTexture","Icon","atpTab","getData","HeroAptitudeTableByHeroAptitude","getValue","bookTable","Aptitude","bgSpr","BookTitle","heroclass","HeroClassTableByHeroClass","Class","bookPlaysSpr","node","PlaystyleName","proSpr","detailsRichText","bookStarTable","BookDescription","isTest","BookDictionary","getBookDicTabByHeroClass","Id","PhaseOneBook","createHeroIcon","heroIds","caleRecommendHeros","Heros","buildArr","getExtraIds","j","length","indexOf","push","node_heros_content","parent","getChildByName","destroyAllChildren","i","icon","sp_recommend_icon","addChild","iconPath","HeroTableById","WeaponHead","getComponent","setShowStar","b","heroStar","showStar","star","heroItemId","validList","rogueInfos","_rogueInfo","rogueTab","Condition","heroItemIds","getHeroIdsByRougeInfos","k","bookID","BookId","bookTab","BookTableById","Builds","Builds_Core","Builds_Skill","Builds_None","getTeamIdBuilds","heroInfo","getHeroByClass","Number","itemId","buildId","buildsHeros","teams","getTeam","getById","heroId","builds","heroTable","_buildArr"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Label, log, Node, RichText, Sprite } from 'cc';\r\nimport { HeroStar } from '../hero/HeroStar';\r\nimport { RareBookInfo } from '../rareBook/RareBookInfo';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { RogueInfo } from '../../fight/view/rogue/RogueInfo';\r\nimport { HeroTeamControl } from '../hero/HeroTeamControl';\r\nimport { HeroData } from '../hero/HeroData';\r\nimport { RogueControl } from '../../fight/view/rogue/RogueControl';\r\nimport { RareBookData } from '../rareBook/RareBookData';\r\nimport { FightMsgControl } from '../../fight/FightMsgControl';\r\nimport { FightData } from '../../fight/data/FightData';\r\nimport { IsInFightScene } from '../../guide/GuideCommand';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * WeaponInfoItem\r\n * zhudingchao\r\n * Mon May 27 2024 14:34:23 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/common/WeaponInfoItem.ts\r\n *\r\n */\r\n\r\n@ccclass('WeaponInfoItem')\r\nexport class WeaponInfoItem extends Component {\r\n    @property(Sprite)\r\n    bgSpr: Sprite = null;\r\n    @property(Sprite)\r\n    infoSpr: Sprite = null;\r\n    @property(Label)\r\n    nameLab: Label = null;\r\n    @property(HeroStar)\r\n    heroStar: HeroStar = null;\r\n    @property(RichText)\r\n    detailsRichText: RichText = null;\r\n    @property(Node)\r\n    proNode: Node = null;\r\n    @property(Sprite)\r\n    proSpr: Sprite = null;\r\n    @property(Sprite)\r\n    bookPlaysSpr: Sprite = null;\r\n    @property(Sprite)\r\n    sp_recommend_icon: Sprite = null;\r\n    @property(Node)\r\n    node_heros_content: Node = null;\r\n    @property(Node)\r\n    node_recommand:Node = null;\r\n\r\n\r\n\r\n    private info: RareBookInfo;\r\n    private rogueInfo: RogueInfo;\r\n    initData(bookInfo: RareBookInfo, rogueInfo?: RogueInfo) {\r\n        this.info = bookInfo;\r\n        this.rogueInfo = rogueInfo;\r\n        this.initView();\r\n        if(FightData.ins.stageId===1&&IsInFightScene()){\r\n            this.node_recommand.active = false;\r\n        }\r\n    }\r\n    initView() {\r\n        this.nameLab.string = LangMgr.getLab(this.info.itemTable.Name);\r\n        this.infoSpr.setTexture(this.info.itemTable.Icon);\r\n        let atpTab = tab.getData().HeroAptitudeTableByHeroAptitude.getValue(this.info.bookTable.Aptitude);\r\n        this.bgSpr.setTexture(atpTab.BookTitle);\r\n        let heroclass = tab.getData().HeroClassTableByHeroClass.getValue(this.info.bookTable.Class);\r\n        this.bookPlaysSpr.node.active = this.info.bookTable.PlaystyleName != \"\";\r\n        if (this.info.bookTable.PlaystyleName != \"\") {\r\n            this.bookPlaysSpr.setTexture(this.info.bookTable.PlaystyleName)\r\n        }\r\n        this.proSpr.setTexture(heroclass.Icon);\r\n        this.detailsRichText.string = LangMgr.getLab(this.info.bookStarTable.BookDescription);\r\n        if (FightMsgControl.ins.isTest) {\r\n            return\r\n        }\r\n        if (this.rogueInfo) {\r\n            const BookDictionary = RareBookData.ins.getBookDicTabByHeroClass(this.info.bookTable.Class);\r\n            if (this.info.bookTable.Id === BookDictionary.PhaseOneBook) {\r\n                this.createHeroIcon([])\r\n            } else {\r\n                const heroIds = this.caleRecommendHeros(this.rogueInfo);\r\n                this.createHeroIcon(heroIds);\r\n            }\r\n        } else {\r\n            // 通过bookid\r\n            let Heros = [];\r\n            const buildArr = this.getExtraIds(this.info.bookTable);\r\n            for (let j = 0; j < buildArr.length; j++) {\r\n                if (Heros.indexOf(buildArr[j]) === -1) {\r\n                    Heros.push(buildArr[j]);\r\n                }\r\n            }\r\n            this.createHeroIcon(Heros);\r\n        }\r\n    }\r\n    createHeroIcon(heroIds: number[]) {\r\n        this.node_heros_content.parent.active = heroIds.length > 0\r\n        this.node_heros_content.parent.getChildByName(\"pro_node\").active = false;\r\n        this.node_heros_content.destroyAllChildren();\r\n        if (heroIds.length > 0) {\r\n            for (let i = 0; i < heroIds.length; i++) {\r\n                const icon = instantiate(this.sp_recommend_icon.node);\r\n                this.node_heros_content.addChild(icon);\r\n                icon.active = true;\r\n                const iconPath = tab.getData().HeroTableById.getValue(heroIds[i]).WeaponHead;\r\n                icon.getComponent(Sprite).setTexture(iconPath);\r\n            }\r\n        }\r\n    }\r\n    setShowStar(b: boolean) {\r\n        if (b) {\r\n            this.heroStar.node.active = true;\r\n            this.heroStar.showStar(this.info.star)\r\n        } else {\r\n            this.heroStar.node.active = false;\r\n        }\r\n\r\n    }\r\n\r\n    // 根据肉鸽id推荐英雄\r\n    caleRecommendHeros(rogueInfo: RogueInfo) {\r\n        if (rogueInfo == null) {\r\n            return []\r\n        }\r\n        if (!rogueInfo.heroItemId) {\r\n            const validList = RogueControl.ins.validList;\r\n            const rogueInfos = [rogueInfo];\r\n            for (let i = 0; i < validList.length; i++) {\r\n                const _rogueInfo = validList[i];\r\n                if (_rogueInfo.Id === rogueInfo.Id) {\r\n                    continue;\r\n                }\r\n                if (_rogueInfo.rogueTab.Condition === rogueInfo.rogueTab.Id) {\r\n                    rogueInfos.push(_rogueInfo);\r\n                }\r\n            }\r\n            const heroItemIds = this.getHeroIdsByRougeInfos(rogueInfos);\r\n            return heroItemIds;\r\n        } else {\r\n            return [];\r\n        }\r\n    }\r\n    // 通过关联的肉鸽Ids返回所有的英雄id\r\n    getHeroIdsByRougeInfos(rogueInfos: RogueInfo[]): number[] {\r\n        let Heros = [];\r\n        for (let k = 0; k < rogueInfos.length; k++) {\r\n            const bookID = rogueInfos[k].rogueTab.BookId;\r\n            const bookTab = tab.getData().BookTableById.getValue(bookID);\r\n            if (bookTab.Builds !== tab.Builds.Builds_Core && bookTab.Builds !== tab.Builds.Builds_Skill && bookTab.Builds !== tab.Builds.Builds_None) {\r\n                const buildArr = this.getTeamIdBuilds(bookTab.Builds);\r\n                for (let j = 0; j < buildArr.length; j++) {\r\n                    if (Heros.indexOf(buildArr[j]) === -1) {\r\n                        Heros.push(buildArr[j]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // log(\"cocos 推荐英雄的流派ids为=\", Heros);\r\n        for (let i = 0; i < rogueInfos.length; i++) {\r\n            const rogueInfo = rogueInfos[i];\r\n            const bookTab = tab.getData().BookTableById.getValue(rogueInfo.rogueTab.BookId);\r\n            if (bookTab.Builds === tab.Builds.Builds_Core || bookTab.Builds === tab.Builds.Builds_Skill) {\r\n                const heroInfo = HeroTeamControl.ins.getHeroByClass(Number(bookTab.Class))\r\n                if (Heros.indexOf(heroInfo.itemId) === -1) {\r\n                    // log(\"cocos 推荐英雄的itemId为=\", heroInfo.itemId);\r\n                    Heros.push(heroInfo.itemId)\r\n                }\r\n            }\r\n        }\r\n        return Heros;\r\n    }\r\n    getTeamIdBuilds(buildId: tab.Builds): number[] {\r\n        const buildsHeros = [];\r\n        const teams = HeroTeamControl.ins.getTeam();\r\n        for (let i = 0; i < teams.length; i++) {\r\n            const heroInfo = HeroData.ins.getById(teams[i].heroId);\r\n            const builds = heroInfo.heroTable.Builds;\r\n            if (builds.indexOf(buildId) > -1) {\r\n                buildsHeros.push(heroInfo.itemId);\r\n            }\r\n        }\r\n        return buildsHeros;\r\n    }\r\n    // 是否存在二阶今借到秘籍Id\r\n    getExtraIds(bookTab: tab.BookTable) {\r\n        let Heros = [];\r\n        const BookDictionary = RareBookData.ins.getBookDicTabByHeroClass(bookTab.Class);\r\n        const _buildArr = this.getTeamIdBuilds(bookTab.Builds);\r\n\r\n        const heroInfo = HeroTeamControl.ins.getHeroByClass(Number(bookTab.Class))\r\n        if (Heros.indexOf(heroInfo.itemId) === -1 && (bookTab.Builds === tab.Builds.Builds_Core || bookTab.Builds === tab.Builds.Builds_Skill)) {\r\n            Heros.push(heroInfo.itemId)\r\n        }\r\n        for (let i = 0; i < _buildArr.length; i++) {\r\n            if (Heros.indexOf(_buildArr[i]) === -1) {\r\n                Heros.push(_buildArr[i]);\r\n            }\r\n        }\r\n\r\n        if (bookTab.Id === BookDictionary.PhaseOneBook) {\r\n            return [];\r\n            // for (let k = 0; k < BookDictionary.PhaseTwoBook.length; k++) {\r\n            //     const bookID = BookDictionary.PhaseTwoBook[k];\r\n            //     const bookTab = tab.getData().BookTableById.getValue(bookID);\r\n            //     const heroInfo = HeroTeamControl.ins.getHeroByClass(Number(bookTab.Class))\r\n            //     if (Heros.indexOf(heroInfo.itemId) === -1 && (bookTab.Builds === tab.Builds.Builds_Core || bookTab.Builds === tab.Builds.Builds_Skill)) {\r\n            //         Heros.push(heroInfo.itemId)\r\n            //     }\r\n            //     if (bookTab.Builds !== tab.Builds.Builds_Core && bookTab.Builds !== tab.Builds.Builds_Skill && bookTab.Builds !== tab.Builds.Builds_None) {\r\n            //         const buildArr = this.getTeamIdBuilds(bookTab.Builds);\r\n            //         for (let j = 0; j < buildArr.length; j++) {\r\n            //             if (Heros.indexOf(buildArr[j]) === -1) {\r\n            //                 Heros.push(buildArr[j]);\r\n            //             }\r\n            //         }\r\n            //     }\r\n            // }\r\n        }\r\n        return Heros;\r\n    }\r\n}"]}