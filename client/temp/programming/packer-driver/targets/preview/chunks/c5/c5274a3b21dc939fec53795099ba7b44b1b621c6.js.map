{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/fincaFight/FincaFightStageWeaponItem.ts"],"names":["_decorator","Component","Node","WeaponItem","LocalEvent","EventMgr","FincaFightData","ccclass","property","FincaFightStageWeaponItem","bookInfo","initData","info","node","name","String","itemId","item_weapon","onTouchItem","bind","inTeam","ins","getBookInTeam","node_select","active","setSelectCircle","curSelectBook","changeSelect","index","BookToggleIndex","teamIndex","bookIds","emitLocal","Finca_Book_Change","console","log","onDestroy","targetOff","parent","getChildByName","isValid","itemTs","getComponent","isShow","node_select_1"],"mappings":"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","sourcesContent":["import { _decorator, Component, log, Node } from 'cc';\r\nimport { WeaponItem } from '../common/WeaponItem';\r\nimport { RareBookInfo } from '../rareBook/RareBookInfo';\r\nimport { LocalEvent } from '../../define/LocalEvent';\r\nimport { EventMgr } from '../../mgr/EventMgr';\r\nimport { FincaFightData } from './FincaFightData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('FincaFightStageWeaponItem')\r\nexport class FincaFightStageWeaponItem extends Component {\r\n    @property(WeaponItem)\r\n    item_weapon:WeaponItem = null;\r\n    @property(Node)\r\n    node_select_1:Node = null;\r\n    @property(Node)\r\n    node_select:Node = null;\r\n    private bookInfo:RareBookInfo = null;\r\n    initData(info:RareBookInfo){\r\n        this.bookInfo = info;\r\n        // info.isLock = true;\r\n        this.node.name = String(this.bookInfo.itemId);\r\n        this.item_weapon.initData(info, true, false, false, this.onTouchItem.bind(this));\r\n        const inTeam = FincaFightData.ins.getBookInTeam(this.bookInfo.itemId);\r\n        this.node_select.active = inTeam>-1;\r\n        this.setSelectCircle(this.bookInfo.itemId === FincaFightData.ins.curSelectBook);\r\n    }\r\n    onTouchItem(){\r\n        this.changeSelect();\r\n        FincaFightData.ins.curSelectBook = this.bookInfo.itemId;\r\n        const index = FincaFightData.ins.BookToggleIndex;\r\n        const teamIndex = FincaFightData.ins.getBookInTeam(this.bookInfo.itemId);\r\n        // 点击的英雄是否在队伍中\r\n        if (teamIndex>-1) {\r\n            FincaFightData.ins.bookIds[teamIndex] = 0;\r\n            EventMgr.emitLocal(LocalEvent.Finca_Book_Change,teamIndex+1);\r\n        } else {\r\n            // 判断不在队伍中的英雄是否可以替换\r\n            FincaFightData.ins.bookIds[index - 1] = this.bookInfo.itemId;\r\n            EventMgr.emitLocal(LocalEvent.Finca_Book_Change,index);\r\n        }\r\n        console.log(FincaFightData.ins.bookIds);\r\n    }\r\n    protected onDestroy(): void {\r\n        this.node.targetOff(this);\r\n    }\r\n    changeSelect(){\r\n        const node = this.node.parent.getChildByName(String(FincaFightData.ins.curSelectBook));\r\n        if(node&&node.isValid){\r\n            const itemTs = node.getComponent(FincaFightStageWeaponItem);\r\n            if(itemTs&&itemTs.isValid){\r\n                itemTs.setSelectCircle(false);\r\n            }\r\n        }\r\n        this.setSelectCircle(true);   \r\n    }\r\n    setSelectCircle(isShow:boolean){\r\n        this.node_select_1.active = isShow\r\n    }\r\n}\r\n\r\n\r\n"]}