{"version":3,"sources":["file:///C:/chickenStarClient/client/assets/scripts/logic/model/common/WeaponItem.ts"],"names":["_decorator","Button","Component","Label","Node","Sprite","LangMgr","tab","RareBookData","OpenFunctionMgr","ccclass","property","WeaponItem","info","touchCallBack","initData","isTouch","isShowName","isShowLock","button","enabled","nameNode","active","selectNode","nameLab","string","getLab","itemTable","Name","iconSpr","setTexture","Icon","signSpr","node","bookTable","PlaystyleName","atpTab","getData","HeroAptitudeTableByHeroAptitude","getValue","Aptitude","qualitybgSpr","BookBgSmall","unlockNode","isLock","initBookItemId","bookId","ins","getBookInfoByItemId","setSelect","b","onClickItem","setNotOpen","isOpen","checkFunctionIsOpen","OpenFunctionName","OpenFunctionName_RareBook","HeroAptitude","HeroAptitude_SR","nodeNotOpen"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, Label, Node, Sprite } from 'cc';\r\nimport { RareBookInfo } from '../rareBook/RareBookInfo';\r\nimport { LangMgr } from '../../mgr/LangMgr';\r\nimport { tab } from '../../../Table/table_gen';\r\nimport { RareBookData } from '../rareBook/RareBookData';\r\nimport { OpenFunctionMgr } from '../../../Common/component/OpenFunctionMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * \r\n * WeaponItem\r\n * zhudingchao\r\n * Tue May 28 2024 14:38:31 GMT+0800 (中国标准时间)\r\n * db://assets/scripts/logic/model/common/WeaponItem.ts\r\n *\r\n */\r\n\r\n@ccclass('WeaponItem')\r\nexport class WeaponItem extends Component {\r\n    @property(Button)\r\n    button: Button = null;\r\n    @property(Sprite)\r\n    qualitybgSpr:Sprite=null;\r\n    @property(Sprite)\r\n    iconSpr:Sprite=null;\r\n    @property(Sprite)\r\n    signSpr:Sprite=null;\r\n    @property(Node)\r\n    nameNode:Node=null;\r\n    @property(Label)\r\n    nameLab:Label=null;\r\n    @property(Node)\r\n    unlockNode:Node=null;\r\n    @property(Node)\r\n    selectNode:Node=null;\r\n    @property(Node)\r\n    redPointNode:Node=null;\r\n    @property(Node)\r\n    nodeNotOpen:Node = null;\r\n    public info:RareBookInfo;\r\n    private touchCallBack:Function;\r\n\r\n    initData(info:RareBookInfo,isTouch:boolean=true,isShowName:boolean=true,isShowLock:boolean=false,touchCallBack=null){\r\n        this.info=info;\r\n        if(this.button){\r\n            this.button.enabled=isTouch;\r\n        }\r\n        this.nameNode.active=isShowName;\r\n        this.selectNode.active=false;\r\n        this.nameLab.string = LangMgr.getLab(this.info.itemTable.Name);\r\n        this.iconSpr.setTexture(this.info.itemTable.Icon);\r\n        this.signSpr.node.active = this.info.bookTable.PlaystyleName != \"\";\r\n        if( this.info.bookTable.PlaystyleName != \"\"){\r\n            this.signSpr.setTexture(this.info.bookTable.PlaystyleName);\r\n        }\r\n        let atpTab = tab.getData().HeroAptitudeTableByHeroAptitude.getValue(this.info.bookTable.Aptitude);\r\n        this.qualitybgSpr.setTexture(atpTab.BookBgSmall);\r\n        // this.qualitySpr.setTexture(atpTab.Icon);\r\n        // this.qualityBgSpr.setTexture(atpTab.BookBgSmall);\r\n        // this.qualitybgSpr.setTexture(\"textrue/quality/qualityBg_\" + info.itemTable.Quality);\r\n        if(isShowLock){\r\n            this.unlockNode.active=!info.isLock;\r\n        }else{\r\n            this.unlockNode.active=false;\r\n        }\r\n        this.touchCallBack=touchCallBack;\r\n    }\r\n    initBookItemId(bookId:number,isTouch:boolean=true,isShowName:boolean=true,isShowLock:boolean=false,touchCallBack=null){\r\n        let info=RareBookData.ins.getBookInfoByItemId(bookId);\r\n        this.initData(info,isTouch,isShowName,isShowLock,touchCallBack);\r\n    }\r\n\r\n    setSelect(b:boolean){\r\n        this.selectNode.active=b;\r\n    }\r\n    onClickItem(){\r\n        if(this.touchCallBack){\r\n            this.touchCallBack(this);\r\n        }\r\n}\r\n    setNotOpen(){\r\n        const isOpen = OpenFunctionMgr.ins.checkFunctionIsOpen(tab.OpenFunctionName.OpenFunctionName_RareBook);\r\n        let atpTab = tab.getData().HeroAptitudeTableByHeroAptitude.getValue(this.info.bookTable.Aptitude);\r\n        if(this.button){\r\n            if(!isOpen&&atpTab.HeroAptitude===tab.HeroAptitude.HeroAptitude_SR){\r\n                this.nodeNotOpen.active = true;\r\n                this.button.node.active = false;\r\n            }else{\r\n                this.nodeNotOpen.active = false;\r\n                this.button.node.active = true;\r\n            }\r\n        }\r\n    }\r\n}"]}